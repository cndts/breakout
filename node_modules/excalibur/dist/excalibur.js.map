{"version":3,"sources":["webpack://ex/webpack/universalModuleDefinition","webpack://ex/webpack/bootstrap","webpack://ex/./Loader.css","webpack://ex//home/travis/build/excaliburjs/Excalibur/node_modules/css-loader/lib/css-base.js","webpack://ex/./Actions/Action.ts","webpack://ex/./Actions/ActionContext.ts","webpack://ex/./Actions/Index.ts","webpack://ex/./Actions/RotationType.ts","webpack://ex/./Actor.ts","webpack://ex/./Algebra.ts","webpack://ex/./Camera.ts","webpack://ex/./Class.ts","webpack://ex/./Collision/Body.ts","webpack://ex/./Collision/BoundingBox.ts","webpack://ex/./Collision/CircleArea.ts","webpack://ex/./Collision/CollisionContact.ts","webpack://ex/./Collision/CollisionJumpTable.ts","webpack://ex/./Collision/DynamicTree.ts","webpack://ex/./Collision/DynamicTreeCollisionBroadphase.ts","webpack://ex/./Collision/EdgeArea.ts","webpack://ex/./Collision/Index.ts","webpack://ex/./Collision/NaiveCollisionBroadphase.ts","webpack://ex/./Collision/Pair.ts","webpack://ex/./Collision/PolygonArea.ts","webpack://ex/./Collision/Side.ts","webpack://ex/./Configurable.ts","webpack://ex/./Debug.ts","webpack://ex/./Drawing/Animation.ts","webpack://ex/./Drawing/Color.ts","webpack://ex/./Drawing/Index.ts","webpack://ex/./Drawing/Polygon.ts","webpack://ex/./Drawing/Sprite.ts","webpack://ex/./Drawing/SpriteEffects.ts","webpack://ex/./Drawing/SpriteSheet.ts","webpack://ex/./Engine.ts","webpack://ex/./EventDispatcher.ts","webpack://ex/./Events.ts","webpack://ex/./Events/MediaEvents.ts","webpack://ex/./Group.ts","webpack://ex/./Input/Gamepad.ts","webpack://ex/./Input/Index.ts","webpack://ex/./Input/Keyboard.ts","webpack://ex/./Input/Pointer.ts","webpack://ex/./Interfaces/IAudioImplementation.ts","webpack://ex/./Interfaces/Index.ts","webpack://ex/./Label.ts","webpack://ex/./Loader.css?aa59","webpack://ex/./Loader.logo.png","webpack://ex/./Loader.ts","webpack://ex/./Math/Index.ts","webpack://ex/./Math/PerlinNoise.ts","webpack://ex/./Math/Random.ts","webpack://ex/./Particles.ts","webpack://ex/./Physics.ts","webpack://ex/./Polyfill.ts","webpack://ex/./PostProcessing/ColorBlindCorrector.ts","webpack://ex/./PostProcessing/Index.ts","webpack://ex/./Promises.ts","webpack://ex/./Resources/Index.ts","webpack://ex/./Resources/Resource.ts","webpack://ex/./Resources/Sound/AudioContext.ts","webpack://ex/./Resources/Sound/AudioInstance.ts","webpack://ex/./Resources/Sound/Index.ts","webpack://ex/./Resources/Sound/Sound.ts","webpack://ex/./Resources/Texture.ts","webpack://ex/./Scene.ts","webpack://ex/./TileMap.ts","webpack://ex/./Timer.ts","webpack://ex/./Traits/CapturePointer.ts","webpack://ex/./Traits/EulerMovement.ts","webpack://ex/./Traits/Index.ts","webpack://ex/./Traits/OffscreenCulling.ts","webpack://ex/./Traits/TileMapCollisionDetection.ts","webpack://ex/./Trigger.ts","webpack://ex/./UIActor.ts","webpack://ex/./Util/Actors.ts","webpack://ex/./Util/CullingBox.ts","webpack://ex/./Util/Decorators.ts","webpack://ex/./Util/Detector.ts","webpack://ex/./Util/DrawUtil.ts","webpack://ex/./Util/EasingFunctions.ts","webpack://ex/./Util/Index.ts","webpack://ex/./Util/Log.ts","webpack://ex/./Util/SortedList.ts","webpack://ex/./Util/Sound.ts","webpack://ex/./Util/Util.ts","webpack://ex/./Util/WebAudio.ts","webpack://ex/./index.ts"],"names":[],"mappings":"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EAAE;YACF,GAAG;YACH,EAAE;YACF,EAAE;YACF,GAAG;YACH,CAAC;YACD,EAAE;YACF,EAAE;YACF,GAAG;YACH,EAAE;YACF,EAAE;YACF,EAAE;YACF,GAAG;YACH,CAAC;YACD,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,EAAE;YACF,CAAC;YACD,EAAE;YACF,GAAG;YACH,EAAE;YACF,EAAE;YACF,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,EAAE;YACF,EAAE;YACF,EAAE;YACF,EAAE;YACF,GAAG;YACH,EAAE;YACF,EAAE;YACF,GAAG;YACH,GAAG;YACH,EAAE;YACF,EAAE;YACF,GAAG;YACH,EAAE;YACF,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,EAAE;YACF,GAAG;YACH,EAAE;YACF,GAAG;YACH,EAAE;YACF,GAAG;YACH,GAAG;YACH,EAAE;YACF,EAAE;YACF,GAAG;YACH,EAAE;YACF,GAAG;YACH,GAAG;YACH,GAAG;YACH,EAAE;YACF,GAAG;YACH,GAAG;YACH,GAAG;YACH,EAAE;YACF,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,EAAE;YACF,EAAE;YACF,EAAE;YACF,EAAE;YACF,GAAG;YACH,EAAE;YACF,GAAG;YACH,GAAG;YACH,GAAG;YACH,EAAE;YACF,EAAE;YACF,EAAE;YACF,EAAE;YACF,GAAG;YACH,CAAC;YACD,GAAG;YACH,EAAE;YACF,EAAE;YACF,GAAG;YACH,EAAE;YACF,GAAG;YACH,GAAG;YACH,GAAG;YACH,EAAE;YACF,EAAE;YACF,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,EAAE;YACF,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,CAAC;YACD,EAAE;YACF,EAAE;YACF,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,CAAC;YACD,GAAG;YACH,EAAE;YACF,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,EAAE;YACF,EAAE;YACF,GAAG;YACH,GAAG;YACH,GAAG;YACH,EAAE;YACF,GAAG;YACH,EAAE;YACF,EAAE;YACF,EAAE;YACF,EAAE;YACF,GAAG;YACH,GAAG;YACH,EAAE;YACF,EAAE;YACF,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,CAAC;YACD,EAAE;YACF,GAAG;YACH,GAAG;YACH,EAAE;YACF,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,EAAE;YACF,GAAG;YACH,CAAC;YACD,GAAG;YACH,EAAE;YACF,EAAE;YACF,GAAG;YACH,EAAE;YACF,EAAE;YACF,GAAG;YACH,GAAG;YACH,EAAE;YACF,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,EAAE;YACF,GAAG;YACH,GAAG;YACH,EAAE;YACF,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,EAAE;YACF,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,EAAE;YACF,EAAE;YACF,GAAG;YACH,GAAG;YACH,GAAG;YACH,EAAE;YACF,GAAG;YACH,GAAG;YACH,EAAE;YACF,GAAG;YACH,GAAG;YACH,EAAE;YACF,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,EAAE;YACF,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,EAAE;YACF,EAAE;YACF,GAAG;YACH,CAAC;YACD,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,EAAE;YACF,GAAG;YACH,GAAG;YACH,EAAE;YACF,EAAE;YACF,EAAE;YACF,EAAE;YACF,GAAG;YACH,GAAG;YACH,GAAG;YACH,GAAG;YACH,EAAE;YACF,EAAE;YACF,GAAG;YACH,EAAE;YACF,GAAG;YACH,GAAG;SACJ,CAAC;QACM,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","file":"excalibur.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ex\"] = factory();\n\telse\n\t\troot[\"ex\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./index.ts\");\n","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"/* Buttons styles start */\\n\\nbutton#excalibur-play {\\n  display: inline-block;\\n  position: relative;\\n  border-radius: 6px;\\n  border: none;\\n  /*border: 3px solid;\\n    border-color: white;\\n    box-shadow: 0 0 10px #ccc;*/\\n  padding: 1rem 1.5rem 1rem 4rem;\\n  margin: 0;\\n  text-decoration: none;\\n  background: #00b233;\\n  color: #ffffff;\\n  font-family: sans-serif;\\n  font-size: 2rem;\\n  line-height: 1;\\n  cursor: pointer;\\n  text-align: center;\\n  transition: background 250ms ease-in-out, transform 150ms ease;\\n  -webkit-appearance: none;\\n  -moz-appearance: none;\\n\\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\\n  animation: excalibur-button-fadein 200ms;\\n}\\n\\n/*\\nbutton#excalibur-play {\\n  display: none;\\n}*/\\n\\nbutton#excalibur-play:after {\\n  position: absolute;\\n  content: '';\\n  border: 8px solid;\\n  border-color: transparent transparent transparent white;\\n  left: 35px;\\n  top: 24px;\\n  width: 0;\\n  height: 0;\\n}\\n\\nbutton#excalibur-play:before {\\n  position: absolute;\\n  content: '';\\n  border: 3px solid;\\n  left: 19px;\\n  top: 14px;\\n  border-radius: 20px;\\n  width: 30px;\\n  height: 30px;\\n}\\n\\nbutton#excalibur-play:hover,\\nbutton#excalibur-play:focus {\\n  background: #00982c;\\n}\\n\\nbutton#excalibur-play:focus {\\n  outline: 1px solid #fff;\\n  outline-offset: -4px;\\n}\\n\\nbutton#excalibur-play:active {\\n  transform: scale(0.99);\\n}\\n\\n@keyframes excalibur-button-fadein {\\n  from {\\n    opacity: 0;\\n  }\\n  to {\\n    opacity: 1;\\n  }\\n}\\n\\n/* Firefox < 16 */\\n@-moz-keyframes excalibur-button-fadein {\\n  from {\\n    opacity: 0;\\n  }\\n  to {\\n    opacity: 1;\\n  }\\n}\\n\\n/* Safari, Chrome and Opera > 12.1 */\\n@-webkit-keyframes excalibur-button-fadein {\\n  from {\\n    opacity: 0;\\n  }\\n  to {\\n    opacity: 1;\\n  }\\n}\\n\\n/* Internet Explorer */\\n@-ms-keyframes excalibur-button-fadein {\\n  from {\\n    opacity: 0;\\n  }\\n  to {\\n    opacity: 1;\\n  }\\n}\\n\\n/* Opera < 12.1 */\\n@-o-keyframes excalibur-button-fadein {\\n  from {\\n    opacity: 0;\\n  }\\n  to {\\n    opacity: 1;\\n  }\\n}\\n\", \"\"]);\n\n// exports\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n","import { RotationType } from './RotationType';\n\nimport { Actor } from '../Actor';\nimport { Vector } from '../Algebra';\nimport { Logger } from '../Util/Log';\nimport * as Util from '../Util/Util';\n\n/**\n * Used for implementing actions for the [[ActionContext|Action API]].\n */\nexport interface IAction {\n  update(delta: number): void;\n  isComplete(actor: Actor): boolean;\n  reset(): void;\n  stop(): void;\n}\n\nexport class EaseTo implements IAction {\n  private _currentLerpTime: number = 0;\n  private _lerpDuration: number = 1 * 1000; // 1 second\n  private _lerpStart: Vector = new Vector(0, 0);\n  private _lerpEnd: Vector = new Vector(0, 0);\n  private _initialized: boolean = false;\n  private _stopped: boolean = false;\n  private _distance: number = 0;\n  constructor(\n    public actor: Actor,\n    x: number,\n    y: number,\n    duration: number,\n    public easingFcn: (currentTime: number, startValue: number, endValue: number, duration: number) => number\n  ) {\n    this._lerpDuration = duration;\n    this._lerpEnd = new Vector(x, y);\n  }\n  private _initialize() {\n    this._lerpStart = new Vector(this.actor.pos.x, this.actor.pos.y);\n    this._currentLerpTime = 0;\n    this._distance = this._lerpStart.distance(this._lerpEnd);\n  }\n\n  public update(delta: number): void {\n    if (!this._initialized) {\n      this._initialize();\n      this._initialized = true;\n    }\n\n    var newX = this.actor.pos.x;\n    var newY = this.actor.pos.y;\n    if (this._currentLerpTime < this._lerpDuration) {\n      if (this._lerpEnd.x < this._lerpStart.x) {\n        newX =\n          this._lerpStart.x -\n          (this.easingFcn(this._currentLerpTime, this._lerpEnd.x, this._lerpStart.x, this._lerpDuration) - this._lerpEnd.x);\n      } else {\n        newX = this.easingFcn(this._currentLerpTime, this._lerpStart.x, this._lerpEnd.x, this._lerpDuration);\n      }\n\n      if (this._lerpEnd.y < this._lerpStart.y) {\n        newY =\n          this._lerpStart.y -\n          (this.easingFcn(this._currentLerpTime, this._lerpEnd.y, this._lerpStart.y, this._lerpDuration) - this._lerpEnd.y);\n      } else {\n        newY = this.easingFcn(this._currentLerpTime, this._lerpStart.y, this._lerpEnd.y, this._lerpDuration);\n      }\n      this.actor.pos.x = newX;\n      this.actor.pos.y = newY;\n\n      this._currentLerpTime += delta;\n    } else {\n      this.actor.pos.x = this._lerpEnd.x;\n      this.actor.pos.y = this._lerpEnd.y;\n      //this._lerpStart = null;\n      //this._lerpEnd = null;\n      //this._currentLerpTime = 0;\n    }\n  }\n  public isComplete(actor: Actor): boolean {\n    return this._stopped || new Vector(actor.pos.x, actor.pos.y).distance(this._lerpStart) >= this._distance;\n  }\n\n  public reset(): void {\n    this._initialized = false;\n  }\n  public stop(): void {\n    this._stopped = true;\n  }\n}\n\nexport class MoveTo implements IAction {\n  private _actor: Actor;\n  public x: number;\n  public y: number;\n  private _start: Vector;\n  private _end: Vector;\n  private _dir: Vector;\n  private _speed: number;\n  private _distance: number;\n  private _started = false;\n  private _stopped = false;\n  constructor(actor: Actor, destx: number, desty: number, speed: number) {\n    this._actor = actor;\n    this._end = new Vector(destx, desty);\n    this._speed = speed;\n  }\n\n  public update(_delta: number): void {\n    if (!this._started) {\n      this._started = true;\n      this._start = new Vector(this._actor.pos.x, this._actor.pos.y);\n      this._distance = this._start.distance(this._end);\n      this._dir = this._end.sub(this._start).normalize();\n    }\n    var m = this._dir.scale(this._speed);\n    this._actor.vel.x = m.x;\n    this._actor.vel.y = m.y;\n\n    if (this.isComplete(this._actor)) {\n      this._actor.pos.x = this._end.x;\n      this._actor.pos.y = this._end.y;\n      this._actor.vel.y = 0;\n      this._actor.vel.x = 0;\n    }\n  }\n\n  public isComplete(actor: Actor): boolean {\n    return this._stopped || new Vector(actor.pos.x, actor.pos.y).distance(this._start) >= this._distance;\n  }\n\n  public stop(): void {\n    this._actor.vel.y = 0;\n    this._actor.vel.x = 0;\n    this._stopped = true;\n  }\n\n  public reset(): void {\n    this._started = false;\n  }\n}\n\nexport class MoveBy implements IAction {\n  private _actor: Actor;\n  public x: number;\n  public y: number;\n  private _distance: number;\n  private _speed: number;\n  private _time: number;\n\n  private _start: Vector;\n  private _end: Vector;\n  private _dir: Vector;\n  private _started = false;\n  private _stopped = false;\n  constructor(actor: Actor, destx: number, desty: number, time: number) {\n    this._actor = actor;\n    this._end = new Vector(destx, desty);\n    if (time <= 0) {\n      Logger.getInstance().error('Attempted to moveBy time less than or equal to zero : ' + time);\n      throw new Error('Cannot move in time <= 0');\n    }\n    this._time = time;\n  }\n\n  public update(_delta: number) {\n    if (!this._started) {\n      this._started = true;\n      this._start = new Vector(this._actor.pos.x, this._actor.pos.y);\n      this._distance = this._start.distance(this._end);\n      this._dir = this._end.sub(this._start).normalize();\n      this._speed = this._distance / (this._time / 1000);\n    }\n\n    var m = this._dir.scale(this._speed);\n    this._actor.vel.x = m.x;\n    this._actor.vel.y = m.y;\n\n    if (this.isComplete(this._actor)) {\n      this._actor.pos.x = this._end.x;\n      this._actor.pos.y = this._end.y;\n      this._actor.vel.y = 0;\n      this._actor.vel.x = 0;\n    }\n  }\n\n  public isComplete(actor: Actor): boolean {\n    return this._stopped || new Vector(actor.pos.x, actor.pos.y).distance(this._start) >= this._distance;\n  }\n\n  public stop(): void {\n    this._actor.vel.y = 0;\n    this._actor.vel.x = 0;\n    this._stopped = true;\n  }\n\n  public reset(): void {\n    this._started = false;\n  }\n}\n\nexport class Follow implements IAction {\n  private _actor: Actor;\n  private _actorToFollow: Actor;\n  public x: number;\n  public y: number;\n  private _current: Vector;\n  private _end: Vector;\n  private _dir: Vector;\n  private _speed: number;\n  private _maximumDistance: number;\n  private _distanceBetween: number;\n  private _started = false;\n  private _stopped = false;\n\n  constructor(actor: Actor, actorToFollow: Actor, followDistance?: number) {\n    this._actor = actor;\n    this._actorToFollow = actorToFollow;\n    this._current = new Vector(this._actor.pos.x, this._actor.pos.y);\n    this._end = new Vector(actorToFollow.pos.x, actorToFollow.pos.y);\n    this._maximumDistance = followDistance !== undefined ? followDistance : this._current.distance(this._end);\n    this._speed = 0;\n  }\n\n  public update(_delta: number): void {\n    if (!this._started) {\n      this._started = true;\n      this._distanceBetween = this._current.distance(this._end);\n      this._dir = this._end.sub(this._current).normalize();\n    }\n\n    var actorToFollowSpeed = Math.sqrt(Math.pow(this._actorToFollow.vel.x, 2) + Math.pow(this._actorToFollow.vel.y, 2));\n    if (actorToFollowSpeed !== 0) {\n      this._speed = actorToFollowSpeed;\n    }\n    this._current.x = this._actor.pos.x;\n    this._current.y = this._actor.pos.y;\n\n    this._end.x = this._actorToFollow.pos.x;\n    this._end.y = this._actorToFollow.pos.y;\n    this._distanceBetween = this._current.distance(this._end);\n    this._dir = this._end.sub(this._current).normalize();\n\n    if (this._distanceBetween >= this._maximumDistance) {\n      var m = this._dir.scale(this._speed);\n      this._actor.vel.x = m.x;\n      this._actor.vel.y = m.y;\n    } else {\n      this._actor.vel.x = 0;\n      this._actor.vel.y = 0;\n    }\n\n    if (this.isComplete()) {\n      // TODO this should never occur\n      this._actor.pos.x = this._end.x;\n      this._actor.pos.y = this._end.y;\n      this._actor.vel.y = 0;\n      this._actor.vel.x = 0;\n    }\n  }\n\n  public stop(): void {\n    this._actor.vel.y = 0;\n    this._actor.vel.x = 0;\n    this._stopped = true;\n  }\n\n  public isComplete(): boolean {\n    // the actor following should never stop unless specified to do so\n    return this._stopped;\n  }\n\n  public reset(): void {\n    this._started = false;\n  }\n}\n\nexport class Meet implements IAction {\n  private _actor: Actor;\n  private _actorToMeet: Actor;\n  public x: number;\n  public y: number;\n  private _current: Vector;\n  private _end: Vector;\n  private _dir: Vector;\n  private _speed: number;\n  private _distanceBetween: number;\n  private _started = false;\n  private _stopped = false;\n  private _speedWasSpecified = false;\n\n  constructor(actor: Actor, actorToMeet: Actor, speed?: number) {\n    this._actor = actor;\n    this._actorToMeet = actorToMeet;\n    this._current = new Vector(this._actor.pos.x, this._actor.pos.y);\n    this._end = new Vector(actorToMeet.pos.x, actorToMeet.pos.y);\n    this._speed = speed || 0;\n\n    if (speed !== undefined) {\n      this._speedWasSpecified = true;\n    }\n  }\n\n  public update(_delta: number): void {\n    if (!this._started) {\n      this._started = true;\n      this._distanceBetween = this._current.distance(this._end);\n      this._dir = this._end.sub(this._current).normalize();\n    }\n\n    var actorToMeetSpeed = Math.sqrt(Math.pow(this._actorToMeet.vel.x, 2) + Math.pow(this._actorToMeet.vel.y, 2));\n    if (actorToMeetSpeed !== 0 && !this._speedWasSpecified) {\n      this._speed = actorToMeetSpeed;\n    }\n    this._current.x = this._actor.pos.x;\n    this._current.y = this._actor.pos.y;\n\n    this._end.x = this._actorToMeet.pos.x;\n    this._end.y = this._actorToMeet.pos.y;\n    this._distanceBetween = this._current.distance(this._end);\n    this._dir = this._end.sub(this._current).normalize();\n\n    var m = this._dir.scale(this._speed);\n    this._actor.vel.x = m.x;\n    this._actor.vel.y = m.y;\n\n    if (this.isComplete()) {\n      this._actor.pos.x = this._end.x;\n      this._actor.pos.y = this._end.y;\n      this._actor.vel.y = 0;\n      this._actor.vel.x = 0;\n    }\n  }\n\n  public isComplete(): boolean {\n    return this._stopped || this._distanceBetween <= 1;\n  }\n\n  public stop(): void {\n    this._actor.vel.y = 0;\n    this._actor.vel.x = 0;\n    this._stopped = true;\n  }\n\n  public reset(): void {\n    this._started = false;\n  }\n}\n\nexport class RotateTo implements IAction {\n  private _actor: Actor;\n  public x: number;\n  public y: number;\n  private _start: number;\n  private _end: number;\n  private _speed: number;\n  private _rotationType: RotationType;\n  private _direction: number;\n  private _distance: number;\n  private _shortDistance: number;\n  private _longDistance: number;\n  private _shortestPathIsPositive: boolean;\n  private _started = false;\n  private _stopped = false;\n  constructor(actor: Actor, angleRadians: number, speed: number, rotationType?: RotationType) {\n    this._actor = actor;\n    this._end = angleRadians;\n    this._speed = speed;\n    this._rotationType = rotationType || RotationType.ShortestPath;\n  }\n\n  public update(_delta: number): void {\n    if (!this._started) {\n      this._started = true;\n      this._start = this._actor.rotation;\n      var distance1 = Math.abs(this._end - this._start);\n      var distance2 = Util.TwoPI - distance1;\n      if (distance1 > distance2) {\n        this._shortDistance = distance2;\n        this._longDistance = distance1;\n      } else {\n        this._shortDistance = distance1;\n        this._longDistance = distance2;\n      }\n\n      this._shortestPathIsPositive = (this._start - this._end + Util.TwoPI) % Util.TwoPI >= Math.PI;\n\n      switch (this._rotationType) {\n        case RotationType.ShortestPath:\n          this._distance = this._shortDistance;\n          if (this._shortestPathIsPositive) {\n            this._direction = 1;\n          } else {\n            this._direction = -1;\n          }\n          break;\n        case RotationType.LongestPath:\n          this._distance = this._longDistance;\n          if (this._shortestPathIsPositive) {\n            this._direction = -1;\n          } else {\n            this._direction = 1;\n          }\n          break;\n        case RotationType.Clockwise:\n          this._direction = 1;\n          if (this._shortestPathIsPositive) {\n            this._distance = this._shortDistance;\n          } else {\n            this._distance = this._longDistance;\n          }\n          break;\n        case RotationType.CounterClockwise:\n          this._direction = -1;\n          if (!this._shortestPathIsPositive) {\n            this._distance = this._shortDistance;\n          } else {\n            this._distance = this._longDistance;\n          }\n          break;\n      }\n    }\n\n    this._actor.rx = this._direction * this._speed;\n\n    if (this.isComplete()) {\n      this._actor.rotation = this._end;\n      this._actor.rx = 0;\n      this._stopped = true;\n    }\n  }\n\n  public isComplete(): boolean {\n    var distanceTravelled = Math.abs(this._actor.rotation - this._start);\n    return this._stopped || distanceTravelled >= Math.abs(this._distance);\n  }\n\n  public stop(): void {\n    this._actor.rx = 0;\n    this._stopped = true;\n  }\n\n  public reset(): void {\n    this._started = false;\n  }\n}\n\nexport class RotateBy implements IAction {\n  private _actor: Actor;\n  public x: number;\n  public y: number;\n  private _start: number;\n  private _end: number;\n  private _speed: number;\n  private _time: number;\n  private _rotationType: RotationType;\n  private _direction: number;\n  private _distance: number;\n  private _shortDistance: number;\n  private _longDistance: number;\n  private _shortestPathIsPositive: boolean;\n  private _started = false;\n  private _stopped = false;\n  constructor(actor: Actor, angleRadians: number, time: number, rotationType?: RotationType) {\n    this._actor = actor;\n    this._end = angleRadians;\n    this._time = time;\n    this._rotationType = rotationType || RotationType.ShortestPath;\n  }\n\n  public update(_delta: number): void {\n    if (!this._started) {\n      this._started = true;\n      this._start = this._actor.rotation;\n      var distance1 = Math.abs(this._end - this._start);\n      var distance2 = Util.TwoPI - distance1;\n      if (distance1 > distance2) {\n        this._shortDistance = distance2;\n        this._longDistance = distance1;\n      } else {\n        this._shortDistance = distance1;\n        this._longDistance = distance2;\n      }\n\n      this._shortestPathIsPositive = (this._start - this._end + Util.TwoPI) % Util.TwoPI >= Math.PI;\n\n      switch (this._rotationType) {\n        case RotationType.ShortestPath:\n          this._distance = this._shortDistance;\n          if (this._shortestPathIsPositive) {\n            this._direction = 1;\n          } else {\n            this._direction = -1;\n          }\n          break;\n        case RotationType.LongestPath:\n          this._distance = this._longDistance;\n          if (this._shortestPathIsPositive) {\n            this._direction = -1;\n          } else {\n            this._direction = 1;\n          }\n          break;\n        case RotationType.Clockwise:\n          this._direction = 1;\n          if (this._shortDistance >= 0) {\n            this._distance = this._shortDistance;\n          } else {\n            this._distance = this._longDistance;\n          }\n          break;\n        case RotationType.CounterClockwise:\n          this._direction = -1;\n          if (this._shortDistance <= 0) {\n            this._distance = this._shortDistance;\n          } else {\n            this._distance = this._longDistance;\n          }\n          break;\n      }\n      this._speed = Math.abs((this._distance / this._time) * 1000);\n    }\n\n    this._actor.rx = this._direction * this._speed;\n\n    if (this.isComplete()) {\n      this._actor.rotation = this._end;\n      this._actor.rx = 0;\n      this._stopped = true;\n    }\n  }\n\n  public isComplete(): boolean {\n    var distanceTravelled = Math.abs(this._actor.rotation - this._start);\n    return this._stopped || distanceTravelled >= Math.abs(this._distance);\n  }\n\n  public stop(): void {\n    this._actor.rx = 0;\n    this._stopped = true;\n  }\n\n  public reset(): void {\n    this._started = false;\n  }\n}\n\nexport class ScaleTo implements IAction {\n  private _actor: Actor;\n  public x: number;\n  public y: number;\n  private _startX: number;\n  private _startY: number;\n  private _endX: number;\n  private _endY: number;\n  private _speedX: number;\n  private _speedY: number;\n  private _distanceX: number;\n  private _distanceY: number;\n  private _started = false;\n  private _stopped = false;\n  constructor(actor: Actor, scaleX: number, scaleY: number, speedX: number, speedY: number) {\n    this._actor = actor;\n    this._endX = scaleX;\n    this._endY = scaleY;\n    this._speedX = speedX;\n    this._speedY = speedY;\n  }\n\n  public update(_delta: number): void {\n    if (!this._started) {\n      this._started = true;\n      this._startX = this._actor.scale.x;\n      this._startY = this._actor.scale.y;\n      this._distanceX = Math.abs(this._endX - this._startX);\n      this._distanceY = Math.abs(this._endY - this._startY);\n    }\n\n    if (!(Math.abs(this._actor.scale.x - this._startX) >= this._distanceX)) {\n      var directionX = this._endY < this._startY ? -1 : 1;\n      this._actor.sx = this._speedX * directionX;\n    } else {\n      this._actor.sx = 0;\n    }\n\n    if (!(Math.abs(this._actor.scale.y - this._startY) >= this._distanceY)) {\n      var directionY = this._endY < this._startY ? -1 : 1;\n      this._actor.sy = this._speedY * directionY;\n    } else {\n      this._actor.sy = 0;\n    }\n\n    if (this.isComplete()) {\n      this._actor.scale.x = this._endX;\n      this._actor.scale.y = this._endY;\n      this._actor.sx = 0;\n      this._actor.sy = 0;\n    }\n  }\n\n  public isComplete(): boolean {\n    return (\n      this._stopped ||\n      (Math.abs(this._actor.scale.y - this._startX) >= this._distanceX && Math.abs(this._actor.scale.y - this._startY) >= this._distanceY)\n    );\n  }\n\n  public stop(): void {\n    this._actor.sx = 0;\n    this._actor.sy = 0;\n    this._stopped = true;\n  }\n\n  public reset(): void {\n    this._started = false;\n  }\n}\n\nexport class ScaleBy implements IAction {\n  private _actor: Actor;\n  public x: number;\n  public y: number;\n  private _startX: number;\n  private _startY: number;\n  private _endX: number;\n  private _endY: number;\n  private _distanceX: number;\n  private _distanceY: number;\n  private _started = false;\n  private _stopped = false;\n  private _speedX: number;\n  private _speedY: number;\n  constructor(actor: Actor, scaleX: number, scaleY: number, time: number) {\n    this._actor = actor;\n    this._endX = scaleX;\n    this._endY = scaleY;\n    this._speedX = ((this._endX - this._actor.scale.x) / time) * 1000;\n    this._speedY = ((this._endY - this._actor.scale.y) / time) * 1000;\n  }\n\n  public update(_delta: number): void {\n    if (!this._started) {\n      this._started = true;\n      this._startX = this._actor.scale.x;\n      this._startY = this._actor.scale.y;\n      this._distanceX = Math.abs(this._endX - this._startX);\n      this._distanceY = Math.abs(this._endY - this._startY);\n    }\n    var directionX = this._endX < this._startX ? -1 : 1;\n    var directionY = this._endY < this._startY ? -1 : 1;\n    this._actor.sx = this._speedX * directionX;\n    this._actor.sy = this._speedY * directionY;\n\n    if (this.isComplete()) {\n      this._actor.scale.x = this._endX;\n      this._actor.scale.y = this._endY;\n      this._actor.sx = 0;\n      this._actor.sy = 0;\n    }\n  }\n\n  public isComplete(): boolean {\n    return (\n      this._stopped ||\n      (Math.abs(this._actor.scale.x - this._startX) >= this._distanceX && Math.abs(this._actor.scale.y - this._startY) >= this._distanceY)\n    );\n  }\n\n  public stop(): void {\n    this._actor.sx = 0;\n    this._actor.sy = 0;\n    this._stopped = true;\n  }\n\n  public reset(): void {\n    this._started = false;\n  }\n}\n\nexport class Delay implements IAction {\n  public x: number;\n  public y: number;\n  private _actor: Actor;\n  private _elapsedTime: number = 0;\n  private _delay: number;\n  private _started: boolean = false;\n  private _stopped = false;\n  constructor(actor: Actor, delay: number) {\n    this._actor = actor;\n    this._delay = delay;\n  }\n\n  public update(delta: number): void {\n    if (!this._started) {\n      this._started = true;\n    }\n\n    this.x = this._actor.pos.x;\n    this.y = this._actor.pos.y;\n\n    this._elapsedTime += delta;\n  }\n\n  isComplete(): boolean {\n    return this._stopped || this._elapsedTime >= this._delay;\n  }\n\n  public stop(): void {\n    this._stopped = true;\n  }\n\n  reset(): void {\n    this._elapsedTime = 0;\n    this._started = false;\n  }\n}\n\nexport class Blink implements IAction {\n  private _timeVisible: number = 0;\n  private _timeNotVisible: number = 0;\n  private _elapsedTime: number = 0;\n  private _totalTime: number = 0;\n  private _actor: Actor;\n  private _duration: number;\n  private _stopped: boolean = false;\n  private _started: boolean = false;\n  constructor(actor: Actor, timeVisible: number, timeNotVisible: number, numBlinks: number = 1) {\n    this._actor = actor;\n    this._timeVisible = timeVisible;\n    this._timeNotVisible = timeNotVisible;\n    this._duration = (timeVisible + timeNotVisible) * numBlinks;\n  }\n\n  public update(delta: number): void {\n    if (!this._started) {\n      this._started = true;\n    }\n\n    this._elapsedTime += delta;\n    this._totalTime += delta;\n    if (this._actor.visible && this._elapsedTime >= this._timeVisible) {\n      this._actor.visible = false;\n      this._elapsedTime = 0;\n    }\n\n    if (!this._actor.visible && this._elapsedTime >= this._timeNotVisible) {\n      this._actor.visible = true;\n      this._elapsedTime = 0;\n    }\n\n    if (this.isComplete()) {\n      this._actor.visible = true;\n    }\n  }\n\n  public isComplete(): boolean {\n    return this._stopped || this._totalTime >= this._duration;\n  }\n\n  public stop(): void {\n    this._actor.visible = true;\n    this._stopped = true;\n  }\n\n  public reset() {\n    this._started = false;\n    this._elapsedTime = 0;\n    this._totalTime = 0;\n  }\n}\n\nexport class Fade implements IAction {\n  public x: number;\n  public y: number;\n\n  private _actor: Actor;\n  private _endOpacity: number;\n  private _speed: number;\n  private _multiplier: number = 1;\n  private _started = false;\n  private _stopped = false;\n\n  constructor(actor: Actor, endOpacity: number, speed: number) {\n    this._actor = actor;\n    this._endOpacity = endOpacity;\n    this._speed = speed;\n  }\n\n  public update(delta: number): void {\n    if (!this._started) {\n      this._started = true;\n\n      // determine direction when we start\n      if (this._endOpacity < this._actor.opacity) {\n        this._multiplier = -1;\n      } else {\n        this._multiplier = 1;\n      }\n    }\n\n    if (this._speed > 0) {\n      this._actor.opacity += (this._multiplier * (Math.abs(this._actor.opacity - this._endOpacity) * delta)) / this._speed;\n    }\n\n    this._speed -= delta;\n\n    if (this.isComplete()) {\n      this._actor.opacity = this._endOpacity;\n    }\n\n    Logger.getInstance().debug('[Action fade] Actor opacity:', this._actor.opacity);\n  }\n\n  public isComplete(): boolean {\n    return this._stopped || Math.abs(this._actor.opacity - this._endOpacity) < 0.05;\n  }\n\n  public stop(): void {\n    this._stopped = true;\n  }\n\n  public reset(): void {\n    this._started = false;\n  }\n}\n\nexport class Die implements IAction {\n  public x: number;\n  public y: number;\n\n  private _actor: Actor;\n  private _stopped = false;\n\n  constructor(actor: Actor) {\n    this._actor = actor;\n  }\n\n  public update(_delta: number): void {\n    this._actor.actionQueue.clearActions();\n    this._actor.kill();\n    this._stopped = true;\n  }\n\n  public isComplete(): boolean {\n    return this._stopped;\n  }\n\n  public stop(): void {\n    return;\n  }\n\n  public reset(): void {\n    return;\n  }\n}\n\nexport class CallMethod implements IAction {\n  public x: number;\n  public y: number;\n  private _method: () => any = null;\n  private _actor: Actor = null;\n  private _hasBeenCalled: boolean = false;\n  constructor(actor: Actor, method: () => any) {\n    this._actor = actor;\n    this._method = method;\n  }\n\n  public update(_delta: number) {\n    this._method.call(this._actor);\n    this._hasBeenCalled = true;\n  }\n  public isComplete() {\n    return this._hasBeenCalled;\n  }\n  public reset() {\n    this._hasBeenCalled = false;\n  }\n  public stop() {\n    this._hasBeenCalled = true;\n  }\n}\n\nexport class Repeat implements IAction {\n  public x: number;\n  public y: number;\n  private _actor: Actor;\n  private _actionQueue: ActionQueue;\n  private _repeat: number;\n  private _originalRepeat: number;\n  private _stopped: boolean = false;\n  constructor(actor: Actor, repeat: number, actions: IAction[]) {\n    this._actor = actor;\n    this._actionQueue = new ActionQueue(actor);\n    this._repeat = repeat;\n    this._originalRepeat = repeat;\n\n    var i = 0,\n      len = actions.length;\n    for (i; i < len; i++) {\n      actions[i].reset();\n      this._actionQueue.add(actions[i]);\n    }\n  }\n\n  public update(delta: number): void {\n    this.x = this._actor.pos.x;\n    this.y = this._actor.pos.y;\n    if (!this._actionQueue.hasNext()) {\n      this._actionQueue.reset();\n      this._repeat--;\n    }\n    this._actionQueue.update(delta);\n  }\n\n  public isComplete(): boolean {\n    return this._stopped || this._repeat <= 0;\n  }\n\n  public stop(): void {\n    this._stopped = true;\n  }\n\n  public reset(): void {\n    this._repeat = this._originalRepeat;\n  }\n}\n\nexport class RepeatForever implements IAction {\n  public x: number;\n  public y: number;\n  private _actor: Actor;\n  private _actionQueue: ActionQueue;\n  private _stopped: boolean = false;\n  constructor(actor: Actor, actions: IAction[]) {\n    this._actor = actor;\n    this._actionQueue = new ActionQueue(actor);\n\n    var i = 0,\n      len = actions.length;\n    for (i; i < len; i++) {\n      actions[i].reset();\n      this._actionQueue.add(actions[i]);\n    }\n  }\n\n  public update(delta: number): void {\n    this.x = this._actor.pos.x;\n    this.y = this._actor.pos.y;\n    if (this._stopped) {\n      return;\n    }\n\n    if (!this._actionQueue.hasNext()) {\n      this._actionQueue.reset();\n    }\n\n    this._actionQueue.update(delta);\n  }\n\n  public isComplete(): boolean {\n    return this._stopped;\n  }\n\n  public stop(): void {\n    this._stopped = true;\n    this._actionQueue.clearActions();\n  }\n\n  public reset(): void {\n    return;\n  }\n}\n\n/**\n * Action Queues\n *\n * Action queues are part of the [[ActionContext|Action API]] and\n * store the list of actions to be executed for an [[Actor]].\n *\n * Actors implement [[Actor.actions]] which can be manipulated by\n * advanced users to adjust the actions currently being executed in the\n * queue.\n */\nexport class ActionQueue {\n  private _actor: Actor;\n  private _actions: IAction[] = [];\n  private _currentAction: IAction;\n  private _completedActions: IAction[] = [];\n  constructor(actor: Actor) {\n    this._actor = actor;\n  }\n\n  public add(action: IAction) {\n    this._actions.push(action);\n  }\n\n  public remove(action: IAction) {\n    var index = this._actions.indexOf(action);\n    this._actions.splice(index, 1);\n  }\n\n  public clearActions(): void {\n    this._actions.length = 0;\n    this._completedActions.length = 0;\n    if (this._currentAction) {\n      this._currentAction.stop();\n    }\n  }\n\n  public getActions(): IAction[] {\n    return this._actions.concat(this._completedActions);\n  }\n\n  public hasNext(): boolean {\n    return this._actions.length > 0;\n  }\n\n  public reset(): void {\n    this._actions = this.getActions();\n\n    var i = 0,\n      len = this._actions.length;\n    for (i; i < len; i++) {\n      this._actions[i].reset();\n    }\n    this._completedActions = [];\n  }\n\n  public update(delta: number) {\n    if (this._actions.length > 0) {\n      this._currentAction = this._actions[0];\n      this._currentAction.update(delta);\n\n      if (this._currentAction.isComplete(this._actor)) {\n        this._completedActions.push(this._actions.shift());\n      }\n    }\n  }\n}\n","import * as Actions from './Action';\nimport { RotationType } from './RotationType';\n\nimport { Actor } from '../Actor';\nimport { Promise } from '../Promises';\nimport { EasingFunction, EasingFunctions } from '../Util/EasingFunctions';\n\n/**\n * The fluent Action API allows you to perform \"actions\" on\n * [[Actor|Actors]] such as following, moving, rotating, and\n * more. You can implement your own actions by implementing\n * the [[IAction]] interface.\n *\n * [[include:Actions.md]]\n */\nexport class ActionContext {\n  private _actors: Actor[] = [];\n  private _queues: Actions.ActionQueue[] = [];\n\n  constructor();\n  constructor(actor: Actor);\n  constructor(actors: Actor[]);\n  constructor() {\n    if (arguments !== null) {\n      this._actors = Array.prototype.slice.call(arguments, 0);\n      this._queues = this._actors.map((a) => {\n        return a.actionQueue;\n      });\n    }\n  }\n\n  /**\n   * Clears all queued actions from the Actor\n   */\n  public clearActions(): void {\n    var i = 0,\n      len = this._queues.length;\n    for (i; i < len; i++) {\n      this._queues[i].clearActions();\n    }\n  }\n\n  public addActorToContext(actor: Actor) {\n    this._actors.push(actor);\n    // if we run into problems replace the line below with:\n    this._queues.push(actor.actionQueue);\n  }\n\n  public removeActorFromContext(actor: Actor) {\n    var index = this._actors.indexOf(actor);\n    if (index > -1) {\n      this._actors.splice(index, 1);\n      this._queues.splice(index, 1);\n    }\n  }\n\n  /**\n   * This method will move an actor to the specified `x` and `y` position over the\n   * specified duration using a given [[EasingFunctions]] and return back the actor. This\n   * method is part of the actor 'Action' fluent API allowing action chaining.\n   * @param x         The x location to move the actor to\n   * @param y         The y location to move the actor to\n   * @param duration  The time it should take the actor to move to the new location in milliseconds\n   * @param easingFcn Use [[EasingFunctions]] or a custom function to use to calculate position\n   */\n  public easeTo(x: number, y: number, duration: number, easingFcn: EasingFunction = EasingFunctions.Linear) {\n    var i = 0,\n      len = this._queues.length;\n\n    for (i; i < len; i++) {\n      this._queues[i].add(new Actions.EaseTo(this._actors[i], x, y, duration, easingFcn));\n    }\n\n    return this;\n  }\n\n  /**\n   * This method will move an actor to the specified x and y position at the\n   * speed specified (in pixels per second) and return back the actor. This\n   * method is part of the actor 'Action' fluent API allowing action chaining.\n   * @param x      The x location to move the actor to\n   * @param y      The y location to move the actor to\n   * @param speed  The speed in pixels per second to move\n   */\n  public moveTo(x: number, y: number, speed: number): ActionContext {\n    var i = 0,\n      len = this._queues.length;\n    for (i; i < len; i++) {\n      this._queues[i].add(new Actions.MoveTo(this._actors[i], x, y, speed));\n    }\n\n    return this;\n  }\n\n  /**\n   * This method will move an actor to the specified x and y position by a\n   * certain time (in milliseconds). This method is part of the actor\n   * 'Action' fluent API allowing action chaining.\n   * @param x     The x location to move the actor to\n   * @param y     The y location to move the actor to\n   * @param time  The time it should take the actor to move to the new location in milliseconds\n   */\n  public moveBy(x: number, y: number, time: number): ActionContext {\n    var i = 0,\n      len = this._queues.length;\n    for (i; i < len; i++) {\n      this._queues[i].add(new Actions.MoveBy(this._actors[i], x, y, time));\n    }\n    return this;\n  }\n\n  /**\n   * This method will rotate an actor to the specified angle at the speed\n   * specified (in radians per second) and return back the actor. This\n   * method is part of the actor 'Action' fluent API allowing action chaining.\n   * @param angleRadians  The angle to rotate to in radians\n   * @param speed         The angular velocity of the rotation specified in radians per second\n   * @param rotationType  The [[RotationType]] to use for this rotation\n   */\n  public rotateTo(angleRadians: number, speed: number, rotationType?: RotationType): ActionContext {\n    var i = 0,\n      len = this._queues.length;\n    for (i; i < len; i++) {\n      this._queues[i].add(new Actions.RotateTo(this._actors[i], angleRadians, speed, rotationType));\n    }\n    return this;\n  }\n\n  /**\n   * This method will rotate an actor to the specified angle by a certain\n   * time (in milliseconds) and return back the actor. This method is part\n   * of the actor 'Action' fluent API allowing action chaining.\n   * @param angleRadians  The angle to rotate to in radians\n   * @param time          The time it should take the actor to complete the rotation in milliseconds\n   * @param rotationType  The [[RotationType]] to use for this rotation\n   */\n  public rotateBy(angleRadians: number, time: number, rotationType?: RotationType): ActionContext {\n    var i = 0,\n      len = this._queues.length;\n    for (i; i < len; i++) {\n      this._queues[i].add(new Actions.RotateBy(this._actors[i], angleRadians, time, rotationType));\n    }\n    return this;\n  }\n\n  /**\n   * This method will scale an actor to the specified size at the speed\n   * specified (in magnitude increase per second) and return back the\n   * actor. This method is part of the actor 'Action' fluent API allowing\n   * action chaining.\n   * @param sizeX   The scaling factor to apply on X axis\n   * @param sizeY   The scaling factor to apply on Y axis\n   * @param speedX  The speed of scaling specified in magnitude increase per second on X axis\n   * @param speedY  The speed of scaling specified in magnitude increase per second on Y axis\n   */\n  public scaleTo(sizeX: number, sizeY: number, speedX: number, speedY: number): ActionContext {\n    var i = 0,\n      len = this._queues.length;\n    for (i; i < len; i++) {\n      this._queues[i].add(new Actions.ScaleTo(this._actors[i], sizeX, sizeY, speedX, speedY));\n    }\n    return this;\n  }\n\n  /**\n   * This method will scale an actor to the specified size by a certain time\n   * (in milliseconds) and return back the actor. This method is part of the\n   * actor 'Action' fluent API allowing action chaining.\n   * @param sizeX   The scaling factor to apply on X axis\n   * @param sizeY   The scaling factor to apply on Y axis\n   * @param time    The time it should take to complete the scaling in milliseconds\n   */\n  public scaleBy(sizeX: number, sizeY: number, time: number): ActionContext {\n    var i = 0,\n      len = this._queues.length;\n    for (i; i < len; i++) {\n      this._queues[i].add(new Actions.ScaleBy(this._actors[i], sizeX, sizeY, time));\n    }\n    return this;\n  }\n\n  /**\n   * This method will cause an actor to blink (become visible and not\n   * visible). Optionally, you may specify the number of blinks. Specify the amount of time\n   * the actor should be visible per blink, and the amount of time not visible.\n   * This method is part of the actor 'Action' fluent API allowing action chaining.\n   * @param timeVisible     The amount of time to stay visible per blink in milliseconds\n   * @param timeNotVisible  The amount of time to stay not visible per blink in milliseconds\n   * @param numBlinks       The number of times to blink\n   */\n  public blink(timeVisible: number, timeNotVisible: number, numBlinks: number = 1): ActionContext {\n    var i = 0,\n      len = this._queues.length;\n    for (i; i < len; i++) {\n      this._queues[i].add(new Actions.Blink(this._actors[i], timeVisible, timeNotVisible, numBlinks));\n    }\n    return this;\n  }\n\n  /**\n   * This method will cause an actor's opacity to change from its current value\n   * to the provided value by a specified time (in milliseconds). This method is\n   * part of the actor 'Action' fluent API allowing action chaining.\n   * @param opacity  The ending opacity\n   * @param time     The time it should take to fade the actor (in milliseconds)\n   */\n  public fade(opacity: number, time: number): ActionContext {\n    var i = 0,\n      len = this._queues.length;\n    for (i; i < len; i++) {\n      this._queues[i].add(new Actions.Fade(this._actors[i], opacity, time));\n    }\n    return this;\n  }\n\n  /**\n   * This method will delay the next action from executing for a certain\n   * amount of time (in milliseconds). This method is part of the actor\n   * 'Action' fluent API allowing action chaining.\n   * @param time  The amount of time to delay the next action in the queue from executing in milliseconds\n   */\n  public delay(time: number): ActionContext {\n    var i = 0,\n      len = this._queues.length;\n    for (i; i < len; i++) {\n      this._queues[i].add(new Actions.Delay(this._actors[i], time));\n    }\n    return this;\n  }\n\n  /**\n   * This method will add an action to the queue that will remove the actor from the\n   * scene once it has completed its previous actions. Any actions on the\n   * action queue after this action will not be executed.\n   */\n  public die(): ActionContext {\n    var i = 0,\n      len = this._queues.length;\n    for (i; i < len; i++) {\n      this._queues[i].add(new Actions.Die(this._actors[i]));\n    }\n    return this;\n  }\n\n  /**\n   * This method allows you to call an arbitrary method as the next action in the\n   * action queue. This is useful if you want to execute code in after a specific\n   * action, i.e An actor arrives at a destination after traversing a path\n   */\n  public callMethod(method: () => any): ActionContext {\n    var i = 0,\n      len = this._queues.length;\n    for (i; i < len; i++) {\n      this._queues[i].add(new Actions.CallMethod(this._actors[i], method));\n    }\n    return this;\n  }\n\n  /**\n   * This method will cause the actor to repeat all of the previously\n   * called actions a certain number of times. If the number of repeats\n   * is not specified it will repeat forever. This method is part of\n   * the actor 'Action' fluent API allowing action chaining\n   * @param times  The number of times to repeat all the previous actions in the action queue. If nothing is specified the actions\n   * will repeat forever\n   */\n  public repeat(times?: number): ActionContext {\n    if (!times) {\n      this.repeatForever();\n      return this;\n    }\n    var i = 0,\n      len = this._queues.length;\n    for (i; i < len; i++) {\n      this._queues[i].add(new Actions.Repeat(this._actors[i], times, this._actors[i].actionQueue.getActions()));\n    }\n\n    return this;\n  }\n\n  /**\n   * This method will cause the actor to repeat all of the previously\n   * called actions forever. This method is part of the actor 'Action'\n   * fluent API allowing action chaining.\n   */\n  public repeatForever(): ActionContext {\n    var i = 0,\n      len = this._queues.length;\n    for (i; i < len; i++) {\n      this._queues[i].add(new Actions.RepeatForever(this._actors[i], this._actors[i].actionQueue.getActions()));\n    }\n    return this;\n  }\n\n  /**\n   * This method will cause the actor to follow another at a specified distance\n   * @param actor           The actor to follow\n   * @param followDistance  The distance to maintain when following, if not specified the actor will follow at the current distance.\n   */\n  public follow(actor: Actor, followDistance?: number): ActionContext {\n    var i = 0,\n      len = this._queues.length;\n    for (i; i < len; i++) {\n      if (followDistance === undefined) {\n        this._queues[i].add(new Actions.Follow(this._actors[i], actor));\n      } else {\n        this._queues[i].add(new Actions.Follow(this._actors[i], actor, followDistance));\n      }\n    }\n    return this;\n  }\n\n  /**\n   * This method will cause the actor to move towards another until they\n   * collide \"meet\" at a specified speed.\n   * @param actor  The actor to meet\n   * @param speed  The speed in pixels per second to move, if not specified it will match the speed of the other actor\n   */\n  public meet(actor: Actor, speed?: number): ActionContext {\n    var i = 0,\n      len = this._queues.length;\n    for (i; i < len; i++) {\n      if (speed === undefined) {\n        this._queues[i].add(new Actions.Meet(this._actors[i], actor));\n      } else {\n        this._queues[i].add(new Actions.Meet(this._actors[i], actor, speed));\n      }\n    }\n    return this;\n  }\n\n  /**\n   * Returns a promise that resolves when the current action queue up to now\n   * is finished.\n   */\n  public asPromise<T>(): Promise<T> {\n    var promises = this._queues.map((q, i) => {\n      var temp = new Promise<T>();\n      q.add(\n        new Actions.CallMethod(this._actors[i], () => {\n          temp.resolve();\n        })\n      );\n      return temp;\n    });\n    return Promise.join.apply(this, promises);\n  }\n}\n","export * from './ActionContext';\nexport * from './IActionable';\nexport * from './RotationType';\n\nimport * as actions from './Action';\nexport { actions as Actions };\n// legacy Internal.Actions namespace support\nexport var Internal = { Actions: actions };\n","/**\n * An enum that describes the strategies that rotation actions can use\n */\nexport enum RotationType {\n  /**\n   * Rotation via `ShortestPath` will use the smallest angle\n   * between the starting and ending points. This strategy is the default behavior.\n   */\n  ShortestPath = 0,\n  /**\n   * Rotation via `LongestPath` will use the largest angle\n   * between the starting and ending points.\n   */\n  LongestPath = 1,\n  /**\n   * Rotation via `Clockwise` will travel in a clockwise direction,\n   * regardless of the starting and ending points.\n   */\n  Clockwise = 2,\n  /**\n   * Rotation via `CounterClockwise` will travel in a counterclockwise direction,\n   * regardless of the starting and ending points.\n   */\n  CounterClockwise = 3\n}\n","import { Physics } from './Physics';\nimport { Class } from './Class';\nimport { BoundingBox } from './Collision/BoundingBox';\nimport { Texture } from './Resources/Texture';\nimport {\n  InitializeEvent,\n  KillEvent,\n  PreUpdateEvent,\n  PostUpdateEvent,\n  PreDrawEvent,\n  PostDrawEvent,\n  PreDebugDrawEvent,\n  PostDebugDrawEvent,\n  PostCollisionEvent,\n  PreCollisionEvent,\n  CollisionStartEvent,\n  CollisionEndEvent,\n  PostKillEvent,\n  PreKillEvent,\n  GameEvent,\n  ExitTriggerEvent,\n  EnterTriggerEvent,\n  EnterViewPortEvent,\n  ExitViewPortEvent\n} from './Events';\nimport { PointerEvent, WheelEvent, PointerDragEvent } from './Input/Pointer';\nimport { Engine } from './Engine';\nimport { Color } from './Drawing/Color';\nimport { Sprite } from './Drawing/Sprite';\nimport { IActorTrait } from './Interfaces/IActorTrait';\nimport { IDrawable } from './Interfaces/IDrawable';\nimport { ICanInitialize, ICanUpdate, ICanDraw, ICanBeKilled } from './Interfaces/LifecycleEvents';\nimport { Scene } from './Scene';\nimport { Logger } from './Util/Log';\nimport { ActionContext } from './Actions/ActionContext';\nimport { ActionQueue } from './Actions/Action';\nimport { Vector } from './Algebra';\nimport { ICollisionArea } from './Collision/ICollisionArea';\nimport { Body } from './Collision/Body';\nimport { Side } from './Collision/Side';\nimport { IEvented } from './Interfaces/IEvented';\nimport { IActionable } from './Actions/IActionable';\nimport { Configurable } from './Configurable';\nimport * as Traits from './Traits/Index';\nimport * as Effects from './Drawing/SpriteEffects';\nimport * as Util from './Util/Util';\nimport * as Events from './Events';\nimport { IPointerEvents } from './Interfaces/IPointerEvents';\n\nexport type PointerEventName =\n  | 'pointerdragstart'\n  | 'pointerdragend'\n  | 'pointerdragmove'\n  | 'pointerdragenter'\n  | 'pointerdragleave'\n  | 'pointermove'\n  | 'pointerenter'\n  | 'pointerleave'\n  | 'pointerup'\n  | 'pointerdown';\n\n/**\n * [[include:Constructors.md]]\n */\nexport interface IActorArgs extends Partial<ActorImpl> {\n  width?: number;\n  height?: number;\n  pos?: Vector;\n  vel?: Vector;\n  acc?: Vector;\n  rotation?: number;\n  rx?: number;\n  z?: number;\n  color?: Color;\n  visible?: boolean;\n  body?: Body;\n  collisionType?: CollisionType;\n}\n\nexport interface IActorDefaults {\n  anchor: Vector;\n}\n\n/**\n * @hidden\n */\n\nexport class ActorImpl extends Class implements IActionable, IEvented, IPointerEvents, ICanInitialize, ICanUpdate, ICanDraw, ICanBeKilled {\n  // #region Properties\n\n  /**\n   * Indicates the next id to be set\n   */\n  public static defaults: IActorDefaults = {\n    anchor: Vector.Half.clone()\n  };\n  /**\n   * Indicates the next id to be set\n   */\n  public static maxId = 0;\n  /**\n   * The unique identifier for the actor\n   */\n  public id: number = ActorImpl.maxId++;\n\n  /**\n   * The physics body the is associated with this actor. The body is the container for all physical properties, like position, velocity,\n   * acceleration, mass, inertia, etc.\n   */\n  public body: Body = new Body(this);\n\n  /**\n   * Gets the collision area shape to use for collision possible options are [CircleArea|circles], [PolygonArea|polygons], and\n   * [EdgeArea|edges].\n   */\n  public get collisionArea(): ICollisionArea {\n    return this.body.collisionArea;\n  }\n\n  /**\n   * Gets the collision area shape to use for collision possible options are [CircleArea|circles], [PolygonArea|polygons], and\n   * [EdgeArea|edges].\n   */\n  public set collisionArea(area: ICollisionArea) {\n    this.body.collisionArea = area;\n  }\n\n  /**\n   * Gets the x position of the actor relative to it's parent (if any)\n   */\n  public get x(): number {\n    return this.body.pos.x;\n  }\n\n  /**\n   * Sets the x position of the actor relative to it's parent (if any)\n   */\n  public set x(theX: number) {\n    this.body.pos.x = theX;\n  }\n\n  /**\n   * Gets the y position of the actor relative to it's parent (if any)\n   */\n  public get y(): number {\n    return this.body.pos.y;\n  }\n\n  /**\n   * Sets the y position of the actor relative to it's parent (if any)\n   */\n  public set y(theY: number) {\n    this.body.pos.y = theY;\n  }\n\n  /**\n   * Gets the position vector of the actor in pixels\n   */\n  public get pos(): Vector {\n    return this.body.pos;\n  }\n\n  /**\n   * Sets the position vector of the actor in pixels\n   */\n  public set pos(thePos: Vector) {\n    this.body.pos.setTo(thePos.x, thePos.y);\n  }\n\n  /**\n   * Gets the position vector of the actor from the last frame\n   */\n  public get oldPos(): Vector {\n    return this.body.oldPos;\n  }\n\n  /**\n   * Sets the position vector of the actor in the last frame\n   */\n  public set oldPos(thePos: Vector) {\n    this.body.oldPos.setTo(thePos.x, thePos.y);\n  }\n\n  /**\n   * Gets the velocity vector of the actor in pixels/sec\n   */\n  public get vel(): Vector {\n    return this.body.vel;\n  }\n\n  /**\n   * Sets the velocity vector of the actor in pixels/sec\n   */\n  public set vel(theVel: Vector) {\n    this.body.vel.setTo(theVel.x, theVel.y);\n  }\n\n  /**\n   * Gets the velocity vector of the actor from the last frame\n   */\n  public get oldVel(): Vector {\n    return this.body.oldVel;\n  }\n\n  /**\n   * Sets the velocity vector of the actor from the last frame\n   */\n  public set oldVel(theVel: Vector) {\n    this.body.oldVel.setTo(theVel.x, theVel.y);\n  }\n\n  /**\n   * Gets/sets the acceleration of the actor from the last frame. This does not include the global acc [[Physics.acc]].\n   */\n  public oldAcc: Vector = Vector.Zero.clone();\n\n  /**\n   * Gets the acceleration vector of the actor in pixels/second/second. An acceleration pointing down such as (0, 100) may be\n   * useful to simulate a gravitational effect.\n   */\n  public get acc(): Vector {\n    return this.body.acc;\n  }\n\n  /**\n   * Sets the acceleration vector of teh actor in pixels/second/second\n   */\n  public set acc(theAcc: Vector) {\n    this.body.acc.setTo(theAcc.x, theAcc.y);\n  }\n\n  /**\n   * Gets the rotation of the actor in radians. 1 radian = 180/PI Degrees.\n   */\n  public get rotation(): number {\n    return this.body.rotation;\n  }\n\n  /**\n   * Sets the rotation of the actor in radians. 1 radian = 180/PI Degrees.\n   */\n  public set rotation(theAngle: number) {\n    this.body.rotation = theAngle;\n  }\n\n  /**\n   * Gets the rotational velocity of the actor in radians/second\n   */\n  public get rx(): number {\n    return this.body.rx;\n  }\n\n  /**\n   * Sets the rotational velocity of the actor in radians/sec\n   */\n  public set rx(angularVelocity: number) {\n    this.body.rx = angularVelocity;\n  }\n\n  /**\n   * Gets the current torque applied to the actor. Torque can be thought of as rotational force\n   */\n  public get torque() {\n    return this.body.torque;\n  }\n\n  /**\n   * Sets the current torque applied to the actor. Torque can be thought of as rotational force\n   */\n  public set torque(theTorque: number) {\n    this.body.torque = theTorque;\n  }\n\n  /**\n   * Get the current mass of the actor, mass can be thought of as the resistance to acceleration.\n   */\n  public get mass() {\n    return this.body.mass;\n  }\n\n  /**\n   * Sets the mass of the actor, mass can be thought of as the resistance to acceleration.\n   */\n  public set mass(theMass: number) {\n    this.body.mass = theMass;\n  }\n\n  /**\n   * Gets the current moment of inertia, moi can be thought of as the resistance to rotation.\n   */\n  public get moi() {\n    return this.body.moi;\n  }\n\n  /**\n   * Sets the current moment of inertia, moi can be thought of as the resistance to rotation.\n   */\n  public set moi(theMoi: number) {\n    this.body.moi = theMoi;\n  }\n\n  /**\n   * Gets the coefficient of friction on this actor, this can be thought of as how sticky or slippery an object is.\n   */\n  public get friction() {\n    return this.body.friction;\n  }\n\n  /**\n   * Sets the coefficient of friction of this actor, this can ve thought of as how stick or slippery an object is.\n   */\n  public set friction(theFriction: number) {\n    this.body.friction = theFriction;\n  }\n\n  /**\n   * Gets the coefficient of restitution of this actor, represents the amount of energy preserved after collision. Think of this\n   * as bounciness.\n   */\n  public get restitution() {\n    return this.body.restitution;\n  }\n\n  /**\n   * Sets the coefficient of restitution of this actor, represents the amount of energy preserved after collision. Think of this\n   * as bounciness.\n   */\n  public set restitution(theRestitution: number) {\n    this.body.restitution = theRestitution;\n  }\n\n  /**\n   * The anchor to apply all actor related transformations like rotation,\n   * translation, and scaling. By default the anchor is in the center of\n   * the actor. By default it is set to the center of the actor (.5, .5)\n   *\n   * An anchor of (.5, .5) will ensure that drawings are centered.\n   *\n   * Use `anchor.setTo` to set the anchor to a different point using\n   * values between 0 and 1. For example, anchoring to the top-left would be\n   * `Actor.anchor.setTo(0, 0)` and top-right would be `Actor.anchor.setTo(0, 1)`.\n   */\n  public anchor: Vector;\n\n  private _height: number = 0;\n  private _width: number = 0;\n\n  /**\n   * The scale vector of the actor\n   */\n  public scale: Vector = Vector.One.clone();\n\n  /**\n   * The scale of the actor last frame\n   */\n  public oldScale: Vector = Vector.One.clone();\n\n  /**\n   * The x scalar velocity of the actor in scale/second\n   */\n  public sx: number = 0; //scale/sec\n  /**\n   * The y scalar velocity of the actor in scale/second\n   */\n  public sy: number = 0; //scale/sec\n\n  /**\n   * Indicates whether the actor is physically in the viewport\n   */\n  public isOffScreen: boolean = false;\n  /**\n   * The visibility of an actor\n   */\n  public visible: boolean = true;\n  /**\n   * The opacity of an actor. Passing in a color in the [[constructor]] will use the\n   * color's opacity.\n   */\n  public opacity: number = 1;\n  public previousOpacity: number = 1;\n\n  /**\n   * Direct access to the actor's [[ActionQueue]]. Useful if you are building custom actions.\n   */\n  public actionQueue: ActionQueue;\n\n  /**\n   * [[ActionContext|Action context]] of the actor. Useful for scripting actor behavior.\n   */\n  public actions: ActionContext;\n  /**\n   * Convenience reference to the global logger\n   */\n  public logger: Logger = Logger.getInstance();\n  /**\n   * The scene that the actor is in\n   */\n  public scene: Scene = null;\n  /**\n   * The parent of this actor\n   */\n  public parent: Actor = null;\n  // TODO: Replace this with the new actor collection once z-indexing is built\n  /**\n   * The children of this actor\n   */\n  public children: Actor[] = [];\n  /**\n   * Gets or sets the current collision type of this actor. By\n   * default it is ([[CollisionType.PreventCollision]]).\n   */\n  public collisionType: CollisionType = CollisionType.PreventCollision;\n  public collisionGroups: string[] = [];\n\n  /**\n   * Flag to be set when any property change would result in a geometry recalculation\n   * @internal\n   */\n  private _geometryDirty: boolean = false;\n\n  private _collisionHandlers: { [key: string]: { (actor: Actor): void }[] } = {};\n  private _isInitialized: boolean = false;\n  public frames: { [key: string]: IDrawable } = {};\n  private _effectsDirty: boolean = false;\n\n  /**\n   * Access to the current drawing for the actor, this can be\n   * an [[Animation]], [[Sprite]], or [[Polygon]].\n   * Set drawings with [[setDrawing]].\n   */\n  public currentDrawing: IDrawable = null;\n\n  /**\n   * Modify the current actor update pipeline.\n   */\n  public traits: IActorTrait[] = [];\n\n  /**\n   * Sets the color of the actor. A rectangle of this color will be\n   * drawn if no [[IDrawable]] is specified as the actors drawing.\n   *\n   * The default is `null` which prevents a rectangle from being drawn.\n   */\n  public get color(): Color {\n    return this._color;\n  }\n  public set color(v: Color) {\n    this._color = v.clone();\n  }\n  private _color: Color;\n\n  /**\n   * Whether or not to enable the [[CapturePointer]] trait that propagates\n   * pointer events to this actor\n   */\n  public enableCapturePointer: boolean = false;\n\n  /**\n   * Configuration for [[CapturePointer]] trait\n   */\n  public capturePointer: Traits.ICapturePointerConfig = {\n    captureMoveEvents: false,\n    captureDragEvents: false\n  };\n\n  private _zIndex: number = 0;\n  private _isKilled: boolean = false;\n  private _opacityFx = new Effects.Opacity(this.opacity);\n\n  // #endregion\n\n  /**\n   * @param x       The starting x coordinate of the actor\n   * @param y       The starting y coordinate of the actor\n   * @param width   The starting width of the actor\n   * @param height  The starting height of the actor\n   * @param color   The starting color of the actor. Leave null to draw a transparent actor. The opacity of the color will be used as the\n   * initial [[opacity]].\n   */\n  constructor(xOrConfig?: number | IActorArgs, y?: number, width?: number, height?: number, color?: Color) {\n    super();\n\n    if (xOrConfig && typeof xOrConfig === 'object') {\n      var config = xOrConfig;\n      xOrConfig = config.pos ? config.pos.x : config.x;\n      y = config.pos ? config.pos.y : config.y;\n      width = config.width;\n      height = config.height;\n    }\n\n    this.pos.x = <number>xOrConfig || 0;\n    this.pos.y = y || 0;\n    this._width = width || 0;\n    this._height = height || 0;\n    if (color) {\n      this.color = color;\n      // set default opacity of an actor to the color\n      this.opacity = color.a;\n    }\n\n    // Build default pipeline\n    //this.traits.push(new ex.Traits.EulerMovement());\n    // TODO: TileMaps should be converted to a collision area\n    this.traits.push(new Traits.TileMapCollisionDetection());\n    this.traits.push(new Traits.OffscreenCulling());\n    this.traits.push(new Traits.CapturePointer());\n\n    // Build the action queue\n    this.actionQueue = new ActionQueue(this);\n    this.actions = new ActionContext(this);\n\n    // initialize default options\n    this._initDefaults();\n\n    // Initialize default collision area to be box\n    this.body.useBoxCollision();\n  }\n\n  /**\n   * `onInitialize` is called before the first update of the actor. This method is meant to be\n   * overridden. This is where initialization of child actors should take place.\n   *\n   * Synonymous with the event handler `.on('initialize', (evt) => {...})`\n   */\n  public onInitialize(_engine: Engine): void {\n    // Override me\n  }\n\n  /**\n   * Gets whether the actor is Initialized\n   */\n  public get isInitialized(): boolean {\n    return this._isInitialized;\n  }\n\n  /**\n   * Initializes this actor and all it's child actors, meant to be called by the Scene before first update not by users of Excalibur.\n   *\n   * It is not recommended that internal excalibur methods be overriden, do so at your own risk.\n   *\n   * @internal\n   */\n  public _initialize(engine: Engine) {\n    if (!this.isInitialized) {\n      this.onInitialize(engine);\n      super.emit('initialize', new InitializeEvent(engine, this));\n      this._isInitialized = true;\n    }\n    for (var child of this.children) {\n      child._initialize(engine);\n    }\n  }\n\n  private _initDefaults() {\n    this.anchor = Actor.defaults.anchor.clone();\n  }\n\n  // #region Events\n\n  private _capturePointerEvents: PointerEventName[] = [\n    'pointerup',\n    'pointerdown',\n    'pointermove',\n    'pointerenter',\n    'pointerleave',\n    'pointerdragstart',\n    'pointerdragend',\n    'pointerdragmove',\n    'pointerdragenter',\n    'pointerdragleave'\n  ];\n\n  private _captureMoveEvents: PointerEventName[] = [\n    'pointermove',\n    'pointerenter',\n    'pointerleave',\n    'pointerdragmove',\n    'pointerdragenter',\n    'pointerdragleave'\n  ];\n\n  private _captureDragEvents: PointerEventName[] = [\n    'pointerdragstart',\n    'pointerdragend',\n    'pointerdragmove',\n    'pointerdragenter',\n    'pointerdragleave'\n  ];\n\n  private _checkForPointerOptIn(eventName: string) {\n    if (eventName) {\n      const normalized = <PointerEventName>eventName.toLowerCase();\n\n      if (this._capturePointerEvents.indexOf(normalized) !== -1) {\n        this.enableCapturePointer = true;\n\n        if (this._captureMoveEvents.indexOf(normalized) !== -1) {\n          this.capturePointer.captureMoveEvents = true;\n        }\n\n        if (this._captureDragEvents.indexOf(normalized) !== -1) {\n          this.capturePointer.captureDragEvents = true;\n        }\n      }\n    }\n  }\n\n  public on(eventName: Events.exittrigger, handler: (evt: ExitTriggerEvent) => void): void;\n  public on(eventName: Events.entertrigger, handler: (evt: EnterTriggerEvent) => void): void;\n  /**\n   * The **collisionstart** event is fired when a [[Body|physics body]], usually attached to an actor,\n   *  first starts colliding with another [[Body|body]], and will not fire again while in contact until\n   *  the the pair separates and collides again.\n   * Use cases for the **collisionstart** event may be detecting when an actor has touched a surface\n   * (like landing) or if a item has been touched and needs to be picked up.\n   */\n  public on(eventName: Events.collisionstart, handler: (event?: CollisionStartEvent) => void): void;\n  /**\n   * The **collisionend** event is fired when two [[Body|physics bodies]] are no longer in contact.\n   * This event will not fire again until another collision and separation.\n   *\n   * Use cases for the **collisionend** event might be to detect when an actor has left a surface\n   * (like jumping) or has left an area.\n   */\n  public on(eventName: Events.collisionend, handler: (event?: CollisionEndEvent) => void): void;\n  /**\n   * The **precollision** event is fired **every frame** where a collision pair is found and two\n   * bodies are intersecting.\n   *\n   * This event is useful for building in custom collision resolution logic in Passive-Passive or\n   * Active-Passive scenarios. For example in a breakout game you may want to tweak the angle of\n   * richochet of the ball depending on which side of the paddle you hit.\n   */\n  public on(eventName: Events.precollision, handler: (event?: PreCollisionEvent) => void): void;\n  /**\n   * The **postcollision** event is fired for **every frame** where collision resolution was performed.\n   * Collision resolution is when two bodies influence each other and cause a response like bouncing\n   * off one another. It is only possible to have *postcollision* event in Active-Active and Active-Fixed\n   * type collision pairs.\n   *\n   * Post collision would be useful if you need to know that collision resolution is happening or need to\n   * tweak the default resolution.\n   */\n  public on(eventName: Events.postcollision, handler: (event?: PostCollisionEvent) => void): void;\n  public on(eventName: Events.kill, handler: (event?: KillEvent) => void): void;\n  public on(eventName: Events.prekill, handler: (event?: PreKillEvent) => void): void;\n  public on(eventName: Events.postkill, handler: (event?: PostKillEvent) => void): void;\n  public on(eventName: Events.initialize, handler: (event?: InitializeEvent) => void): void;\n  public on(eventName: Events.preupdate, handler: (event?: PreUpdateEvent) => void): void;\n  public on(eventName: Events.postupdate, handler: (event?: PostUpdateEvent) => void): void;\n  public on(eventName: Events.predraw, handler: (event?: PreDrawEvent) => void): void;\n  public on(eventName: Events.postdraw, handler: (event?: PostDrawEvent) => void): void;\n  public on(eventName: Events.predebugdraw, handler: (event?: PreDebugDrawEvent) => void): void;\n  public on(eventName: Events.postdebugdraw, handler: (event?: PostDebugDrawEvent) => void): void;\n  public on(eventName: Events.pointerup, handler: (event?: PointerEvent) => void): void;\n  public on(eventName: Events.pointerdown, handler: (event?: PointerEvent) => void): void;\n  public on(eventName: Events.pointerenter, handler: (event?: PointerEvent) => void): void;\n  public on(eventName: Events.pointerleave, handler: (event?: PointerEvent) => void): void;\n  public on(eventName: Events.pointermove, handler: (event?: PointerEvent) => void): void;\n  public on(eventName: Events.pointercancel, handler: (event?: PointerEvent) => void): void;\n  public on(eventName: Events.pointerwheel, handler: (event?: WheelEvent) => void): void;\n  public on(eventName: Events.pointerdragstart, handler: (event?: PointerDragEvent) => void): void;\n  public on(eventName: Events.pointerdragend, handler: (event?: PointerDragEvent) => void): void;\n  public on(eventName: Events.pointerdragenter, handler: (event?: PointerDragEvent) => void): void;\n  public on(eventName: Events.pointerdragleave, handler: (event?: PointerDragEvent) => void): void;\n  public on(eventName: Events.pointerdragmove, handler: (event?: PointerDragEvent) => void): void;\n  public on(eventName: Events.enterviewport, handler: (event?: EnterViewPortEvent) => void): void;\n  public on(eventName: Events.exitviewport, handler: (event?: ExitViewPortEvent) => void): void;\n  public on(eventName: string, handler: (event?: GameEvent<any>) => void): void;\n  public on(eventName: string, handler: (event?: any) => void): void {\n    this._checkForPointerOptIn(eventName);\n    super.on(eventName, handler);\n  }\n\n  public once(eventName: Events.exittrigger, handler: (evt: ExitTriggerEvent) => void): void;\n  public once(eventName: Events.entertrigger, handler: (evt: EnterTriggerEvent) => void): void;\n  /**\n   * The **collisionstart** event is fired when a [[Body|physics body]], usually attached to an actor,\n   *  first starts colliding with another [[Body|body]], and will not fire again while in contact until\n   *  the the pair separates and collides again.\n   * Use cases for the **collisionstart** event may be detecting when an actor has touch a surface\n   * (like landing) or if a item has been touched and needs to be picked up.\n   */\n  public once(eventName: Events.collisionstart, handler: (event?: CollisionStartEvent) => void): void;\n  /**\n   * The **collisionend** event is fired when two [[Body|physics bodies]] are no longer in contact.\n   * This event will not fire again until another collision and separation.\n   *\n   * Use cases for the **collisionend** event might be to detect when an actor has left a surface\n   * (like jumping) or has left an area.\n   */\n  public once(eventName: Events.collisionend, handler: (event?: CollisionEndEvent) => void): void;\n  /**\n   * The **precollision** event is fired **every frame** where a collision pair is found and two\n   * bodies are intersecting.\n   *\n   * This event is useful for building in custom collision resolution logic in Passive-Passive or\n   * Active-Passive scenarios. For example in a breakout game you may want to tweak the angle of\n   * richochet of the ball depending on which side of the paddle you hit.\n   */\n  public once(eventName: Events.precollision, handler: (event?: PreCollisionEvent) => void): void;\n  /**\n   * The **postcollision** event is fired for **every frame** where collision resolution was performed.\n   * Collision resolution is when two bodies influence each other and cause a response like bouncing\n   * off one another. It is only possible to have *postcollision* event in Active-Active and Active-Fixed\n   * type collision pairs.\n   *\n   * Post collision would be useful if you need to know that collision resolution is happening or need to\n   * tweak the default resolution.\n   */\n  public once(eventName: Events.postcollision, handler: (event?: PostCollisionEvent) => void): void;\n  public once(eventName: Events.kill, handler: (event?: KillEvent) => void): void;\n  public once(eventName: Events.postkill, handler: (event?: PostKillEvent) => void): void;\n  public once(eventName: Events.prekill, handler: (event?: PreKillEvent) => void): void;\n  public once(eventName: Events.initialize, handler: (event?: InitializeEvent) => void): void;\n  public once(eventName: Events.preupdate, handler: (event?: PreUpdateEvent) => void): void;\n  public once(eventName: Events.postupdate, handler: (event?: PostUpdateEvent) => void): void;\n  public once(eventName: Events.predraw, handler: (event?: PreDrawEvent) => void): void;\n  public once(eventName: Events.postdraw, handler: (event?: PostDrawEvent) => void): void;\n  public once(eventName: Events.predebugdraw, handler: (event?: PreDebugDrawEvent) => void): void;\n  public once(eventName: Events.postdebugdraw, handler: (event?: PostDebugDrawEvent) => void): void;\n  public once(eventName: Events.pointerup, handler: (event?: PointerEvent) => void): void;\n  public once(eventName: Events.pointerdown, handler: (event?: PointerEvent) => void): void;\n  public once(eventName: Events.pointerenter, handler: (event?: PointerEvent) => void): void;\n  public once(eventName: Events.pointerleave, handler: (event?: PointerEvent) => void): void;\n  public once(eventName: Events.pointermove, handler: (event?: PointerEvent) => void): void;\n  public once(eventName: Events.pointercancel, handler: (event?: PointerEvent) => void): void;\n  public once(eventName: Events.pointerwheel, handler: (event?: WheelEvent) => void): void;\n  public once(eventName: Events.pointerdragstart, handler: (event?: PointerDragEvent) => void): void;\n  public once(eventName: Events.pointerdragend, handler: (event?: PointerDragEvent) => void): void;\n  public once(eventName: Events.pointerdragenter, handler: (event?: PointerDragEvent) => void): void;\n  public once(eventName: Events.pointerdragleave, handler: (event?: PointerDragEvent) => void): void;\n  public once(eventName: Events.pointerdragmove, handler: (event?: PointerDragEvent) => void): void;\n  public once(eventName: Events.enterviewport, handler: (event?: EnterViewPortEvent) => void): void;\n  public once(eventName: Events.exitviewport, handler: (event?: ExitViewPortEvent) => void): void;\n  public once(eventName: string, handler: (event?: GameEvent<any>) => void): void;\n  public once(eventName: string, handler: (event?: any) => void): void {\n    this._checkForPointerOptIn(eventName);\n    super.once(eventName, handler);\n  }\n\n  public off(eventName: Events.exittrigger, handler?: (evt: ExitTriggerEvent) => void): void;\n  public off(eventName: Events.entertrigger, handler?: (evt: EnterTriggerEvent) => void): void;\n  /**\n   * The **collisionstart** event is fired when a [[Body|physics body]], usually attached to an actor,\n   *  first starts colliding with another [[Body|body]], and will not fire again while in contact until\n   *  the the pair separates and collides again.\n   * Use cases for the **collisionstart** event may be detecting when an actor has touch a surface\n   * (like landing) or if a item has been touched and needs to be picked up.\n   */\n  public off(eventName: Events.collisionstart, handler?: (event?: CollisionStartEvent) => void): void;\n  /**\n   * The **collisionend** event is fired when two [[Body|physics bodies]] are no longer in contact.\n   * This event will not fire again until another collision and separation.\n   *\n   * Use cases for the **collisionend** event might be to detect when an actor has left a surface\n   * (like jumping) or has left an area.\n   */\n  public off(eventName: Events.collisionend, handler?: (event?: CollisionEndEvent) => void): void;\n  /**\n   * The **precollision** event is fired **every frame** where a collision pair is found and two\n   * bodies are intersecting.\n   *\n   * This event is useful for building in custom collision resolution logic in Passive-Passive or\n   * Active-Passive scenarios. For example in a breakout game you may want to tweak the angle of\n   * richochet of the ball depending on which side of the paddle you hit.\n   */\n  public off(eventName: Events.precollision, handler?: (event?: PreCollisionEvent) => void): void;\n  /**\n   * The **postcollision** event is fired for **every frame** where collision resolution was performed.\n   * Collision resolution is when two bodies influence each other and cause a response like bouncing\n   * off one another. It is only possible to have *postcollision* event in Active-Active and Active-Fixed\n   * type collision pairs.\n   *\n   * Post collision would be useful if you need to know that collision resolution is happening or need to\n   * tweak the default resolution.\n   */\n  public off(eventName: Events.postcollision, handler: (event?: PostCollisionEvent) => void): void;\n  public off(eventName: Events.pointerup, handler?: (event?: PointerEvent) => void): void;\n  public off(eventName: Events.pointerdown, handler?: (event?: PointerEvent) => void): void;\n  public off(eventName: Events.pointerenter, handler?: (event?: PointerEvent) => void): void;\n  public off(eventName: Events.pointerleave, handler?: (event?: PointerEvent) => void): void;\n  public off(eventName: Events.pointermove, handler?: (event?: PointerEvent) => void): void;\n  public off(eventName: Events.pointercancel, handler?: (event?: PointerEvent) => void): void;\n  public off(eventName: Events.pointerwheel, handler?: (event?: WheelEvent) => void): void;\n  public off(eventName: Events.pointerdragstart, handler?: (event?: PointerDragEvent) => void): void;\n  public off(eventName: Events.pointerdragend, handler?: (event?: PointerDragEvent) => void): void;\n  public off(eventName: Events.pointerdragenter, handler?: (event?: PointerDragEvent) => void): void;\n  public off(eventName: Events.pointerdragleave, handler?: (event?: PointerDragEvent) => void): void;\n  public off(eventName: Events.pointerdragmove, handler?: (event?: PointerDragEvent) => void): void;\n  public off(eventName: Events.prekill, handler?: (event?: PreKillEvent) => void): void;\n  public off(eventName: Events.postkill, handler?: (event?: PostKillEvent) => void): void;\n  public off(eventName: Events.initialize, handler?: (event?: Events.InitializeEvent) => void): void;\n  public off(eventName: Events.postupdate, handler?: (event?: Events.PostUpdateEvent) => void): void;\n  public off(eventName: Events.preupdate, handler?: (event?: Events.PreUpdateEvent) => void): void;\n  public off(eventName: Events.postdraw, handler?: (event?: Events.PostDrawEvent) => void): void;\n  public off(eventName: Events.predraw, handler?: (event?: Events.PreDrawEvent) => void): void;\n  public off(eventName: Events.enterviewport, handler?: (event?: EnterViewPortEvent) => void): void;\n  public off(eventName: Events.exitviewport, handler?: (event?: ExitViewPortEvent) => void): void;\n  public off(eventName: string, handler?: (event?: GameEvent<any>) => void): void;\n  public off(eventName: string, handler?: (event?: any) => void): void {\n    super.off(eventName, handler);\n  }\n\n  // #endregion\n\n  /**\n   * It is not recommended that internal excalibur methods be overriden, do so at your own risk.\n   *\n   * Internal _prekill handler for [[onPreKill]] lifecycle event\n   * @internal\n   */\n  public _prekill(_scene: Scene) {\n    super.emit('prekill', new PreKillEvent(this));\n    this.onPreKill(_scene);\n  }\n\n  /**\n   * Safe to override onPreKill lifecycle event handler. Synonymous with `.on('prekill', (evt) =>{...})`\n   *\n   * `onPreKill` is called directly before an actor is killed and removed from its current [[Scene]].\n   */\n  public onPreKill(_scene: Scene) {\n    // Override me\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overriden, do so at your own risk.\n   *\n   * Internal _prekill handler for [[onPostKill]] lifecycle event\n   * @internal\n   */\n  public _postkill(_scene: Scene) {\n    super.emit('postkill', new PostKillEvent(this));\n    this.onPostKill(_scene);\n  }\n\n  /**\n   * Safe to override onPostKill lifecycle event handler. Synonymous with `.on('postkill', (evt) => {...})`\n   *\n   * `onPostKill` is called directly after an actor is killed and remove from its current [[Scene]].\n   */\n  public onPostKill(_scene: Scene) {\n    // Override me\n  }\n\n  /**\n   * If the current actor is a member of the scene, this will remove\n   * it from the scene graph. It will no longer be drawn or updated.\n   */\n  public kill() {\n    if (this.scene) {\n      this._prekill(this.scene);\n      this.emit('kill', new KillEvent(this));\n      this._isKilled = true;\n      this.scene.remove(this);\n      this._postkill(this.scene);\n    } else {\n      this.logger.warn('Cannot kill actor, it was never added to the Scene');\n    }\n  }\n\n  /**\n   * If the current actor is killed, it will now not be killed.\n   */\n  public unkill() {\n    this._isKilled = false;\n  }\n\n  /**\n   * Indicates wether the actor has been killed.\n   */\n  public isKilled(): boolean {\n    return this._isKilled;\n  }\n\n  /**\n   * Adds a child actor to this actor. All movement of the child actor will be\n   * relative to the parent actor. Meaning if the parent moves the child will\n   * move with it.\n   * @param actor The child actor to add\n   */\n  public add(actor: Actor) {\n    actor.collisionType = CollisionType.PreventCollision;\n    if (Util.addItemToArray(actor, this.children)) {\n      actor.parent = this;\n    }\n  }\n  /**\n   * Removes a child actor from this actor.\n   * @param actor The child actor to remove\n   */\n  public remove(actor: Actor) {\n    if (Util.removeItemFromArray(actor, this.children)) {\n      actor.parent = null;\n    }\n  }\n  /**\n   * Sets the current drawing of the actor to the drawing corresponding to\n   * the key.\n   * @param key The key of the drawing\n   */\n  public setDrawing(key: string): void;\n  /**\n   * Sets the current drawing of the actor to the drawing corresponding to\n   * an `enum` key (e.g. `Animations.Left`)\n   * @param key The `enum` key of the drawing\n   */\n  public setDrawing(key: number): void;\n  public setDrawing(key: any): void {\n    key = key.toString();\n    if (this.currentDrawing !== this.frames[<string>key]) {\n      if (this.frames[key] != null) {\n        this.frames[key].reset();\n        this.currentDrawing = this.frames[key];\n      } else {\n        Logger.getInstance().error(`the specified drawing key ${key} does not exist`);\n      }\n    }\n  }\n\n  /**\n   * Adds a whole texture as the \"default\" drawing. Set a drawing using [[setDrawing]].\n   */\n  public addDrawing(texture: Texture): void;\n  /**\n   * Adds a whole sprite as the \"default\" drawing. Set a drawing using [[setDrawing]].\n   */\n  public addDrawing(sprite: Sprite): void;\n  /**\n   * Adds a drawing to the list of available drawings for an actor. Set a drawing using [[setDrawing]].\n   * @param key     The key to associate with a drawing for this actor\n   * @param drawing This can be an [[Animation]], [[Sprite]], or [[Polygon]].\n   */\n  public addDrawing(key: any, drawing: IDrawable): void;\n  public addDrawing(): void {\n    if (arguments.length === 2) {\n      this.frames[<string>arguments[0]] = arguments[1];\n      if (!this.currentDrawing) {\n        this.currentDrawing = arguments[1];\n      }\n      this._effectsDirty = true;\n    } else {\n      if (arguments[0] instanceof Sprite) {\n        this.addDrawing('default', arguments[0]);\n      }\n      if (arguments[0] instanceof Texture) {\n        this.addDrawing('default', arguments[0].asSprite());\n      }\n    }\n  }\n\n  public get z(): number {\n    return this.getZIndex();\n  }\n\n  public set z(newZ: number) {\n    this.setZIndex(newZ);\n  }\n\n  /**\n   * Gets the z-index of an actor. The z-index determines the relative order an actor is drawn in.\n   * Actors with a higher z-index are drawn on top of actors with a lower z-index\n   */\n  public getZIndex(): number {\n    return this._zIndex;\n  }\n\n  /**\n   * Sets the z-index of an actor and updates it in the drawing list for the scene.\n   * The z-index determines the relative order an actor is drawn in.\n   * Actors with a higher z-index are drawn on top of actors with a lower z-index\n   * @param newIndex new z-index to assign\n   */\n  public setZIndex(newIndex: number) {\n    this.scene.cleanupDrawTree(this);\n    this._zIndex = newIndex;\n    this.scene.updateDrawTree(this);\n  }\n\n  /**\n   * Adds an actor to a collision group. Actors with no named collision groups are\n   * considered to be in every collision group.\n   *\n   * Once in a collision group(s) actors will only collide with other actors in\n   * that group.\n   *\n   * @param name The name of the collision group\n   */\n  public addCollisionGroup(name: string) {\n    this.collisionGroups.push(name);\n  }\n  /**\n   * Removes an actor from a collision group.\n   * @param name The name of the collision group\n   */\n  public removeCollisionGroup(name: string) {\n    var index = this.collisionGroups.indexOf(name);\n    if (index !== -1) {\n      this.collisionGroups.splice(index, 1);\n    }\n  }\n\n  /**\n   * Get the center point of an actor\n   */\n  public getCenter(): Vector {\n    return new Vector(\n      this.pos.x + this.getWidth() / 2 - this.anchor.x * this.getWidth(),\n      this.pos.y + this.getHeight() / 2 - this.anchor.y * this.getHeight()\n    );\n  }\n  /**\n   * Gets the calculated width of an actor, factoring in scale\n   */\n  public getWidth() {\n    return this._width * this.getGlobalScale().x;\n  }\n  /**\n   * Sets the width of an actor, factoring in the current scale\n   */\n  public setWidth(width: number) {\n    this._width = width / this.scale.x;\n    this._geometryDirty = true;\n  }\n  /**\n   * Gets the calculated height of an actor, factoring in scale\n   */\n  public getHeight() {\n    return this._height * this.getGlobalScale().y;\n  }\n  /**\n   * Sets the height of an actor, factoring in the current scale\n   */\n  public setHeight(height: number) {\n    this._height = height / this.scale.y;\n    this._geometryDirty = true;\n  }\n  /**\n   * Gets the left edge of the actor\n   */\n  public getLeft() {\n    return this.getBounds().left;\n  }\n  /**\n   * Gets the right edge of the actor\n   */\n  public getRight() {\n    return this.getBounds().right;\n  }\n  /**\n   * Gets the top edge of the actor\n   */\n  public getTop() {\n    return this.getBounds().top;\n  }\n  /**\n   * Gets the bottom edge of the actor\n   */\n  public getBottom() {\n    return this.getBounds().bottom;\n  }\n\n  /**\n   * Gets this actor's rotation taking into account any parent relationships\n   *\n   * @returns Rotation angle in radians\n   */\n  public getWorldRotation(): number {\n    if (!this.parent) {\n      return this.rotation;\n    }\n\n    return this.rotation + this.parent.getWorldRotation();\n  }\n\n  /**\n   * Gets an actor's world position taking into account parent relationships, scaling, rotation, and translation\n   *\n   * @returns Position in world coordinates\n   */\n  public getWorldPos(): Vector {\n    if (!this.parent) {\n      return this.pos.clone();\n    }\n\n    // collect parents\n    var parents: Actor[] = [];\n    var root: Actor = this;\n\n    parents.push(this);\n\n    // find parents\n    while (root.parent) {\n      root = root.parent;\n      parents.push(root);\n    }\n\n    // calculate position\n    var x = parents.reduceRight((px, p) => {\n      if (p.parent) {\n        return px + p.pos.x * p.getGlobalScale().x;\n      }\n      return px + p.pos.x;\n    }, 0);\n\n    var y = parents.reduceRight((py, p) => {\n      if (p.parent) {\n        return py + p.pos.y * p.getGlobalScale().y;\n      }\n      return py + p.pos.y;\n    }, 0);\n\n    // rotate around root anchor\n    var ra = root.getWorldPos(); // 10, 10\n    var r = this.getWorldRotation();\n\n    return new Vector(x, y).rotate(r, ra);\n  }\n\n  /**\n   * Gets the global scale of the Actor\n   */\n  public getGlobalScale(): Vector {\n    if (!this.parent) {\n      return new Vector(this.scale.x, this.scale.y);\n    }\n\n    var parentScale = this.parent.getGlobalScale();\n    return new Vector(this.scale.x * parentScale.x, this.scale.y * parentScale.y);\n  }\n\n  // #region Collision\n\n  /**\n   * Returns the actor's [[BoundingBox]] calculated for this instant in world space.\n   */\n  public getBounds(rotated: boolean = true): BoundingBox {\n    // todo cache bounding box\n    const anchor = this._getCalculatedAnchor();\n    const pos = this.getWorldPos();\n\n    let bb = new BoundingBox(pos.x - anchor.x, pos.y - anchor.y, pos.x + this.getWidth() - anchor.x, pos.y + this.getHeight() - anchor.y);\n\n    return rotated ? bb.rotate(this.rotation, pos) : bb;\n  }\n\n  /**\n   * Returns the actor's [[BoundingBox]] relative to the actor's position.\n   */\n  public getRelativeBounds(rotated: boolean = true): BoundingBox {\n    // todo cache bounding box\n    const anchor = this._getCalculatedAnchor();\n    let bb = new BoundingBox(-anchor.x, -anchor.y, this.getWidth() - anchor.x, this.getHeight() - anchor.y);\n\n    return rotated ? bb.rotate(this.rotation) : bb;\n  }\n\n  /**\n   * Returns the actors unrotated geometry in world coordinates\n   */\n  public getGeometry(): Vector[] {\n    return this.getBounds(false).getPoints();\n  }\n\n  /**\n   * Return the actor's unrotated geometry relative to the actor's position\n   */\n  public getRelativeGeometry(): Vector[] {\n    return this.getRelativeBounds(false).getPoints();\n  }\n\n  /**\n   * Indicates that the actor's collision geometry needs to be recalculated for accurate collisions\n   */\n  public get isGeometryDirty() {\n    return this._geometryDirty;\n  }\n\n  /**\n   * Tests whether the x/y specified are contained in the actor\n   * @param x  X coordinate to test (in world coordinates)\n   * @param y  Y coordinate to test (in world coordinates)\n   * @param recurse checks whether the x/y are contained in any child actors (if they exist).\n   */\n  public contains(x: number, y: number, recurse: boolean = false): boolean {\n    var containment = this.getBounds().contains(new Vector(x, y));\n\n    if (recurse) {\n      return (\n        containment ||\n        this.children.some((child: Actor) => {\n          return child.contains(x, y, true);\n        })\n      );\n    }\n\n    return containment;\n  }\n\n  /**\n   * Returns the side of the collision based on the intersection\n   * @param intersect The displacement vector returned by a collision\n   */\n  public getSideFromIntersect(intersect: Vector) {\n    if (intersect) {\n      if (Math.abs(intersect.x) > Math.abs(intersect.y)) {\n        if (intersect.x < 0) {\n          return Side.Right;\n        }\n        return Side.Left;\n      } else {\n        if (intersect.y < 0) {\n          return Side.Bottom;\n        }\n        return Side.Top;\n      }\n    }\n    return Side.None;\n  }\n  /**\n   * Test whether the actor has collided with another actor, returns the side of the current actor that collided.\n   * @param actor The other actor to test\n   */\n  public collidesWithSide(actor: Actor): Side {\n    var separationVector = this.collides(actor);\n    if (!separationVector) {\n      return Side.None;\n    }\n    if (Math.abs(separationVector.x) > Math.abs(separationVector.y)) {\n      if (this.pos.x < actor.pos.x) {\n        return Side.Right;\n      } else {\n        return Side.Left;\n      }\n    } else {\n      if (this.pos.y < actor.pos.y) {\n        return Side.Bottom;\n      } else {\n        return Side.Top;\n      }\n    }\n  }\n  /**\n   * Test whether the actor has collided with another actor, returns the intersection vector on collision. Returns\n   * `null` when there is no collision;\n   * @param actor The other actor to test\n   */\n  public collides(actor: Actor): Vector {\n    var bounds = this.getBounds();\n    var otherBounds = actor.getBounds();\n    var intersect = bounds.collides(otherBounds);\n    return intersect;\n  }\n  /**\n   * Register a handler to fire when this actor collides with another in a specified group\n   * @param group The group name to listen for\n   * @param func The callback to fire on collision with another actor from the group. The callback is passed the other actor.\n   */\n  public onCollidesWith(group: string, func: (actor: Actor) => void) {\n    if (!this._collisionHandlers[group]) {\n      this._collisionHandlers[group] = [];\n    }\n    this._collisionHandlers[group].push(func);\n  }\n  public getCollisionHandlers(): { [key: string]: { (actor: Actor): void }[] } {\n    return this._collisionHandlers;\n  }\n  /**\n   * Removes all collision handlers for this group on this actor\n   * @param group Group to remove all handlers for on this actor.\n   */\n  public removeCollidesWith(group: string) {\n    this._collisionHandlers[group] = [];\n  }\n  /**\n   * Returns true if the two actors are less than or equal to the distance specified from each other\n   * @param actor     Actor to test\n   * @param distance  Distance in pixels to test\n   */\n  public within(actor: Actor, distance: number): boolean {\n    return Math.sqrt(Math.pow(this.pos.x - actor.pos.x, 2) + Math.pow(this.pos.y - actor.pos.y, 2)) <= distance;\n  }\n\n  // #endregion\n\n  private _getCalculatedAnchor(): Vector {\n    return new Vector(this.getWidth() * this.anchor.x, this.getHeight() * this.anchor.y);\n  }\n\n  protected _reapplyEffects(drawing: IDrawable) {\n    drawing.removeEffect(this._opacityFx);\n    drawing.addEffect(this._opacityFx);\n  }\n\n  // #region Update\n  /**\n   * Perform euler integration at the specified time step\n   */\n  public integrate(delta: number) {\n    // Update placements based on linear algebra\n    var seconds = delta / 1000;\n\n    var totalAcc = this.acc.clone();\n    // Only active vanilla actors are affected by global acceleration\n    if (this.collisionType === CollisionType.Active) {\n      totalAcc.addEqual(Physics.acc);\n    }\n\n    this.vel.addEqual(totalAcc.scale(seconds));\n    this.pos.addEqual(this.vel.scale(seconds)).addEqual(totalAcc.scale(0.5 * seconds * seconds));\n\n    this.rx += this.torque * (1.0 / this.moi) * seconds;\n    this.rotation += this.rx * seconds;\n\n    this.scale.x += (this.sx * delta) / 1000;\n    this.scale.y += (this.sy * delta) / 1000;\n\n    if (!this.scale.equals(this.oldScale)) {\n      // change in scale effects the geometry\n      this._geometryDirty = true;\n    }\n\n    // Update physics body\n    this.body.update();\n    this._geometryDirty = false;\n  }\n\n  /**\n   * Called by the Engine, updates the state of the actor\n   * @param engine The reference to the current game engine\n   * @param delta  The time elapsed since the last update in milliseconds\n   */\n  public update(engine: Engine, delta: number) {\n    this._initialize(engine);\n    this._preupdate(engine, delta);\n\n    // Update action queue\n    this.actionQueue.update(delta);\n\n    // Update color only opacity\n    if (this.color) {\n      this.color.a = this.opacity;\n    }\n\n    // calculate changing opacity\n    if (this.previousOpacity !== this.opacity) {\n      this.previousOpacity = this.opacity;\n      this._opacityFx.opacity = this.opacity;\n      this._effectsDirty = true;\n    }\n\n    // Capture old values before integration step updates them\n    this.oldVel.setTo(this.vel.x, this.vel.y);\n    this.oldPos.setTo(this.pos.x, this.pos.y);\n    this.oldAcc.setTo(this.acc.x, this.acc.y);\n    this.oldScale.setTo(this.scale.x, this.scale.y);\n\n    // Run Euler integration\n    this.integrate(delta);\n\n    // Update actor pipeline (movement, collision detection, event propagation, offscreen culling)\n    for (const trait of this.traits) {\n      trait.update(this, engine, delta);\n    }\n\n    // Update child actors\n    for (let i = 0; i < this.children.length; i++) {\n      this.children[i].update(engine, delta);\n    }\n\n    this._postupdate(engine, delta);\n  }\n\n  /**\n   * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n   *\n   * `onPreUpdate` is called directly before an actor is updated.\n   */\n  public onPreUpdate(_engine: Engine, _delta: number): void {\n    // Override me\n  }\n\n  /**\n   * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('postupdate', (evt) =>{...})`\n   *\n   * `onPostUpdate` is called directly after an actor is updated.\n   */\n  public onPostUpdate(_engine: Engine, _delta: number): void {\n    // Override me\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overriden, do so at your own risk.\n   *\n   * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\n   * @internal\n   */\n  public _preupdate(engine: Engine, delta: number): void {\n    this.emit('preupdate', new PreUpdateEvent(engine, delta, this));\n    this.onPreUpdate(engine, delta);\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overriden, do so at your own risk.\n   *\n   * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\n   * @internal\n   */\n  public _postupdate(engine: Engine, delta: number): void {\n    this.emit('postupdate', new PreUpdateEvent(engine, delta, this));\n    this.onPostUpdate(engine, delta);\n  }\n\n  // endregion\n\n  // #region Drawing\n  /**\n   * Called by the Engine, draws the actor to the screen\n   * @param ctx   The rendering context\n   * @param delta The time since the last draw in milliseconds\n   */\n  public draw(ctx: CanvasRenderingContext2D, delta: number) {\n    ctx.save();\n    ctx.translate(this.pos.x, this.pos.y);\n    ctx.rotate(this.rotation);\n    ctx.scale(this.scale.x, this.scale.y);\n\n    // translate canvas by anchor offset\n    ctx.save();\n    ctx.translate(-(this._width * this.anchor.x), -(this._height * this.anchor.y));\n\n    this._predraw(ctx, delta);\n\n    if (this.currentDrawing) {\n      var drawing = this.currentDrawing;\n      // See https://github.com/excaliburjs/Excalibur/pull/619 for discussion on this formula\n      var offsetX = (this._width - drawing.width * drawing.scale.x) * this.anchor.x;\n      var offsetY = (this._height - drawing.height * drawing.scale.y) * this.anchor.y;\n\n      if (this._effectsDirty) {\n        this._reapplyEffects(this.currentDrawing);\n        this._effectsDirty = false;\n      }\n\n      this.currentDrawing.draw(ctx, offsetX, offsetY);\n    } else {\n      if (this.color) {\n        ctx.fillStyle = this.color.toString();\n        ctx.fillRect(0, 0, this._width, this._height);\n      }\n    }\n    ctx.restore();\n\n    // Draw child actors\n    for (var i = 0; i < this.children.length; i++) {\n      if (this.children[i].visible) {\n        this.children[i].draw(ctx, delta);\n      }\n    }\n\n    this._postdraw(ctx, delta);\n    ctx.restore();\n  }\n\n  /**\n   * Safe to override onPreDraw lifecycle event handler. Synonymous with `.on('predraw', (evt) =>{...})`\n   *\n   * `onPreDraw` is called directly before an actor is drawn, but after local transforms are made.\n   */\n  public onPreDraw(_ctx: CanvasRenderingContext2D, _delta: number): void {\n    // Override me\n  }\n\n  /**\n   * Safe to override onPostDraw lifecycle event handler. Synonymous with `.on('postdraw', (evt) =>{...})`\n   *\n   * `onPostDraw` is called directly after an actor is drawn, and before local transforms are removed.\n   */\n  public onPostDraw(_ctx: CanvasRenderingContext2D, _delta: number): void {\n    // Override me\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overriden, do so at your own risk.\n   *\n   * Internal _predraw handler for [[onPreDraw]] lifecycle event\n   * @internal\n   */\n  public _predraw(ctx: CanvasRenderingContext2D, delta: number): void {\n    this.emit('predraw', new PreDrawEvent(ctx, delta, this));\n    this.onPreDraw(ctx, delta);\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overriden, do so at your own risk.\n   *\n   * Internal _postdraw handler for [[onPostDraw]] lifecycle event\n   * @internal\n   */\n  public _postdraw(ctx: CanvasRenderingContext2D, delta: number): void {\n    this.emit('postdraw', new PreDrawEvent(ctx, delta, this));\n    this.onPostDraw(ctx, delta);\n  }\n\n  /**\n   * Called by the Engine, draws the actors debugging to the screen\n   * @param ctx The rendering context\n   */\n  /* istanbul ignore next */\n  public debugDraw(ctx: CanvasRenderingContext2D) {\n    this.emit('predebugdraw', new PreDebugDrawEvent(ctx, this));\n\n    this.body.debugDraw(ctx);\n\n    // Draw actor bounding box\n    var bb = this.getBounds();\n    bb.debugDraw(ctx);\n\n    // Draw actor Id\n    ctx.fillText('id: ' + this.id, bb.left + 3, bb.top + 10);\n\n    // Draw actor anchor Vector\n    ctx.fillStyle = Color.Yellow.toString();\n    ctx.beginPath();\n    ctx.arc(this.getWorldPos().x, this.getWorldPos().y, 3, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.fill();\n\n    // Culling Box debug draw\n    for (var j = 0; j < this.traits.length; j++) {\n      if (this.traits[j] instanceof Traits.OffscreenCulling) {\n        (<Traits.OffscreenCulling>this.traits[j]).cullingBox.debugDraw(ctx);\n      }\n    }\n\n    // Unit Circle debug draw\n    ctx.strokeStyle = Color.Yellow.toString();\n    ctx.beginPath();\n    var radius = Math.min(this.getWidth(), this.getHeight());\n    ctx.arc(this.getWorldPos().x, this.getWorldPos().y, radius, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.stroke();\n    var ticks: { [key: string]: number } = {\n      '0 Pi': 0,\n      'Pi/2': Math.PI / 2,\n      Pi: Math.PI,\n      '3/2 Pi': (3 * Math.PI) / 2\n    };\n\n    var oldFont = ctx.font;\n    for (var tick in ticks) {\n      ctx.fillStyle = Color.Yellow.toString();\n      ctx.font = '14px';\n      ctx.textAlign = 'center';\n      ctx.fillText(\n        tick,\n        this.getWorldPos().x + Math.cos(ticks[tick]) * (radius + 10),\n        this.getWorldPos().y + Math.sin(ticks[tick]) * (radius + 10)\n      );\n    }\n\n    ctx.font = oldFont;\n\n    // Draw child actors\n    for (var i = 0; i < this.children.length; i++) {\n      this.children[i].debugDraw(ctx);\n    }\n\n    this.emit('postdebugdraw', new PostDebugDrawEvent(ctx, this));\n  }\n\n  /**\n   * Returns the full array of ancestors\n   */\n  public getAncestors(): Actor[] {\n    const path: Actor[] = [this];\n    let currentActor: Actor = this;\n    let parent: Actor;\n\n    while ((parent = currentActor.parent)) {\n      currentActor = parent;\n      path.push(currentActor);\n    }\n\n    return path.reverse();\n  }\n  // #endregion\n}\n\n/**\n * The most important primitive in Excalibur is an `Actor`. Anything that\n * can move on the screen, collide with another `Actor`, respond to events,\n * or interact with the current scene, must be an actor. An `Actor` **must**\n * be part of a [[Scene]] for it to be drawn to the screen.\n *\n * [[include:Actors.md]]\n *\n *\n * [[include:Constructors.md]]\n *\n */\nexport class Actor extends Configurable(ActorImpl) {\n  constructor();\n  constructor(config?: IActorArgs);\n  constructor(x?: number, y?: number, width?: number, height?: number, color?: Color);\n  constructor(xOrConfig?: number | IActorArgs, y?: number, width?: number, height?: number, color?: Color) {\n    super(xOrConfig, y, width, height, color);\n  }\n}\n\n/**\n * An enum that describes the types of collisions actors can participate in\n */\nexport enum CollisionType {\n  /**\n   * Actors with the `PreventCollision` setting do not participate in any\n   * collisions and do not raise collision events.\n   */\n  PreventCollision,\n  /**\n   * Actors with the `Passive` setting only raise collision events, but are not\n   * influenced or moved by other actors and do not influence or move other actors.\n   */\n  Passive,\n  /**\n   * Actors with the `Active` setting raise collision events and participate\n   * in collisions with other actors and will be push or moved by actors sharing\n   * the `Active` or `Fixed` setting.\n   */\n  Active,\n  /**\n   * Actors with the `Fixed` setting raise collision events and participate in\n   * collisions with other actors. Actors with the `Fixed` setting will not be\n   * pushed or moved by other actors sharing the `Fixed`. Think of Fixed\n   * actors as \"immovable/onstoppable\" objects. If two `Fixed` actors meet they will\n   * not be pushed or moved by each other, they will not interact except to throw\n   * collision events.\n   */\n  Fixed\n}\n","import { Engine } from './Engine';\nimport * as Util from './Util/Util';\n\n/**\n * A 2D vector on a plane.\n */\nexport class Vector {\n  /**\n   * A (0, 0) vector\n   */\n  public static Zero = new Vector(0, 0);\n\n  /**\n   * A (1, 1) vector\n   */\n  public static One = new Vector(1, 1);\n\n  /**\n   * A (0.5, 0.5) vector\n   */\n  public static Half = new Vector(0.5, 0.5);\n\n  /**\n   * A unit vector pointing up (0, -1)\n   */\n  public static Up = new Vector(0, -1);\n\n  /**\n   * A unit vector pointing down (0, 1)\n   */\n  public static Down = new Vector(0, 1);\n\n  /**\n   * A unit vector pointing left (-1, 0)\n   */\n  public static Left = new Vector(-1, 0);\n  /**\n   * A unit vector pointing right (1, 0)\n   */\n  public static Right = new Vector(1, 0);\n\n  /**\n   * Returns a vector of unit length in the direction of the specified angle in Radians.\n   * @param angle The angle to generate the vector\n   */\n  public static fromAngle(angle: number) {\n    return new Vector(Math.cos(angle), Math.sin(angle));\n  }\n\n  /**\n   * Checks if vector is not null, undefined, or if any of its components are NaN or Infinity.\n   */\n  public static isValid(vec: Vector) {\n    if (vec === null || vec === undefined) {\n      return false;\n    }\n    if (isNaN(vec.x) || isNaN(vec.y)) {\n      return false;\n    }\n\n    if (vec.x === Infinity || vec.y === Infinity || vec.x === -Infinity || vec.y === -Infinity) {\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Calculates distance between two Vectors\n   * @param vec1\n   * @param vec2\n   */\n  public static distance(vec1: Vector, vec2: Vector) {\n    return Math.sqrt(Math.pow(vec1.x - vec2.x, 2) + Math.pow(vec1.y - vec2.y, 2));\n  }\n\n  /**\n   * @param x  X component of the Vector\n   * @param y  Y component of the Vector\n   */\n  constructor(public x: number, public y: number) {}\n\n  /**\n   * Sets the x and y components at once\n   */\n  public setTo(x: number, y: number) {\n    this.x = x;\n    this.y = y;\n  }\n\n  /**\n   * Compares this point against another and tests for equality\n   * @param point  The other point to compare to\n   */\n  public equals(vector: Vector, tolerance: number = 0.001): boolean {\n    return Math.abs(this.x - vector.x) <= tolerance && Math.abs(this.y - vector.y) <= tolerance;\n  }\n\n  /**\n   * The distance to another vector. If no other Vector is specified, this will return the [[magnitude]].\n   * @param v  The other vector. Leave blank to use origin vector.\n   */\n  public distance(v?: Vector): number {\n    if (!v) {\n      v = Vector.Zero;\n    }\n    return Math.sqrt(Math.pow(this.x - v.x, 2) + Math.pow(this.y - v.y, 2));\n  }\n\n  /**\n   * The magnitude (size) of the Vector\n   */\n  public magnitude(): number {\n    return this.distance();\n  }\n\n  /**\n   * Normalizes a vector to have a magnitude of 1.\n   */\n  public normalize(): Vector {\n    var d = this.distance();\n    if (d > 0) {\n      return new Vector(this.x / d, this.y / d);\n    } else {\n      return new Vector(0, 1);\n    }\n  }\n\n  /**\n   * Returns the average (midpoint) between the current point and the specified\n   */\n  public average(vec: Vector): Vector {\n    return this.add(vec).scale(0.5);\n  }\n\n  /**\n   * Scales a vector's by a factor of size\n   * @param size  The factor to scale the magnitude by\n   */\n  public scale(size: number): Vector {\n    return new Vector(this.x * size, this.y * size);\n  }\n\n  /**\n   * Adds one vector to another\n   * @param v The vector to add\n   */\n  public add(v: Vector): Vector {\n    return new Vector(this.x + v.x, this.y + v.y);\n  }\n\n  /**\n   * Subtracts a vector from another, if you subract vector `B.sub(A)` the resulting vector points from A -> B\n   * @param v The vector to subtract\n   */\n  public sub(v: Vector): Vector {\n    return new Vector(this.x - v.x, this.y - v.y);\n  }\n\n  /**\n   * Adds one vector to this one modifying the original\n   * @param v The vector to add\n   */\n  public addEqual(v: Vector): Vector {\n    this.x += v.x;\n    this.y += v.y;\n    return this;\n  }\n\n  /**\n   * Subtracts a vector from this one modifying the original\n   * @parallel v The vector to subtract\n   */\n  public subEqual(v: Vector): Vector {\n    this.x -= v.x;\n    this.y -= v.y;\n    return this;\n  }\n\n  /**\n   * Scales this vector by a factor of size and modifies the original\n   */\n  public scaleEqual(size: number): Vector {\n    this.x *= size;\n    this.y *= size;\n    return this;\n  }\n\n  /**\n   * Performs a dot product with another vector\n   * @param v  The vector to dot\n   */\n  public dot(v: Vector): number {\n    return this.x * v.x + this.y * v.y;\n  }\n\n  /**\n   * Performs a 2D cross product with scalar. 2D cross products with a scalar return a vector.\n   * @param v  The scalar to cross\n   */\n  public cross(v: number): Vector;\n  /**\n   * Performs a 2D cross product with another vector. 2D cross products return a scalar value not a vector.\n   * @param v  The vector to cross\n   */\n  public cross(v: Vector): number;\n  public cross(v: any): any {\n    if (v instanceof Vector) {\n      return this.x * v.y - this.y * v.x;\n    } else if (typeof v === 'number') {\n      return new Vector(v * this.y, -v * this.x);\n    }\n  }\n\n  /**\n   * Returns the perpendicular vector to this one\n   */\n  public perpendicular(): Vector {\n    return new Vector(this.y, -this.x);\n  }\n\n  /**\n   * Returns the normal vector to this one, same as the perpendicular of length 1\n   */\n  public normal(): Vector {\n    return this.perpendicular().normalize();\n  }\n\n  /**\n   * Negate the current vector\n   */\n  public negate(): Vector {\n    return this.scale(-1);\n  }\n\n  /**\n   * Returns the angle of this vector.\n   */\n  public toAngle(): number {\n    return Math.atan2(this.y, this.x);\n  }\n\n  /**\n   * Rotates the current vector around a point by a certain number of\n   * degrees in radians\n   */\n  public rotate(angle: number, anchor?: Vector): Vector {\n    if (!anchor) {\n      anchor = new Vector(0, 0);\n    }\n    var sinAngle = Math.sin(angle);\n    var cosAngle = Math.cos(angle);\n    var x = cosAngle * (this.x - anchor.x) - sinAngle * (this.y - anchor.y) + anchor.x;\n    var y = sinAngle * (this.x - anchor.x) + cosAngle * (this.y - anchor.y) + anchor.y;\n    return new Vector(x, y);\n  }\n\n  /**\n   * Creates new vector that has the same values as the previous.\n   */\n  public clone(): Vector {\n    return new Vector(this.x, this.y);\n  }\n\n  /**\n   * Returns a string repesentation of the vector.\n   */\n  public toString(): string {\n    return `(${this.x}, ${this.y})`;\n  }\n}\n\n/**\n * A 2D ray that can be cast into the scene to do collision detection\n */\nexport class Ray {\n  public pos: Vector;\n  public dir: Vector;\n\n  /**\n   * @param pos The starting position for the ray\n   * @param dir The vector indicating the direction of the ray\n   */\n  constructor(pos: Vector, dir: Vector) {\n    this.pos = pos;\n    this.dir = dir.normalize();\n  }\n\n  /**\n   * Tests a whether this ray intersects with a line segment. Returns a number greater than or equal to 0 on success.\n   * This number indicates the mathematical intersection time.\n   * @param line  The line to test\n   */\n  public intersect(line: Line): number {\n    var numerator = line.begin.sub(this.pos);\n\n    // Test is line and ray are parallel and non intersecting\n    if (this.dir.cross(line.getSlope()) === 0 && numerator.cross(this.dir) !== 0) {\n      return -1;\n    }\n\n    // Lines are parallel\n    var divisor = this.dir.cross(line.getSlope());\n    if (divisor === 0) {\n      return -1;\n    }\n\n    var t = numerator.cross(line.getSlope()) / divisor;\n\n    if (t >= 0) {\n      var u = numerator.cross(this.dir) / divisor / line.getLength();\n      if (u >= 0 && u <= 1) {\n        return t;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * Returns the point of intersection given the intersection time\n   */\n  public getPoint(time: number): Vector {\n    return this.pos.add(this.dir.scale(time));\n  }\n}\n\n/**\n * A 2D line segment\n */\nexport class Line {\n  /**\n   * @param begin  The starting point of the line segment\n   * @param end  The ending point of the line segment\n   */\n  constructor(public begin: Vector, public end: Vector) {}\n\n  /**\n   * Gets the raw slope (m) of the line. Will return (+/-)Infinity for vertical lines.\n   */\n  public get slope() {\n    return (this.end.y - this.begin.y) / (this.end.x - this.begin.x);\n  }\n\n  /**\n   * Gets the Y-intercept (b) of the line. Will return (+/-)Infinity if there is no intercept.\n   */\n  public get intercept() {\n    return this.begin.y - this.slope * this.begin.x;\n  }\n\n  /**\n   * Gets the normal of the line\n   */\n  public normal(): Vector {\n    return this.end.sub(this.begin).normal();\n  }\n\n  /**\n   * Returns the slope of the line in the form of a vector\n   */\n  public getSlope(): Vector {\n    var begin = this.begin;\n    var end = this.end;\n    var distance = begin.distance(end);\n    return end.sub(begin).scale(1 / distance);\n  }\n\n  /**\n   * Returns the length of the line segment in pixels\n   */\n  public getLength(): number {\n    var begin = this.begin;\n    var end = this.end;\n    var distance = begin.distance(end);\n    return distance;\n  }\n\n  /**\n   * Find the perpendicular distance from the line to a point\n   * https://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line\n   * @param point\n   */\n  public distanceToPoint(point: Vector) {\n    let x0 = point.x;\n    let y0 = point.y;\n\n    let l = this.getLength();\n\n    let dy = this.end.y - this.begin.y;\n    let dx = this.end.x - this.begin.x;\n    let distance = Math.abs(dy * x0 - dx * y0 + this.end.x * this.begin.y - this.end.y * this.begin.x) / l;\n    return distance;\n  }\n\n  /**\n   * Finds a point on the line given only an X or a Y value. Given an X value, the function returns\n   * a new point with the calculated Y value and vice-versa.\n   *\n   * @param x The known X value of the target point\n   * @param y The known Y value of the target point\n   * @returns A new point with the other calculated axis value\n   */\n  public findPoint(x: number = null, y: number = null): Vector {\n    var m = this.slope;\n    var b = this.intercept;\n\n    if (x !== null) {\n      return new Vector(x, m * x + b);\n    } else if (y !== null) {\n      return new Vector((y - b) / m, y);\n    } else {\n      throw new Error('You must provide an X or a Y value');\n    }\n  }\n\n  /**\n   * Whether or not the given point lies on this line. This method is precise by default\n   * meaning the point must lie exactly on the line. Adjust threshold to\n   * loosen the strictness of the check for floating-point calculations.\n   */\n  public hasPoint(x: number, y: number, threshold?: number): boolean;\n\n  /**\n   * Whether or not the given point lies on this line. This method is precise by default\n   * meaning the point must lie exactly on the line. Adjust threshold to\n   * loosen the strictness of the check for floating-point calculations.\n   */\n  public hasPoint(v: Vector, threshold?: number): boolean;\n\n  /**\n   * @see http://stackoverflow.com/a/11908158/109458\n   */\n  public hasPoint(): boolean {\n    var currPoint: Vector;\n    var threshold = 0;\n\n    if (typeof arguments[0] === 'number' && typeof arguments[1] === 'number') {\n      currPoint = new Vector(arguments[0], arguments[1]);\n      threshold = arguments[2] || 0;\n    } else if (arguments[0] instanceof Vector) {\n      currPoint = arguments[0];\n      threshold = arguments[1] || 0;\n    } else {\n      throw 'Could not determine the arguments for Vector.hasPoint';\n    }\n\n    var dxc = currPoint.x - this.begin.x;\n    var dyc = currPoint.y - this.begin.y;\n\n    var dx1 = this.end.x - this.begin.x;\n    var dy1 = this.end.y - this.begin.y;\n\n    var cross = dxc * dy1 - dyc * dx1;\n\n    // check whether point lines on the line\n    if (Math.abs(cross) > threshold) {\n      return false;\n    }\n\n    // check whether point lies in-between start and end\n    if (Math.abs(dx1) >= Math.abs(dy1)) {\n      return dx1 > 0 ? this.begin.x <= currPoint.x && currPoint.x <= this.end.x : this.end.x <= currPoint.x && currPoint.x <= this.begin.x;\n    } else {\n      return dy1 > 0 ? this.begin.y <= currPoint.y && currPoint.y <= this.end.y : this.end.y <= currPoint.y && currPoint.y <= this.begin.y;\n    }\n  }\n}\n\n/**\n * A 1 dimensional projection on an axis, used to test overlaps\n */\nexport class Projection {\n  constructor(public min: number, public max: number) {}\n  public overlaps(projection: Projection): boolean {\n    return this.max > projection.min && projection.max > this.min;\n  }\n\n  public getOverlap(projection: Projection): number {\n    if (this.overlaps(projection)) {\n      if (this.max > projection.max) {\n        return projection.max - this.min;\n      } else {\n        return this.max - projection.min;\n      }\n    }\n    return 0;\n  }\n}\n\nexport class GlobalCoordinates {\n  public static fromPagePosition(x: number, y: number, engine: Engine): GlobalCoordinates;\n  public static fromPagePosition(pos: Vector, engine: Engine): GlobalCoordinates;\n  public static fromPagePosition(xOrPos: number | Vector, yOrEngine: number | Engine, engineOrUndefined?: Engine): GlobalCoordinates {\n    var pageX: number;\n    var pageY: number;\n    var pagePos: Vector;\n    var engine: Engine;\n\n    if (arguments.length === 3) {\n      pageX = <number>xOrPos;\n      pageY = <number>yOrEngine;\n      pagePos = new Vector(pageX, pageY);\n      engine = engineOrUndefined;\n    } else {\n      pagePos = <Vector>xOrPos;\n      pageX = pagePos.x;\n      pageY = pagePos.y;\n      engine = <Engine>yOrEngine;\n    }\n\n    var screenX: number = pageX - Util.getPosition(engine.canvas).x;\n    var screenY: number = pageY - Util.getPosition(engine.canvas).y;\n    var screenPos = new Vector(screenX, screenY);\n    var worldPos = engine.screenToWorldCoordinates(screenPos);\n\n    return new GlobalCoordinates(worldPos, pagePos, screenPos);\n  }\n\n  constructor(public worldPos: Vector, public pagePos: Vector, public screenPos: Vector) {}\n}\n","import { Engine } from './Engine';\nimport { EasingFunction, EasingFunctions } from './Util/EasingFunctions';\nimport { IPromise, Promise, PromiseState } from './Promises';\nimport { Vector } from './Algebra';\nimport { Actor } from './Actor';\nimport { removeItemFromArray } from './Util/Util';\nimport { ICanUpdate, ICanInitialize } from './Interfaces/LifecycleEvents';\nimport { PreUpdateEvent, PostUpdateEvent, GameEvent, InitializeEvent } from './Events';\nimport { Class } from './Class';\n\n/**\n * Interface that describes a custom camera strategy for tracking targets\n */\nexport interface ICameraStrategy<T> {\n  /**\n   * Target of the camera strategy that will be passed to the action\n   */\n  target: T;\n\n  /**\n   * Camera strategies perform an action to calculate a new focus returned out of the strategy\n   * @param target The target object to apply this camera strategy (if any)\n   * @param camera The current camera implementation in excalibur running the game\n   * @param engine The current engine running the game\n   * @param delta The elapsed time in milliseconds since the last frame\n   */\n  action: (target: T, camera: BaseCamera, engine: Engine, delta: number) => Vector;\n}\n\n/**\n * Container to house convenience strategy methods\n * @internal\n */\nexport class StrategyContainer {\n  constructor(public camera: BaseCamera) {}\n\n  /**\n   * Creates and adds the [[LockCameraToActorStrategy]] on the current camera.\n   * @param actor The actor to lock the camera to\n   */\n  public lockToActor(actor: Actor) {\n    this.camera.addStrategy(new LockCameraToActorStrategy(actor));\n  }\n\n  /**\n   * Creates and adds the [[LockCameraToActorAxisStrategy]] on the current camera\n   * @param actor The actor to lock the camera to\n   * @param axis The axis to follow the actor on\n   */\n  public lockToActorAxis(actor: Actor, axis: Axis) {\n    this.camera.addStrategy(new LockCameraToActorAxisStrategy(actor, axis));\n  }\n\n  /**\n   * Creates and adds the [[ElasticToActorStrategy]] on the current camera\n   * If cameraElasticity < cameraFriction < 1.0, the behavior will be a dampened spring that will slowly end at the target without bouncing\n   * If cameraFriction < cameraElasticity < 1.0, the behavior will be an oscillationg spring that will over\n   * correct and bounce around the target\n   *\n   * @param target Target actor to elastically follow\n   * @param cameraElasticity [0 - 1.0] The higher the elasticity the more force that will drive the camera towards the target\n   * @param cameraFriction [0 - 1.0] The higher the friction the more that the camera will resist motion towards the target\n   */\n  public elasticToActor(actor: Actor, cameraElasticity: number, cameraFriction: number) {\n    this.camera.addStrategy(new ElasticToActorStrategy(actor, cameraElasticity, cameraFriction));\n  }\n\n  /**\n   * Creates and adds the [[RadiusAroundActorStrategy]] on the current camera\n   * @param target Target actor to follow when it is \"radius\" pixels away\n   * @param radius Number of pixels away before the camera will follow\n   */\n  public radiusAroundActor(actor: Actor, radius: number) {\n    this.camera.addStrategy(new RadiusAroundActorStrategy(actor, radius));\n  }\n}\n\n/**\n * Camera axis enum\n */\nexport enum Axis {\n  X,\n  Y\n}\n\n/**\n * Lock a camera to the exact x/y postition of an actor.\n */\nexport class LockCameraToActorStrategy implements ICameraStrategy<Actor> {\n  constructor(public target: Actor) {}\n  public action = (target: Actor, _cam: BaseCamera, _eng: Engine, _delta: number) => {\n    let center = target.getCenter();\n    return center;\n  };\n}\n\n/**\n * Lock a camera to a specific axis around an actor.\n */\nexport class LockCameraToActorAxisStrategy implements ICameraStrategy<Actor> {\n  constructor(public target: Actor, public axis: Axis) {}\n  public action = (target: Actor, cam: BaseCamera, _eng: Engine, _delta: number) => {\n    let center = target.getCenter();\n    let currentFocus = cam.getFocus();\n    if (this.axis === Axis.X) {\n      return new Vector(center.x, currentFocus.y);\n    } else {\n      return new Vector(currentFocus.x, center.y);\n    }\n  };\n}\n\n/**\n * Using [Hook's law](https://en.wikipedia.org/wiki/Hooke's_law), elastically move the camera towards the target actor.\n */\nexport class ElasticToActorStrategy implements ICameraStrategy<Actor> {\n  /**\n   * If cameraElasticity < cameraFriction < 1.0, the behavior will be a dampened spring that will slowly end at the target without bouncing\n   * If cameraFriction < cameraElasticity < 1.0, the behavior will be an oscillationg spring that will over\n   * correct and bounce around the target\n   *\n   * @param target Target actor to elastically follow\n   * @param cameraElasticity [0 - 1.0] The higher the elasticity the more force that will drive the camera towards the target\n   * @param cameraFriction [0 - 1.0] The higher the friction the more that the camera will resist motion towards the target\n   */\n  constructor(public target: Actor, public cameraElasticity: number, public cameraFriction: number) {}\n  public action = (target: Actor, cam: BaseCamera, _eng: Engine, _delta: number) => {\n    let position = target.getCenter();\n    let focus = cam.getFocus();\n    let cameraVel = new Vector(cam.dx, cam.dy);\n\n    // Calculate the strech vector, using the spring equation\n    // F = kX\n    // https://en.wikipedia.org/wiki/Hooke's_law\n    // Apply to the current camera velocity\n    var stretch = position.sub(focus).scale(this.cameraElasticity); // stretch is X\n    cameraVel = cameraVel.add(stretch);\n\n    // Calculate the friction (-1 to apply a force in the opposition of motion)\n    // Apply to the current camera velocity\n    var friction = cameraVel.scale(-1).scale(this.cameraFriction);\n    cameraVel = cameraVel.add(friction);\n\n    // Update position by velocity deltas\n    focus = focus.add(cameraVel);\n\n    return focus;\n  };\n}\n\nexport class RadiusAroundActorStrategy implements ICameraStrategy<Actor> {\n  /**\n   *\n   * @param target Target actor to follow when it is \"radius\" pixels away\n   * @param radius Number of pixels away before the camera will follow\n   */\n  constructor(public target: Actor, public radius: number) {}\n  public action = (target: Actor, cam: BaseCamera, _eng: Engine, _delta: number) => {\n    let position = target.getCenter();\n    let focus = cam.getFocus();\n\n    let direction = position.sub(focus);\n    let distance = direction.magnitude();\n    if (distance >= this.radius) {\n      let offset = distance - this.radius;\n      return focus.add(direction.normalize().scale(offset));\n    }\n    return focus;\n  };\n}\n\n/**\n * Cameras\n *\n * [[BaseCamera]] is the base class for all Excalibur cameras. Cameras are used\n * to move around your game and set focus. They are used to determine\n * what is \"off screen\" and can be used to scale the game.\n *\n * [[include:Cameras.md]]\n */\nexport class BaseCamera extends Class implements ICanUpdate, ICanInitialize {\n  protected _follow: Actor;\n\n  private _cameraStrategies: ICameraStrategy<any>[] = [];\n\n  public strategy: StrategyContainer = new StrategyContainer(this);\n\n  // camera physical quantities\n  public z: number = 1;\n\n  public dx: number = 0;\n  public dy: number = 0;\n  public dz: number = 0;\n\n  public ax: number = 0;\n  public ay: number = 0;\n  public az: number = 0;\n\n  public rotation: number = 0;\n  public rx: number = 0;\n\n  private _x: number = 0;\n  private _y: number = 0;\n  private _cameraMoving: boolean = false;\n  private _currentLerpTime: number = 0;\n  private _lerpDuration: number = 1000; // 1 second\n  private _lerpStart: Vector = null;\n  private _lerpEnd: Vector = null;\n  private _lerpPromise: IPromise<Vector>;\n\n  //camera effects\n  protected _isShaking: boolean = false;\n  private _shakeMagnitudeX: number = 0;\n  private _shakeMagnitudeY: number = 0;\n  private _shakeDuration: number = 0;\n  private _elapsedShakeTime: number = 0;\n  private _xShake: number = 0;\n  private _yShake: number = 0;\n\n  protected _isZooming: boolean = false;\n  private _zoomStart: number = 1;\n  private _zoomEnd: number = 1;\n  private _currentZoomTime: number = 0;\n  private _zoomDuration: number = 0;\n\n  private _zoomPromise: Promise<boolean>;\n  private _zoomEasing: EasingFunction = EasingFunctions.EaseInOutCubic;\n  private _easing: EasingFunction = EasingFunctions.EaseInOutCubic;\n\n  /**\n   * Get the camera's x position\n   */\n  public get x() {\n    return this._x;\n  }\n\n  /**\n   * Set the camera's x position (cannot be set when following an [[Actor]] or when moving)\n   */\n  public set x(value: number) {\n    if (!this._follow && !this._cameraMoving) {\n      this._x = value;\n    }\n  }\n\n  /**\n   * Get the camera's y position\n   */\n  public get y() {\n    return this._y;\n  }\n\n  /**\n   * Set the camera's y position (cannot be set when following an [[Actor]] or when moving)\n   */\n  public set y(value: number) {\n    if (!this._follow && !this._cameraMoving) {\n      this._y = value;\n    }\n  }\n\n  /**\n   * Get the camera's position as a vector\n   */\n  public get pos(): Vector {\n    return new Vector(this.x, this.y);\n  }\n\n  /**\n   * Set the cameras position\n   */\n  public set pos(value: Vector) {\n    this.x = value.x;\n    this.y = value.y;\n  }\n\n  /**\n   * Get the camera's velocity as a vector\n   */\n  public get vel() {\n    return new Vector(this.dx, this.dy);\n  }\n\n  /**\n   * Set the camera's velocity\n   */\n  public set vel(value: Vector) {\n    this.dx = value.x;\n    this.dy = value.y;\n  }\n\n  /**\n   * Returns the focal point of the camera, a new point giving the x and y position of the camera\n   */\n  public getFocus() {\n    return new Vector(this.x, this.y);\n  }\n\n  /**\n   * This moves the camera focal point to the specified position using specified easing function. Cannot move when following an Actor.\n   *\n   * @param pos The target position to move to\n   * @param duration The duration in milliseconds the move should last\n   * @param [easingFn] An optional easing function ([[ex.EasingFunctions.EaseInOutCubic]] by default)\n   * @returns A [[Promise]] that resolves when movement is finished, including if it's interrupted.\n   *          The [[Promise]] value is the [[Vector]] of the target position. It will be rejected if a move cannot be made.\n   */\n  public move(pos: Vector, duration: number, easingFn: EasingFunction = EasingFunctions.EaseInOutCubic): IPromise<Vector> {\n    if (typeof easingFn !== 'function') {\n      throw 'Please specify an EasingFunction';\n    }\n\n    // cannot move when following an actor\n    if (this._follow) {\n      return new Promise<Vector>().reject(pos);\n    }\n\n    // resolve existing promise, if any\n    if (this._lerpPromise && this._lerpPromise.state() === PromiseState.Pending) {\n      this._lerpPromise.resolve(pos);\n    }\n\n    this._lerpPromise = new Promise<Vector>();\n    this._lerpStart = this.getFocus().clone();\n    this._lerpDuration = duration;\n    this._lerpEnd = pos;\n    this._currentLerpTime = 0;\n    this._cameraMoving = true;\n    this._easing = easingFn;\n\n    return this._lerpPromise;\n  }\n\n  /**\n   * Sets the camera to shake at the specified magnitudes for the specified duration\n   * @param magnitudeX  The x magnitude of the shake\n   * @param magnitudeY  The y magnitude of the shake\n   * @param duration    The duration of the shake in milliseconds\n   */\n  public shake(magnitudeX: number, magnitudeY: number, duration: number) {\n    this._isShaking = true;\n    this._shakeMagnitudeX = magnitudeX;\n    this._shakeMagnitudeY = magnitudeY;\n    this._shakeDuration = duration;\n  }\n\n  /**\n   * Zooms the camera in or out by the specified scale over the specified duration.\n   * If no duration is specified, it take effect immediately.\n   * @param scale    The scale of the zoom\n   * @param duration The duration of the zoom in milliseconds\n   */\n  public zoom(scale: number, duration: number = 0, easingFn: EasingFunction = EasingFunctions.EaseInOutCubic): Promise<boolean> {\n    this._zoomPromise = new Promise<boolean>();\n\n    if (duration) {\n      this._isZooming = true;\n      this._zoomEasing = easingFn;\n      this._currentZoomTime = 0;\n      this._zoomDuration = duration;\n      this._zoomStart = this.z;\n      this._zoomEnd = scale;\n    } else {\n      this._isZooming = false;\n      this.z = scale;\n      this._zoomPromise.resolve(true);\n    }\n\n    return this._zoomPromise;\n  }\n\n  /**\n   * Gets the current zoom scale\n   */\n  public getZoom() {\n    return this.z;\n  }\n\n  /**\n   * Adds a new camera strategy to this camera\n   * @param cameraStrategy Instance of an [[ICameraStrategy]]\n   */\n  public addStrategy<T>(cameraStrategy: ICameraStrategy<T>) {\n    this._cameraStrategies.push(cameraStrategy);\n  }\n\n  /**\n   * Removes a camera strategy by reference\n   * @param cameraStrategy Instance of an [[ICameraStrategy]]\n   */\n  public removeStrategy<T>(cameraStrategy: ICameraStrategy<T>) {\n    removeItemFromArray(cameraStrategy, this._cameraStrategies);\n  }\n\n  /**\n   * Clears all camera strategies from the camera\n   */\n  public clearAllStrategies() {\n    this._cameraStrategies.length = 0;\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overriden, do so at your own risk.\n   *\n   * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\n   * @internal\n   */\n  public _preupdate(engine: Engine, delta: number): void {\n    this.emit('preupdate', new PreUpdateEvent(engine, delta, this));\n    this.onPreUpdate(engine, delta);\n  }\n\n  /**\n   * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n   *\n   * `onPreUpdate` is called directly before a scene is updated.\n   */\n  public onPreUpdate(_engine: Engine, _delta: number): void {\n    // Overridable\n  }\n\n  /**\n   *  It is not recommended that internal excalibur methods be overriden, do so at your own risk.\n   *\n   * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\n   * @internal\n   */\n  public _postupdate(engine: Engine, delta: number): void {\n    this.emit('postupdate', new PostUpdateEvent(engine, delta, this));\n    this.onPostUpdate(engine, delta);\n  }\n\n  /**\n   * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n   *\n   * `onPostUpdate` is called directly after a scene is updated.\n   */\n  public onPostUpdate(_engine: Engine, _delta: number): void {\n    // Overridable\n  }\n\n  private _isInitialized = false;\n  public get isInitialized() {\n    return this._isInitialized;\n  }\n\n  public _initialize(_engine: Engine) {\n    if (!this.isInitialized) {\n      this.onInitialize(_engine);\n      super.emit('initialize', new InitializeEvent(_engine, this));\n      this._isInitialized = true;\n    }\n  }\n\n  /**\n   * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n   *\n   * `onPostUpdate` is called directly after a scene is updated.\n   */\n  public onInitialize(_engine: Engine) {\n    // Overridable\n  }\n\n  public on(eventName: 'initialize', handler: (event?: InitializeEvent) => void): void;\n  public on(eventName: 'preupdate', handler: (event?: PreUpdateEvent) => void): void;\n  public on(eventName: 'postupdate', handler: (event?: PostUpdateEvent) => void): void;\n  public on(eventName: any, handler: any) {\n    super.on(eventName, handler);\n  }\n\n  public off(eventName: 'initialize', handler?: (event?: InitializeEvent) => void): void;\n  public off(eventName: 'preupdate', handler?: (event?: PreUpdateEvent) => void): void;\n  public off(eventName: 'postupdate', handler?: (event?: PostUpdateEvent) => void): void;\n  public off(eventName: string, handler: (event?: GameEvent<any>) => void): void;\n  public off(eventName: string, handler: (event?: any) => void): void {\n    super.off(eventName, handler);\n  }\n\n  public once(eventName: 'initialize', handler: (event?: InitializeEvent) => void): void;\n  public once(eventName: 'preupdate', handler: (event?: PreUpdateEvent) => void): void;\n  public once(eventName: 'postupdate', handler: (event?: PostUpdateEvent) => void): void;\n  public once(eventName: string, handler: (event?: GameEvent<any>) => void): void;\n  public once(eventName: string, handler: (event?: any) => void): void {\n    super.once(eventName, handler);\n  }\n\n  public update(_engine: Engine, delta: number) {\n    this._initialize(_engine);\n    this._preupdate(_engine, delta);\n\n    // Update placements based on linear algebra\n    this._x += (this.dx * delta) / 1000;\n    this._y += (this.dy * delta) / 1000;\n    this.z += (this.dz * delta) / 1000;\n\n    this.dx += (this.ax * delta) / 1000;\n    this.dy += (this.ay * delta) / 1000;\n    this.dz += (this.az * delta) / 1000;\n\n    this.rotation += (this.rx * delta) / 1000;\n\n    if (this._isZooming) {\n      if (this._currentZoomTime < this._zoomDuration) {\n        let zoomEasing = this._zoomEasing;\n        let newZoom = zoomEasing(this._currentZoomTime, this._zoomStart, this._zoomEnd, this._zoomDuration);\n\n        this.z = newZoom;\n        this._currentZoomTime += delta;\n      } else {\n        this._isZooming = false;\n        this.z = this._zoomEnd;\n        this._currentZoomTime = 0;\n        this._zoomPromise.resolve(true);\n      }\n    }\n\n    if (this._cameraMoving) {\n      if (this._currentLerpTime < this._lerpDuration) {\n        let moveEasing = EasingFunctions.CreateVectorEasingFunction(this._easing);\n\n        let lerpPoint = moveEasing(this._currentLerpTime, this._lerpStart, this._lerpEnd, this._lerpDuration);\n\n        this._x = lerpPoint.x;\n        this._y = lerpPoint.y;\n\n        this._currentLerpTime += delta;\n      } else {\n        this._x = this._lerpEnd.x;\n        this._y = this._lerpEnd.y;\n        let end = this._lerpEnd.clone();\n\n        this._lerpStart = null;\n        this._lerpEnd = null;\n        this._currentLerpTime = 0;\n        this._cameraMoving = false;\n        // Order matters here, resolve should be last so any chain promises have a clean slate\n        this._lerpPromise.resolve(end);\n      }\n    }\n\n    if (this._isDoneShaking()) {\n      this._isShaking = false;\n      this._elapsedShakeTime = 0;\n      this._shakeMagnitudeX = 0;\n      this._shakeMagnitudeY = 0;\n      this._shakeDuration = 0;\n      this._xShake = 0;\n      this._yShake = 0;\n    } else {\n      this._elapsedShakeTime += delta;\n      this._xShake = ((Math.random() * this._shakeMagnitudeX) | 0) + 1;\n      this._yShake = ((Math.random() * this._shakeMagnitudeY) | 0) + 1;\n    }\n\n    for (let s of this._cameraStrategies) {\n      this.pos = s.action.call(s, s.target, this, _engine, delta);\n    }\n\n    this._postupdate(_engine, delta);\n  }\n\n  /**\n   * Applies the relevant transformations to the game canvas to \"move\" or apply effects to the Camera\n   * @param ctx    Canvas context to apply transformations\n   * @param delta  The number of milliseconds since the last update\n   */\n  public draw(ctx: CanvasRenderingContext2D) {\n    let focus = this.getFocus();\n    let canvasWidth = ctx.canvas.width;\n    let canvasHeight = ctx.canvas.height;\n    let pixelRatio = window.devicePixelRatio;\n    let zoom = this.getZoom();\n\n    var newCanvasWidth = canvasWidth / zoom / pixelRatio;\n    var newCanvasHeight = canvasHeight / zoom / pixelRatio;\n\n    ctx.scale(zoom, zoom);\n    ctx.translate(-focus.x + newCanvasWidth / 2 + this._xShake, -focus.y + newCanvasHeight / 2 + this._yShake);\n  }\n\n  public debugDraw(ctx: CanvasRenderingContext2D) {\n    var focus = this.getFocus();\n    ctx.fillStyle = 'red';\n    ctx.strokeStyle = 'white';\n    ctx.lineWidth = 3;\n    ctx.beginPath();\n    ctx.arc(focus.x, focus.y, 15, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.stroke();\n\n    ctx.beginPath();\n    ctx.arc(focus.x, focus.y, 5, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.stroke();\n  }\n\n  private _isDoneShaking(): boolean {\n    return !this._isShaking || this._elapsedShakeTime >= this._shakeDuration;\n  }\n}\n","import { GameEvent } from './Events';\nimport { EventDispatcher } from './EventDispatcher';\nimport { IEvented } from './Interfaces/IEvented';\n\n/**\n * Excalibur base class that provides basic functionality such as [[EventDispatcher]]\n * and extending abilities for vanilla Javascript projects\n */\nexport class Class implements IEvented {\n  /**\n   * Direct access to the game object event dispatcher.\n   */\n  public eventDispatcher: EventDispatcher;\n\n  constructor() {\n    this.eventDispatcher = new EventDispatcher(this);\n  }\n\n  /**\n   * Alias for `addEventListener`. You can listen for a variety of\n   * events off of the engine; see the events section below for a complete list.\n   * @param eventName  Name of the event to listen for\n   * @param handler    Event handler for the thrown event\n   */\n  public on(eventName: string, handler: (event?: GameEvent<any>) => void) {\n    this.eventDispatcher.on(eventName, handler);\n  }\n\n  /**\n   * Alias for `removeEventListener`. If only the eventName is specified\n   * it will remove all handlers registered for that specific event. If the eventName\n   * and the handler instance are specified only that handler will be removed.\n   *\n   * @param eventName  Name of the event to listen for\n   * @param handler    Event handler for the thrown event\n   */\n  public off(eventName: string, handler?: (event?: GameEvent<any>) => void) {\n    this.eventDispatcher.off(eventName, handler);\n  }\n\n  /**\n   * Emits a new event\n   * @param eventName   Name of the event to emit\n   * @param eventObject Data associated with this event\n   */\n  public emit(eventName: string, eventObject?: GameEvent<any>) {\n    this.eventDispatcher.emit(eventName, eventObject);\n  }\n\n  /**\n   * Once listens to an event one time, then unsubscribes from that event\n   *\n   * @param eventName The name of the event to subscribe to once\n   * @param handler   The handler of the event that will be auto unsubscribed\n   */\n  public once(eventName: string, handler: (event?: GameEvent<any>) => void) {\n    this.eventDispatcher.once(eventName, handler);\n  }\n\n  /**\n   * You may wish to extend native Excalibur functionality in vanilla Javascript.\n   * Any method on a class inheriting [[Class]] may be extended to support\n   * additional functionality. In the example below we create a new type called `MyActor`.\n   *\n   *\n   * ```js\n   * var MyActor = Actor.extend({\n   *\n   *    constructor: function() {\n   *       this.newprop = 'something';\n   *       Actor.apply(this, arguments);\n   *    },\n   *\n   *    update: function(engine, delta) {\n   *       // Implement custom update\n   *       // Call super constructor update\n   *       Actor.prototype.update.call(this, engine, delta);\n   *\n   *       console.log(\"Something cool!\");\n   *    }\n   * });\n   *\n   * var myActor = new MyActor(100, 100, 100, 100, Color.Azure);\n   * ```\n   *\n   * In TypeScript, you only need to use the `extends` syntax, you do not need\n   * to use this method of extension.\n   *\n   * @param methods A JSON object contain any methods/properties you want to extend\n   */\n  public static extend(methods: any): any {\n    var parent: any = this;\n    var child: any;\n\n    if (methods && methods.hasOwnProperty('constructor')) {\n      child = methods.constructor;\n    } else {\n      child = function(this: any) {\n        return parent.apply(this, arguments);\n      };\n    }\n\n    // Using constructor allows JS to lazily instantiate super classes\n    var Super: any = function(this: any) {\n      this.constructor = child;\n    };\n    Super.prototype = parent.prototype;\n    child.prototype = new Super();\n\n    if (methods) {\n      for (var prop in methods) {\n        if (methods.hasOwnProperty(prop)) {\n          child.prototype[prop] = methods[prop];\n        }\n      }\n    }\n\n    // Make subclasses extendable\n    child.extend = Class.extend;\n\n    return child;\n  }\n}\n","import { Physics, CollisionResolutionStrategy } from './../Physics';\nimport { EdgeArea } from './EdgeArea';\nimport { CircleArea } from './CircleArea';\nimport { ICollisionArea } from './ICollisionArea';\nimport { PolygonArea } from './PolygonArea';\nimport { BoundingBox } from './BoundingBox';\nimport { Pair } from './Pair';\n\nimport { Vector } from '../Algebra';\nimport { Actor } from '../Actor';\nimport { Color } from '../Drawing/Color';\nimport * as DrawUtil from '../Util/DrawUtil';\n\nexport class Body {\n  /**\n   * Constructs a new physics body associated with an actor\n   */\n  constructor(public actor: Actor) {}\n\n  /**\n   * [[ICollisionArea|Collision area]] of this physics body, defines the shape for rigid body collision\n   */\n  public collisionArea: ICollisionArea = null;\n\n  /**\n   * The (x, y) position of the actor this will be in the middle of the actor if the\n   * [[Actor.anchor]] is set to (0.5, 0.5) which is default.\n   * If you want the (x, y) position to be the top left of the actor specify an anchor of (0, 0).\n   */\n  public pos: Vector = new Vector(0, 0);\n\n  /**\n   * The position of the actor last frame (x, y) in pixels\n   */\n  public oldPos: Vector = new Vector(0, 0);\n\n  /**\n   * The current velocity vector (vx, vy) of the actor in pixels/second\n   */\n  public vel: Vector = new Vector(0, 0);\n\n  /**\n   * The velocity of the actor last frame (vx, vy) in pixels/second\n   */\n  public oldVel: Vector = new Vector(0, 0);\n\n  /**\n   * The curret acceleration vector (ax, ay) of the actor in pixels/second/second. An acceleration pointing down such as (0, 100) may\n   * be useful to simulate a gravitational effect.\n   */\n  public acc: Vector = new Vector(0, 0);\n\n  /**\n   * The current torque applied to the actor\n   */\n  public torque: number = 0;\n\n  /**\n   * The current mass of the actor, mass can be thought of as the resistance to acceleration.\n   */\n  public mass: number = 1.0;\n\n  /**\n   * The current moment of inertia, moi can be thought of as the resistance to rotation.\n   */\n  public moi: number = 1000;\n\n  /**\n   * The current \"motion\" of the actor, used to calculated sleep in the physics simulation\n   */\n  public motion: number = 10;\n\n  /**\n   * The coefficient of friction on this actor\n   */\n  public friction: number = 0.99;\n\n  /**\n   * The coefficient of restitution of this actor, represents the amount of energy preserved after collision\n   */\n  public restitution: number = 0.2;\n\n  /**\n   * The rotation of the actor in radians\n   */\n  public rotation: number = 0; // radians\n\n  /**\n   * The rotational velocity of the actor in radians/second\n   */\n  public rx: number = 0; //radians/sec\n\n  private _totalMtv: Vector = Vector.Zero.clone();\n\n  /**\n   * Add minimum translation vectors accumulated during the current frame to resolve collisions.\n   */\n  public addMtv(mtv: Vector) {\n    this._totalMtv.addEqual(mtv);\n  }\n\n  /**\n   * Applies the accumulated translation vectors to the actors position\n   */\n  public applyMtv(): void {\n    this.pos.addEqual(this._totalMtv);\n    this._totalMtv.setTo(0, 0);\n  }\n\n  /**\n   * Returns the body's [[BoundingBox]] calculated for this instant in world space.\n   */\n  public getBounds(): BoundingBox {\n    if (Physics.collisionResolutionStrategy === CollisionResolutionStrategy.Box) {\n      return this.actor.getBounds();\n    } else {\n      return this.collisionArea.getBounds();\n    }\n  }\n\n  /**\n   * Returns the actor's [[BoundingBox]] relative to the actors position.\n   */\n  public getRelativeBounds(): BoundingBox {\n    if (Physics.collisionResolutionStrategy === CollisionResolutionStrategy.Box) {\n      return this.actor.getRelativeBounds();\n    } else {\n      return this.actor.getRelativeBounds();\n    }\n  }\n\n  /**\n   * Updates the collision area geometry and internal caches\n   */\n  public update() {\n    if (this.collisionArea) {\n      // Update the geometry if needed\n      if (this.actor && this.actor.isGeometryDirty && this.collisionArea instanceof PolygonArea) {\n        this.collisionArea.points = this.actor.getRelativeGeometry();\n      }\n\n      this.collisionArea.recalc();\n    }\n  }\n\n  /**\n   * Sets up a box collision area based on the current bounds of the associated actor of this physics body.\n   *\n   * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\n   */\n  public useBoxCollision(center: Vector = Vector.Zero.clone()) {\n    this.collisionArea = new PolygonArea({\n      body: this,\n      points: this.actor.getRelativeGeometry(),\n      pos: center // position relative to actor\n    });\n\n    // in case of a nan moi, coalesce to a safe default\n    this.moi = this.collisionArea.getMomentOfInertia() || this.moi;\n  }\n\n  /**\n   * Sets up a polygon collision area based on a list of of points relative to the anchor of the associated actor of this physics body.\n   *\n   * Only [convex polygon](https://en.wikipedia.org/wiki/Convex_polygon) definitions are supported.\n   *\n   * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\n   */\n  public usePolygonCollision(points: Vector[], center: Vector = Vector.Zero.clone()) {\n    this.collisionArea = new PolygonArea({\n      body: this,\n      points: points,\n      pos: center // position relative to actor\n    });\n\n    // in case of a nan moi, collesce to a safe default\n    this.moi = this.collisionArea.getMomentOfInertia() || this.moi;\n  }\n\n  /**\n   * Sets up a [[CircleArea|circle collision area]] with a specified radius in pixels.\n   *\n   * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\n   */\n  public useCircleCollision(radius?: number, center: Vector = Vector.Zero.clone()) {\n    if (!radius) {\n      radius = this.actor.getWidth() / 2;\n    }\n    this.collisionArea = new CircleArea({\n      body: this,\n      radius: radius,\n      pos: center\n    });\n    this.moi = this.collisionArea.getMomentOfInertia() || this.moi;\n  }\n\n  /**\n   * Sets up an [[EdgeArea|edge collision]] with a start point and an end point relative to the anchor of the associated actor\n   * of this physics body.\n   *\n   * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\n   */\n  public useEdgeCollision(begin: Vector, end: Vector) {\n    this.collisionArea = new EdgeArea({\n      begin: begin,\n      end: end,\n      body: this\n    });\n\n    this.moi = this.collisionArea.getMomentOfInertia() || this.moi;\n  }\n\n  /* istanbul ignore next */\n  public debugDraw(ctx: CanvasRenderingContext2D) {\n    // Draw motion vectors\n    if (Physics.showMotionVectors) {\n      DrawUtil.vector(ctx, Color.Yellow, this.pos, this.acc.add(Physics.acc));\n      DrawUtil.vector(ctx, Color.Red, this.pos, this.vel);\n      DrawUtil.point(ctx, Color.Red, this.pos);\n    }\n\n    if (Physics.showBounds) {\n      this.getBounds().debugDraw(ctx, Color.Yellow);\n    }\n\n    if (Physics.showArea) {\n      this.collisionArea.debugDraw(ctx, Color.Green);\n    }\n  }\n\n  /**\n   * Returns a boolean indicating whether this body collided with\n   * or was in stationary contact with\n   * the body of the other [[Actor]]\n   */\n  public touching(other: Actor): boolean {\n    var pair = new Pair(this, other.body);\n    pair.collide();\n\n    if (pair.collision) {\n      return true;\n    }\n\n    return false;\n  }\n}\n","import { PolygonArea } from './PolygonArea';\n\nimport { Actor } from '../Actor';\nimport { Vector, Ray } from '../Algebra';\nimport { Color } from '../Drawing/Color';\n\n/**\n * Interface all collidable objects must implement\n */\nexport interface ICollidable {\n  /**\n   * Test whether this bounding box collides with another one.\n   *\n   * @param collidable  Other collidable to test\n   * @returns Vector The intersection vector that can be used to resolve the collision.\n   * If there is no collision, `null` is returned.\n   */\n  collides(collidable: ICollidable): Vector;\n  /**\n   * Tests wether a point is contained within the collidable\n   * @param point  The point to test\n   */\n  contains(point: Vector): boolean;\n\n  debugDraw(ctx: CanvasRenderingContext2D): void;\n}\n\n/**\n * Axis Aligned collision primitive for Excalibur.\n */\nexport class BoundingBox implements ICollidable {\n  /**\n   * @param left    x coordinate of the left edge\n   * @param top     y coordinate of the top edge\n   * @param right   x coordinate of the right edge\n   * @param bottom  y coordinate of the bottom edge\n   */\n  constructor(public left: number = 0, public top: number = 0, public right: number = 0, public bottom: number = 0) {}\n\n  public static fromPoints(points: Vector[]): BoundingBox {\n    var minX = Infinity;\n    var minY = Infinity;\n    var maxX = -Infinity;\n    var maxY = -Infinity;\n    for (var i = 0; i < points.length; i++) {\n      if (points[i].x < minX) {\n        minX = points[i].x;\n      }\n      if (points[i].x > maxX) {\n        maxX = points[i].x;\n      }\n      if (points[i].y < minY) {\n        minY = points[i].y;\n      }\n      if (points[i].y > maxY) {\n        maxY = points[i].y;\n      }\n    }\n    return new BoundingBox(minX, minY, maxX, maxY);\n  }\n\n  /**\n   * Returns the calculated width of the bounding box\n   */\n  public getWidth() {\n    return this.right - this.left;\n  }\n\n  /**\n   * Returns the calculated height of the bounding box\n   */\n  public getHeight() {\n    return this.bottom - this.top;\n  }\n\n  /**\n   * Rotates a bounding box by and angle and around a point, if no point is specified (0, 0) is used by default. The resulting bounding\n   * box is also axis-align. This is useful when a new axis-aligned bounding box is needed for rotated geometry.\n   */\n  public rotate(angle: number, point: Vector = Vector.Zero.clone()): BoundingBox {\n    var points = this.getPoints().map((p) => p.rotate(angle, point));\n    return BoundingBox.fromPoints(points);\n  }\n\n  /**\n   * Returns the perimeter of the bounding box\n   */\n  public getPerimeter(): number {\n    var wx = this.getWidth();\n    var wy = this.getHeight();\n    return 2 * (wx + wy);\n  }\n\n  public getPoints(): Vector[] {\n    var results = [];\n    results.push(new Vector(this.left, this.top));\n    results.push(new Vector(this.right, this.top));\n    results.push(new Vector(this.right, this.bottom));\n    results.push(new Vector(this.left, this.bottom));\n    return results;\n  }\n\n  /**\n   * Creates a Polygon collision area from the points of the bounding box\n   */\n  public toPolygon(actor?: Actor): PolygonArea {\n    return new PolygonArea({\n      body: actor ? actor.body : null,\n      points: this.getPoints(),\n      pos: Vector.Zero.clone()\n    });\n  }\n\n  /**\n   * Determines whether a ray intersects with a bounding box\n   */\n  public rayCast(ray: Ray, farClipDistance = Infinity): boolean {\n    // algorithm from https://tavianator.com/fast-branchless-raybounding-box-intersections/\n    var tmin = -Infinity;\n    var tmax = +Infinity;\n\n    var xinv = ray.dir.x === 0 ? Number.MAX_VALUE : 1 / ray.dir.x;\n    var yinv = ray.dir.y === 0 ? Number.MAX_VALUE : 1 / ray.dir.y;\n\n    var tx1 = (this.left - ray.pos.x) * xinv;\n    var tx2 = (this.right - ray.pos.x) * xinv;\n    tmin = Math.min(tx1, tx2);\n    tmax = Math.max(tx1, tx2);\n\n    var ty1 = (this.top - ray.pos.y) * yinv;\n    var ty2 = (this.bottom - ray.pos.y) * yinv;\n    tmin = Math.max(tmin, Math.min(ty1, ty2));\n    tmax = Math.min(tmax, Math.max(ty1, ty2));\n\n    return tmax >= Math.max(0, tmin) && tmin < farClipDistance;\n  }\n\n  public rayCastTime(ray: Ray, farClipDistance = Infinity): number {\n    // algorithm from https://tavianator.com/fast-branchless-raybounding-box-intersections/\n    var tmin = -Infinity;\n    var tmax = +Infinity;\n\n    var xinv = ray.dir.x === 0 ? Number.MAX_VALUE : 1 / ray.dir.x;\n    var yinv = ray.dir.y === 0 ? Number.MAX_VALUE : 1 / ray.dir.y;\n\n    var tx1 = (this.left - ray.pos.x) * xinv;\n    var tx2 = (this.right - ray.pos.x) * xinv;\n    tmin = Math.min(tx1, tx2);\n    tmax = Math.max(tx1, tx2);\n\n    var ty1 = (this.top - ray.pos.y) * yinv;\n    var ty2 = (this.bottom - ray.pos.y) * yinv;\n    tmin = Math.max(tmin, Math.min(ty1, ty2));\n    tmax = Math.min(tmax, Math.max(ty1, ty2));\n\n    if (tmax >= Math.max(0, tmin) && tmin < farClipDistance) {\n      return tmin;\n    }\n    return -1;\n  }\n\n  /**\n   * Tests whether a point is contained within the bounding box\n   * @param p  The point to test\n   */\n  public contains(p: Vector): boolean;\n\n  /**\n   * Tests whether another bounding box is totally contained in this one\n   * @param bb  The bounding box to test\n   */\n  public contains(bb: BoundingBox): boolean;\n  public contains(val: any): boolean {\n    if (val instanceof Vector) {\n      return this.left <= val.x && this.top <= val.y && this.bottom >= val.y && this.right >= val.x;\n    } else if (val instanceof BoundingBox) {\n      if (this.left < val.left && this.top < val.top && val.bottom < this.bottom && val.right < this.right) {\n        return true;\n      }\n      return false;\n    }\n    return false;\n  }\n\n  /**\n   * Combines this bounding box and another together returning a new bounding box\n   * @param other  The bounding box to combine\n   */\n  public combine(other: BoundingBox): BoundingBox {\n    var compositeBB = new BoundingBox(\n      Math.min(this.left, other.left),\n      Math.min(this.top, other.top),\n      Math.max(this.right, other.right),\n      Math.max(this.bottom, other.bottom)\n    );\n    return compositeBB;\n  }\n\n  /**\n   * Test wether this bounding box collides with another returning,\n   * the intersection vector that can be used to resolve the collision. If there\n   * is no collision null is returned.\n   * @param collidable  Other collidable to test\n   */\n  public collides(collidable: ICollidable): Vector {\n    if (collidable instanceof BoundingBox) {\n      var other: BoundingBox = <BoundingBox>collidable;\n      var totalBoundingBox = this.combine(other);\n\n      // If the total bounding box is less than the sum of the 2 bounds then there is collision\n      if (\n        totalBoundingBox.getWidth() < other.getWidth() + this.getWidth() &&\n        totalBoundingBox.getHeight() < other.getHeight() + this.getHeight()\n      ) {\n        // collision\n        var overlapX = 0;\n        if (this.right >= other.left && this.right <= other.right) {\n          overlapX = other.left - this.right;\n        } else {\n          overlapX = other.right - this.left;\n        }\n\n        var overlapY = 0;\n        if (this.top <= other.bottom && this.top >= other.top) {\n          overlapY = other.bottom - this.top;\n        } else {\n          overlapY = other.top - this.bottom;\n        }\n\n        if (Math.abs(overlapX) < Math.abs(overlapY)) {\n          return new Vector(overlapX, 0);\n        } else {\n          return new Vector(0, overlapY);\n        }\n      } else {\n        return null;\n      }\n    }\n\n    return null;\n  }\n\n  /* istanbul ignore next */\n  public debugDraw(ctx: CanvasRenderingContext2D, color: Color = Color.Yellow) {\n    ctx.strokeStyle = color.toString();\n    ctx.strokeRect(this.left, this.top, this.getWidth(), this.getHeight());\n  }\n}\n","import { Body } from './Body';\nimport { BoundingBox } from './BoundingBox';\nimport { ICollisionArea } from './ICollisionArea';\nimport { PolygonArea } from './PolygonArea';\nimport { EdgeArea } from './EdgeArea';\nimport { CollisionJumpTable } from './CollisionJumpTable';\nimport { CollisionContact } from './CollisionContact';\n\nimport { Vector, Ray, Projection } from '../Algebra';\nimport { Physics } from '../Physics';\nimport { Color } from '../Drawing/Color';\n\nexport interface ICircleAreaOptions {\n  pos?: Vector;\n  radius?: number;\n  body?: Body;\n}\n\n/**\n * This is a circle collision area for the excalibur rigid body physics simulation\n */\nexport class CircleArea implements ICollisionArea {\n  /**\n   * This is the center position of the circle, relative to the body position\n   */\n  public pos: Vector = Vector.Zero.clone();\n  /**\n   * This is the radius of the circle\n   */\n  public radius: number;\n  /**\n   * The actor associated with this collision area\n   */\n  public body: Body;\n\n  constructor(options: ICircleAreaOptions) {\n    this.pos = options.pos || Vector.Zero.clone();\n    this.radius = options.radius || 0;\n    this.body = options.body || null;\n  }\n\n  /**\n   * Get the center of the collision area in world coordinates\n   */\n  public getCenter(): Vector {\n    if (this.body) {\n      return this.pos.add(this.body.pos);\n    }\n    return this.pos;\n  }\n\n  /**\n   * Tests if a point is contained in this collision area\n   */\n  public contains(point: Vector): boolean {\n    var distance = this.body.pos.distance(point);\n    if (distance <= this.radius) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Casts a ray at the CircleArea and returns the nearest point of collision\n   * @param ray\n   */\n  public rayCast(ray: Ray, max: number = Infinity): Vector {\n    //https://en.wikipedia.org/wiki/Line%E2%80%93sphere_intersection\n    var c = this.getCenter();\n    var dir = ray.dir;\n    var orig = ray.pos;\n\n    var discriminant = Math.sqrt(Math.pow(dir.dot(orig.sub(c)), 2) - Math.pow(orig.sub(c).distance(), 2) + Math.pow(this.radius, 2));\n\n    if (discriminant < 0) {\n      // no intersection\n      return null;\n    } else {\n      var toi = 0;\n      if (discriminant === 0) {\n        toi = -dir.dot(orig.sub(c));\n        if (toi > 0 && toi < max) {\n          return ray.getPoint(toi);\n        }\n        return null;\n      } else {\n        var toi1 = -dir.dot(orig.sub(c)) + discriminant;\n        var toi2 = -dir.dot(orig.sub(c)) - discriminant;\n\n        var mintoi = Math.min(toi1, toi2);\n        if (mintoi <= max) {\n          return ray.getPoint(mintoi);\n        }\n        return null;\n      }\n    }\n  }\n\n  /**\n   * @inheritdoc\n   */\n  public collide(area: ICollisionArea): CollisionContact {\n    if (area instanceof CircleArea) {\n      return CollisionJumpTable.CollideCircleCircle(this, area);\n    } else if (area instanceof PolygonArea) {\n      return CollisionJumpTable.CollideCirclePolygon(this, area);\n    } else if (area instanceof EdgeArea) {\n      return CollisionJumpTable.CollideCircleEdge(this, area);\n    } else {\n      throw new Error(`Circle could not collide with unknown ICollisionArea ${typeof area}`);\n    }\n  }\n\n  /**\n   * Find the point on the shape furthest in the direction specified\n   */\n  public getFurthestPoint(direction: Vector): Vector {\n    return this.getCenter().add(direction.normalize().scale(this.radius));\n  }\n\n  /**\n   * Get the axis aligned bounding box for the circle area\n   */\n  public getBounds(): BoundingBox {\n    return new BoundingBox(\n      this.pos.x + this.body.pos.x - this.radius,\n      this.pos.y + this.body.pos.y - this.radius,\n      this.pos.x + this.body.pos.x + this.radius,\n      this.pos.y + this.body.pos.y + this.radius\n    );\n  }\n\n  /**\n   * Get axis not implemented on circles, since there are infinite axis in a circle\n   */\n  public getAxes(): Vector[] {\n    return null;\n  }\n\n  /**\n   * Returns the moment of inertia of a circle given it's mass\n   * https://en.wikipedia.org/wiki/List_of_moments_of_inertia\n   */\n  public getMomentOfInertia(): number {\n    var mass = this.body ? this.body.mass : Physics.defaultMass;\n    return (mass * this.radius * this.radius) / 2;\n  }\n\n  /**\n   * Tests the separating axis theorem for circles against polygons\n   */\n  public testSeparatingAxisTheorem(polygon: PolygonArea): Vector {\n    var axes = polygon.getAxes();\n    var pc = polygon.getCenter();\n    // Special SAT with circles\n    var closestPointOnPoly = polygon.getFurthestPoint(this.pos.sub(pc));\n    axes.push(this.pos.sub(closestPointOnPoly).normalize());\n\n    var minOverlap = Number.MAX_VALUE;\n    var minAxis = null;\n    var minIndex = -1;\n    for (var i = 0; i < axes.length; i++) {\n      var proj1 = polygon.project(axes[i]);\n      var proj2 = this.project(axes[i]);\n      var overlap = proj1.getOverlap(proj2);\n      if (overlap <= 0) {\n        return null;\n      } else {\n        if (overlap < minOverlap) {\n          minOverlap = overlap;\n          minAxis = axes[i];\n          minIndex = i;\n        }\n      }\n    }\n    if (minIndex < 0) {\n      return null;\n    }\n    return minAxis.normalize().scale(minOverlap);\n  }\n\n  /* istanbul ignore next */\n  public recalc(): void {\n    // circles don't cache\n  }\n\n  /**\n   * Project the circle along a specified axis\n   */\n  public project(axis: Vector): Projection {\n    var scalars = [];\n    var point = this.getCenter();\n    var dotProduct = point.dot(axis);\n    scalars.push(dotProduct);\n    scalars.push(dotProduct + this.radius);\n    scalars.push(dotProduct - this.radius);\n    return new Projection(Math.min.apply(Math, scalars), Math.max.apply(Math, scalars));\n  }\n\n  /* istanbul ignore next */\n  public debugDraw(ctx: CanvasRenderingContext2D, color: Color = Color.Green.clone()) {\n    var pos = this.body ? this.body.pos.add(this.pos) : this.pos;\n    var rotation = this.body ? this.body.rotation : 0;\n\n    ctx.beginPath();\n    ctx.strokeStyle = color.toString();\n    ctx.arc(pos.x, pos.y, this.radius, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.stroke();\n    ctx.beginPath();\n    ctx.moveTo(pos.x, pos.y);\n    ctx.lineTo(Math.cos(rotation) * this.radius + pos.x, Math.sin(rotation) * this.radius + pos.y);\n    ctx.closePath();\n    ctx.stroke();\n  }\n}\n","import { ICollisionArea } from './ICollisionArea';\nimport { Body } from './Body';\n\nimport { Actor, CollisionType } from '../Actor';\nimport { Vector } from '../Algebra';\nimport { Physics, CollisionResolutionStrategy } from '../Physics';\nimport { PostCollisionEvent, PreCollisionEvent } from '../Events';\nimport * as Util from '../Util/Util';\n\n/**\n * Collision contacts are used internally by Excalibur to resolve collision between actors. This\n * Pair prevents collisions from being evaluated more than one time\n */\nexport class CollisionContact {\n  /**\n   * The id of this collision contact\n   */\n  id: string;\n  /**\n   * The first rigid body in the collision\n   */\n  bodyA: ICollisionArea;\n  /**\n   * The second rigid body in the collision\n   */\n  bodyB: ICollisionArea;\n  /**\n   * The minimum translation vector to resolve penetration, pointing away from bodyA\n   */\n  mtv: Vector;\n  /**\n   * The point of collision shared between bodyA and bodyB\n   */\n  point: Vector;\n  /**\n   * The collision normal, pointing away from bodyA\n   */\n  normal: Vector;\n\n  constructor(bodyA: ICollisionArea, bodyB: ICollisionArea, mtv: Vector, point: Vector, normal: Vector) {\n    this.bodyA = bodyA;\n    this.bodyB = bodyB;\n    this.mtv = mtv;\n    this.point = point;\n    this.normal = normal;\n  }\n\n  resolve(strategy: CollisionResolutionStrategy) {\n    if (strategy === CollisionResolutionStrategy.RigidBody) {\n      this._resolveRigidBodyCollision();\n    } else if (strategy === CollisionResolutionStrategy.Box) {\n      this._resolveBoxCollision();\n    } else {\n      throw new Error('Unknown collision resolution strategy');\n    }\n  }\n\n  private _applyBoxImpulse(bodyA: Actor, bodyB: Actor, mtv: Vector) {\n    if (bodyA.collisionType === CollisionType.Active && bodyB.collisionType !== CollisionType.Passive) {\n      // Resolve overlaps\n      if (bodyA.collisionType === CollisionType.Active && bodyB.collisionType === CollisionType.Active) {\n        // split overlaps if both are Active\n        mtv = mtv.scale(0.5);\n      }\n      // Apply mtv\n      bodyA.pos.y += mtv.y;\n      bodyA.pos.x += mtv.x;\n\n      let mtvDir = mtv.normalize();\n\n      // only adjust if velocity is opposite\n      if (mtvDir.dot(bodyA.vel) < 0) {\n        // Cancel out velocity in direction of mtv\n        let velAdj = mtvDir.scale(mtvDir.dot(bodyA.vel.negate()));\n\n        bodyA.vel = bodyA.vel.add(velAdj);\n      }\n\n      bodyA.emit('postcollision', new PostCollisionEvent(bodyA, bodyB, Util.getSideFromVector(mtv), mtv));\n    }\n  }\n\n  private _resolveBoxCollision() {\n    var bodyA = this.bodyA.body.actor;\n    var bodyB = this.bodyB.body.actor;\n    var side = Util.getSideFromVector(this.mtv);\n    var mtv = this.mtv.negate();\n    // Publish collision events on both participants\n    bodyA.emit('precollision', new PreCollisionEvent(bodyA, bodyB, side, mtv));\n    bodyB.emit('precollision', new PreCollisionEvent(bodyB, bodyA, Util.getOppositeSide(side), mtv.negate()));\n\n    this._applyBoxImpulse(bodyA, bodyB, mtv);\n    this._applyBoxImpulse(bodyB, bodyA, mtv.negate());\n  }\n\n  private _resolveRigidBodyCollision() {\n    // perform collison on bounding areas\n    var bodyA: Body = this.bodyA.body;\n    var bodyB: Body = this.bodyB.body;\n    var mtv = this.mtv; // normal pointing away from bodyA\n    var normal = this.normal; // normal pointing away from bodyA\n    if (bodyA.actor === bodyB.actor) {\n      // sanity check for existing pairs\n      return;\n    }\n\n    // Publish collision events on both participants\n    var side = Util.getSideFromVector(this.mtv);\n    bodyA.actor.emit('precollision', new PreCollisionEvent(this.bodyA.body.actor, this.bodyB.body.actor, side, this.mtv));\n    bodyB.actor.emit(\n      'precollision',\n      new PreCollisionEvent(this.bodyB.body.actor, this.bodyA.body.actor, Util.getOppositeSide(side), this.mtv.negate())\n    );\n\n    // If any of the participants are passive then short circuit\n    if (bodyA.actor.collisionType === CollisionType.Passive || bodyB.actor.collisionType === CollisionType.Passive) {\n      return;\n    }\n\n    var invMassA = bodyA.actor.collisionType === CollisionType.Fixed ? 0 : 1 / bodyA.mass;\n    var invMassB = bodyB.actor.collisionType === CollisionType.Fixed ? 0 : 1 / bodyB.mass;\n\n    var invMoiA = bodyA.actor.collisionType === CollisionType.Fixed ? 0 : 1 / bodyA.moi;\n    var invMoiB = bodyB.actor.collisionType === CollisionType.Fixed ? 0 : 1 / bodyB.moi;\n\n    // average restitution more relistic\n    var coefRestitution = Math.min(bodyA.restitution, bodyB.restitution);\n\n    var coefFriction = Math.min(bodyA.friction, bodyB.friction);\n\n    normal = normal.normalize();\n    var tangent = normal.normal().normalize();\n\n    var ra = this.point.sub(this.bodyA.getCenter()); // point relative to bodyA position\n    var rb = this.point.sub(this.bodyB.getCenter()); /// point relative to bodyB\n\n    // Relative velocity in linear terms\n    // Angular to linear velocity formula -> omega = v/r\n    var rv = bodyB.vel.add(rb.cross(-bodyB.rx)).sub(bodyA.vel.sub(ra.cross(bodyA.rx)));\n    var rvNormal = rv.dot(normal);\n    var rvTangent = rv.dot(tangent);\n\n    var raTangent = ra.dot(tangent);\n    var raNormal = ra.dot(normal);\n\n    var rbTangent = rb.dot(tangent);\n    var rbNormal = rb.dot(normal);\n\n    // If objects are moving away ignore\n    if (rvNormal > 0) {\n      return;\n    }\n\n    // Collision impulse formula from Chris Hecker\n    // https://en.wikipedia.org/wiki/Collision_response\n    var impulse =\n      -((1 + coefRestitution) * rvNormal) / (invMassA + invMassB + invMoiA * raTangent * raTangent + invMoiB * rbTangent * rbTangent);\n\n    if (bodyA.actor.collisionType === CollisionType.Fixed) {\n      bodyB.vel = bodyB.vel.add(normal.scale(impulse * invMassB));\n      if (Physics.allowRigidBodyRotation) {\n        bodyB.rx -= impulse * invMoiB * -rb.cross(normal);\n      }\n      bodyB.addMtv(mtv);\n    } else if (bodyB.actor.collisionType === CollisionType.Fixed) {\n      bodyA.vel = bodyA.vel.sub(normal.scale(impulse * invMassA));\n      if (Physics.allowRigidBodyRotation) {\n        bodyA.rx += impulse * invMoiA * -ra.cross(normal);\n      }\n      bodyA.addMtv(mtv.negate());\n    } else {\n      bodyB.vel = bodyB.vel.add(normal.scale(impulse * invMassB));\n      bodyA.vel = bodyA.vel.sub(normal.scale(impulse * invMassA));\n\n      if (Physics.allowRigidBodyRotation) {\n        bodyB.rx -= impulse * invMoiB * -rb.cross(normal);\n        bodyA.rx += impulse * invMoiA * -ra.cross(normal);\n      }\n\n      // Split the mtv in half for the two bodies, potentially we could do something smarter here\n      bodyB.addMtv(mtv.scale(0.5));\n      bodyA.addMtv(mtv.scale(-0.5));\n    }\n\n    // Friction portion of impulse\n    if (coefFriction && rvTangent) {\n      // Columb model of friction, formula for impulse due to friction from\n      // https://en.wikipedia.org/wiki/Collision_response\n\n      // tangent force exerted by body on another in contact\n      var t = rv.sub(normal.scale(rv.dot(normal))).normalize();\n\n      // impulse in the direction of tangent force\n      var jt = rv.dot(t) / (invMassA + invMassB + raNormal * raNormal * invMoiA + rbNormal * rbNormal * invMoiB);\n\n      var frictionImpulse = new Vector(0, 0);\n      if (Math.abs(jt) <= impulse * coefFriction) {\n        frictionImpulse = t.scale(jt).negate();\n      } else {\n        frictionImpulse = t.scale(-impulse * coefFriction);\n      }\n\n      if (bodyA.actor.collisionType === CollisionType.Fixed) {\n        // apply frictional impulse\n        bodyB.vel = bodyB.vel.add(frictionImpulse.scale(invMassB));\n        if (Physics.allowRigidBodyRotation) {\n          bodyB.rx += frictionImpulse.dot(t) * invMoiB * rb.cross(t);\n        }\n      } else if (bodyB.actor.collisionType === CollisionType.Fixed) {\n        // apply frictional impulse\n        bodyA.vel = bodyA.vel.sub(frictionImpulse.scale(invMassA));\n        if (Physics.allowRigidBodyRotation) {\n          bodyA.rx -= frictionImpulse.dot(t) * invMoiA * ra.cross(t);\n        }\n      } else {\n        // apply frictional impulse\n        bodyB.vel = bodyB.vel.add(frictionImpulse.scale(invMassB));\n        bodyA.vel = bodyA.vel.sub(frictionImpulse.scale(invMassA));\n\n        // apply frictional impulse\n        if (Physics.allowRigidBodyRotation) {\n          bodyB.rx += frictionImpulse.dot(t) * invMoiB * rb.cross(t);\n          bodyA.rx -= frictionImpulse.dot(t) * invMoiA * ra.cross(t);\n        }\n      }\n    }\n\n    bodyA.actor.emit('postcollision', new PostCollisionEvent(this.bodyA.body.actor, this.bodyB.body.actor, side, this.mtv));\n    bodyB.actor.emit(\n      'postcollision',\n      new PostCollisionEvent(this.bodyB.body.actor, this.bodyA.body.actor, Util.getOppositeSide(side), this.mtv.negate())\n    );\n  }\n}\n","import { CircleArea } from './CircleArea';\nimport { CollisionContact } from './CollisionContact';\nimport { PolygonArea } from './PolygonArea';\nimport { EdgeArea } from './EdgeArea';\n\nimport { Vector } from '../Algebra';\n\nexport var CollisionJumpTable = {\n  CollideCircleCircle(circleA: CircleArea, circleB: CircleArea): CollisionContact {\n    var radius = circleA.radius + circleB.radius;\n    var circleAPos = circleA.body.pos.add(circleA.pos);\n    var circleBPos = circleB.body.pos.add(circleB.pos);\n    if (circleAPos.distance(circleBPos) > radius) {\n      return null;\n    }\n\n    var axisOfCollision = circleBPos.sub(circleAPos).normalize();\n    var mvt = axisOfCollision.scale(radius - circleBPos.distance(circleAPos));\n\n    var pointOfCollision = circleA.getFurthestPoint(axisOfCollision);\n\n    return new CollisionContact(circleA, circleB, mvt, pointOfCollision, axisOfCollision);\n  },\n\n  CollideCirclePolygon(circle: CircleArea, polygon: PolygonArea): CollisionContact {\n    var minAxis = circle.testSeparatingAxisTheorem(polygon);\n    if (!minAxis) {\n      return null;\n    }\n\n    // make sure that the minAxis is pointing away from circle\n    var samedir = minAxis.dot(polygon.getCenter().sub(circle.getCenter()));\n    minAxis = samedir < 0 ? minAxis.negate() : minAxis;\n\n    var verts: Vector[] = [];\n\n    var point1 = polygon.getFurthestPoint(minAxis.negate());\n    var point2 = circle.getFurthestPoint(minAxis); //.add(cc);\n    if (circle.contains(point1)) {\n      verts.push(point1);\n    }\n    if (polygon.contains(point2)) {\n      verts.push(point2);\n    }\n    if (verts.length === 0) {\n      return null;\n    }\n\n    return new CollisionContact(circle, polygon, minAxis, verts.length === 2 ? verts[0].average(verts[1]) : verts[0], minAxis.normalize());\n  },\n\n  CollideCircleEdge(circle: CircleArea, edge: EdgeArea): CollisionContact {\n    // center of the circle\n    var cc = circle.getCenter();\n    // vector in the direction of the edge\n    var e = edge.end.sub(edge.begin);\n\n    // amount of overlap with the circle's center along the edge direction\n    var u = e.dot(edge.end.sub(cc));\n    var v = e.dot(cc.sub(edge.begin));\n\n    // Potential region A collision (circle is on the left side of the edge, before the beginning)\n    if (v <= 0) {\n      var da = edge.begin.sub(cc);\n      var dda = da.dot(da); // quick and dirty way of calc'n distance in r^2 terms saves some sqrts\n      // save some sqrts\n      if (dda > circle.radius * circle.radius) {\n        return null; // no collision\n      }\n      return new CollisionContact(circle, edge, da.normalize().scale(circle.radius - Math.sqrt(dda)), edge.begin, da.normalize());\n    }\n\n    // Potential region B collision (circle is on the right side of the edge, after the end)\n    if (u <= 0) {\n      var db = edge.end.sub(cc);\n      var ddb = db.dot(db);\n      if (ddb > circle.radius * circle.radius) {\n        return null;\n      }\n      return new CollisionContact(circle, edge, db.normalize().scale(circle.radius - Math.sqrt(ddb)), edge.end, db.normalize());\n    }\n\n    // Otherwise potential region AB collision (circle is in the middle of the edge between the beginning and end)\n    var den = e.dot(e);\n    var pointOnEdge = edge.begin\n      .scale(u)\n      .add(edge.end.scale(v))\n      .scale(1 / den);\n    var d = cc.sub(pointOnEdge);\n\n    var dd = d.dot(d);\n    if (dd > circle.radius * circle.radius) {\n      return null; // no collision\n    }\n\n    var n = e.perpendicular();\n    // flip correct direction\n    if (n.dot(cc.sub(edge.begin)) < 0) {\n      n.x = -n.x;\n      n.y = -n.y;\n    }\n\n    n = n.normalize();\n\n    var mvt = n.scale(Math.abs(circle.radius - Math.sqrt(dd)));\n    return new CollisionContact(circle, edge, mvt.negate(), pointOnEdge, n.negate());\n  },\n\n  CollideEdgeEdge(): CollisionContact {\n    // Edge-edge collision doesn't make sense\n    return null;\n  },\n\n  CollidePolygonEdge(polygon: PolygonArea, edge: EdgeArea): CollisionContact {\n    // 3 cases:\n    // (1) Polygon lands on the full face\n    // (2) Polygon lands on the right point\n    // (3) Polygon lands on the left point\n\n    let e = edge.end.sub(edge.begin);\n    let edgeNormal = e.normal();\n\n    if (polygon.contains(edge.begin)) {\n      let { distance: mtv, face } = polygon.getClosestFace(edge.begin);\n      if (mtv) {\n        return new CollisionContact(polygon, edge, mtv.negate(), edge.begin.add(mtv.negate()), face.normal().negate());\n      }\n    }\n\n    if (polygon.contains(edge.end)) {\n      let { distance: mtv, face } = polygon.getClosestFace(edge.end);\n      if (mtv) {\n        return new CollisionContact(polygon, edge, mtv.negate(), edge.end.add(mtv.negate()), face.normal().negate());\n      }\n    }\n\n    let pc = polygon.getCenter();\n    let ec = edge.getCenter();\n    let dir = ec.sub(pc).normalize();\n\n    // build a temporary polygon from the edge to use SAT\n    var linePoly = new PolygonArea({\n      points: [edge.begin, edge.end, edge.end.add(dir.scale(30)), edge.begin.add(dir.scale(30))]\n    });\n\n    var minAxis = polygon.testSeparatingAxisTheorem(linePoly);\n\n    // no minAxis, no overlap, no collision\n    if (!minAxis) {\n      return null;\n    }\n\n    // flip the normal and axis to always have positive collisions\n    edgeNormal = edgeNormal.dot(dir) < 0 ? edgeNormal.negate() : edgeNormal;\n    minAxis = minAxis.dot(dir) < 0 ? minAxis.negate() : minAxis;\n\n    return new CollisionContact(polygon, edge, minAxis, polygon.getFurthestPoint(edgeNormal), edgeNormal);\n  },\n\n  CollidePolygonPolygon(polyA: PolygonArea, polyB: PolygonArea): CollisionContact {\n    // do a SAT test to find a min axis if it exists\n    var minAxis = polyA.testSeparatingAxisTheorem(polyB);\n\n    // no overlap, no collision return null\n    if (!minAxis) {\n      return null;\n    }\n\n    // make sure that minAxis is pointing from A -> B\n    var sameDir = minAxis.dot(polyB.getCenter().sub(polyA.getCenter()));\n    minAxis = sameDir < 0 ? minAxis.negate() : minAxis;\n\n    // find rough point of collision\n    // todo this could be better\n    var verts: Vector[] = [];\n    var pointA = polyA.getFurthestPoint(minAxis);\n    var pointB = polyB.getFurthestPoint(minAxis.negate());\n\n    if (polyB.contains(pointA)) {\n      verts.push(pointA);\n    }\n\n    if (polyA.contains(pointB)) {\n      verts.push(pointB);\n    }\n    // no candidates, pick something\n    if (verts.length === 0) {\n      verts.push(pointB);\n    }\n\n    var contact = verts.length === 2 ? verts[0].add(verts[1]).scale(0.5) : verts[0];\n\n    return new CollisionContact(polyA, polyB, minAxis, contact, minAxis.normalize());\n  }\n};\n","import { Physics } from './../Physics';\nimport { BoundingBox } from './BoundingBox';\nimport { Body } from './Body';\n\nimport { Ray } from '../Algebra';\nimport { Logger } from '../Util/Log';\n\n/**\n * Dynamic Tree Node used for tracking bounds within the tree\n */\nexport class TreeNode {\n  public left: TreeNode;\n  public right: TreeNode;\n  public bounds: BoundingBox;\n  public height: number;\n  public body: Body;\n  constructor(public parent?: TreeNode) {\n    this.parent = parent || null;\n    this.body = null;\n    this.bounds = new BoundingBox();\n    this.left = null;\n    this.right = null;\n    this.height = 0;\n  }\n\n  public isLeaf(): boolean {\n    return !this.left && !this.right;\n  }\n}\n\n/**\n * The DynamicTrees provides a spatial partiioning data structure for quickly querying for overlapping bounding boxes for\n * all tracked bodies. The worst case performance of this is O(n*log(n)) where n is the number of bodies in the tree.\n *\n * Internally the bounding boxes are organized as a balanced binary tree of bounding boxes, where the leaf nodes are tracked bodies.\n * Every non-leaf node is a bounding box that contains child bounding boxes.\n */\nexport class DynamicTree {\n  public root: TreeNode;\n  public nodes: { [key: number]: TreeNode };\n  constructor(public worldBounds: BoundingBox = new BoundingBox(-Number.MAX_VALUE, -Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE)) {\n    this.root = null;\n    this.nodes = {};\n  }\n\n  /**\n   * Inserts a node into the dynamic tree\n   */\n  private _insert(leaf: TreeNode): void {\n    // If there are no nodes in the tree, make this the root leaf\n    if (this.root === null) {\n      this.root = leaf;\n      this.root.parent = null;\n      return;\n    }\n\n    // Search the tree for a node that is not a leaf and find the best place to insert\n    var leafAABB = leaf.bounds;\n    var currentRoot = this.root;\n    while (!currentRoot.isLeaf()) {\n      var left = currentRoot.left;\n      var right = currentRoot.right;\n\n      var area = currentRoot.bounds.getPerimeter();\n      var combinedAABB = currentRoot.bounds.combine(leafAABB);\n      var combinedArea = combinedAABB.getPerimeter();\n\n      // Calculate cost heuristic for creating a new parent and leaf\n      var cost = 2 * combinedArea;\n\n      // Minimum cost of pushing the leaf down the tree\n      var inheritanceCost = 2 * (combinedArea - area);\n\n      // Cost of descending\n      var leftCost = 0;\n      var leftCombined = leafAABB.combine(left.bounds);\n      var newArea;\n      var oldArea;\n      if (left.isLeaf()) {\n        leftCost = leftCombined.getPerimeter() + inheritanceCost;\n      } else {\n        oldArea = left.bounds.getPerimeter();\n        newArea = leftCombined.getPerimeter();\n        leftCost = newArea - oldArea + inheritanceCost;\n      }\n\n      var rightCost = 0;\n      var rightCombined = leafAABB.combine(right.bounds);\n      if (right.isLeaf()) {\n        rightCost = rightCombined.getPerimeter() + inheritanceCost;\n      } else {\n        oldArea = right.bounds.getPerimeter();\n        newArea = rightCombined.getPerimeter();\n        rightCost = newArea - oldArea + inheritanceCost;\n      }\n\n      // cost is acceptable\n      if (cost < leftCost && cost < rightCost) {\n        break;\n      }\n\n      // Descend to the depths\n      if (leftCost < rightCost) {\n        currentRoot = left;\n      } else {\n        currentRoot = right;\n      }\n    }\n\n    // Create the new parent node and insert into the tree\n    var oldParent = currentRoot.parent;\n    var newParent = new TreeNode(oldParent);\n    newParent.bounds = leafAABB.combine(currentRoot.bounds);\n    newParent.height = currentRoot.height + 1;\n\n    if (oldParent !== null) {\n      // The sibling node was not the root\n      if (oldParent.left === currentRoot) {\n        oldParent.left = newParent;\n      } else {\n        oldParent.right = newParent;\n      }\n\n      newParent.left = currentRoot;\n      newParent.right = leaf;\n\n      currentRoot.parent = newParent;\n      leaf.parent = newParent;\n    } else {\n      // The sibling node was the root\n      newParent.left = currentRoot;\n      newParent.right = leaf;\n\n      currentRoot.parent = newParent;\n      leaf.parent = newParent;\n      this.root = newParent;\n    }\n\n    // Walk up the tree fixing heights and AABBs\n    var currentNode = leaf.parent;\n    while (currentNode) {\n      currentNode = this._balance(currentNode);\n\n      if (!currentNode.left) {\n        throw new Error('Parent of current leaf cannot have a null left child' + currentNode);\n      }\n      if (!currentNode.right) {\n        throw new Error('Parent of current leaf cannot have a null right child' + currentNode);\n      }\n\n      currentNode.height = 1 + Math.max(currentNode.left.height, currentNode.right.height);\n      currentNode.bounds = currentNode.left.bounds.combine(currentNode.right.bounds);\n\n      currentNode = currentNode.parent;\n    }\n  }\n\n  /**\n   * Removes a node from the dynamic tree\n   */\n  private _remove(leaf: TreeNode) {\n    if (leaf === this.root) {\n      this.root = null;\n      return;\n    }\n\n    var parent = leaf.parent;\n    var grandParent = parent.parent;\n    var sibling: TreeNode;\n    if (parent.left === leaf) {\n      sibling = parent.right;\n    } else {\n      sibling = parent.left;\n    }\n\n    if (grandParent) {\n      if (grandParent.left === parent) {\n        grandParent.left = sibling;\n      } else {\n        grandParent.right = sibling;\n      }\n      sibling.parent = grandParent;\n\n      var currentNode = grandParent;\n      while (currentNode) {\n        currentNode = this._balance(currentNode);\n        currentNode.bounds = currentNode.left.bounds.combine(currentNode.right.bounds);\n        currentNode.height = 1 + Math.max(currentNode.left.height, currentNode.right.height);\n\n        currentNode = currentNode.parent;\n      }\n    } else {\n      this.root = sibling;\n      sibling.parent = null;\n    }\n  }\n\n  /**\n   * Tracks a body in the dynamic tree\n   */\n  public trackBody(body: Body) {\n    var node = new TreeNode();\n    node.body = body;\n    node.bounds = body.getBounds();\n    node.bounds.left -= 2;\n    node.bounds.top -= 2;\n    node.bounds.right += 2;\n    node.bounds.bottom += 2;\n    this.nodes[body.actor.id] = node;\n    this._insert(node);\n  }\n\n  /**\n   * Updates the dynamic tree given the current bounds of each body being tracked\n   */\n  public updateBody(body: Body) {\n    var node = this.nodes[body.actor.id];\n    if (!node) {\n      return false;\n    }\n    var b = body.getBounds();\n\n    // if the body is outside the world no longer update it\n    if (!this.worldBounds.contains(b)) {\n      Logger.getInstance().warn(\n        'Actor with id ' + body.actor.id + ' is outside the world bounds and will no longer be tracked for physics'\n      );\n      this.untrackBody(body);\n      return false;\n    }\n\n    if (node.bounds.contains(b)) {\n      return false;\n    }\n\n    this._remove(node);\n    b.left -= Physics.boundsPadding;\n    b.top -= Physics.boundsPadding;\n    b.right += Physics.boundsPadding;\n    b.bottom += Physics.boundsPadding;\n\n    var multdx = body.vel.x * Physics.dynamicTreeVelocityMultiplyer;\n    var multdy = body.vel.y * Physics.dynamicTreeVelocityMultiplyer;\n\n    if (multdx < 0) {\n      b.left += multdx;\n    } else {\n      b.right += multdx;\n    }\n\n    if (multdy < 0) {\n      b.top += multdy;\n    } else {\n      b.bottom += multdy;\n    }\n\n    node.bounds = b;\n    this._insert(node);\n    return true;\n  }\n\n  /**\n   * Untracks a body from the dynamic tree\n   */\n  public untrackBody(body: Body) {\n    var node = this.nodes[body.actor.id];\n    if (!node) {\n      return;\n    }\n    this._remove(node);\n    this.nodes[body.actor.id] = null;\n    delete this.nodes[body.actor.id];\n  }\n\n  /**\n   * Balances the tree about a node\n   */\n  private _balance(node: TreeNode) {\n    if (node === null) {\n      throw new Error('Cannot balance at null node');\n    }\n\n    if (node.isLeaf() || node.height < 2) {\n      return node;\n    }\n\n    var left = node.left;\n    var right = node.right;\n\n    var a = node;\n    var b = left;\n    var c = right;\n    var d = left.left;\n    var e = left.right;\n    var f = right.left;\n    var g = right.right;\n\n    var balance = c.height - b.height;\n    // Rotate c node up\n    if (balance > 1) {\n      // Swap the right node with it's parent\n      c.left = a;\n      c.parent = a.parent;\n      a.parent = c;\n\n      // The original node's old parent should point to the right node\n      // this is mega confusing\n      if (c.parent) {\n        if (c.parent.left === a) {\n          c.parent.left = c;\n        } else {\n          c.parent.right = c;\n        }\n      } else {\n        this.root = c;\n      }\n\n      // Rotate\n      if (f.height > g.height) {\n        c.right = f;\n        a.right = g;\n        g.parent = a;\n\n        a.bounds = b.bounds.combine(g.bounds);\n        c.bounds = a.bounds.combine(f.bounds);\n\n        a.height = 1 + Math.max(b.height, g.height);\n        c.height = 1 + Math.max(a.height, f.height);\n      } else {\n        c.right = g;\n        a.right = f;\n        f.parent = a;\n\n        a.bounds = b.bounds.combine(f.bounds);\n        c.bounds = a.bounds.combine(g.bounds);\n\n        a.height = 1 + Math.max(b.height, f.height);\n        c.height = 1 + Math.max(a.height, g.height);\n      }\n\n      return c;\n    }\n    // Rotate left node up\n    if (balance < -1) {\n      // swap\n      b.left = a;\n      b.parent = a.parent;\n      a.parent = b;\n\n      // node's old parent should point to b\n      if (b.parent) {\n        if (b.parent.left === a) {\n          b.parent.left = b;\n        } else {\n          if (b.parent.right !== a) {\n            throw 'Error rotating Dynamic Tree';\n          }\n          b.parent.right = b;\n        }\n      } else {\n        this.root = b;\n      }\n\n      // rotate\n      if (d.height > e.height) {\n        b.right = d;\n        a.left = e;\n        e.parent = a;\n\n        a.bounds = c.bounds.combine(e.bounds);\n        b.bounds = a.bounds.combine(d.bounds);\n\n        a.height = 1 + Math.max(c.height, e.height);\n        b.height = 1 + Math.max(a.height, d.height);\n      } else {\n        b.right = e;\n        a.left = d;\n        d.parent = a;\n\n        a.bounds = c.bounds.combine(d.bounds);\n        b.bounds = a.bounds.combine(e.bounds);\n\n        a.height = 1 + Math.max(c.height, d.height);\n        b.height = 1 + Math.max(a.height, e.height);\n      }\n      return b;\n    }\n\n    return node;\n  }\n\n  /**\n   * Returns the internal height of the tree, shorter trees are better. Performance drops as the tree grows\n   */\n  public getHeight(): number {\n    if (this.root === null) {\n      return 0;\n    }\n    return this.root.height;\n  }\n\n  /**\n   * Queries the Dynamic Axis Aligned Tree for bodies that could be colliding with the provided body.\n   *\n   * In the query callback, it will be passed a potential collider. Returning true from this callback indicates\n   * that you are complete with your query and you do not want to continue. Returning false will continue searching\n   * the tree until all possible colliders have been returned.\n   */\n  public query(body: Body, callback: (other: Body) => boolean): void {\n    var bounds = body.getBounds();\n    var helper = (currentNode: TreeNode): boolean => {\n      if (currentNode && currentNode.bounds.collides(bounds)) {\n        if (currentNode.isLeaf() && currentNode.body !== body) {\n          if (callback.call(body, currentNode.body)) {\n            return true;\n          }\n        } else {\n          return helper(currentNode.left) || helper(currentNode.right);\n        }\n      }\n      return false;\n    };\n    helper(this.root);\n  }\n\n  /**\n   * Queries the Dynamic Axis Aligned Tree for bodies that could be intersecting. By default the raycast query uses an infinitely\n   * long ray to test the tree specified by `max`.\n   *\n   * In the query callback, it will be passed a potential body that intersects with the racast. Returning true from this\n   * callback indicates that your are complete with your query and do not want to continue. Return false will continue searching\n   * the tree until all possible bodies that would intersect with the ray have been returned.\n   */\n  public rayCastQuery(ray: Ray, max: number = Infinity, callback: (other: Body) => boolean): void {\n    var helper = (currentNode: TreeNode): boolean => {\n      if (currentNode && currentNode.bounds.rayCast(ray, max)) {\n        if (currentNode.isLeaf()) {\n          if (callback.call(ray, currentNode.body)) {\n            // ray hit a leaf! return the body\n            return true;\n          }\n        } else {\n          // ray hit but not at a leaf, recurse deeper\n          return helper(currentNode.left) || helper(currentNode.right);\n        }\n      }\n      return false; // ray missed\n    };\n    helper(this.root);\n  }\n\n  public getNodes(): TreeNode[] {\n    var helper = (currentNode: TreeNode): TreeNode[] => {\n      if (currentNode) {\n        return [currentNode].concat(helper(currentNode.left), helper(currentNode.right));\n      } else {\n        return [];\n      }\n    };\n    return helper(this.root);\n  }\n\n  public debugDraw(ctx: CanvasRenderingContext2D) {\n    // draw all the nodes in the Dynamic Tree\n    var helper = (currentNode: TreeNode) => {\n      if (currentNode) {\n        if (currentNode.isLeaf()) {\n          ctx.lineWidth = 1;\n          ctx.strokeStyle = 'green';\n        } else {\n          ctx.lineWidth = 1;\n          ctx.strokeStyle = 'white';\n        }\n        currentNode.bounds.debugDraw(ctx);\n\n        if (currentNode.left) {\n          helper(currentNode.left);\n        }\n        if (currentNode.right) {\n          helper(currentNode.right);\n        }\n      }\n    };\n\n    helper(this.root);\n  }\n}\n","import { Physics } from './../Physics';\nimport { ICollisionBroadphase } from './ICollisionResolver';\nimport { DynamicTree } from './DynamicTree';\nimport { Pair } from './Pair';\nimport { Body } from './Body';\n\nimport { Vector, Ray } from '../Algebra';\nimport { Actor, CollisionType } from '../Actor';\nimport { FrameStats } from '../Debug';\nimport { CollisionResolutionStrategy } from '../Physics';\nimport { Logger } from '../Util/Log';\nimport { CollisionStartEvent, CollisionEndEvent } from '../Events';\n\nexport class DynamicTreeCollisionBroadphase implements ICollisionBroadphase {\n  private _dynamicCollisionTree = new DynamicTree();\n  private _collisionHash: { [key: string]: boolean } = {};\n  private _collisionPairCache: Pair[] = [];\n  private _lastFramePairs: Pair[] = [];\n  private _lastFramePairsHash: { [pairId: string]: Pair } = {};\n\n  /**\n   * Tracks a physics body for collisions\n   */\n  public track(target: Body): void {\n    if (!target) {\n      Logger.getInstance().warn('Cannot track null physics body');\n      return;\n    }\n    this._dynamicCollisionTree.trackBody(target);\n  }\n\n  /**\n   * Untracks a physics body\n   */\n  public untrack(target: Body): void {\n    if (!target) {\n      Logger.getInstance().warn('Cannot untrack a null physics body');\n      return;\n    }\n    this._dynamicCollisionTree.untrackBody(target);\n  }\n\n  private _shouldGenerateCollisionPair(actorA: Actor, actorB: Actor) {\n    // if the collision pair has been calculated already short circuit\n    var hash = Pair.calculatePairHash(actorA.body, actorB.body);\n    if (this._collisionHash[hash]) {\n      return false; // pair exists easy exit return false\n    }\n\n    return Pair.canCollide(actorA, actorB);\n  }\n\n  /**\n   * Detects potential collision pairs in a broadphase approach with the dynamic aabb tree strategy\n   */\n  public broadphase(targets: Actor[], delta: number, stats?: FrameStats): Pair[] {\n    var seconds = delta / 1000;\n    // TODO optimization use only the actors that are moving to start\n    // Retrieve the list of potential colliders, exclude killed, prevented, and self\n    var potentialColliders = targets.filter((other) => {\n      return !other.isKilled() && other.collisionType !== CollisionType.PreventCollision;\n    });\n\n    // clear old list of collision pairs\n    this._collisionPairCache = [];\n    this._collisionHash = {};\n\n    // check for normal collision pairs\n    var actor: Actor;\n    for (var j = 0, l = potentialColliders.length; j < l; j++) {\n      actor = potentialColliders[j];\n\n      // Query the collision tree for potential colliders\n      this._dynamicCollisionTree.query(actor.body, (other: Body) => {\n        if (this._shouldGenerateCollisionPair(actor, other.actor)) {\n          var pair = new Pair(actor.body, other);\n          this._collisionHash[pair.id] = true;\n          this._collisionPairCache.push(pair);\n        }\n        // Always return false, to query whole tree. Returning true in the query method stops searching\n        return false;\n      });\n    }\n    if (stats) {\n      stats.physics.pairs = this._collisionPairCache.length;\n    }\n\n    // Check dynamic tree for fast moving objects\n    // Fast moving objects are those moving at least there smallest bound per frame\n    if (Physics.checkForFastBodies) {\n      for (var actor of potentialColliders) {\n        // Skip non-active objects. Does not make sense on other collison types\n        if (actor.collisionType !== CollisionType.Active) {\n          continue;\n        }\n\n        // Maximum travel distance next frame\n        var updateDistance =\n          actor.vel.magnitude() * seconds + // velocity term\n          actor.acc.magnitude() * 0.5 * seconds * seconds; // acc term\n\n        // Find the minimum dimension\n        var minDimension = Math.min(actor.body.getBounds().getHeight(), actor.body.getBounds().getWidth());\n        if (Physics.disableMinimumSpeedForFastBody || updateDistance > minDimension / 2) {\n          if (stats) {\n            stats.physics.fastBodies++;\n          }\n\n          // start with the oldPos because the integration for actors has already happened\n          // objects resting on a surface may be slightly penatrating in the current position\n          var updateVec = actor.pos.sub(actor.oldPos);\n          var centerPoint = actor.body.collisionArea.getCenter();\n          var furthestPoint = actor.body.collisionArea.getFurthestPoint(actor.vel);\n          var origin: Vector = furthestPoint.sub(updateVec);\n\n          var ray: Ray = new Ray(origin, actor.vel);\n\n          // back the ray up by -2x surfaceEpsilon to account for fast moving objects starting on the surface\n          ray.pos = ray.pos.add(ray.dir.scale(-2 * Physics.surfaceEpsilon));\n          var minBody: Body;\n          var minTranslate: Vector = new Vector(Infinity, Infinity);\n          this._dynamicCollisionTree.rayCastQuery(ray, updateDistance + Physics.surfaceEpsilon * 2, (other: Body) => {\n            if (actor.body !== other && other.collisionArea) {\n              var hitPoint = other.collisionArea.rayCast(ray, updateDistance + Physics.surfaceEpsilon * 10);\n              if (hitPoint) {\n                var translate = hitPoint.sub(origin);\n                if (translate.magnitude() < minTranslate.magnitude()) {\n                  minTranslate = translate;\n                  minBody = other;\n                }\n              }\n            }\n            return false;\n          });\n\n          if (minBody && Vector.isValid(minTranslate)) {\n            var pair = new Pair(actor.body, minBody);\n            if (!this._collisionHash[pair.id]) {\n              this._collisionHash[pair.id] = true;\n              this._collisionPairCache.push(pair);\n            }\n            // move the fast moving object to the other body\n            // need to push into the surface by ex.Physics.surfaceEpsilon\n            var shift = centerPoint.sub(furthestPoint);\n            actor.pos = origin\n              .add(shift)\n              .add(minTranslate)\n              .add(ray.dir.scale(2 * Physics.surfaceEpsilon));\n            actor.body.collisionArea.recalc();\n\n            if (stats) {\n              stats.physics.fastBodyCollisions++;\n            }\n          }\n        }\n      }\n    }\n    // return cache\n    return this._collisionPairCache;\n  }\n\n  /**\n   * Applies narrow phase on collision pairs to find actual area intersections\n   * Adds actual colliding pairs to stats' Frame data\n   */\n  public narrowphase(pairs: Pair[], stats?: FrameStats): Pair[] {\n    for (var i = 0; i < pairs.length; i++) {\n      pairs[i].collide();\n      if (stats && pairs[i].collision) {\n        stats.physics.collisions++;\n        stats.physics.collidersHash[pairs[i].id] = pairs[i];\n      }\n    }\n    return pairs.filter((p) => p.collision);\n  }\n\n  /**\n   * Perform collision resolution given a strategy (rigid body or box) and move objects out of intersect.\n   */\n  public resolve(pairs: Pair[], delta: number, strategy: CollisionResolutionStrategy): Pair[] {\n    for (let pair of pairs) {\n      pair.resolve(strategy);\n\n      if (pair.collision) {\n        pair.bodyA.applyMtv();\n        pair.bodyB.applyMtv();\n        // todo still don't like this, this is a small integration step to resolve narrowphase collisions\n        pair.bodyA.actor.integrate(delta * Physics.collisionShift);\n        pair.bodyB.actor.integrate(delta * Physics.collisionShift);\n      }\n    }\n\n    return pairs.filter((p) => p.canCollide);\n  }\n\n  public runCollisionStartEnd(pairs: Pair[]) {\n    let currentFrameHash: { [pairId: string]: Pair } = {};\n\n    for (let p of pairs) {\n      // load currentFrameHash\n      currentFrameHash[p.id] = p;\n\n      // find all new collisions\n      if (!this._lastFramePairsHash[p.id]) {\n        let actor1 = p.bodyA.actor;\n        let actor2 = p.bodyB.actor;\n        actor1.emit('collisionstart', new CollisionStartEvent(actor1, actor2, p));\n        actor2.emit('collisionstart', new CollisionStartEvent(actor2, actor1, p));\n      }\n    }\n\n    // find all old collisions\n    for (let p of this._lastFramePairs) {\n      if (!currentFrameHash[p.id]) {\n        let actor1 = p.bodyA.actor;\n        let actor2 = p.bodyB.actor;\n        actor1.emit('collisionend', new CollisionEndEvent(actor1, actor2));\n        actor2.emit('collisionend', new CollisionEndEvent(actor2, actor1));\n      }\n    }\n\n    // reset the last frame cache\n    this._lastFramePairs = pairs;\n    this._lastFramePairsHash = currentFrameHash;\n  }\n\n  /**\n   * Update the dynamic tree positions\n   */\n  public update(targets: Actor[]): number {\n    var updated = 0,\n      i = 0,\n      len = targets.length;\n\n    for (i; i < len; i++) {\n      if (this._dynamicCollisionTree.updateBody(targets[i].body)) {\n        updated++;\n      }\n    }\n    return updated;\n  }\n\n  /* istanbul ignore next */\n  public debugDraw(ctx: CanvasRenderingContext2D) {\n    if (Physics.broadphaseDebug) {\n      this._dynamicCollisionTree.debugDraw(ctx);\n    }\n\n    if (Physics.showContacts || Physics.showCollisionNormals) {\n      for (var pair of this._collisionPairCache) {\n        pair.debugDraw(ctx);\n      }\n    }\n  }\n}\n","import { Body } from './Body';\nimport { BoundingBox } from './BoundingBox';\nimport { CollisionContact } from './CollisionContact';\nimport { CollisionJumpTable } from './CollisionJumpTable';\nimport { ICollisionArea } from './ICollisionArea';\nimport { CircleArea } from './CircleArea';\nimport { PolygonArea } from './PolygonArea';\n\nimport { Vector, Ray, Projection } from '../Algebra';\nimport { Physics } from '../Physics';\nimport { Color } from '../Drawing/Color';\n\nexport interface IEdgeAreaOptions {\n  begin?: Vector;\n  end?: Vector;\n  body?: Body;\n}\n\nexport class EdgeArea implements ICollisionArea {\n  body: Body;\n  pos: Vector;\n  begin: Vector;\n  end: Vector;\n\n  constructor(options: IEdgeAreaOptions) {\n    this.begin = options.begin || Vector.Zero.clone();\n    this.end = options.end || Vector.Zero.clone();\n    this.body = options.body || null;\n\n    this.pos = this.getCenter();\n  }\n\n  /**\n   * Get the center of the collision area in world coordinates\n   */\n  public getCenter(): Vector {\n    var pos = this.begin.average(this.end).add(this._getBodyPos());\n    return pos;\n  }\n\n  private _getBodyPos(): Vector {\n    var bodyPos = Vector.Zero.clone();\n    if (this.body.pos) {\n      bodyPos = this.body.pos;\n    }\n    return bodyPos;\n  }\n\n  private _getTransformedBegin(): Vector {\n    var angle = this.body ? this.body.rotation : 0;\n    return this.begin.rotate(angle).add(this._getBodyPos());\n  }\n\n  private _getTransformedEnd(): Vector {\n    var angle = this.body ? this.body.rotation : 0;\n    return this.end.rotate(angle).add(this._getBodyPos());\n  }\n\n  /**\n   * Returns the slope of the line in the form of a vector\n   */\n  public getSlope(): Vector {\n    var begin = this._getTransformedBegin();\n    var end = this._getTransformedEnd();\n    var distance = begin.distance(end);\n    return end.sub(begin).scale(1 / distance);\n  }\n\n  /**\n   * Returns the length of the line segment in pixels\n   */\n  public getLength(): number {\n    var begin = this._getTransformedBegin();\n    var end = this._getTransformedEnd();\n    var distance = begin.distance(end);\n    return distance;\n  }\n\n  /**\n   * Tests if a point is contained in this collision area\n   */\n  public contains(): boolean {\n    return false;\n  }\n\n  /**\n   * @inheritdoc\n   */\n  public rayCast(ray: Ray, max: number = Infinity): Vector {\n    var numerator = this._getTransformedBegin().sub(ray.pos);\n\n    // Test is line and ray are parallel and non intersecting\n    if (ray.dir.cross(this.getSlope()) === 0 && numerator.cross(ray.dir) !== 0) {\n      return null;\n    }\n\n    // Lines are parallel\n    var divisor = ray.dir.cross(this.getSlope());\n    if (divisor === 0) {\n      return null;\n    }\n\n    var t = numerator.cross(this.getSlope()) / divisor;\n\n    if (t >= 0 && t <= max) {\n      var u = numerator.cross(ray.dir) / divisor / this.getLength();\n      if (u >= 0 && u <= 1) {\n        return ray.getPoint(t);\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * @inheritdoc\n   */\n  public collide(area: ICollisionArea): CollisionContact {\n    if (area instanceof CircleArea) {\n      return CollisionJumpTable.CollideCircleEdge(area, this);\n    } else if (area instanceof PolygonArea) {\n      return CollisionJumpTable.CollidePolygonEdge(area, this);\n    } else if (area instanceof EdgeArea) {\n      return CollisionJumpTable.CollideEdgeEdge();\n    } else {\n      throw new Error(`Edge could not collide with unknown ICollisionArea ${typeof area}`);\n    }\n  }\n\n  /**\n   * Find the point on the shape furthest in the direction specified\n   */\n  public getFurthestPoint(direction: Vector): Vector {\n    var transformedBegin = this._getTransformedBegin();\n    var transformedEnd = this._getTransformedEnd();\n    if (direction.dot(transformedBegin) > 0) {\n      return transformedBegin;\n    } else {\n      return transformedEnd;\n    }\n  }\n\n  /**\n   * Get the axis aligned bounding box for the circle area\n   */\n  public getBounds(): BoundingBox {\n    var transformedBegin = this._getTransformedBegin();\n    var transformedEnd = this._getTransformedEnd();\n    return new BoundingBox(\n      Math.min(transformedBegin.x, transformedEnd.x),\n      Math.min(transformedBegin.y, transformedEnd.y),\n      Math.max(transformedBegin.x, transformedEnd.x),\n      Math.max(transformedBegin.y, transformedEnd.y)\n    );\n  }\n\n  /**\n   * Get the axis associated with the edge\n   */\n  public getAxes(): Vector[] {\n    var e = this._getTransformedEnd().sub(this._getTransformedBegin());\n    var edgeNormal = e.normal();\n\n    var axes = [];\n    axes.push(edgeNormal);\n    axes.push(edgeNormal.negate());\n    axes.push(edgeNormal.normal());\n    axes.push(edgeNormal.normal().negate());\n    return axes;\n  }\n\n  /**\n   * Get the moment of inertia for an edge\n   * https://en.wikipedia.org/wiki/List_of_moments_of_inertia\n   */\n  public getMomentOfInertia(): number {\n    var mass = this.body ? this.body.mass : Physics.defaultMass;\n    var length = this.end.sub(this.begin).distance() / 2;\n    return mass * length * length;\n  }\n\n  /**\n   * @inheritdoc\n   */\n  public recalc(): void {\n    // edges don't have any cached data\n  }\n\n  /**\n   * Project the edge along a specified axis\n   */\n  public project(axis: Vector): Projection {\n    var scalars = [];\n\n    var points = [this._getTransformedBegin(), this._getTransformedEnd()];\n    var len = points.length;\n    for (var i = 0; i < len; i++) {\n      scalars.push(points[i].dot(axis));\n    }\n\n    return new Projection(Math.min.apply(Math, scalars), Math.max.apply(Math, scalars));\n  }\n\n  /* istanbul ignore next */\n  public debugDraw(ctx: CanvasRenderingContext2D, color: Color = Color.Red.clone()) {\n    ctx.strokeStyle = color.toString();\n    ctx.beginPath();\n    ctx.moveTo(this.begin.x, this.begin.y);\n    ctx.lineTo(this.end.x, this.end.y);\n    ctx.closePath();\n    ctx.stroke();\n  }\n}\n","export * from './Body';\nexport * from './BoundingBox';\nexport * from './CircleArea';\nexport * from './CollisionContact';\nexport * from './CollisionJumpTable';\nexport * from './DynamicTree';\nexport * from './DynamicTreeCollisionBroadphase';\nexport * from './EdgeArea';\nexport * from './ICollisionArea';\nexport * from './ICollisionResolver';\nexport * from './IPhysics';\nexport * from './NaiveCollisionBroadphase';\nexport * from './Pair';\nexport * from './PolygonArea';\nexport * from './Side';\n","import { Physics } from './../Physics';\nimport { CollisionContact } from './CollisionContact';\nimport { Pair } from './Pair';\nimport { Actor, CollisionType } from './../Actor';\nimport { ICollisionBroadphase } from './ICollisionResolver';\nimport { CollisionStartEvent, CollisionEndEvent } from '../Events';\n\nexport class NaiveCollisionBroadphase implements ICollisionBroadphase {\n  private _lastFramePairs: Pair[] = [];\n  private _lastFramePairsHash: { [pairId: string]: Pair } = {};\n\n  public track() {\n    // pass\n  }\n\n  public untrack() {\n    // pass\n  }\n\n  /**\n   * Detects potential collision pairs in a broadphase approach with the dynamic aabb tree strategy\n   */\n  public broadphase(targets: Actor[]): Pair[] {\n    // Retrieve the list of potential colliders, exclude killed, prevented, and self\n    var potentialColliders = targets.filter((other) => {\n      return !other.isKilled() && other.collisionType !== CollisionType.PreventCollision;\n    });\n\n    var actor1: Actor;\n    var actor2: Actor;\n    var collisionPairs: Pair[] = [];\n\n    for (var j = 0, l = potentialColliders.length; j < l; j++) {\n      actor1 = potentialColliders[j];\n\n      for (var i = j + 1; i < l; i++) {\n        actor2 = potentialColliders[i];\n\n        var minimumTranslationVector;\n        if ((minimumTranslationVector = actor1.collides(actor2))) {\n          var pair = new Pair(actor1.body, actor2.body);\n          pair.collision = new CollisionContact(\n            actor1.collisionArea,\n            actor2.collisionArea,\n            minimumTranslationVector,\n            actor1.pos,\n            minimumTranslationVector\n          );\n          if (\n            !collisionPairs.some((cp) => {\n              return cp.id === pair.id;\n            })\n          ) {\n            collisionPairs.push(pair);\n          }\n        }\n      }\n    }\n    return collisionPairs;\n  }\n\n  /**\n   * Identify actual collisions from those pairs, and calculate collision impulse\n   */\n  public narrowphase(pairs: Pair[]): Pair[] {\n    return pairs;\n  }\n\n  public runCollisionStartEnd(pairs: Pair[]) {\n    let currentFrameHash: { [pairId: string]: Pair } = {};\n\n    for (let p of pairs) {\n      // load currentFrameHash\n      currentFrameHash[p.id] = p;\n\n      // find all new collisions\n      if (!this._lastFramePairsHash[p.id]) {\n        let actor1 = p.bodyA.actor;\n        let actor2 = p.bodyB.actor;\n        actor1.emit('collisionstart', new CollisionStartEvent(actor1, actor2, p));\n        actor2.emit('collisionstart', new CollisionStartEvent(actor2, actor1, p));\n      }\n    }\n\n    // find all old collisions\n    for (let p of this._lastFramePairs) {\n      if (!currentFrameHash[p.id]) {\n        let actor1 = p.bodyA.actor;\n        let actor2 = p.bodyB.actor;\n        actor1.emit('collisionend', new CollisionEndEvent(actor1, actor2));\n        actor2.emit('collisionend', new CollisionEndEvent(actor2, actor1));\n      }\n    }\n\n    // reset the last frame cache\n    this._lastFramePairs = pairs;\n    this._lastFramePairsHash = currentFrameHash;\n  }\n\n  /**\n   * Resolve the position and velocity of the physics bodies\n   */\n  public resolve(pairs: Pair[]): Pair[] {\n    for (var pair of pairs) {\n      pair.resolve(Physics.collisionResolutionStrategy);\n    }\n\n    return pairs.filter((p) => p.canCollide);\n  }\n\n  public update(): number {\n    return 0;\n  }\n\n  public debugDraw() {\n    return;\n  }\n}\n","import { Physics } from './../Physics';\nimport { Color } from './../Drawing/Color';\nimport { Body } from './Body';\nimport { CollisionContact } from './CollisionContact';\nimport { CollisionType, Actor } from '../Actor';\nimport { CollisionResolutionStrategy } from '../Physics';\nimport * as DrawUtil from '../Util/DrawUtil';\n\n/**\n * Models a potential collision between 2 bodies\n */\nexport class Pair {\n  public id: string = null;\n  public collision: CollisionContact = null;\n\n  constructor(public bodyA: Body, public bodyB: Body) {\n    this.id = Pair.calculatePairHash(bodyA, bodyB);\n  }\n\n  public static canCollide(actorA: Actor, actorB: Actor) {\n    // if both are fixed short circuit\n    if (actorA.collisionType === CollisionType.Fixed && actorB.collisionType === CollisionType.Fixed) {\n      return false;\n    }\n\n    // if the either is prevent collision short circuit\n    if (actorB.collisionType === CollisionType.PreventCollision || actorA.collisionType === CollisionType.PreventCollision) {\n      return false;\n    }\n\n    // if either is dead short circuit\n    if (actorA.isKilled() || actorB.isKilled()) {\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Returns whether or not it is possible for the pairs to collide\n   */\n  public get canCollide(): boolean {\n    let actorA = this.bodyA.actor;\n    let actorB = this.bodyB.actor;\n    return Pair.canCollide(actorA, actorB);\n  }\n\n  /**\n   * Runs the collison intersection logic on the members of this pair\n   */\n  public collide() {\n    this.collision = this.bodyA.collisionArea.collide(this.bodyB.collisionArea);\n  }\n\n  /**\n   * Resovles the collision body position and velocity if a collision occured\n   */\n  public resolve(strategy: CollisionResolutionStrategy) {\n    if (this.collision) {\n      this.collision.resolve(strategy);\n    }\n  }\n\n  /**\n   * Calculates the unique pair hash id for this collision pair\n   */\n  public static calculatePairHash(bodyA: Body, bodyB: Body): string {\n    if (bodyA.actor.id < bodyB.actor.id) {\n      return `#${bodyA.actor.id}+${bodyB.actor.id}`;\n    } else {\n      return `#${bodyB.actor.id}+${bodyA.actor.id}`;\n    }\n  }\n\n  /* istanbul ignore next */\n  public debugDraw(ctx: CanvasRenderingContext2D) {\n    if (this.collision) {\n      if (Physics.showContacts) {\n        DrawUtil.point(ctx, Color.Red, this.collision.point);\n      }\n      if (Physics.showCollisionNormals) {\n        DrawUtil.vector(ctx, Color.Cyan, this.collision.point, this.collision.normal, 30);\n      }\n    }\n  }\n}\n","import { Color } from './../Drawing/Color';\nimport { Physics } from './../Physics';\nimport { BoundingBox } from './BoundingBox';\nimport { EdgeArea } from './EdgeArea';\nimport { CollisionJumpTable } from './CollisionJumpTable';\nimport { CircleArea } from './CircleArea';\nimport { CollisionContact } from './CollisionContact';\nimport { ICollisionArea } from './ICollisionArea';\nimport { Body } from './Body';\nimport { Vector, Line, Ray, Projection } from './../Algebra';\n\nexport interface IPolygonAreaOptions {\n  pos?: Vector;\n  points?: Vector[];\n  clockwiseWinding?: boolean;\n  body?: Body;\n}\n\n/**\n * Polygon collision area for detecting collisions for actors, or independently\n */\nexport class PolygonArea implements ICollisionArea {\n  public pos: Vector;\n  public points: Vector[];\n  public body: Body;\n\n  private _transformedPoints: Vector[] = [];\n  private _axes: Vector[] = [];\n  private _sides: Line[] = [];\n\n  constructor(options: IPolygonAreaOptions) {\n    this.pos = options.pos || Vector.Zero.clone();\n    var winding = !!options.clockwiseWinding;\n    this.points = (winding ? options.points.reverse() : options.points) || [];\n    this.body = options.body || null;\n\n    // calculate initial transformation\n    this._calculateTransformation();\n  }\n\n  /**\n   * Get the center of the collision area in world coordinates\n   */\n  public getCenter(): Vector {\n    if (this.body) {\n      return this.body.pos.add(this.pos);\n    }\n    return this.pos;\n  }\n\n  /**\n   * Calculates the underlying transformation from the body relative space to world space\n   */\n  private _calculateTransformation() {\n    var pos = this.body ? this.body.pos.add(this.pos) : this.pos;\n    var angle = this.body ? this.body.rotation : 0;\n\n    var len = this.points.length;\n    this._transformedPoints.length = 0; // clear out old transform\n    for (var i = 0; i < len; i++) {\n      this._transformedPoints[i] = this.points[i].rotate(angle).add(pos);\n    }\n  }\n\n  /**\n   * Gets the points that make up the polygon in world space, from actor relative space (if specified)\n   */\n  public getTransformedPoints(): Vector[] {\n    if (!this._transformedPoints.length) {\n      this._calculateTransformation();\n    }\n    return this._transformedPoints;\n  }\n\n  /**\n   * Gets the sides of the polygon in world space\n   */\n  public getSides(): Line[] {\n    if (this._sides.length) {\n      return this._sides;\n    }\n    var lines = [];\n    var points = this.getTransformedPoints();\n    var len = points.length;\n    for (var i = 0; i < len; i++) {\n      lines.push(new Line(points[i], points[(i - 1 + len) % len]));\n    }\n    this._sides = lines;\n    return this._sides;\n  }\n\n  public recalc(): void {\n    this._sides.length = 0;\n    this._axes.length = 0;\n    this._transformedPoints.length = 0;\n    this.getTransformedPoints();\n    this.getAxes();\n    this.getSides();\n  }\n\n  /**\n   * Tests if a point is contained in this collision area in world space\n   */\n  public contains(point: Vector): boolean {\n    // Always cast to the right, as long as we cast in a consitent fixed direction we\n    // will be fine\n    var testRay = new Ray(point, new Vector(1, 0));\n    var intersectCount = this.getSides().reduce(function(accum, side) {\n      if (testRay.intersect(side) >= 0) {\n        return accum + 1;\n      }\n      return accum;\n    }, 0);\n\n    if (intersectCount % 2 === 0) {\n      return false;\n    }\n    return true;\n  }\n\n  /**\n   * Returns a collision contact if the 2 collision areas collide, otherwise collide will\n   * return null.\n   * @param area\n   */\n  public collide(area: ICollisionArea): CollisionContact {\n    if (area instanceof CircleArea) {\n      return CollisionJumpTable.CollideCirclePolygon(area, this);\n    } else if (area instanceof PolygonArea) {\n      return CollisionJumpTable.CollidePolygonPolygon(this, area);\n    } else if (area instanceof EdgeArea) {\n      return CollisionJumpTable.CollidePolygonEdge(this, area);\n    } else {\n      throw new Error(`Polygon could not collide with unknown ICollisionArea ${typeof area}`);\n    }\n  }\n\n  /**\n   * Find the point on the shape furthest in the direction specified\n   */\n  public getFurthestPoint(direction: Vector): Vector {\n    var pts = this.getTransformedPoints();\n    var furthestPoint = null;\n    var maxDistance = -Number.MAX_VALUE;\n    for (var i = 0; i < pts.length; i++) {\n      var distance = direction.dot(pts[i]);\n      if (distance > maxDistance) {\n        maxDistance = distance;\n        furthestPoint = pts[i];\n      }\n    }\n    return furthestPoint;\n  }\n\n  /**\n   * Finds the closes face to the point using perpendicular distance\n   * @param point point to test against polygon\n   */\n  public getClosestFace(point: Vector): { distance: Vector; face: Line } {\n    let sides = this.getSides();\n    let min = Number.POSITIVE_INFINITY;\n    let faceIndex = -1;\n    let distance = -1;\n    for (let i = 0; i < sides.length; i++) {\n      let dist = sides[i].distanceToPoint(point);\n      if (dist < min) {\n        min = dist;\n        faceIndex = i;\n        distance = dist;\n      }\n    }\n\n    if (faceIndex !== -1) {\n      return {\n        distance: sides[faceIndex].normal().scale(distance),\n        face: sides[faceIndex]\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Get the axis aligned bounding box for the polygon area\n   */\n  public getBounds(): BoundingBox {\n    // todo there is a faster way to do this\n    var points = this.getTransformedPoints();\n\n    var minX = points.reduce(function(prev, curr) {\n      return Math.min(prev, curr.x);\n    }, 999999999);\n    var maxX = points.reduce(function(prev, curr) {\n      return Math.max(prev, curr.x);\n    }, -99999999);\n\n    var minY = points.reduce(function(prev, curr) {\n      return Math.min(prev, curr.y);\n    }, 9999999999);\n    var maxY = points.reduce(function(prev, curr) {\n      return Math.max(prev, curr.y);\n    }, -9999999999);\n\n    return new BoundingBox(minX, minY, maxX, maxY);\n  }\n\n  /**\n   * Get the moment of inertia for an arbitrary polygon\n   * https://en.wikipedia.org/wiki/List_of_moments_of_inertia\n   */\n  public getMomentOfInertia(): number {\n    var mass = this.body ? this.body.mass : Physics.defaultMass;\n    var numerator = 0;\n    var denominator = 0;\n    for (var i = 0; i < this.points.length; i++) {\n      var iplusone = (i + 1) % this.points.length;\n      var crossTerm = this.points[iplusone].cross(this.points[i]);\n      numerator +=\n        crossTerm *\n        (this.points[i].dot(this.points[i]) + this.points[i].dot(this.points[iplusone]) + this.points[iplusone].dot(this.points[iplusone]));\n      denominator += crossTerm;\n    }\n    return (mass / 6) * (numerator / denominator);\n  }\n\n  /**\n   * Casts a ray into the polygon and returns a vector representing the point of contact (in world space) or null if no collision.\n   */\n  public rayCast(ray: Ray, max: number = Infinity) {\n    // find the minimum contact time greater than 0\n    // contact times less than 0 are behind the ray and we don't want those\n    var sides = this.getSides();\n    var len = sides.length;\n    var minContactTime = Number.MAX_VALUE;\n    var contactIndex = -1;\n    for (var i = 0; i < len; i++) {\n      var contactTime = ray.intersect(sides[i]);\n      if (contactTime >= 0 && contactTime < minContactTime && contactTime <= max) {\n        minContactTime = contactTime;\n        contactIndex = i;\n      }\n    }\n\n    // contact was found\n    if (contactIndex >= 0) {\n      return ray.getPoint(minContactTime);\n    }\n\n    // no contact found\n    return null;\n  }\n\n  /**\n   * Get the axis associated with the edge\n   */\n  public getAxes(): Vector[] {\n    if (this._axes.length) {\n      return this._axes;\n    }\n\n    var axes = [];\n    var points = this.getTransformedPoints();\n    var len = points.length;\n    for (var i = 0; i < len; i++) {\n      axes.push(points[i].sub(points[(i + 1) % len]).normal());\n    }\n    this._axes = axes;\n    return this._axes;\n  }\n\n  /**\n   * Perform Separating Axis test against another polygon, returns null if no overlap in polys\n   * Reference http://www.dyn4j.org/2010/01/sat/\n   */\n  public testSeparatingAxisTheorem(other: PolygonArea): Vector {\n    var poly1 = this;\n    var poly2 = other;\n    var axes = poly1.getAxes().concat(poly2.getAxes());\n\n    var minOverlap = Number.MAX_VALUE;\n    var minAxis = null;\n    var minIndex = -1;\n    for (var i = 0; i < axes.length; i++) {\n      var proj1 = poly1.project(axes[i]);\n      var proj2 = poly2.project(axes[i]);\n      var overlap = proj1.getOverlap(proj2);\n      if (overlap <= 0) {\n        return null;\n      } else {\n        if (overlap < minOverlap) {\n          minOverlap = overlap;\n          minAxis = axes[i];\n          minIndex = i;\n        }\n      }\n    }\n\n    // Sanity check\n    if (minIndex === -1) {\n      return null;\n    }\n\n    return minAxis.normalize().scale(minOverlap);\n  }\n\n  /**\n   * Project the edges of the polygon along a specified axis\n   */\n  public project(axis: Vector): Projection {\n    var points = this.getTransformedPoints();\n    var len = points.length;\n    var min = Number.MAX_VALUE;\n    var max = -Number.MAX_VALUE;\n    for (var i = 0; i < len; i++) {\n      var scalar = points[i].dot(axis);\n      min = Math.min(min, scalar);\n      max = Math.max(max, scalar);\n    }\n\n    return new Projection(min, max);\n  }\n\n  /* istanbul ignore next */\n  public debugDraw(ctx: CanvasRenderingContext2D, color: Color = Color.Red.clone()) {\n    ctx.beginPath();\n    ctx.strokeStyle = color.toString();\n    // Iterate through the supplied points and construct a 'polygon'\n    var firstPoint = this.getTransformedPoints()[0];\n    ctx.moveTo(firstPoint.x, firstPoint.y);\n    this.getTransformedPoints().forEach(function(point) {\n      ctx.lineTo(point.x, point.y);\n    });\n    ctx.lineTo(firstPoint.x, firstPoint.y);\n    ctx.closePath();\n    ctx.stroke();\n  }\n}\n","/**\n * An enum that describes the sides of an Actor for collision\n */\nexport enum Side {\n  None,\n  Top,\n  Bottom,\n  Left,\n  Right\n}\n","export type Constructor<T> = {\n  new (...args: any[]): T;\n};\nexport function Configurable<T extends Constructor<{}>>(base: T): T {\n  return class extends base {\n    public assign(props: Partial<T>) {\n      //set the value of every property that was passed in,\n      //if the constructor previously set this value, it will be overridden here\n      for (var k in props) {\n        if (typeof (<any>this)[k] !== 'function') {\n          (<any>this)[k] = (<any>props)[k];\n        }\n      }\n    }\n\n    constructor(...args: any[]) {\n      super(...args);\n      //get the number of arguments that aren't undefined. TS passes a value to all parameters\n      //of whatever ctor is the implementation, so args.length doesn't work here.\n      var size = args.filter(function(value) {\n        return value !== undefined;\n      }).length;\n      if (size === 1 && args[0] && typeof args[0] === 'object' && !(args[0] instanceof Array)) {\n        this.assign(args[0]);\n      }\n    }\n  };\n}\n","import { IDebugFlags } from './DebugFlags';\nimport { Pair } from './Collision/Pair';\n\n/**\n * Debug stats containing current and previous frame statistics\n */\nexport interface IDebugStats {\n  currFrame: FrameStats;\n  prevFrame: FrameStats;\n}\n\n/**\n * Hash containing the [[Pair.id]]s of pairs that collided in a frame\n */\nexport interface ICollidersHash {\n  [pairId: string]: Pair;\n}\n\n/**\n * Represents a frame's individual statistics\n */\nexport interface IFrameStats {\n  /**\n   * The number of the frame\n   */\n  id: number;\n\n  /**\n   * Gets the frame's delta (time since last frame scaled by [[Engine.timescale]]) (in ms)\n   */\n  delta: number;\n\n  /**\n   * Gets the frame's frames-per-second (FPS)\n   */\n  fps: number;\n\n  /**\n   * Duration statistics (in ms)\n   */\n  duration: IFrameDurationStats;\n\n  /**\n   * Actor statistics\n   */\n  actors: IFrameActorStats;\n\n  /**\n   * Physics statistics\n   */\n  physics: IPhysicsStats;\n}\n\n/**\n * Represents actor stats for a frame\n */\nexport interface IFrameActorStats {\n  /**\n   * Gets the frame's number of actors (alive)\n   */\n  alive: number;\n\n  /**\n   * Gets the frame's number of actors (killed)\n   */\n  killed: number;\n\n  /**\n   * Gets the frame's number of remaining actors (alive - killed)\n   */\n  remaining: number;\n\n  /**\n   * Gets the frame's number of UI actors\n   */\n  ui: number;\n\n  /**\n   * Gets the frame's number of total actors (remaining + UI)\n   */\n  total: number;\n}\n\n/**\n * Represents duration stats for a frame\n */\nexport interface IFrameDurationStats {\n  /**\n   * Gets the frame's total time to run the update function (in ms)\n   */\n  update: number;\n\n  /**\n   * Gets the frame's total time to run the draw function (in ms)\n   */\n  draw: number;\n\n  /**\n   * Gets the frame's total render duration (update + draw duration) (in ms)\n   */\n  total: number;\n}\n\n/**\n * Represents physics stats for the current frame\n */\nexport interface IPhysicsStats {\n  /**\n   * Gets the number of broadphase collision pairs which\n   */\n  pairs: number;\n\n  /**\n   * Gets the number of actual collisons\n   */\n  collisions: number;\n\n  /**\n   * A Hash storing the [[Pair.id]]s of [[Pair]]s that collided in the frame\n   */\n  collidersHash: ICollidersHash;\n\n  /**\n   * Gets the number of fast moving bodies using raycast continuous collisions in the scene\n   */\n  fastBodies: number;\n\n  /**\n   * Gets the number of bodies that had a fast body collision resolution\n   */\n  fastBodyCollisions: number;\n\n  /**\n   * Gets the time it took to calculate the broadphase pairs\n   */\n  broadphase: number;\n\n  /**\n   * Gets the time it took to calculate the narrowphase\n   */\n  narrowphase: number;\n}\n\n/**\n * Debug statistics and flags for Excalibur. If polling these values, it would be\n * best to do so on the `postupdate` event for [[Engine]], after all values have been\n * updated during a frame.\n */\nexport class Debug implements IDebugFlags {\n  /**\n   * Performance statistics\n   */\n  public stats: IDebugStats = {\n    /**\n     * Current frame statistics. Engine reuses this instance, use [[FrameStats.clone]] to copy frame stats.\n     * Best accessed on [[postframe]] event. See [[IFrameStats]]\n     */\n    currFrame: new FrameStats(),\n\n    /**\n     * Previous frame statistics. Engine reuses this instance, use [[FrameStats.clone]] to copy frame stats.\n     * Best accessed on [[preframe]] event. Best inspected on engine event `preframe`. See [[IFrameStats]]\n     */\n    prevFrame: new FrameStats()\n  };\n}\n\n/**\n * Implementation of a frame's stats. Meant to have values copied via [[FrameStats.reset]], avoid\n * creating instances of this every frame.\n */\nexport class FrameStats implements IFrameStats {\n  private _id: number = 0;\n  private _delta: number = 0;\n  private _fps: number = 0;\n  private _actorStats: IFrameActorStats = {\n    alive: 0,\n    killed: 0,\n    ui: 0,\n    get remaining(this: IFrameActorStats) {\n      return this.alive - this.killed;\n    },\n    get total(this: IFrameActorStats) {\n      return this.remaining + this.ui;\n    }\n  };\n  private _durationStats: IFrameDurationStats = {\n    update: 0,\n    draw: 0,\n    get total(this: IFrameDurationStats) {\n      return this.update + this.draw;\n    }\n  };\n\n  private _physicsStats: PhysicsStats = new PhysicsStats();\n\n  /**\n   * Zero out values or clone other IFrameStat stats. Allows instance reuse.\n   *\n   * @param [otherStats] Optional stats to clone\n   */\n  public reset(otherStats?: IFrameStats) {\n    if (otherStats) {\n      this.id = otherStats.id;\n      this.delta = otherStats.delta;\n      this.fps = otherStats.fps;\n      this.actors.alive = otherStats.actors.alive;\n      this.actors.killed = otherStats.actors.killed;\n      this.actors.ui = otherStats.actors.ui;\n      this.duration.update = otherStats.duration.update;\n      this.duration.draw = otherStats.duration.draw;\n      this._physicsStats.reset(otherStats.physics);\n    } else {\n      this.id = this.delta = this.fps = 0;\n      this.actors.alive = this.actors.killed = this.actors.ui = 0;\n      this.duration.update = this.duration.draw = 0;\n      this._physicsStats.reset();\n    }\n  }\n\n  /**\n   * Provides a clone of this instance.\n   */\n  public clone(): FrameStats {\n    var fs = new FrameStats();\n\n    fs.reset(this);\n\n    return fs;\n  }\n\n  /**\n   * Gets the frame's id\n   */\n  public get id() {\n    return this._id;\n  }\n\n  /**\n   * Sets the frame's id\n   */\n  public set id(value: number) {\n    this._id = value;\n  }\n\n  /**\n   * Gets the frame's delta (time since last frame)\n   */\n  public get delta() {\n    return this._delta;\n  }\n\n  /**\n   * Sets the frame's delta (time since last frame). Internal use only.\n   * @internal\n   */\n  public set delta(value: number) {\n    this._delta = value;\n  }\n\n  /**\n   * Gets the frame's frames-per-second (FPS)\n   */\n  public get fps() {\n    return this._fps;\n  }\n\n  /**\n   * Sets the frame's frames-per-second (FPS). Internal use only.\n   * @internal\n   */\n  public set fps(value: number) {\n    this._fps = value;\n  }\n\n  /**\n   * Gets the frame's actor statistics\n   */\n  public get actors() {\n    return this._actorStats;\n  }\n\n  /**\n   * Gets the frame's duration statistics\n   */\n  public get duration() {\n    return this._durationStats;\n  }\n\n  /**\n   * Gets the frame's physics statistics\n   */\n  public get physics() {\n    return this._physicsStats;\n  }\n}\n\nexport class PhysicsStats implements IPhysicsStats {\n  private _pairs: number = 0;\n  private _collisions: number = 0;\n  private _collidersHash: ICollidersHash = {};\n  private _fastBodies: number = 0;\n  private _fastBodyCollisions: number = 0;\n  private _broadphase: number = 0;\n  private _narrowphase: number = 0;\n\n  /**\n   * Zero out values or clone other IPhysicsStats stats. Allows instance reuse.\n   *\n   * @param [otherStats] Optional stats to clone\n   */\n  public reset(otherStats?: IPhysicsStats) {\n    if (otherStats) {\n      this.pairs = otherStats.pairs;\n      this.collisions = otherStats.collisions;\n      this.collidersHash = otherStats.collidersHash;\n      this.fastBodies = otherStats.fastBodies;\n      this.fastBodyCollisions = otherStats.fastBodyCollisions;\n      this.broadphase = otherStats.broadphase;\n      this.narrowphase = otherStats.narrowphase;\n    } else {\n      this.pairs = this.collisions = this.fastBodies = 0;\n      this.fastBodyCollisions = this.broadphase = this.narrowphase = 0;\n      this.collidersHash = {};\n    }\n  }\n\n  /**\n   * Provides a clone of this instance.\n   */\n  public clone(): IPhysicsStats {\n    var ps = new PhysicsStats();\n\n    ps.reset(this);\n\n    return ps;\n  }\n\n  public get pairs(): number {\n    return this._pairs;\n  }\n\n  public set pairs(value: number) {\n    this._pairs = value;\n  }\n\n  public get collisions(): number {\n    return this._collisions;\n  }\n\n  public set collisions(value: number) {\n    this._collisions = value;\n  }\n\n  public get collidersHash(): ICollidersHash {\n    return this._collidersHash;\n  }\n\n  public set collidersHash(colliders: ICollidersHash) {\n    this._collidersHash = colliders;\n  }\n\n  public get fastBodies(): number {\n    return this._fastBodies;\n  }\n\n  public set fastBodies(value: number) {\n    this._fastBodies = value;\n  }\n\n  public get fastBodyCollisions(): number {\n    return this._fastBodyCollisions;\n  }\n\n  public set fastBodyCollisions(value: number) {\n    this._fastBodyCollisions = value;\n  }\n\n  public get broadphase(): number {\n    return this._broadphase;\n  }\n\n  public set broadphase(value: number) {\n    this._broadphase = value;\n  }\n\n  public get narrowphase(): number {\n    return this._narrowphase;\n  }\n\n  public set narrowphase(value: number) {\n    this._narrowphase = value;\n  }\n}\n","import { Sprite } from './Sprite';\nimport { IAnimationArgs } from '../Drawing/Animation';\nimport * as Effects from './SpriteEffects';\nimport { Color } from './Color';\n\nimport { IDrawable } from '../Interfaces/IDrawable';\nimport { Vector } from '../Algebra';\nimport { Engine } from '../Engine';\nimport * as Util from '../Util/Util';\nimport { Configurable } from '../Configurable';\n\n/**\n * @hidden\n */\nexport class AnimationImpl implements IDrawable {\n  /**\n   * The sprite frames to play, in order. See [[SpriteSheet.getAnimationForAll]] to quickly\n   * generate an [[Animation]].\n   */\n  public sprites: Sprite[] = [];\n\n  /**\n   * Duration to show each frame (in milliseconds)\n   */\n  public speed: number;\n\n  /**\n   * Current frame index being shown\n   */\n  public currentFrame: number = 0;\n\n  private _oldTime: number = Date.now();\n\n  public anchor: Vector = new Vector(0.0, 0.0);\n  public rotation: number = 0.0;\n  public scale: Vector = new Vector(1, 1);\n\n  /**\n   * Indicates whether the animation should loop after it is completed\n   */\n  public loop: boolean = true;\n\n  /**\n   * Indicates the frame index the animation should freeze on for a non-looping\n   * animation. By default it is the last frame.\n   */\n  public freezeFrame: number = -1;\n\n  private _engine: Engine;\n\n  /**\n   * Flip each frame vertically. Sets [[Sprite.flipVertical]].\n   */\n  public flipVertical: boolean = false;\n\n  /**\n   * Flip each frame horizontally. Sets [[Sprite.flipHorizontal]].\n   */\n  public flipHorizontal: boolean = false;\n\n  public drawWidth: number = 0;\n  public drawHeight: number = 0;\n  public width: number = 0;\n  public height: number = 0;\n\n  /**\n   * Typically you will use a [[SpriteSheet]] to generate an [[Animation]].\n   *\n   * @param engine  Reference to the current game engine\n   * @param images  An array of sprites to create the frames for the animation\n   * @param speed   The number in milliseconds to display each frame in the animation\n   * @param loop    Indicates whether the animation should loop after it is completed\n   */\n  constructor(engineOrConfig: Engine | IAnimationArgs, sprites: Sprite[], speed: number, loop?: boolean) {\n    var engine = engineOrConfig;\n    if (engineOrConfig && !(engineOrConfig instanceof Engine)) {\n      var config = engineOrConfig;\n      engine = config.engine;\n      sprites = config.sprites;\n      speed = config.speed;\n      loop = config.loop;\n    }\n\n    this.sprites = sprites;\n    this.speed = speed;\n    this._engine = <Engine>engine;\n\n    if (loop != null) {\n      this.loop = loop;\n    }\n\n    if (sprites && sprites[0]) {\n      this.drawHeight = sprites[0] ? sprites[0].drawHeight : 0;\n      this.drawWidth = sprites[0] ? sprites[0].drawWidth : 0;\n\n      this.width = sprites[0] ? sprites[0].width : 0;\n      this.height = sprites[0] ? sprites[0].height : 0;\n\n      this.freezeFrame = sprites.length - 1;\n    }\n  }\n\n  /**\n   * Applies the opacity effect to a sprite, setting the alpha of all pixels to a given value\n   */\n  public opacity(value: number) {\n    this.addEffect(new Effects.Opacity(value));\n  }\n\n  /**\n   * Applies the grayscale effect to a sprite, removing color information.\n   */\n  public grayscale() {\n    this.addEffect(new Effects.Grayscale());\n  }\n\n  /**\n   * Applies the invert effect to a sprite, inverting the pixel colors.\n   */\n  public invert() {\n    this.addEffect(new Effects.Invert());\n  }\n\n  /**\n   * Applies the fill effect to a sprite, changing the color channels of all non-transparent pixels to match a given color\n   */\n  public fill(color: Color) {\n    this.addEffect(new Effects.Fill(color));\n  }\n\n  /**\n   * Applies the colorize effect to a sprite, changing the color channels of all pixels to be the average of the original color and the\n   * provided color.\n   */\n  public colorize(color: Color) {\n    this.addEffect(new Effects.Colorize(color));\n  }\n\n  /**\n   * Applies the lighten effect to a sprite, changes the lightness of the color according to hsl\n   */\n  public lighten(factor: number = 0.1) {\n    this.addEffect(new Effects.Lighten(factor));\n  }\n\n  /**\n   * Applies the darken effect to a sprite, changes the darkness of the color according to hsl\n   */\n  public darken(factor: number = 0.1) {\n    this.addEffect(new Effects.Darken(factor));\n  }\n\n  /**\n   * Applies the saturate effect to a sprite, saturates the color according to hsl\n   */\n  public saturate(factor: number = 0.1) {\n    this.addEffect(new Effects.Saturate(factor));\n  }\n\n  /**\n   * Applies the desaturate effect to a sprite, desaturates the color according to hsl\n   */\n  public desaturate(factor: number = 0.1) {\n    this.addEffect(new Effects.Desaturate(factor));\n  }\n\n  /**\n   * Add a [[ISpriteEffect]] manually\n   */\n  public addEffect(effect: Effects.ISpriteEffect) {\n    for (var i in this.sprites) {\n      this.sprites[i].addEffect(effect);\n    }\n  }\n\n  /**\n   * Removes an [[ISpriteEffect]] from this animation.\n   * @param effect Effect to remove from this animation\n   */\n  public removeEffect(effect: Effects.ISpriteEffect): void;\n\n  /**\n   * Removes an effect given the index from this animation.\n   * @param index  Index of the effect to remove from this animation\n   */\n  public removeEffect(index: number): void;\n  public removeEffect(param: any) {\n    for (var i in this.sprites) {\n      this.sprites[i].removeEffect(param);\n    }\n  }\n\n  /**\n   * Clear all sprite effects\n   */\n  public clearEffects() {\n    for (var i in this.sprites) {\n      this.sprites[i].clearEffects();\n    }\n  }\n\n  private _setAnchor(point: Vector) {\n    //if (!this.anchor.equals(point)) {\n    for (var i in this.sprites) {\n      this.sprites[i].anchor.setTo(point.x, point.y);\n    }\n    //}\n  }\n\n  private _setRotation(radians: number) {\n    //if (this.rotation !== radians) {\n    for (var i in this.sprites) {\n      this.sprites[i].rotation = radians;\n    }\n    //}\n  }\n\n  private _setScale(scale: Vector) {\n    //if (!this.scale.equals(scale)) {\n    for (var i in this.sprites) {\n      this.sprites[i].scale = scale;\n    }\n    //}\n  }\n\n  /**\n   * Resets the animation to first frame.\n   */\n  public reset() {\n    this.currentFrame = 0;\n  }\n\n  /**\n   * Indicates whether the animation is complete, animations that loop are never complete.\n   */\n  public isDone() {\n    return !this.loop && this.currentFrame >= this.sprites.length;\n  }\n\n  /**\n   * Not meant to be called by game developers. Ticks the animation forward internally and\n   * calculates whether to change to the frame.\n   * @internal\n   */\n  public tick() {\n    var time = Date.now();\n    if (time - this._oldTime > this.speed) {\n      this.currentFrame = this.loop ? (this.currentFrame + 1) % this.sprites.length : this.currentFrame + 1;\n      this._oldTime = time;\n    }\n  }\n\n  private _updateValues(): void {\n    this._setAnchor(this.anchor);\n    this._setRotation(this.rotation);\n    this._setScale(this.scale);\n  }\n\n  /**\n   * Skips ahead a specified number of frames in the animation\n   * @param frames  Frames to skip ahead\n   */\n  public skip(frames: number) {\n    this.currentFrame = (this.currentFrame + frames) % this.sprites.length;\n  }\n\n  public draw(ctx: CanvasRenderingContext2D, x: number, y: number) {\n    this.tick();\n    this._updateValues();\n    var currSprite: Sprite;\n    if (this.currentFrame < this.sprites.length) {\n      currSprite = this.sprites[this.currentFrame];\n      if (this.flipVertical) {\n        currSprite.flipVertical = this.flipVertical;\n      }\n      if (this.flipHorizontal) {\n        currSprite.flipHorizontal = this.flipHorizontal;\n      }\n      currSprite.draw(ctx, x, y);\n    }\n\n    if (this.freezeFrame !== -1 && this.currentFrame >= this.sprites.length) {\n      currSprite = this.sprites[Util.clamp(this.freezeFrame, 0, this.sprites.length - 1)];\n      currSprite.draw(ctx, x, y);\n    }\n\n    // add the calculated width\n    if (currSprite) {\n      this.drawWidth = currSprite.drawWidth;\n      this.drawHeight = currSprite.drawHeight;\n    }\n  }\n\n  /**\n   * Plays an animation at an arbitrary location in the game.\n   * @param x  The x position in the game to play\n   * @param y  The y position in the game to play\n   */\n  public play(x: number, y: number) {\n    this.reset();\n    this._engine.playAnimation(this, x, y);\n  }\n}\n\n/**\n * [[include:Constructors.md]]\n */\nexport interface IAnimationArgs extends Partial<AnimationImpl> {\n  engine: Engine;\n  sprites: Sprite[];\n  speed: number;\n  loop?: boolean;\n  anchor?: Vector;\n  rotation?: number;\n  scale?: Vector;\n  flipVertical?: boolean;\n  flipHorizontal?: boolean;\n  width?: number;\n  height?: number;\n}\n\n/**\n * Animations allow you to display a series of images one after another,\n * creating the illusion of change. Generally these images will come from a [[SpriteSheet]] source.\n *\n * [[include:Animations.md]]\n */\nexport class Animation extends Configurable(AnimationImpl) {\n  constructor(config: IAnimationArgs);\n  constructor(engine: Engine, images: Sprite[], speed: number, loop?: boolean);\n  constructor(engineOrConfig: Engine | IAnimationArgs, images?: Sprite[], speed?: number, loop?: boolean) {\n    super(engineOrConfig, images, speed, loop);\n  }\n}\n","/**\n * Provides standard colors (e.g. [[Color.Black]])\n * but you can also create custom colors using RGB, HSL, or Hex. Also provides\n * useful color operations like [[Color.lighten]], [[Color.darken]], and more.\n *\n * [[include:Colors.md]]\n */\nexport class Color {\n  /**\n   * Red channel\n   */\n  public r: number;\n  /**\n   * Green channel\n   */\n  public g: number;\n  /**\n   * Blue channel\n   */\n  public b: number;\n  /**\n   * Alpha channel (between 0 and 1)\n   */\n  public a: number;\n\n  /**\n   * Hue\n   */\n  public h: number;\n  /**\n   * Saturation\n   */\n  public s: number;\n  /**\n   * Lightness\n   */\n  public l: number;\n\n  /**\n   * Creates a new instance of Color from an r, g, b, a\n   *\n   * @param r  The red component of color (0-255)\n   * @param g  The green component of color (0-255)\n   * @param b  The blue component of color (0-255)\n   * @param a  The alpha component of color (0-1.0)\n   */\n  constructor(r: number, g: number, b: number, a?: number) {\n    this.r = r;\n    this.g = g;\n    this.b = b;\n    this.a = a != null ? a : 1;\n  }\n\n  /**\n   * Creates a new instance of Color from an r, g, b, a\n   *\n   * @param r  The red component of color (0-255)\n   * @param g  The green component of color (0-255)\n   * @param b  The blue component of color (0-255)\n   * @param a  The alpha component of color (0-1.0)\n   */\n  public static fromRGB(r: number, g: number, b: number, a?: number): Color {\n    return new Color(r, g, b, a);\n  }\n\n  /**\n   * Creates a new inscance of Color from a hex string\n   *\n   * @param hex  CSS color string of the form #ffffff, the alpha component is optional\n   */\n  public static fromHex(hex: string): Color {\n    var hexRegEx: RegExp = /^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i;\n    var match = null;\n    if ((match = hex.match(hexRegEx))) {\n      var r = parseInt(match[1], 16);\n      var g = parseInt(match[2], 16);\n      var b = parseInt(match[3], 16);\n      var a = 1;\n      if (match[4]) {\n        a = parseInt(match[4], 16) / 255;\n      }\n      return new Color(r, g, b, a);\n    } else {\n      throw new Error('Invalid hex string: ' + hex);\n    }\n  }\n\n  /**\n   * Creats a new instance of Color from hsla values\n   *\n   * @param h  Hue is represented [0-1]\n   * @param s  Saturation is represented [0-1]\n   * @param l  Luminance is represented [0-1]\n   * @param a  Alpha is represented [0-1]\n   */\n  public static fromHSL(h: number, s: number, l: number, a: number = 1.0): Color {\n    var temp = new HSLColor(h, s, l, a);\n    return temp.toRGBA();\n  }\n\n  /**\n   * Lightens the current color by a specified amount\n   *\n   * @param factor  The amount to lighten by [0-1]\n   */\n  public lighten(factor: number = 0.1): Color {\n    var temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\n    temp.l += temp.l * factor;\n    return temp.toRGBA();\n  }\n\n  /**\n   * Darkens the current color by a specified amount\n   *\n   * @param factor  The amount to darken by [0-1]\n   */\n  public darken(factor: number = 0.1): Color {\n    var temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\n    temp.l -= temp.l * factor;\n    return temp.toRGBA();\n  }\n\n  /**\n   * Saturates the current color by a specified amount\n   *\n   * @param factor  The amount to saturate by [0-1]\n   */\n  public saturate(factor: number = 0.1): Color {\n    var temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\n    temp.s += temp.s * factor;\n    return temp.toRGBA();\n  }\n\n  /**\n   * Desaturates the current color by a specified amount\n   *\n   * @param factor  The amount to desaturate by [0-1]\n   */\n  public desaturate(factor: number = 0.1): Color {\n    var temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\n    temp.s -= temp.s * factor;\n    return temp.toRGBA();\n  }\n\n  /**\n   * Multiplies a color by another, results in a darker color\n   *\n   * @param color  The other color\n   */\n  public mulitiply(color: Color): Color {\n    var newR = (((color.r / 255) * this.r) / 255) * 255;\n    var newG = (((color.g / 255) * this.g) / 255) * 255;\n    var newB = (((color.b / 255) * this.b) / 255) * 255;\n    var newA = color.a * this.a;\n    return new Color(newR, newG, newB, newA);\n  }\n\n  /**\n   * Screens a color by another, results in a lighter color\n   *\n   * @param color  The other color\n   */\n  public screen(color: Color): Color {\n    var color1 = color.invert();\n    var color2 = color.invert();\n    return color1.mulitiply(color2).invert();\n  }\n\n  /**\n   * Inverts the current color\n   */\n  public invert(): Color {\n    return new Color(255 - this.r, 255 - this.g, 255 - this.b, 1.0 - this.a);\n  }\n\n  /**\n   * Averages the current color with another\n   *\n   * @param color  The other color\n   */\n  public average(color: Color): Color {\n    var newR = (color.r + this.r) / 2;\n    var newG = (color.g + this.g) / 2;\n    var newB = (color.b + this.b) / 2;\n    var newA = (color.a + this.a) / 2;\n    return new Color(newR, newG, newB, newA);\n  }\n\n  /**\n   * Returns a CSS string representation of a color.\n   *\n   * @param format Color representation, accepts: rgb, hsl, or hex\n   */\n  public toString(format: 'rgb' | 'hsl' | 'hex' = 'rgb') {\n    switch (format) {\n      case 'rgb':\n        return this.toRGBA();\n      case 'hsl':\n        return this.toHSLA();\n      case 'hex':\n        return this.toHex();\n      default:\n        throw new Error('Invalid Color format');\n    }\n  }\n\n  /**\n   * Returns Hex Value of a color component\n   * @param c color component\n   * @see https://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb\n   */\n  private _componentToHex(c: number) {\n    var hex = c.toString(16);\n    return hex.length === 1 ? '0' + hex : hex;\n  }\n\n  /**\n   * Return Hex representation of a color.\n   */\n  public toHex() {\n    return '#' + this._componentToHex(this.r) + this._componentToHex(this.g) + this._componentToHex(this.b);\n  }\n\n  /**\n   * Return RGBA representation of a color.\n   */\n  public toRGBA() {\n    var result = String(this.r.toFixed(0)) + ', ' + String(this.g.toFixed(0)) + ', ' + String(this.b.toFixed(0));\n    if (this.a !== undefined || this.a !== null) {\n      return 'rgba(' + result + ', ' + String(this.a) + ')';\n    }\n    return 'rgb(' + result + ')';\n  }\n\n  /**\n   * Return HSLA representation of a color.\n   */\n  public toHSLA() {\n    return HSLColor.fromRGBA(this.r, this.g, this.b, this.a).toString();\n  }\n\n  /**\n   * Returns a CSS string representation of a color.\n   */\n  public fillStyle() {\n    return this.toString();\n  }\n\n  /**\n   * Returns a clone of the current color.\n   */\n  public clone(): Color {\n    return new Color(this.r, this.g, this.b, this.a);\n  }\n\n  /**\n   * Black (#000000)\n   */\n  public static Black: Color = Color.fromHex('#000000');\n\n  /**\n   * White (#FFFFFF)\n   */\n  public static White: Color = Color.fromHex('#FFFFFF');\n\n  /**\n   * Gray (#808080)\n   */\n  public static Gray: Color = Color.fromHex('#808080');\n\n  /**\n   * Light gray (#D3D3D3)\n   */\n  public static LightGray: Color = Color.fromHex('#D3D3D3');\n\n  /**\n   * Dark gray (#A9A9A9)\n   */\n  public static DarkGray: Color = Color.fromHex('#A9A9A9');\n\n  /**\n   * Yellow (#FFFF00)\n   */\n  public static Yellow: Color = Color.fromHex('#FFFF00');\n\n  /**\n   * Orange (#FFA500)\n   */\n  public static Orange: Color = Color.fromHex('#FFA500');\n\n  /**\n   * Red (#FF0000)\n   */\n  public static Red: Color = Color.fromHex('#FF0000');\n\n  /**\n   * Vermillion (#FF5B31)\n   */\n  public static Vermillion: Color = Color.fromHex('#FF5B31');\n\n  /**\n   * Rose (#FF007F)\n   */\n  public static Rose: Color = Color.fromHex('#FF007F');\n\n  /**\n   * Magenta (#FF00FF)\n   */\n  public static Magenta: Color = Color.fromHex('#FF00FF');\n\n  /**\n   * Violet (#7F00FF)\n   */\n  public static Violet: Color = Color.fromHex('#7F00FF');\n\n  /**\n   * Blue (#0000FF)\n   */\n  public static Blue: Color = Color.fromHex('#0000FF');\n\n  /**\n   * Azure (#007FFF)\n   */\n  public static Azure: Color = Color.fromHex('#007FFF');\n\n  /**\n   * Cyan (#00FFFF)\n   */\n  public static Cyan: Color = Color.fromHex('#00FFFF');\n\n  /**\n   * Viridian (#59978F)\n   */\n  public static Viridian: Color = Color.fromHex('#59978F');\n\n  /**\n   * Green (#00FF00)\n   */\n  public static Green: Color = Color.fromHex('#00FF00');\n\n  /**\n   * Chartreuse (#7FFF00)\n   */\n  public static Chartreuse: Color = Color.fromHex('#7FFF00');\n\n  /**\n   * Transparent (#FFFFFF00)\n   */\n  public static Transparent: Color = Color.fromHex('#FFFFFF00');\n}\n\n/**\n * Internal HSL Color representation\n *\n * http://en.wikipedia.org/wiki/HSL_and_HSV\n * http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c\n */\nclass HSLColor {\n  constructor(public h: number, public s: number, public l: number, public a: number) {}\n\n  public static hue2rgb(p: number, q: number, t: number): number {\n    if (t < 0) {\n      t += 1;\n    }\n    if (t > 1) {\n      t -= 1;\n    }\n    if (t < 1 / 6) {\n      return p + (q - p) * 6 * t;\n    }\n    if (t < 1 / 2) {\n      return q;\n    }\n    if (t < 2 / 3) {\n      return p + (q - p) * (2 / 3 - t) * 6;\n    }\n    return p;\n  }\n\n  public static fromRGBA(r: number, g: number, b: number, a: number): HSLColor {\n    r /= 255;\n    g /= 255;\n    b /= 255;\n    var max = Math.max(r, g, b),\n      min = Math.min(r, g, b);\n    var h,\n      s,\n      l = (max + min) / 2;\n\n    if (max === min) {\n      h = s = 0; // achromatic\n    } else {\n      var d = max - min;\n      s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n      switch (max) {\n        case r:\n          h = (g - b) / d + (g < b ? 6 : 0);\n          break;\n        case g:\n          h = (b - r) / d + 2;\n          break;\n        case b:\n          h = (r - g) / d + 4;\n          break;\n      }\n      h /= 6;\n    }\n\n    return new HSLColor(h, s, l, a);\n  }\n\n  public toRGBA(): Color {\n    var r: number, g: number, b: number;\n\n    if (this.s === 0) {\n      r = g = b = this.l; // achromatic\n    } else {\n      var q = this.l < 0.5 ? this.l * (1 + this.s) : this.l + this.s - this.l * this.s;\n      var p = 2 * this.l - q;\n      r = HSLColor.hue2rgb(p, q, this.h + 1 / 3);\n      g = HSLColor.hue2rgb(p, q, this.h);\n      b = HSLColor.hue2rgb(p, q, this.h - 1 / 3);\n    }\n\n    return new Color(r * 255, g * 255, b * 255, this.a);\n  }\n\n  public toString(): string {\n    let h = this.h.toFixed(0),\n      s = this.s.toFixed(0),\n      l = this.l.toFixed(0),\n      a = this.a.toFixed(0);\n    return `hsla(${h}, ${s}, ${l}, ${a})`;\n  }\n}\n","export { Animation, IAnimationArgs } from './Animation';\nexport * from './Color';\nexport * from './Polygon';\nexport { Sprite, ISpriteArgs } from './Sprite';\nexport { SpriteSheet, SpriteFont, ISpriteSheetArgs, ISpriteFontInitArgs, ISpriteFontOptions } from './SpriteSheet';\n\nimport * as effects from './SpriteEffects';\nexport { effects as Effects };\n","import { Color } from './Color';\nimport * as Effects from './SpriteEffects';\n\nimport { IDrawable } from '../Interfaces/IDrawable';\nimport { Vector } from '../Algebra';\n\n/**\n * Creates a closed polygon drawing given a list of [[Vector]]s.\n *\n * @warning Use sparingly as Polygons are performance intensive\n */\nexport class Polygon implements IDrawable {\n  public flipVertical: boolean;\n  public flipHorizontal: boolean;\n  public drawWidth: number;\n  public drawHeight: number;\n\n  public width: number;\n  public height: number;\n\n  /**\n   * The color to use for the lines of the polygon\n   */\n  public lineColor: Color;\n  /**\n   * The color to use for the interior of the polygon\n   */\n  public fillColor: Color;\n  /**\n   * The width of the lines of the polygon\n   */\n  public lineWidth: number = 5;\n  /**\n   * Indicates whether the polygon is filled or not.\n   */\n  public filled: boolean = false;\n\n  private _points: Vector[] = [];\n  public anchor = new Vector(0, 0);\n  public rotation: number = 0;\n  public scale = new Vector(1, 1);\n\n  /**\n   * @param points  The vectors to use to build the polygon in order\n   */\n  constructor(points: Vector[]) {\n    this._points = points;\n\n    var minX = this._points.reduce((prev: number, curr: Vector) => {\n      return Math.min(prev, curr.x);\n    }, 0);\n    var maxX = this._points.reduce((prev: number, curr: Vector) => {\n      return Math.max(prev, curr.x);\n    }, 0);\n\n    this.drawWidth = maxX - minX;\n\n    var minY = this._points.reduce((prev: number, curr: Vector) => {\n      return Math.min(prev, curr.y);\n    }, 0);\n    var maxY = this._points.reduce((prev: number, curr: Vector) => {\n      return Math.max(prev, curr.y);\n    }, 0);\n\n    this.drawHeight = maxY - minY;\n\n    this.height = this.drawHeight;\n    this.width = this.drawWidth;\n  }\n\n  /**\n   * @notimplemented Effects are not supported on `Polygon`\n   */\n  public addEffect() {\n    // not supported on polygons\n  }\n  /**\n   * @notimplemented Effects are not supported on `Polygon`\n   */\n  public removeEffect(index: number): void;\n  /**\n   * @notimplemented Effects are not supported on `Polygon`\n   */\n  public removeEffect(effect: Effects.ISpriteEffect): void;\n  /**\n   * @notimplemented Effects are not supported on `Polygon`\n   */\n  public removeEffect() {\n    // not supported on polygons\n  }\n\n  /**\n   * @notimplemented Effects are not supported on `Polygon`\n   */\n  public clearEffects() {\n    // not supported on polygons\n  }\n\n  public reset() {\n    //pass\n  }\n\n  public draw(ctx: CanvasRenderingContext2D, x: number, y: number) {\n    ctx.save();\n    ctx.translate(x + this.anchor.x, y + this.anchor.y);\n    ctx.scale(this.scale.x, this.scale.y);\n    ctx.rotate(this.rotation);\n    ctx.beginPath();\n    ctx.lineWidth = this.lineWidth;\n\n    // Iterate through the supplied points and construct a 'polygon'\n    var firstPoint = this._points[0];\n    ctx.moveTo(firstPoint.x, firstPoint.y);\n\n    var i = 0,\n      len = this._points.length;\n\n    for (i; i < len; i++) {\n      ctx.lineTo(this._points[i].x, this._points[i].y);\n    }\n\n    ctx.lineTo(firstPoint.x, firstPoint.y);\n    ctx.closePath();\n\n    if (this.filled) {\n      ctx.fillStyle = this.fillColor.toString();\n      ctx.fill();\n    }\n\n    ctx.strokeStyle = this.lineColor.toString();\n\n    if (this.flipHorizontal) {\n      ctx.translate(this.drawWidth, 0);\n      ctx.scale(-1, 1);\n    }\n\n    if (this.flipVertical) {\n      ctx.translate(0, this.drawHeight);\n      ctx.scale(1, -1);\n    }\n\n    ctx.stroke();\n    ctx.restore();\n  }\n}\n","import * as Effects from './SpriteEffects';\nimport { Color } from './Color';\n\nimport { IDrawable } from '../Interfaces/IDrawable';\nimport { Texture } from '../Resources/Texture';\nimport { Vector } from '../Algebra';\nimport { Logger } from '../Util/Log';\nimport { clamp } from '../Util/Util';\nimport { Configurable } from '../Configurable';\n\n/**\n * @hidden\n */\nexport class SpriteImpl implements IDrawable {\n  private _texture: Texture;\n\n  public x: number = 0;\n  public y: number = 0;\n\n  public get drawWidth(): number {\n    return this.width * this.scale.x;\n  }\n\n  public get drawHeight(): number {\n    return this.height * this.scale.y;\n  }\n\n  public rotation: number = 0.0;\n  public anchor: Vector = new Vector(0.0, 0.0);\n  public scale: Vector = new Vector(1, 1);\n\n  public logger: Logger = Logger.getInstance();\n\n  /**\n   * Draws the sprite flipped vertically\n   */\n  public flipVertical: boolean = false;\n\n  /**\n   * Draws the sprite flipped horizontally\n   */\n  public flipHorizontal: boolean = false;\n\n  public effects: Effects.ISpriteEffect[] = [];\n\n  public width: number = 0;\n  public height: number = 0;\n\n  private _spriteCanvas: HTMLCanvasElement = null;\n  private _spriteCtx: CanvasRenderingContext2D = null;\n  private _pixelData: ImageData = null;\n  private _pixelsLoaded: boolean = false;\n  private _dirtyEffect: boolean = false;\n\n  /**\n   * @param image   The backing image texture to build the Sprite\n   * @param x      The x position of the sprite\n   * @param y      The y position of the sprite\n   * @param width  The width of the sprite in pixels\n   * @param height The height of the sprite in pixels\n   */\n  constructor(imageOrConfig: Texture | ISpriteArgs, x: number, y: number, width: number, height: number) {\n    var image = imageOrConfig;\n    if (imageOrConfig && !(imageOrConfig instanceof Texture)) {\n      x = imageOrConfig.x | 0;\n      y = imageOrConfig.y | 0;\n      width = imageOrConfig.width | 0;\n      height = imageOrConfig.height | 0;\n      image = imageOrConfig.image;\n      if (!image) {\n        const message = 'An image texture is required to contsruct a sprite';\n        throw new Error(message);\n      }\n    }\n\n    this.x = x || 0;\n    this.y = y || 0;\n\n    this._texture = <Texture>image;\n    this._spriteCanvas = document.createElement('canvas');\n    this._spriteCanvas.width = width;\n    this._spriteCanvas.height = height;\n    this._spriteCtx = <CanvasRenderingContext2D>this._spriteCanvas.getContext('2d');\n    this._texture.loaded\n      .then(() => {\n        this.width = this.width || this._texture.image.naturalWidth;\n        this.height = this.height || this._texture.image.naturalHeight;\n        this._spriteCanvas.width = this._spriteCanvas.width || this._texture.image.naturalWidth;\n        this._spriteCanvas.height = this._spriteCanvas.height || this._texture.image.naturalHeight;\n        this._loadPixels();\n        this._dirtyEffect = true;\n      })\n      .error((e) => {\n        this.logger.error('Error loading texture ', this._texture.path, e);\n      });\n\n    this.width = width;\n    this.height = height;\n  }\n\n  private _loadPixels() {\n    if (this._texture.isLoaded() && !this._pixelsLoaded) {\n      var naturalWidth = this._texture.image.naturalWidth || 0;\n      var naturalHeight = this._texture.image.naturalHeight || 0;\n\n      if (this.width > naturalWidth) {\n        this.logger.warn(`The sprite width ${this.width} exceeds the width \n                              ${naturalWidth} of the backing texture ${this._texture.path}`);\n      }\n\n      if (this.width <= 0 || naturalWidth <= 0) {\n        throw new Error(`The width of a sprite cannot be 0 or negative, sprite width: ${this.width}, original width: ${naturalWidth}`);\n      }\n\n      if (this.height > naturalHeight) {\n        this.logger.warn(`The sprite height ${this.height} exceeds the height \n                              ${naturalHeight} of the backing texture ${this._texture.path}`);\n      }\n\n      if (this.height <= 0 || naturalHeight <= 0) {\n        throw new Error(`The height of a sprite cannot be 0 or negative, sprite height: ${this.height}, original height: ${naturalHeight}`);\n      }\n\n      this._spriteCtx.drawImage(\n        this._texture.image,\n        clamp(this.x, 0, naturalWidth),\n        clamp(this.y, 0, naturalHeight),\n        clamp(this.width, 0, naturalWidth),\n        clamp(this.height, 0, naturalHeight),\n        0,\n        0,\n        this.width,\n        this.height\n      );\n\n      this._pixelsLoaded = true;\n    }\n  }\n\n  /**\n   * Applies the [[Opacity]] effect to a sprite, setting the alpha of all pixels to a given value\n   */\n  public opacity(value: number) {\n    this.addEffect(new Effects.Opacity(value));\n  }\n\n  /**\n   * Applies the [[Grayscale]] effect to a sprite, removing color information.\n   */\n  public grayscale() {\n    this.addEffect(new Effects.Grayscale());\n  }\n\n  /**\n   * Applies the [[Invert]] effect to a sprite, inverting the pixel colors.\n   */\n  public invert() {\n    this.addEffect(new Effects.Invert());\n  }\n\n  /**\n   * Applies the [[Fill]] effect to a sprite, changing the color channels of all non-transparent pixels to match a given color\n   */\n  public fill(color: Color) {\n    this.addEffect(new Effects.Fill(color));\n  }\n\n  /**\n   * Applies the [[Colorize]] effect to a sprite, changing the color channels of all pixels to be the average of the original color\n   * and the provided color.\n   */\n  public colorize(color: Color) {\n    this.addEffect(new Effects.Colorize(color));\n  }\n\n  /**\n   * Applies the [[Lighten]] effect to a sprite, changes the lightness of the color according to HSL\n   */\n  public lighten(factor: number = 0.1) {\n    this.addEffect(new Effects.Lighten(factor));\n  }\n\n  /**\n   * Applies the [[Darken]] effect to a sprite, changes the darkness of the color according to HSL\n   */\n  public darken(factor: number = 0.1) {\n    this.addEffect(new Effects.Darken(factor));\n  }\n\n  /**\n   * Applies the [[Saturate]] effect to a sprite, saturates the color according to HSL\n   */\n  public saturate(factor: number = 0.1) {\n    this.addEffect(new Effects.Saturate(factor));\n  }\n\n  /**\n   * Applies the [[Desaturate]] effect to a sprite, desaturates the color according to HSL\n   */\n  public desaturate(factor: number = 0.1) {\n    this.addEffect(new Effects.Desaturate(factor));\n  }\n\n  /**\n   * Adds a new [[ISpriteEffect]] to this drawing.\n   * @param effect  Effect to add to the this drawing\n   */\n  public addEffect(effect: Effects.ISpriteEffect) {\n    this.effects.push(effect);\n    // We must check if the texture and the backing sprite pixels are loaded as well before\n    // an effect can be applied\n    if (!this._texture.isLoaded() || !this._pixelsLoaded) {\n      this._dirtyEffect = true;\n    } else {\n      this._applyEffects();\n    }\n  }\n\n  /**\n   * Removes a [[ISpriteEffect]] from this sprite.\n   * @param effect  Effect to remove from this sprite\n   */\n  public removeEffect(effect: Effects.ISpriteEffect): void;\n\n  /**\n   * Removes an effect given the index from this sprite.\n   * @param index  Index of the effect to remove from this sprite\n   */\n  public removeEffect(index: number): void;\n  public removeEffect(param: any) {\n    var indexToRemove = -1;\n    if (typeof param === 'number') {\n      indexToRemove = param;\n    } else {\n      indexToRemove = this.effects.indexOf(param);\n    }\n\n    // bounds check\n    if (indexToRemove < 0 || indexToRemove >= this.effects.length) {\n      return;\n    }\n\n    this.effects.splice(indexToRemove, 1);\n\n    // We must check if the texture and the backing sprite pixels are loaded as well before\n    // an effect can be applied\n    if (!this._texture.isLoaded() || !this._pixelsLoaded) {\n      this._dirtyEffect = true;\n    } else {\n      this._applyEffects();\n    }\n  }\n\n  private _applyEffects() {\n    var naturalWidth = this._texture.image.naturalWidth || 0;\n    var naturalHeight = this._texture.image.naturalHeight || 0;\n\n    this._spriteCtx.clearRect(0, 0, this.width, this.height);\n    this._spriteCtx.drawImage(\n      this._texture.image,\n      clamp(this.x, 0, naturalWidth),\n      clamp(this.y, 0, naturalHeight),\n      clamp(this.width, 0, naturalWidth),\n      clamp(this.height, 0, naturalHeight),\n      0,\n      0,\n      this.width,\n      this.height\n    );\n    this._pixelData = this._spriteCtx.getImageData(0, 0, this.width, this.height);\n\n    var i = 0,\n      x = 0,\n      y = 0,\n      len = this.effects.length;\n    for (i; i < len; i++) {\n      y = 0;\n      for (y; y < this.height; y++) {\n        x = 0;\n        for (x; x < this.width; x++) {\n          this.effects[i].updatePixel(x, y, this._pixelData);\n        }\n      }\n    }\n    this._spriteCtx.clearRect(0, 0, this.width, this.height);\n    this._spriteCtx.putImageData(this._pixelData, 0, 0);\n\n    this._dirtyEffect = false;\n  }\n\n  /**\n   * Clears all effects from the drawing and return it to its original state.\n   */\n  public clearEffects() {\n    this.effects.length = 0;\n    this._applyEffects();\n  }\n\n  /**\n   * Resets the internal state of the drawing (if any)\n   */\n  public reset() {\n    // do nothing\n  }\n\n  public debugDraw(ctx: CanvasRenderingContext2D, x: number, y: number) {\n    ctx.save();\n    ctx.translate(x, y);\n    ctx.rotate(this.rotation);\n    var xpoint = this.drawWidth * this.anchor.x;\n    var ypoint = this.drawHeight * this.anchor.y;\n\n    ctx.strokeStyle = Color.Black.toString();\n    ctx.strokeRect(-xpoint, -ypoint, this.drawWidth, this.drawHeight);\n    ctx.restore();\n  }\n\n  /**\n   * Draws the sprite appropriately to the 2D rendering context, at an x and y coordinate.\n   * @param ctx  The 2D rendering context\n   * @param x    The x coordinate of where to draw\n   * @param y    The y coordinate of where to draw\n   */\n  public draw(ctx: CanvasRenderingContext2D, x: number, y: number) {\n    if (this._dirtyEffect) {\n      this._applyEffects();\n    }\n\n    // calculating current dimensions\n    ctx.save();\n    var xpoint = this.drawWidth * this.anchor.x;\n    var ypoint = this.drawHeight * this.anchor.y;\n    ctx.translate(x, y);\n    ctx.rotate(this.rotation);\n\n    // todo cache flipped sprites\n    if (this.flipHorizontal) {\n      ctx.translate(this.drawWidth, 0);\n      ctx.scale(-1, 1);\n    }\n\n    if (this.flipVertical) {\n      ctx.translate(0, this.drawHeight);\n      ctx.scale(1, -1);\n    }\n\n    ctx.drawImage(this._spriteCanvas, 0, 0, this.width, this.height, -xpoint, -ypoint, this.drawWidth, this.drawHeight);\n\n    ctx.restore();\n  }\n\n  /**\n   * Produces a copy of the current sprite\n   */\n  public clone(): SpriteImpl {\n    var result = new Sprite(this._texture, this.x, this.y, this.width, this.height);\n    result.scale = this.scale.clone();\n    result.rotation = this.rotation;\n    result.flipHorizontal = this.flipHorizontal;\n    result.flipVertical = this.flipVertical;\n\n    var i = 0,\n      len = this.effects.length;\n    for (i; i < len; i++) {\n      result.addEffect(this.effects[i]);\n    }\n    return result;\n  }\n}\n\n/**\n * [[include:Constructors.md]]\n */\nexport interface ISpriteArgs extends Partial<SpriteImpl> {\n  image?: Texture;\n  x?: number;\n  width?: number;\n  height?: number;\n  rotation?: number;\n  anchor?: Vector;\n  scale?: Vector;\n  flipVertical?: boolean;\n  flipHorizontal?: boolean;\n}\n\n/**\n * A [[Sprite]] is one of the main drawing primitives. It is responsible for drawing\n * images or parts of images from a [[Texture]] resource to the screen.\n *\n * [[include:Sprites.md]]\n */\nexport class Sprite extends Configurable(SpriteImpl) {\n  constructor(config: ISpriteArgs);\n  constructor(image: Texture, x: number, y: number, width: number, height: number);\n  constructor(imageOrConfig: Texture | ISpriteArgs, x?: number, y?: number, width?: number, height?: number) {\n    super(imageOrConfig, x, y, width, height);\n  }\n}\n","/**\n * These effects can be applied to any bitmap image but are mainly used\n * for [[Sprite]] effects or [[Animation]] effects.\n *\n * [[include:SpriteEffects.md]]\n */\n\n/**\n * @typedoc\n */\n\nimport { Color } from './Color';\n\n/**\n * The interface that all sprite effects must implement\n */\nexport interface ISpriteEffect {\n  /**\n   * Should update individual pixels values\n   * @param x          The pixel's x coordinate\n   * @param y          The pixel's y coordinate\n   * @param imageData  The sprite's raw pixel data\n   */\n  updatePixel(x: number, y: number, imageData: ImageData): void;\n}\n\n/**\n * Applies the \"Grayscale\" effect to a sprite, removing color information.\n */\nexport class Grayscale implements ISpriteEffect {\n  updatePixel(x: number, y: number, imageData: ImageData): void {\n    var firstPixel = (x + y * imageData.width) * 4;\n    var pixel = imageData.data;\n    var avg = (pixel[firstPixel + 0] + pixel[firstPixel + 1] + pixel[firstPixel + 2]) / 3;\n    pixel[firstPixel + 0] = avg;\n    pixel[firstPixel + 1] = avg;\n    pixel[firstPixel + 2] = avg;\n  }\n}\n\n/**\n * Applies the \"Invert\" effect to a sprite, inverting the pixel colors.\n */\nexport class Invert implements ISpriteEffect {\n  updatePixel(x: number, y: number, imageData: ImageData): void {\n    var firstPixel = (x + y * imageData.width) * 4;\n    var pixel = imageData.data;\n    pixel[firstPixel + 0] = 255 - pixel[firstPixel + 0];\n    pixel[firstPixel + 1] = 255 - pixel[firstPixel + 1];\n    pixel[firstPixel + 2] = 255 - pixel[firstPixel + 2];\n  }\n}\n\n/**\n * Applies the \"Opacity\" effect to a sprite, setting the alpha of all pixels to a given value.\n */\nexport class Opacity implements ISpriteEffect {\n  /**\n   * @param opacity  The new opacity of the sprite from 0-1.0\n   */\n  constructor(public opacity: number) {}\n  updatePixel(x: number, y: number, imageData: ImageData): void {\n    var firstPixel = (x + y * imageData.width) * 4;\n    var pixel = imageData.data;\n    if (pixel[firstPixel + 3] !== 0) {\n      pixel[firstPixel + 3] = Math.round(this.opacity * pixel[firstPixel + 3]);\n    }\n  }\n}\n\n/**\n * Applies the \"Colorize\" effect to a sprite, changing the color channels of all the pixels to an\n * average of the original color and the provided color\n */\nexport class Colorize implements ISpriteEffect {\n  /**\n   * @param color  The color to apply to the sprite\n   */\n  constructor(public color: Color) {}\n  updatePixel(x: number, y: number, imageData: ImageData): void {\n    var firstPixel = (x + y * imageData.width) * 4;\n    var pixel = imageData.data;\n    if (pixel[firstPixel + 3] !== 0) {\n      pixel[firstPixel + 0] = (pixel[firstPixel + 0] + this.color.r) / 2;\n      pixel[firstPixel + 1] = (pixel[firstPixel + 1] + this.color.g) / 2;\n      pixel[firstPixel + 2] = (pixel[firstPixel + 2] + this.color.b) / 2;\n    }\n  }\n}\n\n/**\n * Applies the \"Lighten\" effect to a sprite, changes the lightness of the color according to HSL\n */\nexport class Lighten implements ISpriteEffect {\n  /**\n   * @param factor  The factor of the effect between 0-1\n   */\n  constructor(public factor: number = 0.1) {}\n  updatePixel(x: number, y: number, imageData: ImageData): void {\n    var firstPixel = (x + y * imageData.width) * 4;\n    var pixel = imageData.data;\n    var color = Color.fromRGB(pixel[firstPixel + 0], pixel[firstPixel + 1], pixel[firstPixel + 2], pixel[firstPixel + 3]).lighten(\n      this.factor\n    );\n    pixel[firstPixel + 0] = color.r;\n    pixel[firstPixel + 1] = color.g;\n    pixel[firstPixel + 2] = color.b;\n    pixel[firstPixel + 3] = color.a;\n  }\n}\n\n/**\n * Applies the \"Darken\" effect to a sprite, changes the darkness of the color according to HSL\n */\nexport class Darken implements ISpriteEffect {\n  /**\n   * @param factor  The factor of the effect between 0-1\n   */\n  constructor(public factor: number = 0.1) {}\n  updatePixel(x: number, y: number, imageData: ImageData): void {\n    var firstPixel = (x + y * imageData.width) * 4;\n    var pixel = imageData.data;\n    var color = Color.fromRGB(pixel[firstPixel + 0], pixel[firstPixel + 1], pixel[firstPixel + 2], pixel[firstPixel + 3]).darken(\n      this.factor\n    );\n    pixel[firstPixel + 0] = color.r;\n    pixel[firstPixel + 1] = color.g;\n    pixel[firstPixel + 2] = color.b;\n    pixel[firstPixel + 3] = color.a;\n  }\n}\n\n/**\n * Applies the \"Saturate\" effect to a sprite, saturates the color according to HSL\n */\nexport class Saturate implements ISpriteEffect {\n  /**\n   * @param factor  The factor of the effect between 0-1\n   */\n  constructor(public factor: number = 0.1) {}\n  updatePixel(x: number, y: number, imageData: ImageData): void {\n    var firstPixel = (x + y * imageData.width) * 4;\n    var pixel = imageData.data;\n    var color = Color.fromRGB(pixel[firstPixel + 0], pixel[firstPixel + 1], pixel[firstPixel + 2], pixel[firstPixel + 3]).saturate(\n      this.factor\n    );\n    pixel[firstPixel + 0] = color.r;\n    pixel[firstPixel + 1] = color.g;\n    pixel[firstPixel + 2] = color.b;\n    pixel[firstPixel + 3] = color.a;\n  }\n}\n\n/**\n * Applies the \"Desaturate\" effect to a sprite, desaturates the color according to HSL\n */\nexport class Desaturate implements ISpriteEffect {\n  /**\n   * @param factor  The factor of the effect between 0-1\n   */\n  constructor(public factor: number = 0.1) {}\n  updatePixel(x: number, y: number, imageData: ImageData): void {\n    var firstPixel = (x + y * imageData.width) * 4;\n    var pixel = imageData.data;\n    var color = Color.fromRGB(pixel[firstPixel + 0], pixel[firstPixel + 1], pixel[firstPixel + 2], pixel[firstPixel + 3]).desaturate(\n      this.factor\n    );\n    pixel[firstPixel + 0] = color.r;\n    pixel[firstPixel + 1] = color.g;\n    pixel[firstPixel + 2] = color.b;\n    pixel[firstPixel + 3] = color.a;\n  }\n}\n\n/**\n * Applies the \"Fill\" effect to a sprite, changing the color channels of all non-transparent pixels to match\n * a given color\n */\nexport class Fill implements ISpriteEffect {\n  /**\n   * @param color  The color to apply to the sprite\n   */\n  constructor(public color: Color) {}\n  updatePixel(x: number, y: number, imageData: ImageData): void {\n    var firstPixel = (x + y * imageData.width) * 4;\n    var pixel = imageData.data;\n    if (pixel[firstPixel + 3] !== 0) {\n      pixel[firstPixel + 0] = this.color.r;\n      pixel[firstPixel + 1] = this.color.g;\n      pixel[firstPixel + 2] = this.color.b;\n    }\n  }\n}\n","import { Sprite, ISpriteArgs } from './Sprite';\nimport { Animation } from './Animation';\nimport { Color } from './Color';\nimport * as Effects from './SpriteEffects';\n\nimport { Texture } from '../Resources/Texture';\nimport { Engine } from '../Engine';\nimport { Logger } from '../Util/Log';\nimport { TextAlign, BaseAlign } from '../Label';\nimport { Configurable } from '../Configurable';\n\n/**\n * @hidden\n */\nexport class SpriteSheetImpl {\n  public sprites: Sprite[] = [];\n  public image: Texture = null;\n  public columns: number = 0;\n  public rows: number = 0;\n  public spWidth: number = 0;\n  public spHeight: number = 0;\n\n  /**\n   * @param image     The backing image texture to build the SpriteSheet\n   * @param columns   The number of columns in the image texture\n   * @param rows      The number of rows in the image texture\n   * @param spWidth   The width of each individual sprite in pixels\n   * @param spHeight  The height of each individual sprite in pixels\n   */\n  constructor(\n    imageOrConfigOrSprites: Texture | ISpriteSheetArgs | Sprite[],\n    columns?: number,\n    rows?: number,\n    spWidth?: number,\n    spHeight?: number\n  ) {\n    var loadFromImage: boolean = false;\n    if (imageOrConfigOrSprites instanceof Array) {\n      this.sprites = imageOrConfigOrSprites;\n    } else {\n      if (imageOrConfigOrSprites && !(imageOrConfigOrSprites instanceof Texture)) {\n        this.columns = imageOrConfigOrSprites.columns;\n        this.rows = imageOrConfigOrSprites.rows;\n        this.spWidth = imageOrConfigOrSprites.spWidth;\n        this.spHeight = imageOrConfigOrSprites.spHeight;\n        this.image = imageOrConfigOrSprites.image;\n      } else {\n        this.image = <Texture>imageOrConfigOrSprites;\n        this.columns = columns;\n        this.rows = rows;\n        this.spWidth = spWidth;\n        this.spHeight = spHeight;\n      }\n      this.sprites = new Array(this.columns * this.rows);\n      loadFromImage = true;\n    }\n\n    // TODO: Inspect actual image dimensions with preloading\n    /*if(spWidth * columns > this.internalImage.naturalWidth){\n         throw new Error(\"SpriteSheet specified is wider than image width\");\n      }\n\n      if(spHeight * rows > this.internalImage.naturalHeight){\n         throw new Error(\"SpriteSheet specified is higher than image height\");\n      }*/\n\n    if (loadFromImage) {\n      var i = 0;\n      var j = 0;\n      for (i = 0; i < this.rows; i++) {\n        for (j = 0; j < this.columns; j++) {\n          this.sprites[j + i * this.columns] = new Sprite(this.image, j * this.spWidth, i * this.spHeight, this.spWidth, this.spHeight);\n        }\n      }\n    }\n  }\n\n  /**\n   * Create an animation from the this SpriteSheet by listing out the\n   * sprite indices. Sprites are organized in row major order in the SpriteSheet.\n   * @param engine   Reference to the current game [[Engine]]\n   * @param indices  An array of sprite indices to use in the animation\n   * @param speed    The number in milliseconds to display each frame in the animation\n   */\n  public getAnimationByIndices(engine: Engine, indices: number[], speed: number) {\n    var images: Sprite[] = indices.map((index) => {\n      return this.sprites[index];\n    });\n\n    images = images.map(function(i) {\n      return i.clone();\n    });\n    return new Animation(engine, images, speed);\n  }\n\n  /**\n   * Create an animation from the this SpriteSheet by specifing the range of\n   * images with the beginning (inclusive) and ending (exclusive) index\n   * For example `getAnimationBetween(engine, 0, 5, 200)` returns an animation with 5 frames.\n   * @param engine      Reference to the current game Engine\n   * @param beginIndex  The index to start taking frames (inclusive)\n   * @param endIndex    The index to stop taking frames (exclusive)\n   * @param speed       The number in milliseconds to display each frame in the animation\n   */\n  public getAnimationBetween(engine: Engine, beginIndex: number, endIndex: number, speed: number) {\n    var images = this.sprites.slice(beginIndex, endIndex);\n    images = images.map(function(i) {\n      return i.clone();\n    });\n    return new Animation(engine, images, speed);\n  }\n\n  /**\n   * Treat the entire SpriteSheet as one animation, organizing the frames in\n   * row major order.\n   * @param engine  Reference to the current game [[Engine]]\n   * @param speed   The number in milliseconds to display each frame the animation\n   */\n  public getAnimationForAll(engine: Engine, speed: number) {\n    var sprites = this.sprites.map(function(i) {\n      return i.clone();\n    });\n    return new Animation(engine, sprites, speed);\n  }\n\n  /**\n   * Retreive a specific sprite from the SpriteSheet by its index. Sprites are organized\n   * in row major order in the SpriteSheet.\n   * @param index  The index of the sprite\n   */\n  public getSprite(index: number): Sprite {\n    if (index >= 0 && index < this.sprites.length) {\n      return this.sprites[index];\n    } else {\n      throw new Error('Invalid index: ' + index);\n    }\n  }\n\n  /**\n   * Get an animation with bespoke sprite coordinates. This is useful if the SpriteSheet is\n   * packed and not a uniform width or height. The resulting [[Animation]] will have the height and width of the\n   * largest dimension (width, height) from among the sprite coordinates\n   * @param engine\n   * @param spriteCoordinates\n   * @param speed\n   */\n  public getAnimationByCoords(engine: Engine, spriteCoordinates: ISpriteArgs[], speed: number): Animation {\n    let maxWidth: number = 0;\n    let maxHeight: number = 0;\n    let sprites: Sprite[] = new Array(spriteCoordinates.length);\n    for (let i = 0; i < spriteCoordinates.length; i++) {\n      let coord = spriteCoordinates[i];\n      // no need to pass image again if using a spritesheet\n      coord.image = coord.image || this.image;\n      maxWidth = Math.max(maxWidth, coord.drawWidth);\n      maxHeight = Math.max(maxHeight, coord.drawHeight);\n      sprites[i] = new Sprite(coord);\n    }\n\n    let anim = new Animation(engine, sprites, speed);\n\n    anim.drawWidth = maxWidth;\n    anim.drawHeight = maxHeight;\n    return anim;\n  }\n}\n\n/**\n * [[include:Constructors.md]]\n */\nexport interface ISpriteSheetArgs extends Partial<SpriteSheetImpl> {\n  image: Texture;\n  sprites?: Sprite[];\n  spWidth: number;\n  spHeight: number;\n  rows: number;\n  columns: number;\n}\n\n/**\n * Sprite sheets are a useful mechanism for slicing up image resources into\n * separate sprites or for generating in game animations. [[Sprite|Sprites]] are organized\n * in row major order in the [[SpriteSheet]].\n *\n * [[include:SpriteSheets.md]]\n */\nexport class SpriteSheet extends Configurable(SpriteSheetImpl) {\n  constructor(config: ISpriteSheetArgs);\n  constructor(sprites: Sprite[]);\n  constructor(image: Texture, columns: number, rows: number, spWidth: number, spHeight: number);\n  constructor(\n    imageOrConfigOrSprites: Texture | ISpriteSheetArgs | Sprite[],\n    columns?: number,\n    rows?: number,\n    spWidth?: number,\n    spHeight?: number\n  ) {\n    super(imageOrConfigOrSprites, columns, rows, spWidth, spHeight);\n  }\n}\n\nexport class SpriteFontImpl extends SpriteSheet {\n  private _currentColor: Color = Color.Black.clone();\n  private _currentOpacity: Number = 1.0;\n  private _sprites: { [key: string]: Sprite } = {};\n\n  // text shadow\n  private _textShadowOn: boolean = false;\n  private _textShadowDirty: boolean = true;\n  private _textShadowColor: Color = Color.Black.clone();\n  private _textShadowSprites: { [key: string]: Sprite } = {};\n  private _shadowOffsetX: number = 5;\n  private _shadowOffsetY: number = 5;\n  private _alphabet: string;\n  private _caseInsensitive: boolean;\n\n  /**\n   * @param image           The backing image texture to build the SpriteFont\n   * @param alphabet        A string representing all the characters in the image, in row major order.\n   * @param caseInsensitive  Indicate whether this font takes case into account\n   * @param columns         The number of columns of characters in the image\n   * @param rows            The number of rows of characters in the image\n   * @param spWidth         The width of each character in pixels\n   * @param spHeight        The height of each character in pixels\n   */\n  constructor(\n    imageOrConfig: Texture | ISpriteFontInitArgs,\n    alphabet: string,\n    caseInsensitive: boolean,\n    columns: number,\n    rows: number,\n    spWidth: number,\n    spHeight: number\n  ) {\n    super(\n      imageOrConfig instanceof Texture\n        ? {\n            image: imageOrConfig,\n            spWidth: spWidth,\n            spHeight: spHeight,\n            rows: rows,\n            columns: columns\n          }\n        : imageOrConfig\n    );\n\n    if (imageOrConfig && !(imageOrConfig instanceof Texture)) {\n      alphabet = imageOrConfig.alphabet;\n      caseInsensitive = imageOrConfig.caseInsensitive;\n    }\n\n    this._alphabet = alphabet;\n    this._caseInsensitive = caseInsensitive;\n    this._sprites = this.getTextSprites();\n  }\n\n  /**\n   * Returns a dictionary that maps each character in the alphabet to the appropriate [[Sprite]].\n   */\n  public getTextSprites(): { [key: string]: Sprite } {\n    var lookup: { [key: string]: Sprite } = {};\n    for (var i = 0; i < this._alphabet.length; i++) {\n      var char = this._alphabet[i];\n      if (this._caseInsensitive) {\n        char = char.toLowerCase();\n      }\n      lookup[char] = this.sprites[i].clone();\n    }\n    return lookup;\n  }\n\n  /**\n   * Sets the text shadow for sprite fonts\n   * @param offsetX      The x offset in pixels to place the shadow\n   * @param offsetY      The y offset in pixels to place the shadow\n   * @param shadowColor  The color of the text shadow\n   */\n  public setTextShadow(offsetX: number, offsetY: number, shadowColor: Color) {\n    this._textShadowOn = true;\n    this._shadowOffsetX = offsetX;\n    this._shadowOffsetY = offsetY;\n    this._textShadowColor = shadowColor.clone();\n    this._textShadowDirty = true;\n    for (var character in this._sprites) {\n      this._textShadowSprites[character] = this._sprites[character].clone();\n    }\n  }\n\n  /**\n   * Toggles text shadows on or off\n   */\n  public useTextShadow(on: boolean) {\n    this._textShadowOn = on;\n    if (on) {\n      this.setTextShadow(5, 5, this._textShadowColor);\n    }\n  }\n\n  /**\n   * Draws the current sprite font\n   */\n  public draw(ctx: CanvasRenderingContext2D, text: string, x: number, y: number, options: ISpriteFontOptions) {\n    options = this._parseOptions(options);\n\n    if (this._currentColor.toString() !== options.color.toString() || this._currentOpacity !== options.opacity) {\n      this._currentOpacity = options.opacity;\n      this._currentColor = options.color;\n      for (var char in this._sprites) {\n        this._sprites[char].clearEffects();\n        this._sprites[char].fill(options.color);\n        this._sprites[char].opacity(options.opacity);\n      }\n    }\n\n    if (this._textShadowOn && this._textShadowDirty && this._textShadowColor) {\n      for (var characterShadow in this._textShadowSprites) {\n        this._textShadowSprites[characterShadow].clearEffects();\n        this._textShadowSprites[characterShadow].addEffect(new Effects.Fill(this._textShadowColor.clone()));\n      }\n      this._textShadowDirty = false;\n    }\n\n    // find the current length of text in pixels\n    var sprite = this.sprites[0];\n\n    // find the current height fo the text in pixels\n    var height = sprite.drawHeight;\n\n    // calculate appropriate scale for font size\n    var scale = options.fontSize / height;\n\n    var length = text.length * sprite.drawWidth * scale + text.length * options.letterSpacing;\n\n    var currX = x;\n    if (options.textAlign === TextAlign.Left || options.textAlign === TextAlign.Start) {\n      currX = x;\n    } else if (options.textAlign === TextAlign.Right || options.textAlign === TextAlign.End) {\n      currX = x - length;\n    } else if (options.textAlign === TextAlign.Center) {\n      currX = x - length / 2;\n    }\n\n    var currY = y - height * scale;\n    if (options.baseAlign === BaseAlign.Top || options.baseAlign === BaseAlign.Hanging) {\n      currY = y;\n    } else if (\n      options.baseAlign === BaseAlign.Ideographic ||\n      options.baseAlign === BaseAlign.Bottom ||\n      options.baseAlign === BaseAlign.Alphabetic\n    ) {\n      currY = y - height * scale;\n    } else if (options.baseAlign === BaseAlign.Middle) {\n      currY = y - (height * scale) / 2;\n    }\n\n    for (var i = 0; i < text.length; i++) {\n      var character = text[i];\n      if (this._caseInsensitive) {\n        character = character.toLowerCase();\n      }\n      try {\n        // if text shadow\n        if (this._textShadowOn) {\n          this._textShadowSprites[character].scale.x = scale;\n          this._textShadowSprites[character].scale.y = scale;\n          this._textShadowSprites[character].draw(ctx, currX + this._shadowOffsetX, currY + this._shadowOffsetY);\n        }\n\n        var charSprite = this._sprites[character];\n        charSprite.scale.x = scale;\n        charSprite.scale.y = scale;\n        charSprite.draw(ctx, currX, currY);\n        currX += charSprite.drawWidth + options.letterSpacing;\n      } catch (e) {\n        Logger.getInstance().error(`SpriteFont Error drawing char ${character}`);\n      }\n    }\n  }\n\n  private _parseOptions(options: ISpriteFontOptions): ISpriteFontOptions {\n    return {\n      fontSize: options.fontSize || 10,\n      letterSpacing: options.letterSpacing || 0,\n      color: options.color || Color.Black.clone(),\n      textAlign: typeof options.textAlign === undefined ? TextAlign.Left : options.textAlign,\n      baseAlign: typeof options.baseAlign === undefined ? BaseAlign.Bottom : options.baseAlign,\n      maxWidth: options.maxWidth || -1,\n      opacity: options.opacity || 0\n    };\n  }\n}\n\n/**\n * Specify various font attributes for sprite fonts\n */\nexport interface ISpriteFontOptions {\n  color?: Color;\n  opacity?: number;\n  fontSize?: number;\n  letterSpacing?: number;\n  textAlign?: TextAlign;\n  baseAlign?: BaseAlign;\n  maxWidth?: number;\n}\n\n/**\n * [[include:Constructors.md]]\n */\nexport interface ISpriteFontInitArgs extends ISpriteSheetArgs {\n  image: Texture;\n  columns: number;\n  rows: number;\n  spWidth: number;\n  spHeight: number;\n  alphabet: string;\n  caseInsensitive: boolean;\n}\n\n/**\n * Sprite fonts are a used in conjunction with a [[Label]] to specify\n * a particular bitmap as a font. Note that some font features are not\n * supported by Sprite fonts.\n *\n * [[include:SpriteFonts.md]]\n */\nexport class SpriteFont extends Configurable(SpriteFontImpl) {\n  constructor(config: ISpriteFontInitArgs);\n  constructor(image: Texture, alphabet: string, caseInsensitive: boolean, columns: number, rows: number, spWidth: number, spHeight: number);\n  constructor(\n    imageOrConfig: Texture | ISpriteFontInitArgs,\n    alphabet?: string,\n    caseInsensitive?: boolean,\n    columns?: number,\n    rows?: number,\n    spWidth?: number,\n    spHeight?: number\n  ) {\n    super(imageOrConfig, alphabet, caseInsensitive, columns, rows, spWidth, spHeight);\n  }\n}\n","import { EX_VERSION } from './';\nimport './Polyfill';\nimport { ICanUpdate, ICanDraw, ICanInitialize } from './Interfaces/LifecycleEvents';\nimport { ILoadable } from './Interfaces/ILoadable';\nimport { Promise } from './Promises';\nimport { Vector } from './Algebra';\nimport { UIActor } from './UIActor';\nimport { Actor } from './Actor';\nimport { Timer } from './Timer';\nimport { TileMap } from './TileMap';\nimport { Animation } from './Drawing/Animation';\nimport { Loader } from './Loader';\nimport { Detector } from './Util/Detector';\nimport {\n  VisibleEvent,\n  HiddenEvent,\n  GameStartEvent,\n  GameStopEvent,\n  PreUpdateEvent,\n  PostUpdateEvent,\n  PreFrameEvent,\n  PostFrameEvent,\n  GameEvent,\n  DeactivateEvent,\n  ActivateEvent,\n  PreDrawEvent,\n  PostDrawEvent,\n  InitializeEvent\n} from './Events';\nimport { ILoader } from './Interfaces/ILoader';\nimport { Logger, LogLevel } from './Util/Log';\nimport { Color } from './Drawing/Color';\nimport { Scene } from './Scene';\nimport { IPostProcessor } from './PostProcessing/IPostProcessor';\nimport { Debug, IDebugStats } from './Debug';\nimport { Class } from './Class';\nimport * as Input from './Input/Index';\nimport * as Util from './Util/Util';\nimport * as Events from './Events';\nimport { BoundingBox } from './Collision/BoundingBox';\n\n/**\n * Enum representing the different display modes available to Excalibur\n */\nexport enum DisplayMode {\n  /**\n   * Show the game as full screen\n   */\n  FullScreen,\n  /**\n   * Scale the game to the parent DOM container\n   */\n  Container,\n  /**\n   * Show the game as a fixed size\n   */\n  Fixed,\n\n  /**\n   * Allow the game to be positioned with the [[IEngineOptions.position]] option\n   */\n  Position\n}\n\n/**\n * Enum representing the different mousewheel event bubble prevention\n */\nexport enum ScrollPreventionMode {\n  /**\n   * Do not prevent any page scrolling\n   */\n  None,\n  /**\n   * Prevent page scroll if mouse is over the game canvas\n   */\n  Canvas,\n  /**\n   * Prevent all page scrolling via mouse wheel\n   */\n  All\n}\n\n/**\n * Interface describing the absolute CSS position of the game window. For use when [[DisplayMode.Position]]\n * is specified and when the user wants to define exact pixel spacing of the window.\n * When a number is given, the value is interpreted as pixels\n */\nexport interface IAbsolutePosition {\n  top?: number | string;\n  left?: number | string;\n  right?: number | string;\n  bottom?: number | string;\n}\n\n/**\n * Defines the available options to configure the Excalibur engine at constructor time.\n */\nexport interface IEngineOptions {\n  /**\n   * Optionally configure the native canvas width of the game\n   */\n  width?: number;\n\n  /**\n   * Optionally configure the native canvas height of the game\n   */\n  height?: number;\n\n  /**\n   * Optionally specify the target canvas DOM element to render the game in\n   */\n  canvasElementId?: string;\n\n  /**\n   * The [[DisplayMode]] of the game. Depending on this value, [[width]] and [[height]] may be ignored.\n   */\n  displayMode?: DisplayMode;\n\n  /**\n   * Configures the pointer scope. Pointers scoped to the 'Canvas' can only fire events within the canvas viewport; whereas, 'Document'\n   * (default) scoped will fire anywhere on the page.\n   */\n  pointerScope?: Input.PointerScope;\n\n  /**\n   * Suppress boot up console message, which contains the \"powered by Excalibur message\"\n   */\n  suppressConsoleBootMessage?: boolean;\n\n  /**\n   * Suppress minimum browser feature detection, it is not recommended users of excalibur switch this off. This feature ensures that\n   * the currently running browser meets the minimum requirements for running excalibur. This can be useful if running on non-standard\n   * browsers or if there is a bug in excalibur preventing execution.\n   */\n  suppressMinimumBrowserFeatureDetection?: boolean;\n\n  /**\n   * Suppress HiDPI auto detection and scaling, it is not recommended users of excalibur switch off this feature. This feature detects\n   * and scales the drawing canvas appropriately to accommodate HiDPI screens.\n   */\n  suppressHiDPIScaling?: boolean;\n\n  /**\n   * Suppress play button, it is not recommended users of excalibur switch this feature. Some browsers require a user gesture (like a click)\n   * for certain browser features to work like web audio.\n   */\n  suppressPlayButton?: boolean;\n\n  /**\n   * Specify how the game window is to be positioned when the [[DisplayMode.Position]] is chosen. This option MUST be specified\n   * if the DisplayMode is set as [[DisplayMode.Position]]. The position can be either a string or an [[IAbsolutePosition]].\n   * String must be in the format of css style background-position. The vertical position must precede the horizontal position in strings.\n   *\n   * Valid String examples: \"top left\", \"top\", \"bottom\", \"middle\", \"middle center\", \"bottom right\"\n   * Valid [[IAbsolutePosition]] examples: `{top: 5, right: 10%}`, `{bottom: 49em, left: 10px}`, `{left: 10, bottom: 40}`\n   */\n  position?: string | IAbsolutePosition;\n\n  /**\n   * Scroll prevention method.\n   */\n  scrollPreventionMode?: ScrollPreventionMode;\n\n  /**\n   * Optionally set the background color\n   */\n  backgroundColor?: Color;\n}\n\n/**\n * The Excalibur Engine\n *\n * The [[Engine]] is the main driver for a game. It is responsible for\n * starting/stopping the game, maintaining state, transmitting events,\n * loading resources, and managing the scene.\n *\n * [[include:Engine.md]]\n */\nexport class Engine extends Class implements ICanInitialize, ICanUpdate, ICanDraw {\n  /**\n   * Direct access to the engine's canvas element\n   */\n  public canvas: HTMLCanvasElement;\n\n  /**\n   * Direct access to the engine's 2D rendering context\n   */\n  public ctx: CanvasRenderingContext2D;\n\n  /**\n   * Direct access to the canvas element ID, if an ID exists\n   */\n  public canvasElementId: string;\n\n  /**\n   * The width of the game canvas in pixels (physical width component of the\n   * resolution of the canvas element)\n   */\n  public get canvasWidth(): number {\n    return this.canvas.width;\n  }\n\n  /**\n   * Returns half width of the game canvas in pixels (half physical width component)\n   */\n  public get halfCanvasWidth(): number {\n    return this.canvas.width / 2;\n  }\n\n  /**\n   * The height of the game canvas in pixels, (physical height component of\n   * the resolution of the canvas element)\n   */\n  public get canvasHeight(): number {\n    return this.canvas.height;\n  }\n\n  /**\n   * Returns half height of the game canvas in pixels (half physical height component)\n   */\n  public get halfCanvasHeight(): number {\n    return this.canvas.height / 2;\n  }\n\n  /**\n   * Returns the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\n   */\n  public get drawWidth(): number {\n    if (this.currentScene && this.currentScene.camera) {\n      return this.canvasWidth / this.currentScene.camera.getZoom() / this.pixelRatio;\n    }\n    return this.canvasWidth / this.pixelRatio;\n  }\n\n  /**\n   * Returns half the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\n   */\n  public get halfDrawWidth(): number {\n    return this.drawWidth / 2;\n  }\n\n  /**\n   * Returns the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\n   */\n  public get drawHeight(): number {\n    if (this.currentScene && this.currentScene.camera) {\n      return this.canvasHeight / this.currentScene.camera.getZoom() / this.pixelRatio;\n    }\n    return this.canvasHeight / this.pixelRatio;\n  }\n\n  /**\n   * Returns half the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\n   */\n  public get halfDrawHeight(): number {\n    return this.drawHeight / 2;\n  }\n\n  /**\n   * Returns whether excalibur detects the current screen to be HiDPI\n   */\n  public get isHiDpi(): boolean {\n    return this.pixelRatio !== 1;\n  }\n\n  /**\n   * Access engine input like pointer, keyboard, or gamepad\n   */\n  public input: Input.IEngineInput;\n\n  private _hasStarted: boolean = false;\n\n  /**\n   * Access Excalibur debugging functionality.\n   */\n  public debug = new Debug();\n\n  /**\n   * Access [[stats]] that holds frame statistics.\n   */\n  public get stats(): IDebugStats {\n    return this.debug.stats;\n  }\n\n  /**\n   * Gets or sets the list of post processors to apply at the end of drawing a frame (such as [[ColorBlindCorrector]])\n   */\n  public postProcessors: IPostProcessor[] = [];\n\n  /**\n   * The current [[Scene]] being drawn and updated on screen\n   */\n  public currentScene: Scene;\n\n  /**\n   * The default [[Scene]] of the game, use [[Engine.goToScene]] to transition to different scenes.\n   */\n  public rootScene: Scene;\n\n  /**\n   * Contains all the scenes currently registered with Excalibur\n   */\n  public scenes: { [key: string]: Scene } = {};\n\n  private _animations: AnimationNode[] = [];\n\n  /**\n   * Indicates whether the engine is set to fullscreen or not\n   */\n  public isFullscreen: boolean = false;\n\n  /**\n   * Indicates the current [[DisplayMode]] of the engine.\n   */\n  public displayMode: DisplayMode = DisplayMode.FullScreen;\n\n  private _suppressHiDPIScaling: boolean = false;\n\n  private _suppressPlayButton: boolean = false;\n  /**\n   * Returns the calculated pixel ration for use in rendering\n   */\n  public get pixelRatio(): number {\n    if (this._suppressHiDPIScaling) {\n      return 1;\n    }\n\n    if (window.devicePixelRatio < 1) {\n      return 1;\n    }\n\n    let devicePixelRatio = window.devicePixelRatio || 1;\n\n    let pixelRatio = devicePixelRatio;\n    return pixelRatio;\n  }\n\n  /**\n   * Indicates the current position of the engine. Valid only when DisplayMode is DisplayMode.Position\n   */\n  public position: string | IAbsolutePosition;\n  /**\n   * Indicates whether audio should be paused when the game is no longer visible.\n   */\n  public pauseAudioWhenHidden: boolean = true;\n\n  /**\n   * Indicates whether the engine should draw with debug information\n   */\n  public isDebug: boolean = false;\n  public debugColor: Color = new Color(255, 255, 255);\n  /**\n   * Sets the background color for the engine.\n   */\n  public backgroundColor: Color;\n\n  /**\n   * The action to take when a fatal exception is thrown\n   */\n  public onFatalException = (e: any) => {\n    Logger.getInstance().fatal(e);\n  };\n\n  /**\n   * The mouse wheel scroll prevention mode\n   */\n  public pageScrollPreventionMode: ScrollPreventionMode;\n\n  private _logger: Logger;\n  private _isSmoothingEnabled: boolean = true;\n\n  // this is a reference to the current requestAnimationFrame return value\n  private _requestId: number;\n\n  // this determines whether excalibur is compatible with your browser\n  private _compatible: boolean;\n\n  private _timescale: number = 1.0;\n\n  // loading\n  private _loader: ILoader;\n  private _isLoading: boolean = false;\n\n  private _isInitialized: boolean = false;\n\n  public on(eventName: Events.initialize, handler: (event?: Events.InitializeEvent) => void): void;\n  public on(eventName: Events.visible, handler: (event?: VisibleEvent) => void): void;\n  public on(eventName: Events.hidden, handler: (event?: HiddenEvent) => void): void;\n  public on(eventName: Events.start, handler: (event?: GameStartEvent) => void): void;\n  public on(eventName: Events.stop, handler: (event?: GameStopEvent) => void): void;\n  public on(eventName: Events.preupdate, handler: (event?: PreUpdateEvent) => void): void;\n  public on(eventName: Events.postupdate, handler: (event?: PostUpdateEvent) => void): void;\n  public on(eventName: Events.preframe, handler: (event?: PreFrameEvent) => void): void;\n  public on(eventName: Events.postframe, handler: (event?: PostFrameEvent) => void): void;\n  public on(eventName: Events.predraw, handler: (event?: PreDrawEvent) => void): void;\n  public on(eventName: Events.postdraw, handler: (event?: PostDrawEvent) => void): void;\n  public on(eventName: string, handler: (event?: GameEvent<any>) => void): void;\n  public on(eventName: string, handler: (event?: any) => void): void {\n    super.on(eventName, handler);\n  }\n\n  public once(eventName: Events.initialize, handler: (event?: Events.InitializeEvent) => void): void;\n  public once(eventName: Events.visible, handler: (event?: VisibleEvent) => void): void;\n  public once(eventName: Events.hidden, handler: (event?: HiddenEvent) => void): void;\n  public once(eventName: Events.start, handler: (event?: GameStartEvent) => void): void;\n  public once(eventName: Events.stop, handler: (event?: GameStopEvent) => void): void;\n  public once(eventName: Events.preupdate, handler: (event?: PreUpdateEvent) => void): void;\n  public once(eventName: Events.postupdate, handler: (event?: PostUpdateEvent) => void): void;\n  public once(eventName: Events.preframe, handler: (event?: PreFrameEvent) => void): void;\n  public once(eventName: Events.postframe, handler: (event?: PostFrameEvent) => void): void;\n  public once(eventName: Events.predraw, handler: (event?: PreDrawEvent) => void): void;\n  public once(eventName: Events.postdraw, handler: (event?: PostDrawEvent) => void): void;\n  public once(eventName: string, handler: (event?: GameEvent<any>) => void): void;\n  public once(eventName: string, handler: (event?: any) => void): void {\n    super.once(eventName, handler);\n  }\n\n  public off(eventName: Events.initialize, handler?: (event?: Events.InitializeEvent) => void): void;\n  public off(eventName: Events.visible, handler?: (event?: VisibleEvent) => void): void;\n  public off(eventName: Events.hidden, handler?: (event?: HiddenEvent) => void): void;\n  public off(eventName: Events.start, handler?: (event?: GameStartEvent) => void): void;\n  public off(eventName: Events.stop, handler?: (event?: GameStopEvent) => void): void;\n  public off(eventName: Events.preupdate, handler?: (event?: PreUpdateEvent) => void): void;\n  public off(eventName: Events.postupdate, handler?: (event?: PostUpdateEvent) => void): void;\n  public off(eventName: Events.preframe, handler?: (event?: PreFrameEvent) => void): void;\n  public off(eventName: Events.postframe, handler?: (event?: PostFrameEvent) => void): void;\n  public off(eventName: Events.predraw, handler?: (event?: PreDrawEvent) => void): void;\n  public off(eventName: Events.postdraw, handler?: (event?: PostDrawEvent) => void): void;\n  public off(eventName: string, handler?: (event?: GameEvent<any>) => void): void;\n  public off(eventName: string, handler?: (event?: any) => void): void {\n    super.off(eventName, handler);\n  }\n\n  /**\n   * Default [[IEngineOptions]]\n   */\n  private static _DefaultEngineOptions: IEngineOptions = {\n    width: 0,\n    height: 0,\n    canvasElementId: '',\n    pointerScope: Input.PointerScope.Document,\n    suppressConsoleBootMessage: null,\n    suppressMinimumBrowserFeatureDetection: null,\n    suppressHiDPIScaling: null,\n    suppressPlayButton: null,\n    scrollPreventionMode: ScrollPreventionMode.Canvas,\n    backgroundColor: Color.fromHex('#2185d0') // Excalibur blue\n  };\n\n  /**\n   * Creates a new game using the given [[IEngineOptions]]. By default, if no options are provided,\n   * the game will be rendered full screen (taking up all available browser window space).\n   * You can customize the game rendering through [[IEngineOptions]].\n   *\n   * Example:\n   *\n   * ```js\n   * var game = new ex.Engine({\n   *   width: 0, // the width of the canvas\n   *   height: 0, // the height of the canvas\n   *   canvasElementId: '', // the DOM canvas element ID, if you are providing your own\n   *   displayMode: ex.DisplayMode.FullScreen, // the display mode\n   *   pointerScope: ex.Input.PointerScope.Document, // the scope of capturing pointer (mouse/touch) events\n   *   backgroundColor: ex.Color.fromHex('#2185d0') // background color of the engine\n   * });\n   *\n   * // call game.start, which is a Promise\n   * game.start().then(function () {\n   *   // ready, set, go!\n   * });\n   * ```\n   */\n  constructor(options?: IEngineOptions) {\n    super();\n\n    options = Util.extend({}, Engine._DefaultEngineOptions, options);\n\n    // Check compatibility\n    var detector = new Detector();\n    if (!options.suppressMinimumBrowserFeatureDetection && !(this._compatible = detector.test())) {\n      var message = document.createElement('div');\n      message.innerText = 'Sorry, your browser does not support all the features needed for Excalibur';\n      document.body.appendChild(message);\n\n      detector.failedTests.forEach(function(test) {\n        var testMessage = document.createElement('div');\n        testMessage.innerText = 'Browser feature missing ' + test;\n        document.body.appendChild(testMessage);\n      });\n\n      if (options.canvasElementId) {\n        var canvas = document.getElementById(options.canvasElementId);\n        if (canvas) {\n          canvas.parentElement.removeChild(canvas);\n        }\n      }\n\n      return;\n    } else {\n      this._compatible = true;\n    }\n\n    // Use native console API for color fun\n    if (console.log && !options.suppressConsoleBootMessage) {\n      console.log(\n        `%cPowered by Excalibur.js (v${EX_VERSION})`,\n        'background: #176BAA; color: white; border-radius: 5px; padding: 15px; font-size: 1.5em; line-height: 80px;'\n      );\n      console.log('\\n\\\n      /| ________________\\n\\\nO|===|* >________________>\\n\\\n      \\\\|');\n      console.log('Visit', 'http://excaliburjs.com', 'for more information');\n    }\n\n    // Suppress play button\n    if (options.suppressPlayButton) {\n      this._suppressPlayButton = true;\n    }\n\n    this._logger = Logger.getInstance();\n\n    // If debug is enabled, let's log browser features to the console.\n    if (this._logger.defaultLevel === LogLevel.Debug) {\n      detector.logBrowserFeatures();\n    }\n\n    this._logger.debug('Building engine...');\n\n    this.canvasElementId = options.canvasElementId;\n\n    if (options.canvasElementId) {\n      this._logger.debug('Using Canvas element specified: ' + options.canvasElementId);\n      this.canvas = <HTMLCanvasElement>document.getElementById(options.canvasElementId);\n    } else {\n      this._logger.debug('Using generated canvas element');\n      this.canvas = <HTMLCanvasElement>document.createElement('canvas');\n    }\n    if (options.width && options.height) {\n      if (options.displayMode === undefined) {\n        this.displayMode = DisplayMode.Fixed;\n      }\n      this._logger.debug('Engine viewport is size ' + options.width + ' x ' + options.height);\n\n      this.canvas.width = options.width;\n      this.canvas.height = options.height;\n    } else if (!options.displayMode) {\n      this._logger.debug('Engine viewport is fullscreen');\n      this.displayMode = DisplayMode.FullScreen;\n    }\n\n    if (options.backgroundColor) {\n      this.backgroundColor = options.backgroundColor.clone();\n    }\n\n    this._loader = new Loader();\n\n    this._initialize(options);\n\n    this.rootScene = this.currentScene = new Scene(this);\n\n    this.addScene('root', this.rootScene);\n    this.goToScene('root');\n  }\n\n  /**\n   * Returns a BoundingBox of the top left corner of the screen\n   * and the bottom right corner of the screen.\n   */\n  public getWorldBounds() {\n    var left = this.screenToWorldCoordinates(Vector.Zero).x;\n    var top = this.screenToWorldCoordinates(Vector.Zero).y;\n    var right = left + this.drawWidth;\n    var bottom = top + this.drawHeight;\n\n    return new BoundingBox(left, top, right, bottom);\n  }\n\n  /**\n   * Gets the current engine timescale factor (default is 1.0 which is 1:1 time)\n   */\n  public get timescale() {\n    return this._timescale;\n  }\n\n  /**\n   * Sets the current engine timescale factor. Useful for creating slow-motion effects or fast-forward effects\n   * when using time-based movement.\n   */\n  public set timescale(value: number) {\n    if (value <= 0) {\n      Logger.getInstance().error('Cannot set engine.timescale to a value of 0 or less than 0.');\n      return;\n    }\n\n    this._timescale = value;\n  }\n\n  /**\n   * Plays a sprite animation on the screen at the specified `x` and `y`\n   * (in game coordinates, not screen pixels). These animations play\n   * independent of actors, and will be cleaned up internally as soon\n   * as they are complete. Note animations that loop will never be\n   * cleaned up.\n   *\n   * @param animation  Animation to play\n   * @param x          x game coordinate to play the animation\n   * @param y          y game coordinate to play the animation\n   */\n  public playAnimation(animation: Animation, x: number, y: number) {\n    this._animations.push(new AnimationNode(animation, x, y));\n  }\n\n  /**\n   * Adds a [[TileMap]] to the [[currentScene]], once this is done the TileMap\n   * will be drawn and updated.\n   */\n  public addTileMap(tileMap: TileMap) {\n    this.currentScene.addTileMap(tileMap);\n  }\n\n  /**\n   * Removes a [[TileMap]] from the [[currentScene]], it will no longer be drawn or updated.\n   */\n  public removeTileMap(tileMap: TileMap) {\n    this.currentScene.removeTileMap(tileMap);\n  }\n\n  /**\n   * Adds a [[Timer]] to the [[currentScene]].\n   * @param timer  The timer to add to the [[currentScene]].\n   */\n  public addTimer(timer: Timer): Timer {\n    return this.currentScene.addTimer(timer);\n  }\n\n  /**\n   * Removes a [[Timer]] from the [[currentScene]].\n   * @param timer  The timer to remove to the [[currentScene]].\n   */\n  public removeTimer(timer: Timer): Timer {\n    return this.currentScene.removeTimer(timer);\n  }\n\n  /**\n   * Adds a [[Scene]] to the engine, think of scenes in Excalibur as you\n   * would levels or menus.\n   *\n   * @param key  The name of the scene, must be unique\n   * @param scene The scene to add to the engine\n   */\n  public addScene(key: string, scene: Scene) {\n    if (this.scenes[key]) {\n      this._logger.warn('Scene', key, 'already exists overwriting');\n    }\n    this.scenes[key] = scene;\n    scene.engine = this;\n  }\n\n  /**\n   * Removes a [[Scene]] instance from the engine\n   * @param scene  The scene to remove\n   */\n  public removeScene(scene: Scene): void;\n  /**\n   * Removes a scene from the engine by key\n   * @param key  The scene key to remove\n   */\n  public removeScene(key: string): void;\n  /**\n   * @internal\n   */\n  public removeScene(entity: any): void {\n    if (entity instanceof Scene) {\n      // remove scene\n      for (var key in this.scenes) {\n        if (this.scenes.hasOwnProperty(key)) {\n          if (this.scenes[key] === entity) {\n            delete this.scenes[key];\n          }\n        }\n      }\n    }\n\n    if (typeof entity === 'string') {\n      // remove scene\n      delete this.scenes[entity];\n    }\n  }\n\n  /**\n   * Adds a [[Scene]] to the engine, think of scenes in Excalibur as you\n   * would levels or menus.\n   * @param sceneKey  The key of the scene, must be unique\n   * @param scene     The scene to add to the engine\n   */\n  public add(sceneKey: string, scene: Scene): void;\n  /**\n   * Adds a [[Timer]] to the [[currentScene]].\n   * @param timer  The timer to add to the [[currentScene]].\n   */\n  public add(timer: Timer): void;\n  /**\n   * Adds a [[TileMap]] to the [[currentScene]], once this is done the TileMap\n   * will be drawn and updated.\n   */\n  public add(tileMap: TileMap): void;\n  /**\n   * Adds an actor to the [[currentScene]] of the game. This is synonymous\n   * to calling `engine.currentScene.add(actor)`.\n   *\n   * Actors can only be drawn if they are a member of a scene, and only\n   * the [[currentScene]] may be drawn or updated.\n   *\n   * @param actor  The actor to add to the [[currentScene]]\n   */\n  public add(actor: Actor): void;\n\n  /**\n   * Adds a [[UIActor]] to the [[currentScene]] of the game,\n   * UIActors do not participate in collisions, instead the\n   * remain in the same place on the screen.\n   * @param uiActor  The UIActor to add to the [[currentScene]]\n   */\n  public add(uiActor: UIActor): void;\n  public add(entity: any): void {\n    if (entity instanceof UIActor) {\n      this.currentScene.addUIActor(entity);\n      return;\n    }\n    if (entity instanceof Actor) {\n      this._addChild(entity);\n    }\n    if (entity instanceof Timer) {\n      this.addTimer(entity);\n    }\n\n    if (entity instanceof TileMap) {\n      this.addTileMap(entity);\n    }\n\n    if (arguments.length === 2) {\n      this.addScene(<string>arguments[0], <Scene>arguments[1]);\n    }\n  }\n\n  /**\n   * Removes a scene instance from the engine\n   * @param scene  The scene to remove\n   */\n  public remove(scene: Scene): void;\n  /**\n   * Removes a scene from the engine by key\n   * @param sceneKey  The scene to remove\n   */\n  public remove(sceneKey: string): void;\n  /**\n   * Removes a [[Timer]] from the [[currentScene]].\n   * @param timer  The timer to remove to the [[currentScene]].\n   */\n  public remove(timer: Timer): void;\n  /**\n   * Removes a [[TileMap]] from the [[currentScene]], it will no longer be drawn or updated.\n   */\n  public remove(tileMap: TileMap): void;\n  /**\n   * Removes an actor from the [[currentScene]] of the game. This is synonymous\n   * to calling `engine.currentScene.removeChild(actor)`.\n   * Actors that are removed from a scene will no longer be drawn or updated.\n   *\n   * @param actor  The actor to remove from the [[currentScene]].\n   */\n  public remove(actor: Actor): void;\n  /**\n   * Removes a [[UIActor]] to the scene, it will no longer be drawn or updated\n   * @param uiActor  The UIActor to remove from the [[currentScene]]\n   */\n  public remove(uiActor: UIActor): void;\n  public remove(entity: any): void {\n    if (entity instanceof UIActor) {\n      this.currentScene.removeUIActor(entity);\n      return;\n    }\n    if (entity instanceof Actor) {\n      this._removeChild(entity);\n    }\n    if (entity instanceof Timer) {\n      this.removeTimer(entity);\n    }\n\n    if (entity instanceof TileMap) {\n      this.removeTileMap(entity);\n    }\n\n    if (entity instanceof Scene) {\n      this.removeScene(entity);\n    }\n\n    if (typeof entity === 'string') {\n      this.removeScene(entity);\n    }\n  }\n\n  /**\n   * Adds an actor to the [[currentScene]] of the game. This is synonymous\n   * to calling `engine.currentScene.add(actor)`.\n   *\n   * Actors can only be drawn if they are a member of a scene, and only\n   * the [[currentScene]] may be drawn or updated.\n   *\n   * @param actor  The actor to add to the [[currentScene]]\n   */\n  protected _addChild(actor: Actor) {\n    this.currentScene.add(actor);\n  }\n\n  /**\n   * Removes an actor from the [[currentScene]] of the game. This is synonymous\n   * to calling `engine.currentScene.remove(actor)`.\n   * Actors that are removed from a scene will no longer be drawn or updated.\n   *\n   * @param actor  The actor to remove from the [[currentScene]].\n   */\n  protected _removeChild(actor: Actor) {\n    this.currentScene.remove(actor);\n  }\n\n  /**\n   * Changes the currently updating and drawing scene to a different,\n   * named scene. Calls the [[Scene]] lifecycle events.\n   * @param key  The key of the scene to transition to.\n   */\n  public goToScene(key: string) {\n    if (this.scenes[key]) {\n      var oldScene = this.currentScene;\n      var newScene = this.scenes[key];\n\n      this._logger.debug('Going to scene:', key);\n\n      // only deactivate when initialized\n      if (this.currentScene.isInitialized) {\n        this.currentScene._deactivate.call(this.currentScene, [oldScene, newScene]);\n        this.currentScene.eventDispatcher.emit('deactivate', new DeactivateEvent(newScene, this.currentScene));\n      }\n\n      // set current scene to new one\n      this.currentScene = newScene;\n\n      // initialize the current scene if has not been already\n      this.currentScene._initialize(this);\n\n      this.currentScene._activate.call(this.currentScene, [oldScene, newScene]);\n      this.currentScene.eventDispatcher.emit('activate', new ActivateEvent(oldScene, this.currentScene));\n    } else {\n      this._logger.error('Scene', key, 'does not exist!');\n    }\n  }\n\n  /**\n   * Transforms the current x, y from screen coordinates to world coordinates\n   * @param point  Screen coordinate to convert\n   */\n  public screenToWorldCoordinates(point: Vector): Vector {\n    var newX = point.x;\n    var newY = point.y;\n\n    // transform back to world space\n    newX = (newX / this.canvas.clientWidth) * this.drawWidth;\n    newY = (newY / this.canvas.clientHeight) * this.drawHeight;\n\n    // transform based on zoom\n    newX = newX - this.halfDrawWidth;\n    newY = newY - this.halfDrawHeight;\n\n    // shift by focus\n    if (this.currentScene && this.currentScene.camera) {\n      var focus = this.currentScene.camera.getFocus();\n      newX += focus.x;\n      newY += focus.y;\n    }\n\n    return new Vector(Math.floor(newX), Math.floor(newY));\n  }\n\n  /**\n   * Transforms a world coordinate, to a screen coordinate\n   * @param point  World coordinate to convert\n   */\n  public worldToScreenCoordinates(point: Vector): Vector {\n    var screenX = point.x;\n    var screenY = point.y;\n\n    // shift by focus\n    if (this.currentScene && this.currentScene.camera) {\n      var focus = this.currentScene.camera.getFocus();\n      screenX -= focus.x;\n      screenY -= focus.y;\n    }\n\n    // transform back on zoom\n    screenX = screenX + this.halfDrawWidth;\n    screenY = screenY + this.halfDrawHeight;\n\n    // transform back to screen space\n    screenX = (screenX * this.canvas.clientWidth) / this.drawWidth;\n    screenY = (screenY * this.canvas.clientHeight) / this.drawHeight;\n\n    return new Vector(Math.floor(screenX), Math.floor(screenY));\n  }\n\n  /**\n   * Sets the internal canvas height based on the selected display mode.\n   */\n  private _setHeightByDisplayMode(parent: HTMLElement | Window) {\n    if (this.displayMode === DisplayMode.Container) {\n      this.canvas.width = (<HTMLElement>parent).clientWidth;\n      this.canvas.height = (<HTMLElement>parent).clientHeight;\n    }\n\n    if (this.displayMode === DisplayMode.FullScreen) {\n      document.body.style.margin = '0px';\n      document.body.style.overflow = 'hidden';\n      this.canvas.width = (<Window>parent).innerWidth;\n      this.canvas.height = (<Window>parent).innerHeight;\n    }\n  }\n\n  /**\n   * Initializes the internal canvas, rendering context, displaymode, and native event listeners\n   */\n  private _initialize(options?: IEngineOptions) {\n    if (options.displayMode) {\n      this.displayMode = options.displayMode;\n    }\n\n    if (this.displayMode === DisplayMode.FullScreen || this.displayMode === DisplayMode.Container) {\n      var parent = <any>(this.displayMode === DisplayMode.Container ? <any>(this.canvas.parentElement || document.body) : <any>window);\n\n      this._setHeightByDisplayMode(parent);\n\n      window.addEventListener('resize', () => {\n        this._logger.debug('View port resized');\n        this._setHeightByDisplayMode(parent);\n        this._logger.info('parent.clientHeight ' + parent.clientHeight);\n        this.setAntialiasing(this._isSmoothingEnabled);\n      });\n    } else if (this.displayMode === DisplayMode.Position) {\n      this._intializeDisplayModePosition(options);\n    }\n\n    // initialize inputs\n    this.input = {\n      keyboard: new Input.Keyboard(),\n      pointers: new Input.Pointers(this),\n      gamepads: new Input.Gamepads()\n    };\n    this.input.keyboard.init();\n    this.input.pointers.init(options && options.pointerScope === Input.PointerScope.Document ? document : this.canvas);\n    this.input.gamepads.init();\n\n    this.pageScrollPreventionMode = options.scrollPreventionMode;\n\n    // Issue #385 make use of the visibility api\n    // https://developer.mozilla.org/en-US/docs/Web/Guide/User_experience/Using_the_Page_Visibility_API\n\n    var hidden: keyof HTMLDocument, visibilityChange: string;\n    if (typeof document.hidden !== 'undefined') {\n      // Opera 12.10 and Firefox 18 and later support\n      hidden = 'hidden';\n      visibilityChange = 'visibilitychange';\n    } else if ('msHidden' in document) {\n      hidden = <keyof HTMLDocument>'msHidden';\n      visibilityChange = 'msvisibilitychange';\n    } else if ('webkitHidden' in document) {\n      hidden = <keyof HTMLDocument>'webkitHidden';\n      visibilityChange = 'webkitvisibilitychange';\n    }\n\n    document.addEventListener(visibilityChange, () => {\n      if (document[hidden]) {\n        this.eventDispatcher.emit('hidden', new HiddenEvent(this));\n        this._logger.debug('Window hidden');\n      } else {\n        this.eventDispatcher.emit('visible', new VisibleEvent(this));\n        this._logger.debug('Window visible');\n      }\n    });\n\n    this.ctx = <CanvasRenderingContext2D>this.canvas.getContext('2d');\n\n    this._suppressHiDPIScaling = !!options.suppressHiDPIScaling;\n    if (!options.suppressHiDPIScaling) {\n      this._initializeHiDpi();\n    }\n\n    if (!this.canvasElementId) {\n      document.body.appendChild(this.canvas);\n    }\n  }\n\n  public onInitialize(_engine: Engine) {\n    // Override me\n  }\n\n  private _intializeDisplayModePosition(options: IEngineOptions) {\n    if (!options.position) {\n      throw new Error('DisplayMode of Position was selected but no position option was given');\n    } else {\n      this.canvas.style.display = 'block';\n      this.canvas.style.position = 'absolute';\n\n      if (typeof options.position === 'string') {\n        var specifiedPosition = options.position.split(' ');\n\n        switch (specifiedPosition[0]) {\n          case 'top':\n            this.canvas.style.top = '0px';\n            break;\n          case 'bottom':\n            this.canvas.style.bottom = '0px';\n            break;\n          case 'middle':\n            this.canvas.style.top = '50%';\n            var offsetY = -this.halfDrawHeight;\n            this.canvas.style.marginTop = offsetY.toString();\n            break;\n          default:\n            throw new Error('Invalid Position Given');\n        }\n\n        if (specifiedPosition[1]) {\n          switch (specifiedPosition[1]) {\n            case 'left':\n              this.canvas.style.left = '0px';\n              break;\n            case 'right':\n              this.canvas.style.right = '0px';\n              break;\n            case 'center':\n              this.canvas.style.left = '50%';\n              var offsetX = -this.halfDrawWidth;\n              this.canvas.style.marginLeft = offsetX.toString();\n              break;\n            default:\n              throw new Error('Invalid Position Given');\n          }\n        }\n      } else {\n        if (options.position.top) {\n          typeof options.position.top === 'number'\n            ? (this.canvas.style.top = options.position.top.toString() + 'px')\n            : (this.canvas.style.top = options.position.top);\n        }\n        if (options.position.right) {\n          typeof options.position.right === 'number'\n            ? (this.canvas.style.right = options.position.right.toString() + 'px')\n            : (this.canvas.style.right = options.position.right);\n        }\n        if (options.position.bottom) {\n          typeof options.position.bottom === 'number'\n            ? (this.canvas.style.bottom = options.position.bottom.toString() + 'px')\n            : (this.canvas.style.bottom = options.position.bottom);\n        }\n        if (options.position.left) {\n          typeof options.position.left === 'number'\n            ? (this.canvas.style.left = options.position.left.toString() + 'px')\n            : (this.canvas.style.left = options.position.left);\n        }\n      }\n    }\n  }\n\n  private _initializeHiDpi() {\n    // Scale the canvas if needed\n    if (this.isHiDpi) {\n      let oldWidth = this.canvas.width;\n      let oldHeight = this.canvas.height;\n\n      this.canvas.width = oldWidth * this.pixelRatio;\n      this.canvas.height = oldHeight * this.pixelRatio;\n\n      this.canvas.style.width = oldWidth + 'px';\n      this.canvas.style.height = oldHeight + 'px';\n\n      this._logger.warn(`Hi DPI screen detected, resetting canvas resolution from \n                           ${oldWidth}x${oldHeight} to ${this.canvas.width}x${this.canvas.height} \n                           css size will remain ${oldWidth}x${oldHeight}`);\n\n      this.ctx.scale(this.pixelRatio, this.pixelRatio);\n      this._logger.warn(`Canvas drawing context was scaled by ${this.pixelRatio}`);\n    }\n  }\n\n  /**\n   * If supported by the browser, this will set the antialiasing flag on the\n   * canvas. Set this to `false` if you want a 'jagged' pixel art look to your\n   * image resources.\n   * @param isSmooth  Set smoothing to true or false\n   */\n  public setAntialiasing(isSmooth: boolean) {\n    this._isSmoothingEnabled = isSmooth;\n\n    var ctx: any = this.ctx;\n    ctx.imageSmoothingEnabled = isSmooth;\n    for (var smoothing of ['webkitImageSmoothingEnabled', 'mozImageSmoothingEnabled', 'msImageSmoothingEnabled']) {\n      if (smoothing in ctx) {\n        ctx[smoothing] = isSmooth;\n      }\n    }\n  }\n\n  /**\n   * Return the current smoothing status of the canvas\n   */\n  public getAntialiasing(): boolean {\n    return (\n      (<any>this.ctx).imageSmoothingEnabled ||\n      (<any>this.ctx).webkitImageSmoothingEnabled ||\n      (<any>this.ctx).mozImageSmoothingEnabled ||\n      (<any>this.ctx).msImageSmoothingEnabled\n    );\n  }\n\n  /**\n   * Gets whether the actor is Initialized\n   */\n  public get isInitialized(): boolean {\n    return this._isInitialized;\n  }\n\n  private _overrideInitialize(engine: Engine) {\n    if (!this.isInitialized) {\n      this.onInitialize(engine);\n      super.emit('initialize', new InitializeEvent(engine, this));\n      this._isInitialized = true;\n    }\n  }\n\n  /**\n   * Updates the entire state of the game\n   * @param delta  Number of milliseconds elapsed since the last update.\n   */\n  private _update(delta: number) {\n    if (this._isLoading) {\n      // suspend updates untill loading is finished\n      this._loader.update(this, delta);\n      // Update input listeners\n      this.input.keyboard.update();\n      this.input.pointers.update();\n      this.input.gamepads.update();\n      return;\n    }\n    this._overrideInitialize(this);\n    // Publish preupdate events\n    this._preupdate(delta);\n\n    // process engine level events\n    this.currentScene.update(this, delta);\n\n    // update animations\n    this._animations = this._animations.filter(function(a) {\n      return !a.animation.isDone();\n    });\n\n    // Update input listeners\n    this.input.keyboard.update();\n    this.input.pointers.update();\n    this.input.gamepads.update();\n\n    // Publish update event\n    this._postupdate(delta);\n  }\n\n  /**\n   * @internal\n   */\n  public _preupdate(delta: number) {\n    this.emit('preupdate', new PreUpdateEvent(this, delta, this));\n    this.onPreUpdate(this, delta);\n  }\n\n  public onPreUpdate(_engine: Engine, _delta: number) {\n    // Override me\n  }\n\n  /**\n   * @internal\n   */\n  public _postupdate(delta: number) {\n    this.emit('postupdate', new PostUpdateEvent(this, delta, this));\n    this.onPostUpdate(this, delta);\n  }\n\n  public onPostUpdate(_engine: Engine, _delta: number) {\n    // Override me\n  }\n\n  /**\n   * Draws the entire game\n   * @param delta  Number of milliseconds elapsed since the last draw.\n   */\n  private _draw(delta: number) {\n    var ctx = this.ctx;\n    this._predraw(ctx, delta);\n\n    if (this._isLoading) {\n      this._loader.draw(ctx, delta);\n      // Drawing nothing else while loading\n      return;\n    }\n\n    ctx.clearRect(0, 0, this.canvasWidth, this.canvasHeight);\n    ctx.fillStyle = this.backgroundColor.toString();\n    ctx.fillRect(0, 0, this.canvasWidth, this.canvasHeight);\n\n    this.currentScene.draw(this.ctx, delta);\n\n    // todo needs to be a better way of doing this\n    var a = 0,\n      len = this._animations.length;\n    for (a; a < len; a++) {\n      this._animations[a].animation.draw(ctx, this._animations[a].x, this._animations[a].y);\n    }\n\n    // Draw debug information\n    if (this.isDebug) {\n      this.ctx.font = 'Consolas';\n      this.ctx.fillStyle = this.debugColor.toString();\n      var keys = this.input.keyboard.getKeys();\n      for (var j = 0; j < keys.length; j++) {\n        this.ctx.fillText(keys[j].toString() + ' : ' + (Input.Keys[keys[j]] ? Input.Keys[keys[j]] : 'Not Mapped'), 100, 10 * j + 10);\n      }\n\n      this.ctx.fillText('FPS:' + this.stats.currFrame.fps.toFixed(2).toString(), 10, 10);\n    }\n\n    // Post processing\n    for (var i = 0; i < this.postProcessors.length; i++) {\n      this.postProcessors[i].process(this.ctx.getImageData(0, 0, this.canvasWidth, this.canvasHeight), this.ctx);\n    }\n\n    this._postdraw(ctx, delta);\n  }\n\n  /**\n   * @internal\n   */\n  public _predraw(_ctx: CanvasRenderingContext2D, delta: number) {\n    this.emit('predraw', new PreDrawEvent(_ctx, delta, this));\n    this.onPreDraw(_ctx, delta);\n  }\n\n  public onPreDraw(_ctx: CanvasRenderingContext2D, _delta: number) {\n    // Override me\n  }\n\n  /**\n   * @internal\n   */\n  public _postdraw(_ctx: CanvasRenderingContext2D, delta: number) {\n    this.emit('postdraw', new PostDrawEvent(_ctx, delta, this));\n    this.onPostDraw(_ctx, delta);\n  }\n\n  public onPostDraw(_ctx: CanvasRenderingContext2D, _delta: number) {\n    // Override me\n  }\n\n  /**\n   * Starts the internal game loop for Excalibur after loading\n   * any provided assets.\n   * @param loader  Optional [[ILoader]] to use to load resources. The default loader is [[Loader]], override to provide your own\n   * custom loader.\n   */\n  public start(loader?: ILoader): Promise<any> {\n    if (!this._compatible) {\n      var promise = new Promise();\n      return promise.reject('Excalibur is incompatible with your browser');\n    }\n\n    var loadingComplete: Promise<any>;\n    if (loader) {\n      this._loader = loader;\n      this._loader.suppressPlayButton = this._suppressPlayButton;\n      this._loader.wireEngine(this);\n      loadingComplete = this.load(this._loader);\n    } else {\n      loadingComplete = Promise.resolve();\n    }\n\n    loadingComplete.then(() => {\n      this.emit('start', new GameStartEvent(this));\n    });\n\n    if (!this._hasStarted) {\n      this._hasStarted = true;\n      this._logger.debug('Starting game...');\n\n      Engine.createMainLoop(this, window.requestAnimationFrame, Date.now)();\n\n      this._logger.debug('Game started');\n    } else {\n      // Game already started;\n    }\n    return loadingComplete;\n  }\n\n  public static createMainLoop(game: Engine, raf: (func: Function) => number, nowFn: () => number) {\n    var lastTime = nowFn();\n\n    return function mainloop() {\n      if (!game._hasStarted) {\n        return;\n      }\n      try {\n        game._requestId = raf(mainloop);\n        game.emit('preframe', new PreFrameEvent(game, game.stats.prevFrame));\n\n        // Get the time to calculate time-elapsed\n        var now = nowFn();\n        var elapsed = Math.floor(now - lastTime) || 1;\n        // Resolves issue #138 if the game has been paused, or blurred for\n        // more than a 200 milliseconds, reset elapsed time to 1. This improves reliability\n        // and provides more expected behavior when the engine comes back\n        // into focus\n        if (elapsed > 200) {\n          elapsed = 1;\n        }\n        var delta = elapsed * game.timescale;\n\n        // reset frame stats (reuse existing instances)\n        var frameId = game.stats.prevFrame.id + 1;\n        game.stats.prevFrame.reset(game.stats.currFrame);\n        game.stats.currFrame.reset();\n        game.stats.currFrame.id = frameId;\n        game.stats.currFrame.delta = delta;\n        game.stats.currFrame.fps = 1.0 / (delta / 1000);\n\n        var beforeUpdate = nowFn();\n        game._update(delta);\n        var afterUpdate = nowFn();\n        game._draw(delta);\n        var afterDraw = nowFn();\n\n        game.stats.currFrame.duration.update = afterUpdate - beforeUpdate;\n        game.stats.currFrame.duration.draw = afterDraw - afterUpdate;\n\n        lastTime = now;\n\n        game.emit('postframe', new PostFrameEvent(game, game.stats.currFrame));\n      } catch (e) {\n        window.cancelAnimationFrame(game._requestId);\n        game.stop();\n        game.onFatalException(e);\n      }\n    };\n  }\n\n  /**\n   * Stops Excalibur's main loop, useful for pausing the game.\n   */\n  public stop() {\n    if (this._hasStarted) {\n      this.emit('stop', new GameStopEvent(this));\n      this._hasStarted = false;\n      this._logger.debug('Game stopped');\n    }\n  }\n\n  /**\n   * Returns the Engine's Running status, Useful for checking whether engine is running or paused.\n   */\n  public isPaused(): boolean {\n    return !this._hasStarted;\n  }\n\n  /**\n   * Takes a screen shot of the current viewport and returns it as an\n   * HTML Image Element.\n   */\n  public screenshot(): HTMLImageElement {\n    var result = new Image();\n    var raw = this.canvas.toDataURL('image/png');\n    result.src = raw;\n    return result;\n  }\n\n  /**\n   * Another option available to you to load resources into the game.\n   * Immediately after calling this the game will pause and the loading screen\n   * will appear.\n   * @param loader  Some [[ILoadable]] such as a [[Loader]] collection, [[Sound]], or [[Texture]].\n   */\n  public load(loader: ILoadable): Promise<any> {\n    var complete = new Promise<any>();\n\n    this._isLoading = true;\n\n    loader.load().then(() => {\n      if (this._suppressPlayButton) {\n        setTimeout(() => {\n          this._isLoading = false;\n          complete.resolve();\n          // Delay is to give the logo a chance to show, otherwise don't delay\n        }, 500);\n      } else {\n        this._isLoading = false;\n        complete.resolve();\n      }\n    });\n\n    return complete;\n  }\n}\n\n/**\n * @internal\n */\nclass AnimationNode {\n  constructor(public animation: Animation, public x: number, public y: number) {}\n}\n","import { GameEvent, SubscribeEvent, UnsubscribeEvent } from './Events';\nimport { IEvented } from './Interfaces/IEvented';\n\n/**\n * Excalibur's internal event dispatcher implementation.\n * Callbacks are fired immediately after an event is published.\n * Typically you will use [[Class.eventDispatcher]] since most classes in\n * Excalibur inherit from [[Class]]. You will rarely create an `EventDispatcher`\n * yourself.\n *\n * [[include:Events.md]]\n */\nexport class EventDispatcher implements IEvented {\n  private _handlers: { [key: string]: { (event?: GameEvent<any>): void }[] } = {};\n  private _wiredEventDispatchers: EventDispatcher[] = [];\n\n  private _target: any;\n\n  /**\n   * @param target  The object that will be the recipient of events from this event dispatcher\n   */\n  constructor(target: any) {\n    this._target = target;\n  }\n\n  /**\n   * Emits an event for target\n   * @param eventName  The name of the event to publish\n   * @param event      Optionally pass an event data object to the handler\n   */\n  public emit(eventName: string, event?: GameEvent<any>) {\n    if (!eventName) {\n      // key not mapped\n      return;\n    }\n    eventName = eventName.toLowerCase();\n    var target = this._target;\n    if (!event) {\n      event = new GameEvent();\n    }\n    event.target = target;\n\n    var i: number, len: number;\n\n    if (this._handlers[eventName]) {\n      i = 0;\n      len = this._handlers[eventName].length;\n\n      for (i; i < len; i++) {\n        this._handlers[eventName][i].call(target, event);\n      }\n    }\n\n    i = 0;\n    len = this._wiredEventDispatchers.length;\n\n    for (i; i < len; i++) {\n      this._wiredEventDispatchers[i].emit(eventName, event);\n    }\n  }\n\n  /**\n   * Subscribe an event handler to a particular event name, multiple handlers per event name are allowed.\n   * @param eventName  The name of the event to subscribe to\n   * @param handler    The handler callback to fire on this event\n   */\n  public on(eventName: string, handler: (event?: GameEvent<any>) => void) {\n    eventName = eventName.toLowerCase();\n    if (!this._handlers[eventName]) {\n      this._handlers[eventName] = [];\n    }\n    this._handlers[eventName].push(handler);\n\n    // meta event handlers\n    if (eventName !== 'unsubscribe' && eventName !== 'subscribe') {\n      this.emit('subscribe', new SubscribeEvent(eventName, handler));\n    }\n  }\n\n  /**\n   * Unsubscribe an event handler(s) from an event. If a specific handler\n   * is specified for an event, only that handler will be unsubscribed.\n   * Otherwise all handlers will be unsubscribed for that event.\n   *\n   * @param eventName  The name of the event to unsubscribe\n   * @param handler    Optionally the specific handler to unsubscribe\n   *\n   */\n  public off(eventName: string, handler?: (event?: GameEvent<any>) => void) {\n    eventName = eventName.toLowerCase();\n    var eventHandlers = this._handlers[eventName];\n\n    if (eventHandlers) {\n      // if no explicit handler is give with the event name clear all handlers\n      if (!handler) {\n        this._handlers[eventName].length = 0;\n      } else {\n        var index = eventHandlers.indexOf(handler);\n        this._handlers[eventName].splice(index, 1);\n      }\n    }\n    // meta event handlers\n    if (eventName !== 'unsubscribe' && eventName !== 'subscribe') {\n      this.emit('unsubscribe', new UnsubscribeEvent(eventName, handler));\n    }\n  }\n\n  /**\n   * Once listens to an event one time, then unsubscribes from that event\n   *\n   * @param eventName The name of the event to subscribe to once\n   * @param handler   The handler of the event that will be auto unsubscribed\n   */\n  public once(eventName: string, handler: (event?: GameEvent<any>) => void) {\n    let metaHandler = (event?: GameEvent<any>) => {\n      let ev = event || new GameEvent();\n      ev.target = ev.target || this._target;\n\n      this.off(eventName, handler);\n      handler.call(ev.target, ev);\n    };\n\n    this.on(eventName, metaHandler);\n  }\n\n  /**\n   * Wires this event dispatcher to also recieve events from another\n   */\n  public wire(eventDispatcher: EventDispatcher): void {\n    eventDispatcher._wiredEventDispatchers.push(this);\n  }\n\n  /**\n   * Unwires this event dispatcher from another\n   */\n  public unwire(eventDispatcher: EventDispatcher): void {\n    var index = eventDispatcher._wiredEventDispatchers.indexOf(this);\n    if (index > -1) {\n      eventDispatcher._wiredEventDispatchers.splice(index, 1);\n    }\n  }\n}\n","import { Scene } from './Scene';\nimport { Vector } from './Algebra';\nimport { Actor } from './Actor';\nimport { Trigger } from './Trigger';\nimport { FrameStats } from './Debug';\nimport { Engine } from './Engine';\nimport { TileMap } from './TileMap';\nimport { Side } from './Collision/Side';\nimport * as Input from './Input/Index';\nimport { Pair, BaseCamera } from './index';\n\n/* istanbul ignore next */\n/* compiler only: these are internal to lib */\nexport type kill = 'kill';\nexport type prekill = 'prekill';\nexport type postkill = 'postkill';\n\nexport type predraw = 'predraw';\nexport type postdraw = 'postdraw';\n\nexport type predebugdraw = 'predebugdraw';\nexport type postdebugdraw = 'postdebugdraw';\n\nexport type preupdate = 'preupdate';\nexport type postupdate = 'postupdate';\n\nexport type preframe = 'preframe';\nexport type postframe = 'postframe';\n\nexport type precollision = 'precollision';\nexport type collisionstart = 'collisionstart';\nexport type collisionend = 'collisionend';\nexport type postcollision = 'postcollision';\n\nexport type initialize = 'initialize';\nexport type activate = 'activate';\nexport type deactivate = 'deactivate';\n\nexport type exitviewport = 'exitviewport';\nexport type enterviewport = 'enterviewport';\n\nexport type exittrigger = 'exit';\nexport type entertrigger = 'enter';\n\nexport type connect = 'connect';\nexport type disconnect = 'disconnect';\nexport type button = 'button';\nexport type axis = 'axis';\n\nexport type subscribe = 'subscribe';\nexport type unsubscribe = 'unsubscribe';\n\nexport type visible = 'visible';\nexport type hidden = 'hidden';\nexport type start = 'start';\nexport type stop = 'stop';\n\nexport type pointerup = 'pointerup';\nexport type pointerdown = 'pointerdown';\nexport type pointermove = 'pointermove';\nexport type pointerenter = 'pointerenter';\nexport type pointerleave = 'pointerleave';\nexport type pointercancel = 'pointercancel';\nexport type pointerwheel = 'pointerwheel';\n\nexport type up = 'up';\nexport type down = 'down';\nexport type move = 'move';\nexport type enter = 'enter';\nexport type leave = 'leave';\nexport type cancel = 'cancel';\nexport type wheel = 'wheel';\n\nexport type press = 'press';\nexport type release = 'release';\nexport type hold = 'hold';\n\nexport type pointerdragstart = 'pointerdragstart';\nexport type pointerdragend = 'pointerdragend';\nexport type pointerdragenter = 'pointerdragenter';\nexport type pointerdragleave = 'pointerdragleave';\nexport type pointerdragmove = 'pointerdragmove';\n\n/**\n * Base event type in Excalibur that all other event types derive from. Not all event types are thrown on all Excalibur game objects,\n * some events are unique to a type, others are not.\n *\n */\nexport class GameEvent<T> {\n  /**\n   * Target object for this event.\n   */\n  public target: T;\n  /**\n   * determines, if event bubbles to the target's ancestors\n   */\n  public bubbles: boolean = true;\n  /**\n   * Holds the whole path from the Root to the event target\n   */\n  protected _path: Actor[] = [];\n  protected _name: string = '';\n\n  /**\n   * Returns Event path from root to active actor.\n   */\n  get eventPath(): Actor[] {\n    return this._path;\n  }\n  /**\n   * Returns name of the event\n   */\n  get name(): string {\n    return this._name;\n  }\n\n  /**\n   * Prevents event from bubbling\n   */\n  public stopPropagation() {\n    this.bubbles = false;\n  }\n  /**\n   * Action, that calls when event happens\n   */\n  public action(): void {\n    const actor = this.eventPath.pop();\n\n    if (actor) {\n      this._onActionStart(actor);\n      actor.eventDispatcher.emit(this._name, this);\n      this._onActionEnd(actor);\n    }\n  }\n  /**\n   * Propagate event further through event path\n   */\n  public propagate(): void {\n    if (!this.eventPath.length) {\n      return;\n    }\n\n    this.action();\n\n    if (this.bubbles) {\n      this.propagate();\n    }\n  }\n\n  public layPath(actor: Actor): void {\n    const actorPath = actor.getAncestors();\n    this._path = actorPath.length > this._path.length ? actorPath : this._path;\n  }\n\n  protected _onActionStart(_actor?: Actor) {\n    // to be rewritten\n  }\n\n  protected _onActionEnd(_actor?: Actor) {\n    // to be rewritten\n  }\n}\n\n/**\n * The 'kill' event is emitted on actors when it is killed. The target is the actor that was killed.\n */\nexport class KillEvent extends GameEvent<Actor> {\n  constructor(public target: Actor) {\n    super();\n  }\n}\n\n/**\n * The 'prekill' event is emitted directly before an actor is killed.\n */\nexport class PreKillEvent extends GameEvent<Actor> {\n  constructor(public target: Actor) {\n    super();\n  }\n}\n\n/**\n * The 'postkill' event is emitted directly after the actor is killed.\n */\nexport class PostKillEvent extends GameEvent<Actor> {\n  constructor(public target: Actor) {\n    super();\n  }\n}\n\n/**\n * The 'start' event is emitted on engine when has started and is ready for interaction.\n */\nexport class GameStartEvent extends GameEvent<Engine> {\n  constructor(public target: Engine) {\n    super();\n  }\n}\n\n/**\n * The 'stop' event is emitted on engine when has been stopped and will no longer take input, update or draw.\n */\nexport class GameStopEvent extends GameEvent<Engine> {\n  constructor(public target: Engine) {\n    super();\n  }\n}\n\n/**\n * The 'predraw' event is emitted on actors, scenes, and engine before drawing starts. Actors' predraw happens inside their graphics\n * transform so that all drawing takes place with the actor as the origin.\n *\n */\nexport class PreDrawEvent extends GameEvent<Actor | Scene | Engine | TileMap> {\n  constructor(public ctx: CanvasRenderingContext2D, public delta: number, public target: Actor | Scene | Engine | TileMap) {\n    super();\n  }\n}\n\n/**\n * The 'postdraw' event is emitted on actors, scenes, and engine after drawing finishes. Actors' postdraw happens inside their graphics\n * transform so that all drawing takes place with the actor as the origin.\n *\n */\nexport class PostDrawEvent extends GameEvent<Actor | Scene | Engine | TileMap> {\n  constructor(public ctx: CanvasRenderingContext2D, public delta: number, public target: Actor | Scene | Engine | TileMap) {\n    super();\n  }\n}\n\n/**\n * The 'predebugdraw' event is emitted on actors, scenes, and engine before debug drawing starts.\n */\nexport class PreDebugDrawEvent extends GameEvent<Actor | Scene | Engine> {\n  constructor(public ctx: CanvasRenderingContext2D, public target: Actor | Scene | Engine) {\n    super();\n  }\n}\n\n/**\n * The 'postdebugdraw' event is emitted on actors, scenes, and engine after debug drawing starts.\n */\nexport class PostDebugDrawEvent extends GameEvent<Actor | Scene | Engine> {\n  constructor(public ctx: CanvasRenderingContext2D, public target: Actor | Scene | Engine) {\n    super();\n  }\n}\n\n/**\n * The 'preupdate' event is emitted on actors, scenes, camera, and engine before the update starts.\n */\nexport class PreUpdateEvent extends GameEvent<Actor | Scene | Engine | TileMap | BaseCamera> {\n  constructor(public engine: Engine, public delta: number, public target: Actor | Scene | Engine | TileMap | BaseCamera) {\n    super();\n  }\n}\n\n/**\n * The 'postupdate' event is emitted on actors, scenes, camera, and engine after the update ends.\n */\nexport class PostUpdateEvent extends GameEvent<Actor | Scene | Engine | TileMap | BaseCamera> {\n  constructor(public engine: Engine, public delta: number, public target: Actor | Scene | Engine | TileMap | BaseCamera) {\n    super();\n  }\n}\n\n/**\n * The 'preframe' event is emitted on the engine, before the frame begins.\n */\nexport class PreFrameEvent extends GameEvent<Engine> {\n  constructor(public engine: Engine, public prevStats: FrameStats) {\n    super();\n    this.target = engine;\n  }\n}\n\n/**\n * The 'postframe' event is emitted on the engine, after a frame ends.\n */\nexport class PostFrameEvent extends GameEvent<Engine> {\n  constructor(public engine: Engine, public stats: FrameStats) {\n    super();\n    this.target = engine;\n  }\n}\n\n/**\n * Event received when a gamepad is connected to Excalibur. [[Gamepads]] receives this event.\n */\nexport class GamepadConnectEvent extends GameEvent<Input.Gamepad> {\n  constructor(public index: number, public gamepad: Input.Gamepad) {\n    super();\n    this.target = gamepad;\n  }\n}\n\n/**\n * Event received when a gamepad is disconnected from Excalibur. [[Gamepads]] receives this event.\n */\nexport class GamepadDisconnectEvent extends GameEvent<Input.Gamepad> {\n  constructor(public index: number, public gamepad: Input.Gamepad) {\n    super();\n    this.target = gamepad;\n  }\n}\n\n/**\n * Gamepad button event. See [[Gamepads]] for information on responding to controller input. [[Gamepad]] instances receive this event;\n */\nexport class GamepadButtonEvent extends GameEvent<Input.Gamepad> {\n  /**\n   * @param button  The Gamepad button\n   * @param value   A numeric value between 0 and 1\n   */\n  constructor(public button: Input.Buttons, public value: number, public target: Input.Gamepad) {\n    super();\n  }\n}\n\n/**\n * Gamepad axis event. See [[Gamepads]] for information on responding to controller input. [[Gamepad]] instances receive this event;\n */\nexport class GamepadAxisEvent extends GameEvent<Input.Gamepad> {\n  /**\n   * @param axis  The Gamepad axis\n   * @param value A numeric value between -1 and 1\n   */\n  constructor(public axis: Input.Axes, public value: number, public target: Input.Gamepad) {\n    super();\n  }\n}\n\n/**\n * Subscribe event thrown when handlers for events other than subscribe are added. Meta event that is received by\n * [[EventDispatcher|event dispatchers]].\n */\nexport class SubscribeEvent<T> extends GameEvent<T> {\n  constructor(public topic: string, public handler: (event?: GameEvent<T>) => void) {\n    super();\n  }\n}\n\n/**\n * Unsubscribe event thrown when handlers for events other than unsubscribe are removed. Meta event that is received by\n * [[EventDispatcher|event dispatchers]].\n */\nexport class UnsubscribeEvent<T> extends GameEvent<T> {\n  constructor(public topic: string, public handler: (event?: GameEvent<T>) => void) {\n    super();\n  }\n}\n\n/**\n * Event received by the [[Engine]] when the browser window is visible on a screen.\n */\nexport class VisibleEvent extends GameEvent<Engine> {\n  constructor(public target: Engine) {\n    super();\n  }\n}\n\n/**\n * Event received by the [[Engine]] when the browser window is hidden from all screens.\n */\nexport class HiddenEvent extends GameEvent<Engine> {\n  constructor(public target: Engine) {\n    super();\n  }\n}\n\n/**\n * Event thrown on an [[Actor|actor]] when a collision will occur this frame if it resolves\n */\nexport class PreCollisionEvent extends GameEvent<Actor> {\n  /**\n   * @param actor         The actor the event was thrown on\n   * @param other         The actor that will collided with the current actor\n   * @param side          The side that will be collided with the current actor\n   * @param intersection  Intersection vector\n   */\n  constructor(public actor: Actor, public other: Actor, public side: Side, public intersection: Vector) {\n    super();\n    this.target = actor;\n  }\n}\n\n/**\n * Event thrown on an [[Actor|actor]] when a collision has been resolved (body reacted) this frame\n */\nexport class PostCollisionEvent extends GameEvent<Actor> {\n  /**\n   * @param actor         The actor the event was thrown on\n   * @param other         The actor that did collide with the current actor\n   * @param side          The side that did collide with the current actor\n   * @param intersection  Intersection vector\n   */\n  constructor(public actor: Actor, public other: Actor, public side: Side, public intersection: Vector) {\n    super();\n    this.target = actor;\n  }\n}\n\n/**\n * Event thrown the first time an [[Actor|actor]] collides with another, after an actor is in contact normal collision events are fired.\n */\nexport class CollisionStartEvent extends GameEvent<Actor> {\n  /**\n   *\n   */\n  constructor(public actor: Actor, public other: Actor, public pair: Pair) {\n    super();\n    this.target = actor;\n  }\n}\n\n/**\n * Event thrown when the [[Actor|actor]] is no longer colliding with another\n */\nexport class CollisionEndEvent extends GameEvent<Actor> {\n  /**\n   *\n   */\n  constructor(public actor: Actor, public other: Actor) {\n    super();\n    this.target = actor;\n  }\n}\n\n/**\n * Event thrown on an [[Actor]] and a [[Scene]] only once before the first update call\n */\nexport class InitializeEvent extends GameEvent<Actor | Scene | Engine | BaseCamera> {\n  /**\n   * @param engine  The reference to the current engine\n   */\n  constructor(public engine: Engine, public target: Actor | Scene | Engine | BaseCamera) {\n    super();\n  }\n}\n\n/**\n * Event thrown on a [[Scene]] on activation\n */\nexport class ActivateEvent extends GameEvent<Scene> {\n  /**\n   * @param oldScene  The reference to the old scene\n   */\n  constructor(public oldScene: Scene, public target: Scene) {\n    super();\n  }\n}\n\n/**\n * Event thrown on a [[Scene]] on deactivation\n */\nexport class DeactivateEvent extends GameEvent<Scene> {\n  /**\n   * @param newScene  The reference to the new scene\n   */\n  constructor(public newScene: Scene, public target: Scene) {\n    super();\n  }\n}\n\n/**\n * Event thrown on an [[Actor]] when it completely leaves the screen.\n */\nexport class ExitViewPortEvent extends GameEvent<Actor> {\n  constructor(public target: Actor) {\n    super();\n  }\n}\n\n/**\n * Event thrown on an [[Actor]] when it completely leaves the screen.\n */\nexport class EnterViewPortEvent extends GameEvent<Actor> {\n  constructor(public target: Actor) {\n    super();\n  }\n}\n\nexport class EnterTriggerEvent extends GameEvent<Actor> {\n  constructor(public target: Trigger, public actor: Actor) {\n    super();\n  }\n}\n\nexport class ExitTriggerEvent extends GameEvent<Actor> {\n  constructor(public target: Trigger, public actor: Actor) {\n    super();\n  }\n}\n","import { GameEvent } from '../Events';\nimport { Sound } from '../Resources/Sound/Sound';\nimport { Actor } from '../Actor';\nimport { AudioInstance } from '../Resources/Sound/AudioInstance';\n\nexport class MediaEvent extends GameEvent<Sound> {\n  /**\n   * Media event cannot bubble\n   */\n  public set bubbles(_value: boolean) {\n    // stubbed\n  }\n  /**\n   * Media event cannot bubble\n   */\n  public get bubbles(): boolean {\n    return false;\n  }\n  /**\n   * Media event cannot bubble, so they have no path\n   */\n  protected get _path(): Actor[] {\n    return null;\n  }\n  /**\n   * Media event cannot bubble, so they have no path\n   */\n  protected set _path(_val: Actor[]) {\n    // stubbed\n  }\n\n  constructor(public target: Sound, protected _name: string = 'MediaEvent') {\n    super();\n  }\n\n  /**\n   * Prevents event from bubbling\n   */\n  public stopPropagation(): void {\n    /**\n     * Stub\n     */\n  }\n  /**\n   * Action, that calls when event happens\n   */\n  public action(): void {\n    /**\n     * Stub\n     */\n  }\n  /**\n   * Propagate event further through event path\n   */\n  public propagate(): void {\n    /**\n     * Stub\n     */\n  }\n\n  public layPath(_actor: Actor): void {\n    /**\n     * Stub\n     */\n  }\n}\n\nexport class NativeSoundEvent extends MediaEvent {\n  constructor(target: Sound, public track?: AudioInstance) {\n    super(target, 'NativeSoundEvent');\n  }\n}\n","import { BoundingBox } from './Collision/BoundingBox';\nimport { GameEvent } from './Events';\nimport { Vector } from './Algebra';\nimport { Scene } from './Scene';\nimport { ActionContext } from './Actions/ActionContext';\nimport { Actor } from './Actor';\nimport { Logger } from './Util/Log';\nimport { IEvented } from './Interfaces/IEvented';\nimport { IActionable } from './Actions/IActionable';\nimport { Class } from './Class';\n\n/**\n * Groups are used for logically grouping Actors so they can be acted upon\n * in bulk.\n *\n * [[include:Groups.md]]\n */\nexport class Group extends Class implements IActionable, IEvented {\n  private _logger: Logger = Logger.getInstance();\n  private _members: Actor[] = [];\n\n  public actions: ActionContext = new ActionContext();\n\n  constructor(public name: string, public scene: Scene) {\n    super();\n    if (scene == null) {\n      this._logger.error('Invalid constructor arguments passed to Group: ', name, ', scene must not be null!');\n    } else {\n      var existingGroup = scene.groups[name];\n      if (existingGroup) {\n        this._logger.warn('Group with name', name, 'already exists. This new group will replace it.');\n      }\n      scene.groups[name] = this;\n    }\n  }\n\n  public add(actor: Actor): void;\n  public add(actors: Actor[]): void;\n  public add(actorOrActors: any): void {\n    if (actorOrActors instanceof Actor) {\n      actorOrActors = [].concat(actorOrActors);\n    }\n\n    var i = 0,\n      len = actorOrActors.length,\n      groupIdx: number;\n\n    for (i; i < len; i++) {\n      groupIdx = this.getMembers().indexOf(actorOrActors[i]);\n      if (groupIdx === -1) {\n        this._members.push(actorOrActors[i]);\n        this.scene.add(actorOrActors[i]);\n        this.actions.addActorToContext(actorOrActors[i]);\n        this.eventDispatcher.wire(actorOrActors[i].eventDispatcher);\n      }\n    }\n  }\n\n  public remove(actor: Actor): void {\n    var index = this._members.indexOf(actor);\n    if (index > -1) {\n      this._members.splice(index, 1);\n      this.actions.removeActorFromContext(actor);\n      this.eventDispatcher.unwire(actor.eventDispatcher);\n    }\n  }\n\n  public move(vector: Vector): void;\n  public move(dx: number, dy: number): void;\n  public move(args: Vector | number): void {\n    var i = 0,\n      members = this.getMembers(),\n      len = members.length;\n\n    if (arguments.length === 1 && args instanceof Vector) {\n      for (i; i < len; i++) {\n        members[i].pos.x += args.x;\n        members[i].pos.y += args.y;\n      }\n    } else if (typeof arguments[0] === 'number' && typeof arguments[1] === 'number') {\n      var x = arguments[0];\n      var y = arguments[1];\n\n      for (i; i < len; i++) {\n        members[i].pos.x += x;\n        members[i].pos.y += y;\n      }\n    } else {\n      this._logger.error('Invalid arguments passed to group move', this.name, 'args:', arguments);\n    }\n  }\n\n  public rotate(angle: number): void {\n    if (typeof angle !== 'number') {\n      this._logger.error('Invalid arguments passed to group rotate', this.name, 'args:', arguments);\n      return;\n    }\n\n    for (let member of this.getMembers()) {\n      member.rotation += angle;\n    }\n  }\n\n  public on(eventName: string, handler: (event?: GameEvent<any>) => void) {\n    this.eventDispatcher.on(eventName, handler);\n  }\n\n  public off(eventName: string, handler?: (event?: GameEvent<any>) => void) {\n    this.eventDispatcher.off(eventName, handler);\n  }\n\n  public emit(topic: string, event?: GameEvent<any>) {\n    this.eventDispatcher.emit(topic, event);\n  }\n\n  public contains(actor: Actor): boolean {\n    return this.getMembers().indexOf(actor) > -1;\n  }\n\n  public getMembers(): Actor[] {\n    return this._members;\n  }\n\n  public getRandomMember(): Actor {\n    return this._members[Math.floor(Math.random() * this._members.length)];\n  }\n\n  public getBounds(): BoundingBox {\n    return this.getMembers()\n      .map((a) => a.getBounds())\n      .reduce((prev: BoundingBox, curr: BoundingBox) => {\n        return prev.combine(curr);\n      });\n  }\n}\n","import { Class } from './../Class';\nimport { GameEvent, GamepadConnectEvent, GamepadDisconnectEvent, GamepadButtonEvent, GamepadAxisEvent } from '../Events';\nimport * as Events from '../Events';\n\n/**\n * Excalibur leverages the HTML5 Gamepad API [where it is supported](http://caniuse.com/#feat=gamepad)\n * to provide controller support for your games.\n *\n * [[include:Gamepads.md]]\n */\nexport class Gamepads extends Class {\n  /**\n   * Whether or not to poll for Gamepad input (default: `false`)\n   */\n  public enabled = false;\n\n  /**\n   * Whether or not Gamepad API is supported\n   */\n  public supported = !!(<any>navigator).getGamepads;\n\n  /**\n   * The minimum value an axis has to move before considering it a change\n   */\n  public static MinAxisMoveThreshold = 0.05;\n\n  private _gamePadTimeStamps = [0, 0, 0, 0];\n  private _oldPads: Gamepad[] = [];\n  private _pads: Gamepad[] = [];\n  private _initSuccess: boolean = false;\n  private _navigator: INavigatorGamepads = <any>navigator;\n  private _minimumConfiguration: IGamepadConfiguration = null;\n\n  constructor() {\n    super();\n  }\n\n  public init() {\n    if (!this.supported) {\n      return;\n    }\n    if (this._initSuccess) {\n      return;\n    }\n\n    // In Chrome, this will return 4 undefined items until a button is pressed\n    // In FF, this will not return any items until a button is pressed\n    this._oldPads = this._clonePads(this._navigator.getGamepads());\n    if (this._oldPads.length && this._oldPads[0]) {\n      this._initSuccess = true;\n    }\n  }\n\n  /**\n   * Sets the minimum gamepad configuration, for example {axis: 4, buttons: 4} means\n   * this game requires at minimum 4 axis inputs and 4 buttons, this is not restrictive\n   * all other controllers with more axis or buttons are valid as well. If no minimum\n   * configuration is set all pads are valid.\n   */\n  public setMinimumGamepadConfiguration(config: IGamepadConfiguration): void {\n    this._enableAndUpdate(); // if config is used, implicitly enable\n    this._minimumConfiguration = config;\n  }\n\n  /**\n   * When implicitly enabled, set the enabled flag and run an update so information is updated\n   */\n  private _enableAndUpdate() {\n    if (!this.enabled) {\n      this.enabled = true;\n      this.update();\n    }\n  }\n\n  /**\n   * Checks a navigator gamepad against the minimum configuration if present.\n   */\n  private _isGamepadValid(pad: INavigatorGamepad): boolean {\n    if (!this._minimumConfiguration) {\n      return true;\n    }\n    if (!pad) {\n      return false;\n    }\n    var axesLength = pad.axes.filter((value) => {\n      return typeof value !== undefined;\n    }).length;\n\n    var buttonLength = pad.buttons.filter((value) => {\n      return typeof value !== undefined;\n    }).length;\n    return axesLength >= this._minimumConfiguration.axis && buttonLength >= this._minimumConfiguration.buttons && pad.connected;\n  }\n\n  public on(eventName: Events.connect, handler: (event?: GamepadConnectEvent) => void): void;\n  public on(eventName: Events.disconnect, handler: (event?: GamepadDisconnectEvent) => void): void;\n  public on(eventName: Events.button, handler: (event?: GamepadButtonEvent) => void): void;\n  public on(eventName: Events.axis, handler: (event?: GamepadAxisEvent) => void): void;\n  public on(eventName: string, handler: (event?: GameEvent<any>) => void): void;\n  public on(eventName: string, handler: (event?: any) => void): void {\n    this._enableAndUpdate(); // implicitly enable\n    super.on(eventName, handler);\n  }\n\n  public off(eventName: string, handler?: (event?: GameEvent<any>) => void) {\n    this._enableAndUpdate(); // implicitly enable\n    super.off(eventName, handler);\n  }\n\n  /**\n   * Updates Gamepad state and publishes Gamepad events\n   */\n  public update() {\n    if (!this.enabled || !this.supported) {\n      return;\n    }\n    this.init();\n\n    var gamepads = this._navigator.getGamepads();\n\n    for (var i = 0; i < gamepads.length; i++) {\n      if (!gamepads[i]) {\n        let gamepad = this.at(i);\n        // If was connected, but now isn't emit the disconnect event\n        if (gamepad.connected) {\n          this.eventDispatcher.emit('disconnect', new GamepadDisconnectEvent(i, gamepad));\n        }\n        // Reset connection status\n        gamepad.connected = false;\n        continue;\n      } else {\n        if (!this.at(i).connected && this._isGamepadValid(gamepads[i])) {\n          this.eventDispatcher.emit('connect', new GamepadConnectEvent(i, this.at(i)));\n        }\n        // Set connection status\n        this.at(i).connected = true;\n      }\n\n      // Only supported in Chrome\n      if (gamepads[i].timestamp && gamepads[i].timestamp === this._gamePadTimeStamps[i]) {\n        continue;\n      }\n\n      this._gamePadTimeStamps[i] = gamepads[i].timestamp;\n\n      // Add reference to navigator gamepad\n      this.at(i).navigatorGamepad = gamepads[i];\n\n      // Buttons\n      var b: string, bi: number, a: string, ai: number, value: number;\n\n      for (b in Buttons) {\n        bi = <any>Buttons[b];\n        if (typeof bi === 'number') {\n          if (gamepads[i].buttons[bi]) {\n            value = gamepads[i].buttons[bi].value;\n            if (value !== this._oldPads[i].getButton(bi)) {\n              if (gamepads[i].buttons[bi].pressed) {\n                this.at(i).updateButton(bi, value);\n                this.at(i).eventDispatcher.emit('button', new GamepadButtonEvent(bi, value, this.at(i)));\n              } else {\n                this.at(i).updateButton(bi, 0);\n              }\n            }\n          }\n        }\n      }\n\n      // Axes\n      for (a in Axes) {\n        ai = <any>Axes[a];\n        if (typeof ai === 'number') {\n          value = gamepads[i].axes[ai];\n          if (value !== this._oldPads[i].getAxes(ai)) {\n            this.at(i).updateAxes(ai, value);\n            this.at(i).eventDispatcher.emit('axis', new GamepadAxisEvent(ai, value, this.at(i)));\n          }\n        }\n      }\n\n      this._oldPads[i] = this._clonePad(gamepads[i]);\n    }\n  }\n\n  /**\n   * Safely retrieves a Gamepad at a specific index and creates one if it doesn't yet exist\n   */\n  public at(index: number): Gamepad {\n    this._enableAndUpdate(); // implicitly enable gamepads when at() is called\n    if (index >= this._pads.length) {\n      // Ensure there is a pad to retrieve\n      for (var i = this._pads.length - 1, max = index; i < max; i++) {\n        this._pads.push(new Gamepad());\n        this._oldPads.push(new Gamepad());\n      }\n    }\n\n    return this._pads[index];\n  }\n\n  /**\n   * Returns a list of all valid gamepads that meet the minimum configuration requirement.\n   */\n  public getValidGamepads(): Gamepad[] {\n    this._enableAndUpdate();\n    var result: Gamepad[] = [];\n    for (var i = 0; i < this._pads.length; i++) {\n      if (this._isGamepadValid(this.at(i).navigatorGamepad) && this.at(i).connected) {\n        result.push(this.at(i));\n      }\n    }\n    return result;\n  }\n\n  /**\n   * Gets the number of connected gamepads\n   */\n  public count() {\n    return this._pads.filter((p) => p.connected).length;\n  }\n\n  private _clonePads(pads: INavigatorGamepad[]): Gamepad[] {\n    var arr = [];\n    for (var i = 0, len = pads.length; i < len; i++) {\n      arr.push(this._clonePad(pads[i]));\n    }\n    return arr;\n  }\n\n  /**\n   * Fastest way to clone a known object is to do it yourself\n   */\n  private _clonePad(pad: INavigatorGamepad): Gamepad {\n    var i, len;\n    var clonedPad = new Gamepad();\n\n    if (!pad) {\n      return clonedPad;\n    }\n\n    for (i = 0, len = pad.buttons.length; i < len; i++) {\n      if (pad.buttons[i]) {\n        clonedPad.updateButton(i, pad.buttons[i].value);\n      }\n    }\n    for (i = 0, len = pad.axes.length; i < len; i++) {\n      clonedPad.updateAxes(i, pad.axes[i]);\n    }\n\n    return clonedPad;\n  }\n}\n\n/**\n * Gamepad holds state information for a connected controller. See [[Gamepads]]\n * for more information on handling controller input.\n */\nexport class Gamepad extends Class {\n  public connected = false;\n  public navigatorGamepad: INavigatorGamepad;\n  private _buttons: number[] = new Array(16);\n  private _axes: number[] = new Array(4);\n\n  constructor() {\n    super();\n\n    var i: number;\n    for (i = 0; i < this._buttons.length; i++) {\n      this._buttons[i] = 0;\n    }\n    for (i = 0; i < this._axes.length; i++) {\n      this._axes[i] = 0;\n    }\n  }\n\n  /**\n   * Whether or not the given button is pressed\n   * @param button     The button to query\n   * @param threshold  The threshold over which the button is considered to be pressed\n   */\n  public isButtonPressed(button: Buttons, threshold: number = 1) {\n    return this._buttons[button] >= threshold;\n  }\n\n  /**\n   * Gets the given button value between 0 and 1\n   */\n  public getButton(button: Buttons) {\n    return this._buttons[button];\n  }\n\n  /**\n   * Gets the given axis value between -1 and 1. Values below\n   * [[MinAxisMoveThreshold]] are considered 0.\n   */\n  public getAxes(axes: Axes) {\n    var value = this._axes[axes];\n\n    if (Math.abs(value) < Gamepads.MinAxisMoveThreshold) {\n      return 0;\n    } else {\n      return value;\n    }\n  }\n\n  public updateButton(buttonIndex: number, value: number) {\n    this._buttons[buttonIndex] = value;\n  }\n\n  public updateAxes(axesIndex: number, value: number) {\n    this._axes[axesIndex] = value;\n  }\n}\n\n/**\n * Gamepad Buttons enumeration\n */\nexport enum Buttons {\n  /**\n   * Face 1 button (e.g. A)\n   */\n  Face1 = 0,\n  /**\n   * Face 2 button (e.g. B)\n   */\n  Face2 = 1,\n  /**\n   * Face 3 button (e.g. X)\n   */\n  Face3 = 2,\n  /**\n   * Face 4 button (e.g. Y)\n   */\n  Face4 = 3,\n  /**\n   * Left bumper button\n   */\n  LeftBumper = 4,\n  /**\n   * Right bumper button\n   */\n  RightBumper = 5,\n  /**\n   * Left trigger button\n   */\n  LeftTrigger = 6,\n  /**\n   * Right trigger button\n   */\n  RightTrigger = 7,\n  /**\n   * Select button\n   */\n  Select = 8,\n  /**\n   * Start button\n   */\n  Start = 9,\n  /**\n   * Left analog stick press (e.g. L3)\n   */\n  LeftStick = 10,\n  /**\n   * Right analog stick press (e.g. R3)\n   */\n  RightStick = 11,\n  /**\n   * D-pad up\n   */\n  DpadUp = 12,\n  /**\n   * D-pad down\n   */\n  DpadDown = 13,\n  /**\n   * D-pad left\n   */\n  DpadLeft = 14,\n  /**\n   * D-pad right\n   */\n  DpadRight = 15\n}\n\n/**\n * Gamepad Axes enumeration\n */\nexport enum Axes {\n  /**\n   * Left analogue stick X direction\n   */\n  LeftStickX = 0,\n  /**\n   * Left analogue stick Y direction\n   */\n  LeftStickY = 1,\n  /**\n   * Right analogue stick X direction\n   */\n  RightStickX = 2,\n  /**\n   * Right analogue stick Y direction\n   */\n  RightStickY = 3\n}\n\n/**\n * @internal\n */\ninterface INavigatorGamepads {\n  getGamepads(): INavigatorGamepad[];\n}\n\n/**\n * @internal\n */\nexport interface INavigatorGamepad {\n  axes: number[];\n  buttons: INavigatorGamepadButton[];\n  connected: boolean;\n  id: string;\n  index: number;\n  mapping: string;\n  timestamp: number;\n}\n\n/**\n * @internal\n */\nexport interface INavigatorGamepadButton {\n  pressed: boolean;\n  value: number;\n}\n\n/**\n * @internal\n */\nexport interface INavigatorGamepadEvent {\n  gamepad: INavigatorGamepad;\n}\n\n/**\n * @internal\n */\nexport interface IGamepadConfiguration {\n  axis: number;\n  buttons: number;\n}\n","/**\n * Provides support for mice, keyboards, and controllers.\n *\n * [[include:Input.md]]\n */\n\n/**\n * @typedoc\n */\nexport * from './Gamepad';\nexport * from './Pointer';\nexport * from './Keyboard';\nexport * from './IEngineInput';\n","import { Class } from './../Class';\nimport { GameEvent } from '../Events';\nimport * as Events from '../Events';\n\n/**\n * Enum representing input key codes\n */\nexport enum Keys {\n  Num1 = 97,\n  Num2 = 98,\n  Num3 = 99,\n  Num4 = 100,\n  Num5 = 101,\n  Num6 = 102,\n  Num7 = 103,\n  Num8 = 104,\n  Num9 = 105,\n  Num0 = 96,\n\n  Numlock = 144,\n\n  Semicolon = 186, // 59 in some browsers\n\n  A = 65,\n  B = 66,\n  C = 67,\n  D = 68,\n  E = 69,\n  F = 70,\n  G = 71,\n  H = 72,\n  I = 73,\n  J = 74,\n  K = 75,\n  L = 76,\n  M = 77,\n  N = 78,\n  O = 79,\n  P = 80,\n  Q = 81,\n  R = 82,\n  S = 83,\n  T = 84,\n  U = 85,\n  V = 86,\n  W = 87,\n  X = 88,\n  Y = 89,\n  Z = 90,\n\n  Shift = 16,\n  Alt = 18,\n  Up = 38,\n  Down = 40,\n  Left = 37,\n  Right = 39,\n  Space = 32,\n  Esc = 27\n}\n\n/**\n * Event thrown on a game object for a key event\n */\nexport class KeyEvent extends GameEvent<any> {\n  /**\n   * @param key  The key responsible for throwing the event\n   */\n  constructor(public key: Keys) {\n    super();\n  }\n}\n\n/**\n * Provides keyboard support for Excalibur.\n *\n * [[include:Keyboard.md]]\n */\nexport class Keyboard extends Class {\n  private _keys: number[] = [];\n  private _keysUp: number[] = [];\n  private _keysDown: number[] = [];\n\n  constructor() {\n    super();\n  }\n\n  public on(eventName: Events.press, handler: (event?: KeyEvent) => void): void;\n  public on(eventName: Events.release, handler: (event?: KeyEvent) => void): void;\n  public on(eventName: Events.hold, handler: (event?: KeyEvent) => void): void;\n  public on(eventName: string, handler: (event?: GameEvent<any>) => void): void;\n  public on(eventName: string, handler: (event?: any) => void): void {\n    super.on(eventName, handler);\n  }\n\n  /**\n   * Initialize Keyboard event listeners\n   */\n  init(global?: GlobalEventHandlers): void {\n    global = global || window;\n    global.addEventListener('blur', () => {\n      this._keys.length = 0; // empties array efficiently\n    });\n\n    // key up is on window because canvas cannot have focus\n    global.addEventListener('keyup', (ev: KeyboardEvent) => {\n      var code = this._normalizeKeyCode(ev.keyCode);\n      var key = this._keys.indexOf(code);\n      this._keys.splice(key, 1);\n      this._keysUp.push(code);\n      var keyEvent = new KeyEvent(code);\n\n      // alias the old api, we may want to deprecate this in the future\n      this.eventDispatcher.emit('up', keyEvent);\n      this.eventDispatcher.emit('release', keyEvent);\n    });\n\n    // key down is on window because canvas cannot have focus\n    global.addEventListener('keydown', (ev: KeyboardEvent) => {\n      var code = this._normalizeKeyCode(ev.keyCode);\n      if (this._keys.indexOf(code) === -1) {\n        this._keys.push(code);\n        this._keysDown.push(code);\n        var keyEvent = new KeyEvent(code);\n        this.eventDispatcher.emit('down', keyEvent);\n        this.eventDispatcher.emit('press', keyEvent);\n      }\n    });\n  }\n\n  public update() {\n    // Reset keysDown and keysUp after update is complete\n    this._keysDown.length = 0;\n    this._keysUp.length = 0;\n\n    // Emit synthetic \"hold\" event\n    for (var i = 0; i < this._keys.length; i++) {\n      this.eventDispatcher.emit('hold', new KeyEvent(this._keys[i]));\n    }\n  }\n\n  /**\n   * Gets list of keys being pressed down\n   */\n  public getKeys(): Keys[] {\n    return this._keys;\n  }\n\n  /**\n   * Tests if a certain key was just pressed this frame. This is cleared at the end of the update frame.\n   * @param key Test whether a key was just pressed\n   */\n  public wasPressed(key: Keys): boolean {\n    return this._keysDown.indexOf(key) > -1;\n  }\n\n  /**\n   * Tests if a certain key is held down. This is persisted between frames.\n   * @param key  Test whether a key is held down\n   */\n  public isHeld(key: Keys): boolean {\n    return this._keys.indexOf(key) > -1;\n  }\n\n  /**\n   * Tests if a certain key was just released this frame. This is cleared at the end of the update frame.\n   * @param key  Test whether a key was just released\n   */\n  public wasReleased(key: Keys): boolean {\n    return this._keysUp.indexOf(key) > -1;\n  }\n\n  /**\n   * Normalizes some browser event key codes to map to standard Excalibur key codes\n   * @param code Event keyCode\n   * @see http://unixpapa.com/js/key.html\n   */\n  private _normalizeKeyCode(code: number) {\n    switch (code) {\n      case 59: // : ; in Firefox, Opera\n        return Keys.Semicolon;\n      default:\n        return code;\n    }\n  }\n}\n","import { Engine, ScrollPreventionMode } from './../Engine';\nimport { GameEvent } from '../Events';\nimport { Actor } from '../Actor';\nimport { Vector, GlobalCoordinates } from '../Algebra';\nimport { Class } from '../Class';\nimport * as Actors from '../Util/Actors';\nimport * as Util from '../Util/Util';\nimport * as Events from '../Events';\n\nexport interface IActorsUnderPointer {\n  [ActorId: number]: Actor;\n  length: number;\n}\n\n/**\n * The type of pointer for a [[PointerEvent]].\n */\nexport enum PointerType {\n  Touch,\n  Mouse,\n  Pen,\n  Unknown\n}\n\n/**\n * The mouse button being pressed.\n */\nexport enum PointerButton {\n  Left,\n  Middle,\n  Right,\n  Unknown\n}\n\nexport enum WheelDeltaMode {\n  Pixel,\n  Line,\n  Page\n}\n\n/**\n * Determines the scope of handling mouse/touch events. See [[Pointers]] for more information.\n */\nexport enum PointerScope {\n  /**\n   * Handle events on the `canvas` element only. Events originating outside the\n   * `canvas` will not be handled.\n   */\n  Canvas,\n\n  /**\n   * Handles events on the entire document. All events will be handled by Excalibur.\n   */\n  Document\n}\n\n/**\n * A constant used to normalize wheel events across different browsers\n *\n * This normalization factor is pulled from https://developer.mozilla.org/en-US/docs/Web/Events/wheel#Listening_to_this_event_across_browser\n */\nconst ScrollWheelNormalizationFactor = -1 / 40;\n\n/**\n * Pointer events\n *\n * Represents a mouse, touch, or stylus event. See [[Pointers]] for more information on\n * handling pointer input.\n *\n * For mouse-based events, you can inspect [[PointerEvent.button]] to see what button was pressed.\n */\nexport class PointerEvent extends GameEvent<Actor> {\n  /** The world coordinates of the event. */\n  public get worldPos(): Vector {\n    return this.coordinates.worldPos.clone();\n  }\n\n  /** The page coordinates of the event. */\n  public get pagePos(): Vector {\n    return this.coordinates.pagePos.clone();\n  }\n\n  /** The screen coordinates of the event. */\n  public get screenPos(): Vector {\n    return this.coordinates.screenPos.clone();\n  }\n\n  /**\n   * @param coordinates         The [[GlobalCoordinates]] of the event\n   * @param pointer             The [[Pointer]] of the event\n   * @param index               The index of the pointer (zero-based)\n   * @param pointerType         The type of pointer\n   * @param button              The button pressed (if [[PointerType.Mouse]])\n   * @param ev                  The raw DOM event being handled\n   * @param pos                 (Will be added to signature in 0.14.0 release) The position of the event (in world coordinates)\n   */\n  constructor(\n    protected coordinates: GlobalCoordinates,\n    public pointer: Pointer,\n    public index: number,\n    public pointerType: PointerType,\n    public button: PointerButton,\n    public ev: any\n  ) {\n    super();\n  }\n\n  public get pos(): Vector {\n    return this.coordinates.worldPos.clone();\n  }\n  /**\n   * Sets event path to actor, depending on actor provided.\n   * If actor is lower in hierarchy tree, previous path'll be kept.\n   * @param actor Actor, to lay path form.\n   */\n  public layPath(actor: Actor): void {\n    if (!this.pointer.isActorUnderPointer(actor)) {\n      return;\n    }\n\n    const actorPath = actor.getAncestors();\n    this._path = actorPath.length > this._path.length ? actorPath : this._path;\n  }\n}\n\nexport class PointerEventFactory<T extends PointerEvent> {\n  constructor(\n    protected _pointerEventType: new (\n      coordinates: GlobalCoordinates,\n      pointer: Pointer,\n      index: number,\n      pointerType: PointerType,\n      button: PointerButton,\n      ev: any\n    ) => T\n  ) {}\n\n  /**\n   * Create specific PointerEvent\n   */\n  public create(\n    coordinates: GlobalCoordinates,\n    pointer: Pointer,\n    index: number,\n    pointerType: PointerType,\n    button: PointerButton,\n    ev: any\n  ): T {\n    return new this._pointerEventType(coordinates, pointer, index, pointerType, button, ev);\n  }\n}\n\nexport class PointerDragEvent extends PointerEvent {}\n\nexport class PointerUpEvent extends PointerEvent {\n  protected _name = 'pointerup';\n\n  protected _onActionEnd(actor: Actor) {\n    const pointer = this.pointer;\n\n    if (pointer.isDragEnd && actor.capturePointer.captureDragEvents) {\n      actor.eventDispatcher.emit('pointerdragend', this);\n    }\n  }\n}\n\nexport class PointerDownEvent extends PointerEvent {\n  protected _name = 'pointerdown';\n\n  protected _onActionEnd(actor: Actor) {\n    if (this.pointer.isDragStart && actor.capturePointer.captureDragEvents) {\n      actor.eventDispatcher.emit('pointerdragstart', this);\n    }\n  }\n}\n\nexport class PointerMoveEvent extends PointerEvent {\n  protected _name = 'pointermove';\n\n  public propagate(): void {\n    if (!this.eventPath.length) {\n      if (this.pointer.hasActorsUnderPointer) {\n        const actors = this.pointer.getActorsUnderPointer();\n        actors.forEach((actor) => {\n          if (!this.pointer.isActorUnderPointer(actor)) {\n            this._onActorLeave(actor);\n          }\n        });\n      }\n\n      return;\n    }\n\n    this.action();\n\n    if (this.bubbles) {\n      this.propagate();\n    }\n  }\n\n  /**\n   * Sets event path to actor, depending on actor provided.\n   * If actor is in a dragging state, current dragging target would be used.\n   * @param actor Actor, to lay path form.\n   */\n  public layPath(actor: Actor): void {\n    /**\n     *  double-check is preformed, because user could move pointer too fast and\n     *  in that case, pointer can appear out of boundings of the dragging element\n     */\n    if (this.pointer.isDragging) {\n      actor = this.pointer.dragTarget || actor;\n    } else if (!this.pointer.isActorUnderPointer(actor)) {\n      return;\n    }\n\n    const actorPath = actor.getAncestors();\n    this._path = actorPath.length > this._path.length ? actorPath : this._path;\n  }\n\n  protected _onActionStart(actor: Actor) {\n    if (!actor.capturePointer.captureMoveEvents) {\n      return;\n    }\n\n    if (this.pointer.isActorUnderPointer(actor) && !this.pointer.hasActorUnderPointerInList(actor)) {\n      this._onActorEnter(actor);\n    }\n\n    if (this.pointer.isDragging && actor.capturePointer.captureDragEvents) {\n      actor.eventDispatcher.emit('pointerdragmove', this);\n    }\n  }\n\n  private _onActorEnter(actor: Actor) {\n    const pe = createPointerEventByName('enter', this.coordinates, this.pointer, this.index, this.pointerType, this.button, this.ev);\n    pe.layPath(actor);\n    pe.propagate();\n    this.pointer.addActorUnderPointer(actor);\n\n    if (this.pointer.isDragging) {\n      this.pointer.dragTarget = actor;\n    }\n  }\n\n  private _onActorLeave(actor: Actor) {\n    const pe = createPointerEventByName('leave', this.coordinates, this.pointer, this.index, this.pointerType, this.button, this.ev);\n    pe.layPath(actor);\n    pe.propagate();\n    this.pointer.removeActorUnderPointer(actor);\n  }\n}\n\nexport class PointerEnterEvent extends PointerEvent {\n  protected _name = 'pointerenter';\n\n  protected _onActionStart(actor: Actor) {\n    if (!actor.capturePointer.captureMoveEvents) {\n      return;\n    }\n  }\n\n  protected _onActionEnd(actor: Actor) {\n    const pointer = this.pointer;\n\n    if (pointer.isDragging && actor.capturePointer.captureDragEvents) {\n      actor.eventDispatcher.emit('pointerdragenter', this);\n    }\n  }\n}\n\nexport class PointerLeaveEvent extends PointerEvent {\n  protected _name = 'pointerleave';\n\n  public layPath(actor: Actor): void {\n    const actorPath = actor.getAncestors();\n    this._path = actorPath.length > this._path.length ? actorPath : this._path;\n  }\n\n  protected _onActionStart(actor: Actor) {\n    if (!actor.capturePointer.captureMoveEvents) {\n      return;\n    }\n  }\n\n  protected _onActionEnd(actor: Actor) {\n    const pointer = this.pointer;\n\n    if (pointer.isDragging && actor.capturePointer.captureDragEvents) {\n      actor.eventDispatcher.emit('pointerdragleave', this);\n    }\n  }\n}\n\nexport class PointerCancelEvent extends PointerEvent {\n  protected _name = 'pointercancel';\n}\n/**\n * Wheel Events\n *\n * Represents a mouse wheel event. See [[Pointers]] for more information on\n * handling point input.\n */\nexport class WheelEvent extends GameEvent<Actor> {\n  /**\n   * @param x            The `x` coordinate of the event (in world coordinates)\n   * @param y            The `y` coordinate of the event (in world coordinates)\n   * @param pageX        The `x` coordinate of the event (in document coordinates)\n   * @param pageY        The `y` coordinate of the event (in document coordinates)\n   * @param screenX      The `x` coordinate of the event (in screen coordinates)\n   * @param screenY      The `y` coordinate of the event (in screen coordinates)\n   * @param index        The index of the pointer (zero-based)\n   * @param deltaX       The type of pointer\n   * @param deltaY       The type of pointer\n   * @param deltaZ       The type of pointer\n   * @param deltaMode    The type of movement [[WheelDeltaMode]]\n   * @param ev           The raw DOM event being handled\n   */\n  constructor(\n    public x: number,\n    public y: number,\n    public pageX: number,\n    public pageY: number,\n    public screenX: number,\n    public screenY: number,\n    public index: number,\n    public deltaX: number,\n    public deltaY: number,\n    public deltaZ: number,\n    public deltaMode: WheelDeltaMode,\n    public ev: any\n  ) {\n    super();\n  }\n}\n\nfunction createPointerEventByName(\n  eventName: string,\n  coordinates: GlobalCoordinates,\n  pointer: Pointer,\n  index: number,\n  pointerType: PointerType,\n  button: PointerButton,\n  ev: any\n) {\n  let factory: PointerEventFactory<PointerEvent>;\n\n  switch (eventName) {\n    case 'up':\n      factory = new PointerEventFactory(<any>PointerUpEvent);\n      break;\n    case 'down':\n      factory = new PointerEventFactory(<any>PointerDownEvent);\n      break;\n    case 'move':\n      factory = new PointerEventFactory(<any>PointerMoveEvent);\n      break;\n    case 'cancel':\n      factory = new PointerEventFactory(<any>PointerCancelEvent);\n      break;\n    case 'enter':\n      factory = new PointerEventFactory(<any>PointerEnterEvent);\n      break;\n    case 'leave':\n      factory = new PointerEventFactory(<any>PointerLeaveEvent);\n      break;\n  }\n\n  return factory.create(coordinates, pointer, index, pointerType, button, ev);\n}\n\n/**\n * Handles pointer events (mouse, touch, stylus, etc.) and normalizes to\n * [W3C Pointer Events](http://www.w3.org/TR/pointerevents/).\n *\n * [[include:Pointers.md]]\n */\nexport class Pointers extends Class {\n  private _engine: Engine;\n\n  private _pointerDown: PointerEvent[] = [];\n  private _pointerUp: PointerEvent[] = [];\n  private _pointerMove: PointerEvent[] = [];\n  private _pointerCancel: PointerEvent[] = [];\n  private _wheel: WheelEvent[] = [];\n  private _pointers: Pointer[] = [];\n  private _activePointers: number[] = [];\n\n  constructor(engine: Engine) {\n    super();\n\n    this._engine = engine;\n    this._pointers.push(new Pointer());\n    this._activePointers = [-1];\n    this.primary = this._pointers[0];\n  }\n\n  public on(eventName: Events.up, handler: (event?: PointerEvent) => void): void;\n  public on(eventName: Events.down, handler: (event?: PointerEvent) => void): void;\n  public on(eventName: Events.move, handler: (event?: PointerEvent) => void): void;\n  public on(eventName: Events.enter, handler: (event?: PointerEvent) => void): void;\n  public on(eventName: Events.leave, handler: (event?: PointerEvent) => void): void;\n  public on(eventName: Events.cancel, handler: (event?: PointerEvent) => void): void;\n  public on(eventName: Events.wheel, handler: (event?: WheelEvent) => void): void;\n  public on(eventName: string, handler: (event?: GameEvent<any>) => void): void;\n  public on(eventName: string, handler: (event?: any) => void): void {\n    super.on(eventName, handler);\n  }\n\n  /**\n   * Primary pointer (mouse, 1 finger, stylus, etc.)\n   */\n  public primary: Pointer;\n\n  /**\n   * Initializes pointer event listeners\n   */\n  public init(target?: GlobalEventHandlers): void {\n    target = target || this._engine.canvas;\n\n    // Touch Events\n    target.addEventListener('touchstart', this._handleTouchEvent('down', this._pointerDown));\n    target.addEventListener('touchend', this._handleTouchEvent('up', this._pointerUp));\n    target.addEventListener('touchmove', this._handleTouchEvent('move', this._pointerMove));\n    target.addEventListener('touchcancel', this._handleTouchEvent('cancel', this._pointerCancel));\n\n    // W3C Pointer Events\n    // Current: IE11, IE10\n    if ((<any>window).PointerEvent) {\n      // IE11\n      this._engine.canvas.style.touchAction = 'none';\n      target.addEventListener('pointerdown', this._handlePointerEvent('down', this._pointerDown));\n      target.addEventListener('pointerup', this._handlePointerEvent('up', this._pointerUp));\n      target.addEventListener('pointermove', this._handlePointerEvent('move', this._pointerMove));\n      target.addEventListener('pointercancel', this._handlePointerEvent('cancel', this._pointerCancel));\n    } else if ((<any>window).MSPointerEvent) {\n      // IE10\n      this._engine.canvas.style.msTouchAction = 'none';\n      target.addEventListener('MSPointerDown', this._handlePointerEvent('down', this._pointerDown));\n      target.addEventListener('MSPointerUp', this._handlePointerEvent('up', this._pointerUp));\n      target.addEventListener('MSPointerMove', this._handlePointerEvent('move', this._pointerMove));\n      target.addEventListener('MSPointerCancel', this._handlePointerEvent('cancel', this._pointerCancel));\n    } else {\n      // Mouse Events\n      target.addEventListener('mousedown', this._handleMouseEvent('down', this._pointerDown));\n      target.addEventListener('mouseup', this._handleMouseEvent('up', this._pointerUp));\n      target.addEventListener('mousemove', this._handleMouseEvent('move', this._pointerMove));\n    }\n\n    // MDN MouseWheelEvent\n    if ('onwheel' in document.createElement('div')) {\n      // Modern Browsers\n      target.addEventListener('wheel', this._handleWheelEvent('wheel', this._wheel));\n    } else if (document.onmousewheel !== undefined) {\n      // Webkit and IE\n      target.addEventListener('mousewheel', this._handleWheelEvent('wheel', this._wheel));\n    } else {\n      // Remaining browser and older Firefox\n      target.addEventListener('MozMousePixelScroll', this._handleWheelEvent('wheel', this._wheel));\n    }\n  }\n\n  public update(): void {\n    this._pointerUp.length = 0;\n    this._pointerDown.length = 0;\n    this._pointerMove.length = 0;\n    this._pointerCancel.length = 0;\n    this._wheel.length = 0;\n\n    for (let i = 0; i < this._pointers.length; i++) {\n      this._pointers[i].update();\n    }\n  }\n\n  /**\n   * Safely gets a Pointer at a specific index and initializes one if it doesn't yet exist\n   * @param index  The pointer index to retrieve\n   */\n  public at(index: number): Pointer {\n    if (index >= this._pointers.length) {\n      // Ensure there is a pointer to retrieve\n      for (var i = this._pointers.length - 1, max = index; i < max; i++) {\n        this._pointers.push(new Pointer());\n        this._activePointers.push(-1);\n      }\n    }\n\n    return this._pointers[index];\n  }\n\n  /**\n   * Get number of pointers being watched\n   */\n  public count(): number {\n    return this._pointers.length;\n  }\n\n  /**\n   * Propogates events through ancestors chain if necessary\n   */\n  public propagate() {\n    this._propagatePointerEvent(this._pointerDown);\n    this._propagatePointerEvent(this._pointerUp);\n    this._propagatePointerEvent(this._pointerMove);\n    this._propagatePointerEvent(this._pointerCancel);\n    this._propagateWheelEvent('pointerwheel', this._wheel);\n  }\n\n  /**\n   * Revises pointer events paths accordingly to actor provided\n   * @param actor  Actor to be revised\n   */\n  public revisePointerEventsPaths(actor: Actor) {\n    this._revisePointerEventPath(actor, this._pointerDown);\n    this._revisePointerEventPath(actor, this._pointerUp);\n    this._revisePointerEventPath(actor, this._pointerMove);\n    this._revisePointerEventPath(actor, this._pointerCancel);\n    this._validateWheelEventPath(this._wheel, actor);\n  }\n\n  private _propagatePointerEvent(pointers: PointerEvent[]) {\n    const len = pointers.length;\n\n    for (let i = 0; i < len; i++) {\n      pointers[i].propagate();\n    }\n  }\n\n  private _revisePointerEventPath(actor: Actor, pointers: PointerEvent[]) {\n    const len = pointers.length;\n\n    for (let i = 0; i < len; i++) {\n      const pointerEvent = pointers[i];\n\n      pointerEvent.layPath(actor);\n    }\n  }\n\n  private _validateWheelEventPath(pointers: WheelEvent[], actor: Actor): void {\n    for (let i = 0; i < pointers.length; i++) {\n      const wheelEvent = pointers[i];\n      const isNotUIActor = !Actors.isUIActor(actor);\n\n      if (actor.contains(wheelEvent.x, wheelEvent.y, isNotUIActor)) {\n        wheelEvent.layPath(actor);\n      }\n    }\n  }\n\n  private _propagateWheelEvent(eventName: string, pointers: WheelEvent[]) {\n    const len = pointers.length;\n    let wheelEvent: WheelEvent;\n\n    for (let i = 0; i < len; i++) {\n      wheelEvent = pointers[i];\n\n      switch (eventName) {\n        case 'pointerwheel':\n          this._propagateWheelPointerEvent(wheelEvent);\n          break;\n      }\n    }\n  }\n\n  private _propagateWheelPointerEvent(wheelEvent: WheelEvent) {\n    if (!wheelEvent.eventPath.length) {\n      return;\n    }\n\n    const actor = wheelEvent.eventPath.pop();\n    actor.eventDispatcher.emit('pointerwheel', wheelEvent);\n\n    if (wheelEvent.bubbles) {\n      this._propagateWheelPointerEvent(wheelEvent);\n    }\n  }\n\n  private _handleMouseEvent(eventName: string, eventArr: PointerEvent[]) {\n    return (e: MouseEvent) => {\n      e.preventDefault();\n\n      const pointer = this.at(0);\n      const coordinates = GlobalCoordinates.fromPagePosition(e.pageX, e.pageY, this._engine);\n      const pe = createPointerEventByName(eventName, coordinates, pointer, 0, PointerType.Mouse, e.button, e);\n\n      eventArr.push(pe);\n      pointer.eventDispatcher.emit(eventName, pe);\n    };\n  }\n\n  private _handleTouchEvent(eventName: string, eventArr: PointerEvent[]) {\n    return (e: ITouchEvent) => {\n      e.preventDefault();\n      for (var i = 0, len = e.changedTouches.length; i < len; i++) {\n        const index = this._pointers.length > 1 ? this._getPointerIndex(e.changedTouches[i].identifier) : 0;\n        if (index === -1) {\n          continue;\n        }\n\n        const pointer = this.at(index);\n        const coordinates = GlobalCoordinates.fromPagePosition(e.changedTouches[i].pageX, e.changedTouches[i].pageY, this._engine);\n        const pe = createPointerEventByName(eventName, coordinates, pointer, index, PointerType.Touch, PointerButton.Unknown, e);\n\n        eventArr.push(pe);\n        pointer.eventDispatcher.emit(eventName, pe);\n        // only with multi-pointer\n        if (this._pointers.length > 1) {\n          if (eventName === 'up') {\n            // remove pointer ID from pool when pointer is lifted\n            this._activePointers[index] = -1;\n          } else if (eventName === 'down') {\n            // set pointer ID to given index\n            this._activePointers[index] = e.changedTouches[i].identifier;\n          }\n        }\n      }\n    };\n  }\n\n  private _handlePointerEvent(eventName: string, eventArr: PointerEvent[]) {\n    return (e: MSPointerEvent) => {\n      e.preventDefault();\n\n      // get the index for this pointer ID if multi-pointer is asked for\n      const index = this._pointers.length > 1 ? this._getPointerIndex(e.pointerId) : 0;\n      if (index === -1) {\n        return;\n      }\n\n      const pointer = this.at(index);\n      const coordinates = GlobalCoordinates.fromPagePosition(e.pageX, e.pageY, this._engine);\n      const pe = createPointerEventByName(eventName, coordinates, pointer, index, this._stringToPointerType(e.pointerType), e.button, e);\n\n      eventArr.push(pe);\n      pointer.eventDispatcher.emit(eventName, pe);\n\n      // only with multi-pointer\n      if (this._pointers.length > 1) {\n        if (eventName === 'up') {\n          // remove pointer ID from pool when pointer is lifted\n          this._activePointers[index] = -1;\n        } else if (eventName === 'down') {\n          // set pointer ID to given index\n          this._activePointers[index] = e.pointerId;\n        }\n      }\n    };\n  }\n\n  private _handleWheelEvent(eventName: string, eventArr: WheelEvent[]) {\n    return (e: MouseWheelEvent) => {\n      // Should we prevent page scroll because of this event\n      if (\n        this._engine.pageScrollPreventionMode === ScrollPreventionMode.All ||\n        (this._engine.pageScrollPreventionMode === ScrollPreventionMode.Canvas && e.target === this._engine.canvas)\n      ) {\n        e.preventDefault();\n      }\n\n      var x: number = e.pageX - Util.getPosition(this._engine.canvas).x;\n      var y: number = e.pageY - Util.getPosition(this._engine.canvas).y;\n      var transformedPoint = this._engine.screenToWorldCoordinates(new Vector(x, y));\n\n      // deltaX, deltaY, and deltaZ are the standard modern properties\n      // wheelDeltaX, wheelDeltaY, are legacy properties in webkit browsers and older IE\n      // e.detail is only used in opera\n\n      var deltaX = e.deltaX || e.wheelDeltaX * ScrollWheelNormalizationFactor || 0;\n      var deltaY =\n        e.deltaY || e.wheelDeltaY * ScrollWheelNormalizationFactor || e.wheelDelta * ScrollWheelNormalizationFactor || e.detail || 0;\n      var deltaZ = e.deltaZ || 0;\n      var deltaMode = WheelDeltaMode.Pixel;\n\n      if (e.deltaMode) {\n        if (e.deltaMode === 1) {\n          deltaMode = WheelDeltaMode.Line;\n        } else if (e.deltaMode === 2) {\n          deltaMode = WheelDeltaMode.Page;\n        }\n      }\n\n      var we = new WheelEvent(transformedPoint.x, transformedPoint.y, e.pageX, e.pageY, x, y, 0, deltaX, deltaY, deltaZ, deltaMode, e);\n\n      eventArr.push(we);\n      this.at(0).eventDispatcher.emit(eventName, we);\n    };\n  }\n\n  /**\n   * Gets the index of the pointer specified for the given pointer ID or finds the next empty pointer slot available.\n   * This is required because IE10/11 uses incrementing pointer IDs so we need to store a mapping of ID => idx\n   */\n  private _getPointerIndex(pointerId: number) {\n    var idx;\n    if ((idx = this._activePointers.indexOf(pointerId)) > -1) {\n      return idx;\n    }\n\n    for (var i = 0; i < this._activePointers.length; i++) {\n      if (this._activePointers[i] === -1) {\n        return i;\n      }\n    }\n\n    // ignore pointer because game isn't watching\n    return -1;\n  }\n\n  private _stringToPointerType(s: string) {\n    switch (s) {\n      case 'touch':\n        return PointerType.Touch;\n      case 'mouse':\n        return PointerType.Mouse;\n      case 'pen':\n        return PointerType.Pen;\n      default:\n        return PointerType.Unknown;\n    }\n  }\n}\n\n/**\n * Captures and dispatches PointerEvents\n */\nexport class Pointer extends Class {\n  private _isDown: boolean = false;\n  private _wasDown: boolean = false;\n  private _actorsUnderPointer: IActorsUnderPointer = { length: 0 };\n\n  /**\n   * Whether the Pointer is currently dragging.\n   */\n  public get isDragging(): boolean {\n    return this._isDown;\n  }\n\n  /**\n   * Whether the Pointer just started dragging.\n   */\n  public get isDragStart(): boolean {\n    return !this._wasDown && this._isDown;\n  }\n\n  /**\n   * Whether the Pointer just ended dragging.\n   */\n  public get isDragEnd(): boolean {\n    return this._wasDown && !this._isDown;\n  }\n\n  /**\n   * Returns true if pointer has any actors under\n   */\n  public get hasActorsUnderPointer(): boolean {\n    return !!this._actorsUnderPointer.length;\n  }\n\n  /**\n   * The last position on the document this pointer was at. Can be `null` if pointer was never active.\n   */\n  public lastPagePos: Vector = null;\n\n  /**\n   * The last position on the screen this pointer was at. Can be `null` if pointer was never active.\n   */\n  public lastScreenPos: Vector = null;\n\n  /**\n   * The last position in the game world coordinates this pointer was at. Can be `null` if pointer was never active.\n   */\n  public lastWorldPos: Vector = null;\n\n  /**\n   * Returns the currently dragging target or null if it isn't exist\n   */\n  public dragTarget: Actor = null;\n\n  constructor() {\n    super();\n\n    this.on('move', this._onPointerMove);\n    this.on('down', this._onPointerDown);\n    this.on('up', this._onPointerUp);\n  }\n\n  public update(): void {\n    if (this._wasDown && !this._isDown) {\n      this._wasDown = false;\n    } else if (!this._wasDown && this._isDown) {\n      this._wasDown = true;\n    }\n  }\n\n  /**\n   * Adds an Actor to actorsUnderPointer object.\n   * @param actor An Actor to be added;\n   */\n  public addActorUnderPointer(actor: Actor): void {\n    if (!this.hasActorUnderPointerInList(actor)) {\n      this._actorsUnderPointer[actor.id] = actor;\n      this._actorsUnderPointer.length += 1;\n    }\n  }\n\n  /**\n   * Removes an Actor from actorsUnderPointer object.\n   * @param actor An Actor to be removed;\n   */\n  public removeActorUnderPointer(actor: Actor): void {\n    if (this.hasActorUnderPointerInList(actor)) {\n      delete this._actorsUnderPointer[actor.id];\n      this._actorsUnderPointer.length -= 1;\n    }\n  }\n\n  /**\n   * Returns an Actor from actorsUnderPointer object.\n   * @param actor An Actor to be ;\n   */\n  public getActorsUnderPointer(): Actor[] {\n    const actors: Actor[] = [];\n\n    for (const id in this._actorsUnderPointer) {\n      if (id === 'length') {\n        continue;\n      }\n      const actor = this._actorsUnderPointer[id];\n      actors.push(actor);\n    }\n\n    return actors;\n  }\n\n  /**\n   * Checks if Pointer has a specific Actor under.\n   * @param actor An Actor for check;\n   */\n  public isActorUnderPointer(actor: Actor): boolean {\n    if (this.lastWorldPos) {\n      return actor.contains(this.lastWorldPos.x, this.lastWorldPos.y, !Actors.isUIActor(actor));\n    }\n    return false;\n  }\n\n  /**\n   * Checks if Pointer has a specific Actor in ActrorsUnderPointer list.\n   * @param actor An Actor for check;\n   */\n  public hasActorUnderPointerInList(actor: Actor): boolean {\n    return this._actorsUnderPointer.hasOwnProperty(actor.id.toString());\n  }\n\n  private _onPointerMove(ev: PointerEvent): void {\n    this.lastPagePos = new Vector(ev.pagePos.x, ev.pagePos.y);\n    this.lastScreenPos = new Vector(ev.screenPos.x, ev.screenPos.y);\n    this.lastWorldPos = new Vector(ev.worldPos.x, ev.worldPos.y);\n  }\n\n  private _onPointerDown(ev: PointerEvent): void {\n    this.lastPagePos = new Vector(ev.pagePos.x, ev.pagePos.y);\n    this.lastScreenPos = new Vector(ev.screenPos.x, ev.screenPos.y);\n    this.lastWorldPos = new Vector(ev.worldPos.x, ev.worldPos.y);\n    this._isDown = true;\n  }\n\n  private _onPointerUp(): void {\n    this._isDown = false;\n    this.dragTarget = null;\n  }\n}\n\ninterface ITouchEvent extends Event {\n  altKey: boolean;\n  changedTouches: ITouch[];\n  ctrlKey: boolean;\n  metaKey: boolean;\n  shiftKey: boolean;\n  targetTouches: ITouch[];\n  touches: ITouch[];\n  type: string;\n  target: Element;\n}\n\ninterface ITouch {\n  identifier: number;\n  screenX: number;\n  screenY: number;\n  clientX: number;\n  clientY: number;\n  pageX: number;\n  pageY: number;\n  radiusX: number;\n  radiusY: number;\n  rotationAngle: number;\n  force: number;\n  target: Element;\n}\n","import { Promise } from './../Promises';\nimport { IAudio } from './IAudio';\n\nexport type ExResponseType = '' | 'arraybuffer' | 'blob' | 'document' | 'json' | 'text';\n\nexport interface IExResponseTypesLookup {\n  [name: string]: ExResponseType;\n}\n\nexport class ExResponse {\n  public static type: IExResponseTypesLookup = {\n    any: '',\n    blob: 'blob',\n    json: 'json',\n    text: 'text',\n    document: 'document',\n    arraybuffer: 'arraybuffer'\n  };\n}\n\n/**\n * Represents an audio implementation like [[AudioTag]] or [[WebAudio]]\n */\nexport interface IAudioImplementation {\n  /**\n   * XHR response type\n   */\n  responseType: ExResponseType;\n\n  /**\n   * Processes raw data and transforms into sound data\n   */\n  processData(data: Blob | ArrayBuffer): Promise<string | AudioBuffer>;\n\n  /**\n   * Factory method that returns an instance of a played audio track\n   */\n  createInstance(data: string | AudioBuffer): IAudio;\n}\n","export * from './IActorTrait';\nexport * from './IAudio';\nexport * from './IAudioImplementation';\nexport * from './IDrawable';\nexport * from './IEvented';\nexport * from './ILoadable';\nexport * from './ILoader';\nexport * from './LifecycleEvents';\nexport * from './IPointerEvents';\n","import { Engine } from './Engine';\nimport { Color } from './Drawing/Color';\nimport { SpriteFont } from './Drawing/SpriteSheet';\nimport { Actor, CollisionType } from './Actor';\nimport { Configurable } from './Configurable';\nimport { Vector } from './Algebra';\n/**\n * Enum representing the different font size units\n * https://developer.mozilla.org/en-US/docs/Web/CSS/font-size\n */\nexport enum FontUnit {\n  /**\n   * Em is a scalable unit, 1 em is equal to the current font size of the current element, parent elements can effect em values\n   */\n  Em,\n  /**\n   * Rem is similar to the Em, it is a scalable unit. 1 rem is eqaul to the font size of the root element\n   */\n  Rem,\n  /**\n   * Pixel is a unit of length in screen pixels\n   */\n  Px,\n  /**\n   * Point is a physical unit length (1/72 of an inch)\n   */\n  Pt,\n  /**\n   * Percent is a scalable unit similar to Em, the only difference is the Em units scale faster when Text-Size stuff\n   */\n  Percent\n}\n\n/**\n * Enum representing the different horizontal text alignments\n */\nexport enum TextAlign {\n  /**\n   * The text is left-aligned.\n   */\n  Left,\n  /**\n   * The text is right-aligned.\n   */\n  Right,\n  /**\n   * The text is centered.\n   */\n  Center,\n  /**\n   * The text is aligned at the normal start of the line (left-aligned for left-to-right locales,\n   * right-aligned for right-to-left locales).\n   */\n  Start,\n  /**\n   * The text is aligned at the normal end of the line (right-aligned for left-to-right locales,\n   * left-aligned for right-to-left locales).\n   */\n  End\n}\n\n/**\n * Enum representing the different baseline text alignments\n */\nexport enum BaseAlign {\n  /**\n   * The text baseline is the top of the em square.\n   */\n  Top,\n  /**\n   * The text baseline is the hanging baseline.  Currently unsupported; this will act like\n   * alphabetic.\n   */\n  Hanging,\n  /**\n   * The text baseline is the middle of the em square.\n   */\n  Middle,\n  /**\n   * The text baseline is the normal alphabetic baseline.\n   */\n  Alphabetic,\n  /**\n   * The text baseline is the ideographic baseline; this is the bottom of\n   * the body of the characters, if the main body of characters protrudes\n   * beneath the alphabetic baseline.  Currently unsupported; this will\n   * act like alphabetic.\n   */\n  Ideographic,\n  /**\n   * The text baseline is the bottom of the bounding box.  This differs\n   * from the ideographic baseline in that the ideographic baseline\n   * doesn't consider descenders.\n   */\n  Bottom\n}\n\n/**\n * Enum representing the different possible font styles\n */\nexport enum FontStyle {\n  Normal,\n  Italic,\n  Oblique\n}\n\n/**\n * [[include:Constructors.md]]\n */\nexport interface ILabelArgs extends Partial<LabelImpl> {\n  text?: string;\n  bold?: boolean;\n  pos?: Vector;\n  spriteFont?: SpriteFont;\n  fontFamily?: string;\n  fontSize?: number;\n  fontStyle?: FontStyle;\n  fontUnit?: FontUnit;\n  textAlign?: TextAlign;\n  maxWidth?: number;\n}\n\n/**\n * @hidden\n */\nexport class LabelImpl extends Actor {\n  /**\n   * The text to draw.\n   */\n  public text: string;\n\n  /**\n   * Sets or gets the bold property of the label's text, by default it's false\n   */\n  public bold: boolean = false;\n\n  /**\n   * The [[SpriteFont]] to use, if any. Overrides [[fontFamily]] if present.\n   */\n  public spriteFont: SpriteFont;\n\n  /**\n   * The CSS font family string (e.g. `sans-serif`, `Droid Sans Pro`). Web fonts\n   * are supported, same as in CSS.\n   */\n  public fontFamily: string;\n\n  /**\n   * The font size in the selected units, default is 10 (default units is pixel)\n   */\n  public fontSize: number = 10;\n\n  /**\n   * The font style for this label, the default is [[FontStyle.Normal]]\n   */\n  public fontStyle: FontStyle = FontStyle.Normal;\n\n  /**\n   * The css units for a font size such as px, pt, em (SpriteFont only support px), by default is 'px';\n   */\n  public fontUnit: FontUnit = FontUnit.Px;\n\n  /**\n   * Gets or sets the horizontal text alignment property for the label.\n   */\n  public textAlign: TextAlign = TextAlign.Left;\n\n  /**\n   * Gets or sets the baseline alignment property for the label.\n   */\n  public baseAlign: BaseAlign = BaseAlign.Bottom;\n\n  /**\n   * Gets or sets the maximum width (in pixels) that the label should occupy\n   */\n  public maxWidth: number;\n\n  /**\n   * Gets or sets the letter spacing on a Label. Only supported with Sprite Fonts.\n   */\n  public letterSpacing: number = 0; //px\n\n  /**\n   * Whether or not the [[SpriteFont]] will be case-sensitive when matching characters.\n   */\n  public caseInsensitive: boolean = true;\n\n  private _textShadowOn: boolean;\n  private _shadowOffsetX: number;\n  private _shadowOffsetY: number;\n\n  /**\n   * @param text        The text of the label\n   * @param x           The x position of the label\n   * @param y           The y position of the label\n   * @param fontFamily  Use any valid CSS font string for the label's font. Web fonts are supported. Default is `10px sans-serif`.\n   * @param spriteFont  Use an Excalibur sprite font for the label's font, if a SpriteFont is provided it will take precedence\n   * over a css font.\n   */\n  constructor(textOrConfig?: string | Partial<LabelImpl>, x?: number, y?: number, fontFamily?: string, spriteFont?: SpriteFont) {\n    super(\n      textOrConfig && typeof textOrConfig === 'object'\n        ? {\n            x: textOrConfig.x,\n            y: textOrConfig.y\n          }\n        : { x: x, y: y }\n    );\n\n    let text = '';\n    if (textOrConfig && typeof textOrConfig === 'object') {\n      fontFamily = textOrConfig.fontFamily;\n      spriteFont = textOrConfig.spriteFont;\n      text = textOrConfig.text;\n    } else {\n      text = <string>textOrConfig;\n    }\n\n    this.text = text || '';\n    this.color = Color.Black.clone();\n    this.spriteFont = spriteFont;\n    this.collisionType = CollisionType.PreventCollision;\n    this.fontFamily = fontFamily || 'sans-serif'; // coalesce to default canvas font\n\n    this._textShadowOn = false;\n    this._shadowOffsetX = 0;\n    this._shadowOffsetY = 0;\n    if (spriteFont) {\n      //this._textSprites = spriteFont.getTextSprites();\n    }\n  }\n\n  /**\n   * Returns the width of the text in the label (in pixels);\n   * @param ctx  Rendering context to measure the string with\n   */\n  public getTextWidth(ctx: CanvasRenderingContext2D): number {\n    var oldFont = ctx.font;\n    ctx.font = this._fontString;\n    var width = ctx.measureText(this.text).width;\n    ctx.font = oldFont;\n    return width;\n  }\n\n  // TypeScript doesn't support string enums :(\n  private _lookupFontUnit(fontUnit: FontUnit): string {\n    switch (fontUnit) {\n      case FontUnit.Em:\n        return 'em';\n      case FontUnit.Rem:\n        return 'rem';\n      case FontUnit.Pt:\n        return 'pt';\n      case FontUnit.Px:\n        return 'px';\n      case FontUnit.Percent:\n        return '%';\n      default:\n        return 'px';\n    }\n  }\n\n  private _lookupTextAlign(textAlign: TextAlign): string {\n    switch (textAlign) {\n      case TextAlign.Left:\n        return 'left';\n      case TextAlign.Right:\n        return 'right';\n      case TextAlign.Center:\n        return 'center';\n      case TextAlign.End:\n        return 'end';\n      case TextAlign.Start:\n        return 'start';\n      default:\n        return 'start';\n    }\n  }\n\n  private _lookupBaseAlign(baseAlign: BaseAlign): string {\n    switch (baseAlign) {\n      case BaseAlign.Alphabetic:\n        return 'alphabetic';\n      case BaseAlign.Bottom:\n        return 'bottom';\n      case BaseAlign.Hanging:\n        return 'hangin';\n      case BaseAlign.Ideographic:\n        return 'ideographic';\n      case BaseAlign.Middle:\n        return 'middle';\n      case BaseAlign.Top:\n        return 'top';\n      default:\n        return 'alphabetic';\n    }\n  }\n\n  private _lookupFontStyle(fontStyle: FontStyle): string {\n    var boldstring = this.bold ? ' bold' : '';\n    switch (fontStyle) {\n      case FontStyle.Italic:\n        return 'italic' + boldstring;\n      case FontStyle.Normal:\n        return 'normal' + boldstring;\n      case FontStyle.Oblique:\n        return 'oblique' + boldstring;\n      default:\n        return 'normal' + boldstring;\n    }\n  }\n\n  /**\n   * Sets the text shadow for sprite fonts\n   * @param offsetX      The x offset in pixels to place the shadow\n   * @param offsetY      The y offset in pixels to place the shadow\n   * @param shadowColor  The color of the text shadow\n   */\n  public setTextShadow(offsetX: number, offsetY: number, shadowColor: Color) {\n    this.spriteFont.setTextShadow(offsetX, offsetY, shadowColor);\n  }\n\n  /**\n   * Toggles text shadows on or off, only applies when using sprite fonts\n   */\n  public useTextShadow(on: boolean) {\n    this.spriteFont.useTextShadow(on);\n  }\n\n  /**\n   * Clears the current text shadow\n   */\n  public clearTextShadow() {\n    this._textShadowOn = false;\n    this._shadowOffsetX = 0;\n    this._shadowOffsetY = 0;\n  }\n\n  public update(engine: Engine, delta: number) {\n    super.update(engine, delta);\n  }\n\n  public draw(ctx: CanvasRenderingContext2D, delta: number) {\n    ctx.save();\n    ctx.translate(this.pos.x, this.pos.y);\n    ctx.scale(this.scale.x, this.scale.y);\n    ctx.rotate(this.rotation);\n\n    if (this._textShadowOn) {\n      ctx.save();\n      ctx.translate(this._shadowOffsetX, this._shadowOffsetY);\n      this._fontDraw(ctx);\n      ctx.restore();\n    }\n    this._fontDraw(ctx);\n\n    super.draw(ctx, delta);\n    ctx.restore();\n  }\n\n  private _fontDraw(ctx: CanvasRenderingContext2D) {\n    if (this.spriteFont) {\n      this.spriteFont.draw(ctx, this.text, 0, 0, {\n        color: this.color.clone(),\n        baseAlign: this.baseAlign,\n        textAlign: this.textAlign,\n        fontSize: this.fontSize,\n        letterSpacing: this.letterSpacing,\n        opacity: this.opacity\n      });\n    } else {\n      var oldAlign = ctx.textAlign;\n      var oldTextBaseline = ctx.textBaseline;\n\n      ctx.textAlign = this._lookupTextAlign(this.textAlign);\n      ctx.textBaseline = this._lookupBaseAlign(this.baseAlign);\n      if (this.color) {\n        this.color.a = this.opacity;\n      }\n      ctx.fillStyle = this.color.toString();\n      ctx.font = this._fontString;\n      if (this.maxWidth) {\n        ctx.fillText(this.text, 0, 0, this.maxWidth);\n      } else {\n        ctx.fillText(this.text, 0, 0);\n      }\n\n      ctx.textAlign = oldAlign;\n      ctx.textBaseline = oldTextBaseline;\n    }\n  }\n\n  protected get _fontString() {\n    return `${this._lookupFontStyle(this.fontStyle)} ${this.fontSize}${this._lookupFontUnit(this.fontUnit)} ${this.fontFamily}`;\n  }\n\n  public debugDraw(ctx: CanvasRenderingContext2D) {\n    super.debugDraw(ctx);\n  }\n}\n\n/**\n * Labels are the way to draw small amounts of text to the screen. They are\n * actors and inherit all of the benefits and capabilities.\n *\n * [[include:Labels.md]]\n */\nexport class Label extends Configurable(LabelImpl) {\n  constructor();\n  constructor(config?: ILabelArgs);\n  constructor(text?: string, x?: number, y?: number, fontFamily?: string, spriteFont?: SpriteFont);\n  constructor(textOrConfig?: string | ILabelArgs, x?: number, y?: number, fontFamily?: string, spriteFont?: SpriteFont) {\n    super(textOrConfig, x, y, fontFamily, spriteFont);\n  }\n}\n","\n        var result = require(\"!!../../node_modules/css-loader/index.js!./Loader.css\");\n\n        if (typeof result === \"string\") {\n            module.exports = result;\n        } else {\n            module.exports = result.toString();\n        }\n    ","module.exports = \"data:image/png;base64,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\"","import { Color } from './Drawing/Color';\nimport { WebAudio } from './Util/WebAudio';\nimport { Logger } from './Util/Log';\nimport { Promise, PromiseState } from './Promises';\nimport { Engine } from './Engine';\nimport { ILoadable } from './Interfaces/ILoadable';\nimport { ILoader } from './Interfaces/ILoader';\nimport { Class } from './Class';\nimport * as DrawUtil from './Util/DrawUtil';\nimport { obsolete } from './Util/Decorators';\n\nimport logoImg from './Loader.logo.png';\nimport loaderCss from './Loader.css';\n\n/**\n * Pre-loading assets\n *\n * The loader provides a mechanism to preload multiple resources at\n * one time. The loader must be passed to the engine in order to\n * trigger the loading progress bar.\n *\n * The [[Loader]] itself implements [[ILoadable]] so you can load loaders.\n *\n * ## Example: Pre-loading resources for a game\n *\n * ```js\n * // create a loader\n * var loader = new ex.Loader();\n *\n * // create a resource dictionary (best practice is to keep a separate file)\n * var resources = {\n *   TextureGround: new ex.Texture(\"/images/textures/ground.png\"),\n *   SoundDeath: new ex.Sound(\"/sound/death.wav\", \"/sound/death.mp3\")\n * };\n *\n * // loop through dictionary and add to loader\n * for (var loadable in resources) {\n *   if (resources.hasOwnProperty(loadable)) {\n *     loader.addResource(resources[loadable]);\n *   }\n * }\n *\n * // start game\n * game.start(loader).then(function () {\n *   console.log(\"Game started!\");\n * });\n * ```\n *\n * ## Customize the Loader\n *\n * The loader can be customized to show different, text, logo, background color, and button.\n *\n * ```typescript\n * var loader = new ex.Loader([playerTexture]);\n *\n * // The loaders button text can simply modified using this\n * loader.playButtonText = 'Start the best game ever';\n *\n * // The logo can be changed by inserting a base64 image string here\n *\n * loader.logo = 'data:image/png;base64,iVBORw...';\n * loader.logoWidth = 15;\n * loader.logoHeight = 14;\n *\n * // The background color can be changed like so by supplying a valid CSS color string\n *\n * loader.backgroundColor = 'red'\n * loader.backgroundColor = '#176BAA'\n *\n * // To build a completely new button\n * loader.startButtonFactory = () => {\n *     let myButton = document.createElement('button');\n *     myButton.textContent = 'The best button';\n *     return myButton;\n * };\n *\n * engine.start(loader).then(() => {});\n * ```\n */\nexport class Loader extends Class implements ILoader {\n  private _resourceList: ILoadable[] = [];\n  private _index = 0;\n\n  private _playButtonShown: boolean = false;\n  private _resourceCount: number = 0;\n  private _numLoaded: number = 0;\n  private _progressCounts: { [key: string]: number } = {};\n  private _totalCounts: { [key: string]: number } = {};\n  private _engine: Engine;\n\n  // logo drawing stuff\n\n  // base64 string encoding of the excalibur logo (logo-white.png)\n  public logo = logoImg;\n  public logoWidth = 468;\n  public logoHeight = 118;\n  public backgroundColor = '#176BAA';\n\n  protected _imageElement: HTMLImageElement;\n  protected get _image() {\n    if (!this._imageElement) {\n      this._imageElement = new Image();\n      this._imageElement.src = this.logo;\n    }\n\n    return this._imageElement;\n  }\n\n  public suppressPlayButton: boolean = false;\n  protected _playButtonRootElement: HTMLElement;\n  protected _playButtonElement: HTMLButtonElement;\n  protected _styleBlock: HTMLStyleElement;\n  /** Loads the css from Loader.css */\n  protected _playButtonStyles: string = loaderCss.toString();\n  protected get _playButton() {\n    if (!this._playButtonRootElement) {\n      this._playButtonRootElement = document.createElement('div');\n      this._playButtonRootElement.style.position = 'absolute';\n      document.body.appendChild(this._playButtonRootElement);\n    }\n    if (!this._styleBlock) {\n      this._styleBlock = document.createElement('style');\n      this._styleBlock.textContent = this._playButtonStyles;\n      document.head.appendChild(this._styleBlock);\n    }\n    if (!this._playButtonElement) {\n      this._playButtonElement = this.startButtonFactory();\n      this._playButtonRootElement.appendChild(this._playButtonElement);\n    }\n    return this._playButtonElement;\n  }\n\n  /**\n   * Get/set play button text\n   */\n  public playButtonText: string = 'Play game';\n\n  /**\n   * Return a html button element for excalibur to use as a play button\n   */\n  public startButtonFactory = () => {\n    let buttonElement = document.createElement('button');\n    buttonElement.id = 'excalibur-play';\n    buttonElement.textContent = this.playButtonText;\n    buttonElement.style.display = 'none';\n    return buttonElement;\n  };\n\n  /**\n   * @param loadables  Optionally provide the list of resources you want to load at constructor time\n   */\n  constructor(loadables?: ILoadable[]) {\n    super();\n\n    if (loadables) {\n      this.addResources(loadables);\n    }\n  }\n\n  public wireEngine(engine: Engine) {\n    this._engine = engine;\n  }\n\n  /**\n   * Add a resource to the loader to load\n   * @param loadable  Resource to add\n   */\n  public addResource(loadable: ILoadable) {\n    var key = this._index++;\n    this._resourceList.push(loadable);\n    this._progressCounts[key] = 0;\n    this._totalCounts[key] = 1;\n    this._resourceCount++;\n  }\n\n  /**\n   * Add a list of resources to the loader to load\n   * @param loadables  The list of resources to load\n   */\n  public addResources(loadables: ILoadable[]) {\n    var i = 0,\n      len = loadables.length;\n\n    for (i; i < len; i++) {\n      this.addResource(loadables[i]);\n    }\n  }\n\n  /**\n   * Returns true if the loader has completely loaded all resources\n   */\n  public isLoaded() {\n    return this._numLoaded === this._resourceCount;\n  }\n\n  /**\n   * Shows the play button and returns a promise that resolves when clicked\n   */\n  public showPlayButton(): Promise<any> {\n    if (this.suppressPlayButton) {\n      return Promise.resolve();\n    } else {\n      this._playButtonShown = true;\n      this._playButton.style.display = 'block';\n      let promise = new Promise();\n\n      this._playButton.addEventListener('click', () => (promise.state() === PromiseState.Pending ? promise.resolve() : promise));\n      this._playButton.addEventListener('touchend', () => (promise.state() === PromiseState.Pending ? promise.resolve() : promise));\n      this._playButton.addEventListener('pointerup', () => (promise.state() === PromiseState.Pending ? promise.resolve() : promise));\n\n      return promise;\n    }\n  }\n\n  public hidePlayButton() {\n    this._playButtonShown = false;\n    this._playButton.style.display = 'none';\n  }\n\n  /**\n   * Begin loading all of the supplied resources, returning a promise\n   * that resolves when loading of all is complete\n   */\n  public load(): Promise<any> {\n    var complete = new Promise<any>();\n    var me = this;\n    if (this._resourceList.length === 0) {\n      me.showPlayButton().then(() => {\n        // Unlock audio context in chrome after user gesture\n        // https://github.com/excaliburjs/Excalibur/issues/262\n        // https://github.com/excaliburjs/Excalibur/issues/1031\n        WebAudio.unlock().then(() => {\n          me.hidePlayButton();\n          me.oncomplete.call(me);\n          complete.resolve();\n        });\n      });\n      return complete;\n    }\n\n    var progressArray = new Array<any>(this._resourceList.length);\n    var progressChunks = this._resourceList.length;\n\n    this._resourceList.forEach((r, i) => {\n      if (this._engine) {\n        r.wireEngine(this._engine);\n      }\n      r.onprogress = function(e) {\n        var total = <number>e.total;\n        var loaded = <number>e.loaded;\n        progressArray[i] = { loaded: (loaded / total) * (100 / progressChunks), total: 100 };\n\n        var progressResult: any = progressArray.reduce(\n          function(accum, next) {\n            return { loaded: accum.loaded + next.loaded, total: 100 };\n          },\n          { loaded: 0, total: 100 }\n        );\n\n        me.onprogress.call(me, progressResult);\n      };\n      r.oncomplete = r.onerror = function() {\n        me._numLoaded++;\n        if (me._numLoaded === me._resourceCount) {\n          setTimeout(() => {\n            me.showPlayButton().then(() => {\n              // Unlock audio context in chrome after user gesture\n              // https://github.com/excaliburjs/Excalibur/issues/262\n              // https://github.com/excaliburjs/Excalibur/issues/1031\n              WebAudio.unlock().then(() => {\n                me.hidePlayButton();\n                me.oncomplete.call(me);\n                complete.resolve();\n              });\n            });\n          }, 200); // short delay in showing the button for aesthetics\n        }\n      };\n    });\n\n    function loadNext(list: ILoadable[], index: number) {\n      if (!list[index]) {\n        return;\n      }\n      list[index].load().then(function() {\n        loadNext(list, index + 1);\n      });\n    }\n    loadNext(this._resourceList, 0);\n\n    return complete;\n  }\n\n  /**\n   * Loader draw function. Draws the default Excalibur loading screen.\n   * Override `logo`, `logoWidth`, `logoHeight` and `backgroundColor` properties\n   * to customize the drawing, or just override entire method.\n   */\n  public draw(ctx: CanvasRenderingContext2D) {\n    let canvasHeight = this._engine.canvasHeight / window.devicePixelRatio;\n    let canvasWidth = this._engine.canvasWidth / window.devicePixelRatio;\n\n    if (this._playButtonRootElement) {\n      let left = ctx.canvas.offsetLeft;\n      let top = ctx.canvas.offsetTop;\n      let buttonWidth = this._playButton.clientWidth;\n      let buttonHeight = this._playButton.clientHeight;\n      this._playButtonRootElement.style.left = `${left + canvasWidth / 2 - buttonWidth / 2}px`;\n      this._playButtonRootElement.style.top = `${top + canvasHeight / 2 - buttonHeight / 2 + 100}px`;\n    }\n\n    ctx.fillStyle = this.backgroundColor;\n    ctx.fillRect(0, 0, canvasWidth, canvasHeight);\n\n    var y = canvasHeight / 2;\n    var width = Math.min(this.logoWidth, canvasWidth * 0.75);\n    var x = canvasWidth / 2 - width / 2;\n\n    var imageHeight = Math.floor(width * (this.logoHeight / this.logoWidth)); // OG height/width factor\n    var oldAntialias = this._engine.getAntialiasing();\n    this._engine.setAntialiasing(true);\n    ctx.drawImage(this._image, 0, 0, this.logoWidth, this.logoHeight, x, y - imageHeight - 20, width, imageHeight);\n\n    // loading box\n    if (!this.suppressPlayButton && this._playButtonShown) {\n      this._engine.setAntialiasing(oldAntialias);\n      return;\n    }\n\n    ctx.lineWidth = 2;\n    DrawUtil.roundRect(ctx, x, y, width, 20, 10);\n    var progress = width * (this._numLoaded / this._resourceCount);\n    var margin = 5;\n    var progressWidth = progress - margin * 2;\n    var height = 20 - margin * 2;\n    DrawUtil.roundRect(ctx, x + margin, y + margin, progressWidth > 0 ? progressWidth : 0, height, 5, null, Color.White);\n    this._engine.setAntialiasing(oldAntialias);\n  }\n\n  /**\n   * Perform any calculations or logic in the `update` method. The default `Loader` does not\n   * do anything in this method so it is safe to override.\n   */\n  public update(_engine: Engine, _delta: number) {\n    // overridable update\n  }\n\n  public getData: () => any = () => {\n    return;\n  };\n\n  public setData: (data: any) => any = () => {\n    return;\n  };\n\n  public processData: (data: any) => any = () => {\n    return;\n  };\n\n  public onprogress: (e: any) => void = (e: any) => {\n    Logger.getInstance().debug('[ex.Loader] Loading ' + ((100 * e.loaded) / e.total).toFixed(0));\n\n    return;\n  };\n\n  public oncomplete: () => void = () => {\n    return;\n  };\n\n  public onerror: () => void = () => {\n    return;\n  };\n}\n\n/**\n * @obsolete Use [[Loader]] instead, this functionality has been made default\n *\n * A [[Loader]] that pauses after loading to allow user\n * to proceed to play the game. Typically you will\n * want to use this loader for iOS to allow sounds\n * to play after loading (Apple Safari requires user\n * interaction to allow sounds, even for games)\n *\n * **Note:** Because Loader is not part of a Scene, you must\n * call `update` and `draw` manually on \"child\" objects.\n *\n * ## Implementing a Trigger\n *\n * The `PauseAfterLoader` requires an element to act as the trigger button\n * to start the game.\n *\n * For example, let's create an `<a>` tag to be our trigger and call it `tap-to-play`.\n *\n * ```html\n * <div id=\"wrapper\">\n *    <canvas id=\"game\"></canvas>\n *    <a id=\"tap-to-play\" href='javascript:void(0);'>Tap to Play</a>\n * </div>\n * ```\n *\n * We've put it inside a wrapper to position it properly over the game canvas.\n *\n * Now let's add some CSS to style it (insert into `<head>`):\n *\n * ```html\n * <style>\n *     #wrapper {\n *         position: relative;\n *         width: 500px;\n *         height: 500px;\n *     }\n *     #tap-to-play {\n *         display: none;\n *         font-size: 24px;\n *         font-family: sans-serif;\n *         text-align: center;\n *         border: 3px solid white;\n *         position: absolute;\n *         color: white;\n *         width: 200px;\n *         height: 50px;\n *         line-height: 50px;\n *         text-decoration: none;\n *         left: 147px;\n *         top: 80%;\n *     }\n * </style>\n * ```\n *\n * Now we can create a `PauseAfterLoader` with a reference to our trigger button:\n *\n * ```ts\n * var loader = new ex.PauseAfterLoader('tap-to-play', [...]);\n * ```\n *\n * ## Use PauseAfterLoader for iOS\n *\n * The primary use case for pausing before starting the game is to\n * pass Apple's requirement of user interaction. The Web Audio context\n * in Safari is disabled by default until user interaction.\n *\n * Therefore, you can use this snippet to only use PauseAfterLoader when\n * iOS is detected (see [this thread](http://stackoverflow.com/questions/9038625/detect-if-device-is-ios)\n * for more techniques).\n *\n * ```ts\n * var iOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !(<any>window).MSStream;\n * var loader: ex.Loader = iOS ? new ex.PauseAfterLoader('tap-to-play') : new ex.Loader();\n *\n * loader.addResource(...);\n * ```\n */\nexport class PauseAfterLoader extends Loader {\n  private _loadedValue: any;\n  private _waitPromise: Promise<any>;\n  private _playTrigger: HTMLElement;\n\n  constructor(triggerElementId: string, loadables?: ILoadable[]) {\n    super(loadables);\n\n    this._playTrigger = document.getElementById(triggerElementId);\n    this._playTrigger.addEventListener('click', this._handleOnTrigger);\n  }\n\n  @obsolete({ message: 'Deprecated in v0.20.0', alternateMethod: 'Use ex.Loader instead' })\n  public load(): Promise<any> {\n    this._waitPromise = new Promise<any>();\n\n    // wait until user indicates to proceed before finishing load\n    super.load().then(\n      (value?) => {\n        this._loadedValue = value;\n\n        // show element\n        this._playTrigger.style.display = 'block';\n      },\n      (value?) => {\n        this._waitPromise.reject(value);\n      }\n    );\n\n    return this._waitPromise;\n  }\n\n  private _handleOnTrigger = () => {\n    if (this._waitPromise.state() !== PromiseState.Pending) {\n      return false;\n    }\n\n    // unlock Safari WebAudio context\n    WebAudio.unlock();\n\n    // continue to play game\n    this._waitPromise.resolve(this._loadedValue);\n\n    // hide DOM element\n    this._playTrigger.style.display = 'none';\n\n    return false;\n  };\n}\n","export * from './PerlinNoise';\nexport * from './Random';\n","import { Random } from './Random';\nimport { Color } from '../Drawing/Color';\nimport * as Util from '../Util/Util';\n\nfunction _lerp(time: number, a: number, b: number): number {\n  return a + time * (b - a);\n}\n\nfunction _fade(t: number): number {\n  return t * t * t * (t * (t * 6 - 15) + 10);\n}\n\n/**\n * Options for the perlin noise generator\n */\nexport interface IPerlinGeneratorOptions {\n  /**\n   * Random number seed for the Perlin noise generator\n   */\n  seed?: number;\n  /**\n   * Number of octaves to use when generating the noise, the number of octaves is the number of times the perlin\n   * noise is generated and laid on top of itself. Using higher values can increase the curviness of the noise, and\n   * make it look more natural.\n   */\n  octaves?: number;\n  /**\n   * Frequency to use when generating the noise, the higher the number the more quickly the pattern will oscilate. Another way\n   * to think about this is that it is like \"zooming\" out from an infinite pattern determined by the seed.\n   */\n  frequency?: number;\n  /**\n   * The amplitude determines the relative height of the peaks generated in the noise.\n   */\n  amplitude?: number;\n  /**\n   * The persistance determines how quickly the amplitude will drop off, a high degree of persistance results in smoother patterns,\n   * a low degree of persistance generates spikey patterns.\n   */\n  persistance?: number;\n}\n\n/**\n * Generates perlin noise based on the 2002 Siggraph paper http://mrl.nyu.edu/~perlin/noise/\n * Also https://flafla2.github.io/2014/08/09/perlinnoise.html\n */\nexport class PerlinGenerator {\n  private _perm: number[] = [\n    151,\n    160,\n    137,\n    91,\n    90,\n    15,\n    131,\n    13,\n    201,\n    95,\n    96,\n    53,\n    194,\n    233,\n    7,\n    225,\n    140,\n    36,\n    103,\n    30,\n    69,\n    142,\n    8,\n    99,\n    37,\n    240,\n    21,\n    10,\n    23,\n    190,\n    6,\n    148,\n    247,\n    120,\n    234,\n    75,\n    0,\n    26,\n    197,\n    62,\n    94,\n    252,\n    219,\n    203,\n    117,\n    35,\n    11,\n    32,\n    57,\n    177,\n    33,\n    88,\n    237,\n    149,\n    56,\n    87,\n    174,\n    20,\n    125,\n    136,\n    171,\n    168,\n    68,\n    175,\n    74,\n    165,\n    71,\n    134,\n    139,\n    48,\n    27,\n    166,\n    77,\n    146,\n    158,\n    231,\n    83,\n    111,\n    229,\n    122,\n    60,\n    211,\n    133,\n    230,\n    220,\n    105,\n    92,\n    41,\n    55,\n    46,\n    245,\n    40,\n    244,\n    102,\n    143,\n    54,\n    65,\n    25,\n    63,\n    161,\n    1,\n    216,\n    80,\n    73,\n    209,\n    76,\n    132,\n    187,\n    208,\n    89,\n    18,\n    169,\n    200,\n    196,\n    135,\n    130,\n    116,\n    188,\n    159,\n    86,\n    164,\n    100,\n    109,\n    198,\n    173,\n    186,\n    3,\n    64,\n    52,\n    217,\n    226,\n    250,\n    124,\n    123,\n    5,\n    202,\n    38,\n    147,\n    118,\n    126,\n    255,\n    82,\n    85,\n    212,\n    207,\n    206,\n    59,\n    227,\n    47,\n    16,\n    58,\n    17,\n    182,\n    189,\n    28,\n    42,\n    223,\n    183,\n    170,\n    213,\n    119,\n    248,\n    152,\n    2,\n    44,\n    154,\n    163,\n    70,\n    221,\n    153,\n    101,\n    155,\n    167,\n    43,\n    172,\n    9,\n    129,\n    22,\n    39,\n    253,\n    19,\n    98,\n    108,\n    110,\n    79,\n    113,\n    224,\n    232,\n    178,\n    185,\n    112,\n    104,\n    218,\n    246,\n    97,\n    228,\n    251,\n    34,\n    242,\n    193,\n    238,\n    210,\n    144,\n    12,\n    191,\n    179,\n    162,\n    241,\n    81,\n    51,\n    145,\n    235,\n    249,\n    14,\n    239,\n    107,\n    49,\n    192,\n    214,\n    31,\n    181,\n    199,\n    106,\n    157,\n    184,\n    84,\n    204,\n    176,\n    115,\n    121,\n    50,\n    45,\n    127,\n    4,\n    150,\n    254,\n    138,\n    236,\n    205,\n    93,\n    222,\n    114,\n    67,\n    29,\n    24,\n    72,\n    243,\n    141,\n    128,\n    195,\n    78,\n    66,\n    215,\n    61,\n    156,\n    180\n  ];\n  private _p: Uint8Array = new Uint8Array(512);\n  private _random: Random;\n\n  private _defaultPerlinOptions: IPerlinGeneratorOptions = {\n    octaves: 1,\n    frequency: 1,\n    amplitude: 1,\n    persistance: 0.5\n  };\n\n  /**\n   * The persistance determines how quickly the amplitude will drop off, a high degree of persistance results in smoother patterns,\n   * a low degree of persistance generates spikey patterns.\n   */\n  public persistance: number;\n\n  /**\n   * The amplitude determines the relative height of the peaks generated in the noise.\n   */\n  public amplitude: number;\n\n  /**\n   * Frequency to use when generating the noise, the higher the number the more quickly the pattern will oscilate. Another way\n   * to think about this is that it is like \"zooming\" out from an infinite pattern determined by the seed.\n   */\n  public frequency: number;\n\n  /**\n   * Number of octaves to use when generating the noise, the number of octaves is the number of times the perlin\n   * noise is generated and laid on top of itself. Using higher values can increase the curviness of the noise, and\n   * make it look more natural.\n   */\n  public octaves: number;\n\n  constructor(options?: IPerlinGeneratorOptions) {\n    options = Util.extend({}, this._defaultPerlinOptions, options);\n\n    this.persistance = options.persistance;\n    this.amplitude = options.amplitude;\n    this.frequency = options.frequency;\n    this.octaves = options.octaves;\n\n    if (options.seed) {\n      this._random = new Random(options.seed);\n    } else {\n      this._random = new Random();\n    }\n\n    this._perm = this._random.shuffle(this._perm);\n\n    for (var i = 0; i < 512; i++) {\n      this._p[i] = this._perm[i % 256] & 0xff;\n    }\n  }\n\n  /**\n   * Generates 1-Dimensional perlin noise given an x and generates noises values between [0, 1].\n   */\n  public noise(x: number): number;\n  /**\n   * Generates 2-Dimensional perlin noise given an (x, y) and generates noise values between [0, 1]\n   */\n  public noise(x: number, y: number): number;\n  /**\n   * Generates 3-Dimensional perlin noise given an (x, y, z) and generates noise values between [0, 1]\n   */\n  public noise(x: number, y: number, z: number): number;\n  public noise(): number {\n    var amp = this.amplitude;\n    var freq = this.frequency;\n\n    var total = 0;\n    var maxValue = 0;\n    for (var i = 0; i < this.octaves; i++) {\n      switch (arguments.length) {\n        case 1:\n          total += this._noise1d(arguments[0] * freq) * amp;\n          break;\n        case 2:\n          total += this._noise2d(arguments[0] * freq, arguments[1] * freq) * amp;\n          break;\n        case 3:\n          total += this._noise3d(arguments[0] * freq, arguments[1] * freq, arguments[2] * freq) * amp;\n          break;\n        /* istanbul ignore next */\n        default:\n          throw new Error('Invalid arguments for perlin noise');\n      }\n      maxValue += amp;\n      amp *= this.persistance;\n      freq *= 2;\n    }\n    return total / maxValue;\n  }\n\n  /**\n   * Generates a list starting at 0 and ending at 1 of contious perlin noise, by default the step is 1/length;\n   *\n   */\n  public sequence(length: number, step?: number): number[] {\n    if (!step) {\n      step = 1 / length;\n    }\n    var array: number[] = new Array(length);\n    for (var i = 0; i < length; i++) {\n      array[i] = this.noise(i * step);\n    }\n    return array;\n  }\n\n  /**\n   * Generates a 2D grid of perlin noise given a step value packed into a 1D array i = (x + y*width),\n   * by default the step will 1/(min(dimension))\n   */\n  public grid(width: number, height: number, step?: number): number[] {\n    if (!step) {\n      step = 1 / Math.min(width, height);\n    }\n\n    var array: number[] = new Array(width * height);\n\n    for (var y = 0; y < height; y++) {\n      for (var x = 0; x < width; x++) {\n        array[x + y * width] = this.noise(x * step, y * step);\n      }\n    }\n\n    return array;\n  }\n\n  private _gradient3d(hash: number, x: number, y: number, z: number) {\n    var h = hash & 0xf;\n    var u = h < 8 ? x : y;\n    var v = h < 4 ? y : h === 12 || h === 14 ? x : z;\n    return ((h & 0b1) === 0 ? u : -u) + ((h & 0b10) === 0 ? v : -v);\n  }\n\n  private _gradient2d(hash: number, x: number, y: number) {\n    var value = (hash & 0b1) === 0 ? x : y;\n    return (hash & 0b10) === 0 ? -value : value;\n  }\n\n  private _gradient1d(hash: number, x: number) {\n    return (hash & 0b1) === 0 ? -x : x;\n  }\n\n  private _noise1d(x: number) {\n    var intX = Math.floor(x) & 0xff; // force 0-255 integers to lookup in permutation\n    x -= Math.floor(x);\n    var fadeX = _fade(x);\n    return (_lerp(fadeX, this._gradient1d(this._p[intX], x), this._gradient1d(this._p[intX + 1], x - 1)) + 1) / 2;\n  }\n\n  private _noise2d(x: number, y: number) {\n    var intX = Math.floor(x) & 0xff;\n    var intY = Math.floor(y) & 0xff;\n\n    x -= Math.floor(x);\n    y -= Math.floor(y);\n\n    var fadeX = _fade(x);\n    var fadeY = _fade(y);\n    var a = this._p[intX] + intY;\n    var b = this._p[intX + 1] + intY;\n    return (\n      (_lerp(\n        fadeY,\n        _lerp(fadeX, this._gradient2d(this._p[a], x, y), this._gradient2d(this._p[b], x - 1, y)),\n        _lerp(fadeX, this._gradient2d(this._p[a + 1], x, y - 1), this._gradient2d(this._p[b + 1], x - 1, y - 1))\n      ) +\n        1) /\n      2\n    );\n  }\n\n  private _noise3d(x: number, y: number, z: number) {\n    var intX = Math.floor(x) & 0xff;\n    var intY = Math.floor(y) & 0xff;\n    var intZ = Math.floor(z) & 0xff;\n\n    x -= Math.floor(x);\n    y -= Math.floor(y);\n    z -= Math.floor(z);\n\n    var fadeX = _fade(x);\n    var fadeY = _fade(y);\n    var fadeZ = _fade(z);\n\n    var a = this._p[intX] + intY;\n    var b = this._p[intX + 1] + intY;\n\n    var aa = this._p[a] + intZ;\n    var ba = this._p[b] + intZ;\n\n    var ab = this._p[a + 1] + intZ;\n    var bb = this._p[b + 1] + intZ;\n\n    return (\n      (_lerp(\n        fadeZ,\n        _lerp(\n          fadeY,\n          _lerp(fadeX, this._gradient3d(this._p[aa], x, y, z), this._gradient3d(this._p[ba], x - 1, y, z)),\n          _lerp(fadeX, this._gradient3d(this._p[ab], x, y - 1, z), this._gradient3d(this._p[bb], x - 1, y - 1, z))\n        ),\n        _lerp(\n          fadeY,\n          _lerp(fadeX, this._gradient3d(this._p[aa + 1], x, y, z - 1), this._gradient3d(this._p[ba + 1], x - 1, y, z - 1)),\n          _lerp(fadeX, this._gradient3d(this._p[ab + 1], x, y - 1, z - 1), this._gradient3d(this._p[bb + 1], x - 1, y - 1, z - 1))\n        )\n      ) +\n        1) /\n      2\n    );\n  }\n}\n\n/**\n * A helper to draw 2D perlin maps given a perlin generator and a function\n */\nexport class PerlinDrawer2D {\n  /**\n   * @param generator - An existing perlin generator\n   * @param colorFcn - A color function that takes a value between [0, 255] derived from the perlin generator, and returns a color\n   */\n  constructor(public generator: PerlinGenerator, public colorFcn?: (val: number) => Color) {\n    if (!colorFcn) {\n      this.colorFcn = (val: number) => {\n        return val < 125 ? Color.Black : Color.White;\n      };\n    }\n  }\n\n  /**\n   * Returns an image of 2D perlin noise\n   */\n  public image(width: number, height: number): HTMLImageElement {\n    var image = document.createElement('img');\n    var canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    var ctx = canvas.getContext('2d');\n    this.draw(ctx, 0, 0, width, height);\n    image.src = canvas.toDataURL();\n    return image;\n  }\n\n  /**\n   * This draws a 2D perlin grid on a canvas context, not recommended to be called every frame due to performance\n   */\n  public draw(ctx: CanvasRenderingContext2D, x: number, y: number, width: number, height: number) {\n    var grid = this.generator.grid(width, height);\n    var imageData = ctx.getImageData(x, y, width, height);\n    for (var j = 0; j < height; j++) {\n      for (var i = 0; i < width; i++) {\n        var val = grid[i + width * j];\n        var c = Math.floor(val * 255) & 0xff;\n        var pixel = (i + j * imageData.width) * 4;\n        var color = this.colorFcn(c);\n\n        imageData.data[pixel] = color.r;\n        imageData.data[pixel + 1] = color.g;\n        imageData.data[pixel + 2] = color.b;\n        imageData.data[pixel + 3] = Math.floor(color.a * 255);\n      }\n    }\n    ctx.putImageData(imageData, x, y);\n  }\n}\n","/**\n * Pseudo-Random Utility\n *\n * A pseudo-random utility to add seeded random support for help in\n * generating things like terrain or reproducible randomness. Uses the\n * [Mersenne Twister](https://en.wikipedia.org/wiki/Mersenne_Twister) algorithm.\n *\n * [[include:Random.md]]\n */\n\n/**\n * 32-bit mask\n */\nconst BITMASK32: number = 0xffffffff;\n\n/**\n * Pseudo-random number generator following the Mersenne_Twister algorithm. Given a seed this generator will produce the same sequence\n * of numbers each time it is called.\n * See https://en.wikipedia.org/wiki/Mersenne_Twister for more details.\n * Uses the MT19937-32 (2002) implementation documented here http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/MT2002/emt19937ar.html\n *\n * Api inspired by http://chancejs.com/# https://github.com/chancejs/chancejs\n */\nexport class Random {\n  // Separation point of one one word, the number of bits in the lower bitmask 0 <= r <= w-1\n  private _lowerMask: number = 0x7fffffff; // 31 bits same as _r\n  private _upperMask: number = 0x80000000; // 34 high bits\n\n  // Word size, 64 bits\n  private _w: number = 32;\n\n  // Degree of recurrance\n  private _n: number = 624;\n\n  // Middle word, an offset used in the recurrance defining the series x, 1<=m<n\n  private _m: number = 397;\n  // coefficients of teh rational normal form twist matrix\n  private _a: number = 0x9908b0df;\n\n  // tempering bit shifts and masks\n  private _u: number = 11;\n  private _s: number = 7;\n  private _b: number = 0x9d2c5680;\n  private _t: number = 15;\n  private _c: number = 0xefc60000;\n  private _l: number = 18;\n  private _f: number = 1812433253;\n\n  private _mt: number[];\n\n  private _index: number;\n\n  /**\n   * If no seed is specified, the Date.now() is used\n   */\n  constructor(public seed?: number) {\n    this._mt = new Array<number>(this._n);\n    // need to mask to support higher bit machines\n    this._mt[0] = (seed || Date.now()) >>> 0;\n\n    for (var i = 1; i < this._n; i++) {\n      var s = this._mt[i - 1] ^ (this._mt[i - 1] >>> (this._w - 2));\n      // numbers are bigger than the JS max safe int, add in 16-bit chunks to prevent IEEE rounding errors on high bits\n      this._mt[i] = (((this._f * ((s & 0xffff0000) >>> 16)) << 16) + this._f * (s & 0xffff) + i) >>> 0;\n    }\n    this._index = this._n;\n  }\n\n  /**\n   * Apply the twist\n   */\n  private _twist(): void {\n    var mag01 = [0x0, this._a];\n    var y = 0;\n    for (var i = 0; i < this._n - this._m; i++) {\n      y = (this._mt[i] & this._upperMask) | (this._mt[i + 1] & this._lowerMask);\n      this._mt[i] = this._mt[i + this._m] ^ (y >>> 1) ^ (mag01[y & 0x1] & BITMASK32);\n    }\n    for (; i < this._n - 1; i++) {\n      y = (this._mt[i] & this._upperMask) | (this._mt[i + 1] & this._lowerMask);\n      this._mt[i] = this._mt[i + (this._m - this._n)] ^ (y >>> 1) ^ (mag01[y & 0x1] & BITMASK32);\n    }\n    y = (this._mt[this._n - 1] & this._upperMask) | (this._mt[0] & this._lowerMask);\n    this._mt[this._n - 1] = this._mt[this._m - 1] ^ (y >>> 1) ^ (mag01[y & 0x1] & BITMASK32);\n\n    this._index = 0;\n  }\n\n  /**\n   * Return next 32 bit integer number in sequence\n   */\n  public nextInt(): number {\n    if (this._index >= this._n) {\n      this._twist();\n    }\n\n    var y = this._mt[this._index++];\n\n    y ^= y >>> this._u;\n    y ^= (y << this._s) & this._b;\n    y ^= (y << this._t) & this._c;\n    y ^= y >>> this._l;\n\n    return y >>> 0;\n  }\n\n  /**\n   * Return a random floating point number between [0, 1)\n   */\n  public next(): number {\n    return this.nextInt() * (1.0 / 4294967296.0); // divided by 2^32\n  }\n\n  /**\n   * Return a random floating point in range [min, max) min is included, max is not included\n   */\n  public floating(min: number, max: number): number {\n    return (max - min) * this.next() + min;\n  }\n\n  /**\n   * Return a random integer in range [min, max] min is included, max is included.\n   * Implemented with rejection sampling, see https://medium.com/@betable/tifu-by-using-math-random-f1c308c4fd9d#.i13tdiu5a\n   */\n  public integer(min: number, max: number): number {\n    return Math.floor((max - min + 1) * this.next() + min);\n  }\n\n  /**\n   * Returns true or false randomly with 50/50 odds by default.\n   * By default the likelihood of returning a true is .5 (50%).\n   * @param likelihood takes values between [0, 1]\n   */\n  public bool(likelihood: number = 0.5): boolean {\n    return this.next() <= likelihood;\n  }\n\n  /**\n   * Returns one element from an array at random\n   */\n  public pickOne<T>(array: Array<T>): T {\n    return array[this.integer(0, array.length - 1)];\n  }\n\n  /**\n   * Returns a new array random picking elements from the original\n   * @param array Original array to pick from\n   * @param numPicks can be any positive number\n   * @param allowDuplicates indicates whether the returned set is allowed duplicates (it does not mean there will always be duplicates\n   * just that it is possible)\n   */\n  public pickSet<T>(array: Array<T>, numPicks: number, allowDuplicates: boolean = false): Array<T> {\n    if (allowDuplicates) {\n      return this._pickSetWithDuplicates(array, numPicks);\n    } else {\n      return this._pickSetWithoutDuplicates(array, numPicks);\n    }\n  }\n\n  /**\n   * Returns a new array randomly picking elements in the original (not reused)\n   * @param numPicks must be less than or equal to the number of elements in the array.\n   */\n  private _pickSetWithoutDuplicates<T>(array: Array<T>, numPicks: number): Array<T> {\n    if (numPicks > array.length || numPicks < 0) {\n      throw new Error('Invalid number of elements to pick, must pick a value 0 < n <= length');\n    }\n    if (numPicks === array.length) {\n      return array;\n    }\n\n    var result: Array<T> = new Array<T>(numPicks);\n    var currentPick = 0;\n    var tempArray = array.slice(0);\n    while (currentPick < numPicks) {\n      var index = this.integer(0, tempArray.length - 1);\n      result[currentPick++] = tempArray[index];\n      tempArray.splice(index, 1);\n    }\n\n    return result;\n  }\n\n  /**\n   * Returns a new array random picking elements from the original allowing duplicates\n   * @param numPicks can be any positive number\n   */\n  private _pickSetWithDuplicates<T>(array: Array<T>, numPicks: number): Array<T> {\n    // Typescript numbers are all floating point, so do we add check for int? (or floor the input?)\n    if (numPicks < 0) {\n      throw new Error('Invalid number of elements to pick, must pick a value 0 <= n < MAX_INT');\n    }\n    var result = new Array<T>(numPicks);\n    for (var i = 0; i < numPicks; i++) {\n      result[i] = this.pickOne(array);\n    }\n    return result;\n  }\n\n  /**\n   * Returns a new array that has its elements shuffled. Using the Fisher/Yates method\n   * https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle\n   */\n  public shuffle<T>(array: Array<T>): Array<T> {\n    var tempArray = array.slice(0);\n    var swap: T = null;\n    for (var i = 0; i < tempArray.length - 2; i++) {\n      var randomIndex = this.integer(i, tempArray.length - 1);\n      swap = tempArray[i];\n      tempArray[i] = tempArray[randomIndex];\n      tempArray[randomIndex] = swap;\n    }\n\n    return tempArray;\n  }\n\n  /**\n   * Generate a list of random integer numbers\n   * @param length the length of the final array\n   * @param min the minimum integer number to generate inclusive\n   * @param max the maximum integer number to generate inclusive\n   */\n  public range(length: number, min: number, max: number): Array<number> {\n    var result: Array<number> = new Array(length);\n    for (var i = 0; i < length; i++) {\n      result[i] = this.integer(min, max);\n    }\n    return result;\n  }\n\n  /**\n   * Returns the result of a d4 dice roll\n   */\n  public d4() {\n    return this.integer(1, 4);\n  }\n\n  /**\n   * Returns the result of a d6 dice roll\n   */\n  public d6() {\n    return this.integer(1, 6);\n  }\n\n  /**\n   * Returns the result of a d8 dice roll\n   */\n  public d8() {\n    return this.integer(1, 8);\n  }\n\n  /**\n   * Returns the result of a d10 dice roll\n   */\n  public d10() {\n    return this.integer(1, 10);\n  }\n\n  /**\n   * Returns the result of a d12 dice roll\n   */\n  public d12() {\n    return this.integer(1, 12);\n  }\n\n  /**\n   * Returns the result of a d20 dice roll\n   */\n  public d20() {\n    return this.integer(1, 20);\n  }\n}\n","import { Engine } from './Engine';\nimport { Actor, CollisionType } from './Actor';\nimport { Sprite } from './Drawing/Sprite';\nimport { Color } from './Drawing/Color';\nimport { Vector } from './Algebra';\nimport * as Util from './Util/Util';\nimport * as DrawUtil from './Util/DrawUtil';\nimport * as Traits from './Traits/Index';\nimport { Configurable } from './Configurable';\nimport { Random } from './Math/Random';\n\n/**\n * An enum that represents the types of emitter nozzles\n */\nexport enum EmitterType {\n  /**\n   * Constant for the circular emitter type\n   */\n  Circle,\n  /**\n   * Constant for the rectangular emitter type\n   */\n  Rectangle\n}\n\n/**\n * @hidden\n */\nexport class ParticleImpl {\n  public position: Vector = new Vector(0, 0);\n  public velocity: Vector = new Vector(0, 0);\n  public acceleration: Vector = new Vector(0, 0);\n  public particleRotationalVelocity: number = 0;\n  public currentRotation: number = 0;\n\n  public focus: Vector = null;\n  public focusAccel: number = 0;\n  public opacity: number = 1;\n  public beginColor: Color = Color.White.clone();\n  public endColor: Color = Color.White.clone();\n\n  // Life is counted in ms\n  public life: number = 300;\n  public fadeFlag: boolean = false;\n\n  // Color transitions\n  private _rRate: number = 1;\n  private _gRate: number = 1;\n  private _bRate: number = 1;\n  private _aRate: number = 0;\n  private _currentColor: Color = Color.White.clone();\n\n  public emitter: ParticleEmitter = null;\n  public particleSize: number = 5;\n  public particleSprite: Sprite = null;\n\n  public startSize: number;\n  public endSize: number;\n  public sizeRate: number = 0;\n  public elapsedMultiplier: number = 0;\n\n  constructor(\n    emitterOrConfig: ParticleEmitter | IParticleArgs,\n    life?: number,\n    opacity?: number,\n    beginColor?: Color,\n    endColor?: Color,\n    position?: Vector,\n    velocity?: Vector,\n    acceleration?: Vector,\n    startSize?: number,\n    endSize?: number\n  ) {\n    var emitter = emitterOrConfig;\n    if (emitter && !(emitterOrConfig instanceof ParticleEmitter)) {\n      var config = emitterOrConfig;\n      emitter = config.emitter;\n      life = config.life;\n      opacity = config.opacity;\n      endColor = config.endColor;\n      beginColor = config.beginColor;\n      position = config.position;\n      velocity = config.velocity;\n      acceleration = config.acceleration;\n      startSize = config.startSize;\n      endSize = config.endSize;\n    }\n    this.emitter = <ParticleEmitter>emitter;\n    this.life = life || this.life;\n    this.opacity = opacity || this.opacity;\n    this.endColor = endColor || this.endColor.clone();\n    this.beginColor = beginColor || this.beginColor.clone();\n    this._currentColor = this.beginColor.clone();\n    this.position = position || this.position;\n    this.velocity = velocity || this.velocity;\n    this.acceleration = acceleration || this.acceleration;\n    this._rRate = (this.endColor.r - this.beginColor.r) / this.life;\n    this._gRate = (this.endColor.g - this.beginColor.g) / this.life;\n    this._bRate = (this.endColor.b - this.beginColor.b) / this.life;\n    this._aRate = this.opacity / this.life;\n\n    this.startSize = startSize || 0;\n    this.endSize = endSize || 0;\n\n    if (this.endSize > 0 && this.startSize > 0) {\n      this.sizeRate = (this.endSize - this.startSize) / this.life;\n      this.particleSize = this.startSize;\n    }\n  }\n\n  public kill() {\n    this.emitter.removeParticle(this);\n  }\n\n  public update(delta: number) {\n    this.life = this.life - delta;\n    this.elapsedMultiplier = this.elapsedMultiplier + delta;\n\n    if (this.life < 0) {\n      this.kill();\n    }\n\n    if (this.fadeFlag) {\n      this.opacity = Util.clamp(this._aRate * this.life, 0.0001, 1);\n    }\n\n    if (this.startSize > 0 && this.endSize > 0) {\n      this.particleSize = Util.clamp(\n        this.sizeRate * delta + this.particleSize,\n        Math.min(this.startSize, this.endSize),\n        Math.max(this.startSize, this.endSize)\n      );\n    }\n\n    this._currentColor.r = Util.clamp(this._currentColor.r + this._rRate * delta, 0, 255);\n    this._currentColor.g = Util.clamp(this._currentColor.g + this._gRate * delta, 0, 255);\n    this._currentColor.b = Util.clamp(this._currentColor.b + this._bRate * delta, 0, 255);\n    this._currentColor.a = Util.clamp(this.opacity, 0.0001, 1);\n\n    if (this.focus) {\n      var accel = this.focus\n        .sub(this.position)\n        .normalize()\n        .scale(this.focusAccel)\n        .scale(delta / 1000);\n      this.velocity = this.velocity.add(accel);\n    } else {\n      this.velocity = this.velocity.add(this.acceleration.scale(delta / 1000));\n    }\n    this.position = this.position.add(this.velocity.scale(delta / 1000));\n\n    if (this.particleRotationalVelocity) {\n      this.currentRotation = (this.currentRotation + (this.particleRotationalVelocity * delta) / 1000) % (2 * Math.PI);\n    }\n  }\n\n  public draw(ctx: CanvasRenderingContext2D) {\n    if (this.particleSprite) {\n      this.particleSprite.rotation = this.currentRotation;\n      this.particleSprite.scale.setTo(this.particleSize, this.particleSize);\n      this.particleSprite.draw(ctx, this.position.x, this.position.y);\n      return;\n    }\n\n    this._currentColor.a = Util.clamp(this.opacity, 0.0001, 1);\n    ctx.fillStyle = this._currentColor.toString();\n    ctx.beginPath();\n    ctx.arc(this.position.x, this.position.y, this.particleSize, 0, Math.PI * 2);\n    ctx.fill();\n    ctx.closePath();\n  }\n}\n\n/**\n * [[include:Constructors.md]]\n */\nexport interface IParticleArgs extends Partial<ParticleImpl> {\n  emitter: ParticleEmitter;\n  position?: Vector;\n  velocity?: Vector;\n  acceleration?: Vector;\n  particleRotationalVelocity?: number;\n  currentRotation?: number;\n  particleSize?: number;\n  particleSprite?: Sprite;\n}\n\n/**\n * Particle is used in a [[ParticleEmitter]]\n */\nexport class Particle extends Configurable(ParticleImpl) {\n  constructor(config: IParticleArgs);\n  constructor(\n    emitter: ParticleEmitter,\n    life?: number,\n    opacity?: number,\n    beginColor?: Color,\n    endColor?: Color,\n    position?: Vector,\n    velocity?: Vector,\n    acceleration?: Vector,\n    startSize?: number,\n    endSize?: number\n  );\n  constructor(\n    emitterOrConfig: ParticleEmitter | IParticleArgs,\n    life?: number,\n    opacity?: number,\n    beginColor?: Color,\n    endColor?: Color,\n    position?: Vector,\n    velocity?: Vector,\n    acceleration?: Vector,\n    startSize?: number,\n    endSize?: number\n  ) {\n    super(emitterOrConfig, life, opacity, beginColor, endColor, position, velocity, acceleration, startSize, endSize);\n  }\n}\n\n/**\n * @hidden\n */\nexport class ParticleEmitterImpl extends Actor {\n  private _particlesToEmit: number;\n\n  public numParticles: number = 0;\n\n  /**\n   * Random number generator\n   */\n  public random: Random;\n\n  /**\n   * Gets or sets the isEmitting flag\n   */\n  public isEmitting: boolean = true;\n  /**\n   * Gets or sets the backing particle collection\n   */\n  public particles: Util.Collection<Particle> = null;\n\n  /**\n   * Gets or sets the backing deadParticle collection\n   */\n  public deadParticles: Util.Collection<Particle> = null;\n\n  /**\n   * Gets or sets the minimum particle velocity\n   */\n  public minVel: number = 0;\n  /**\n   * Gets or sets the maximum particle velocity\n   */\n  public maxVel: number = 0;\n\n  /**\n   * Gets or sets the acceleration vector for all particles\n   */\n  public acceleration: Vector = new Vector(0, 0);\n\n  /**\n   * Gets or sets the minimum angle in radians\n   */\n  public minAngle: number = 0;\n  /**\n   * Gets or sets the maximum angle in radians\n   */\n  public maxAngle: number = 0;\n\n  /**\n   * Gets or sets the emission rate for particles (particles/sec)\n   */\n  public emitRate: number = 1; //particles/sec\n  /**\n   * Gets or sets the life of each particle in milliseconds\n   */\n  public particleLife: number = 2000;\n  /**\n   * Gets or sets the opacity of each particle from 0 to 1.0\n   */\n  public opacity: number = 1;\n  /**\n   * Gets or sets the fade flag which causes particles to gradually fade out over the course of their life.\n   */\n  public fadeFlag: boolean = false;\n\n  /**\n   * Gets or sets the optional focus where all particles should accelerate towards\n   */\n  public focus: Vector = null;\n  /**\n   * Gets or sets the acceleration for focusing particles if a focus has been specified\n   */\n  public focusAccel: number = 1;\n  /*\n    * Gets or sets the optional starting size for the particles\n    */\n  public startSize: number = null;\n  /*\n    * Gets or sets the optional ending size for the particles\n    */\n  public endSize: number = null;\n\n  /**\n   * Gets or sets the minimum size of all particles\n   */\n  public minSize: number = 5;\n  /**\n   * Gets or sets the maximum size of all particles\n   */\n  public maxSize: number = 5;\n\n  /**\n   * Gets or sets the beginning color of all particles\n   */\n  public beginColor: Color = Color.White.clone();\n  /**\n   * Gets or sets the ending color of all particles\n   */\n  public endColor: Color = Color.White.clone();\n\n  /**\n   * Gets or sets the sprite that a particle should use\n   * @warning Performance intensive\n   */\n  public particleSprite: Sprite = null;\n\n  /**\n   * Gets or sets the emitter type for the particle emitter\n   */\n  public emitterType: EmitterType = EmitterType.Rectangle;\n\n  /**\n   * Gets or sets the emitter radius, only takes effect when the [[emitterType]] is [[EmitterType.Circle]]\n   */\n  public radius: number = 0;\n\n  /**\n   * Gets or sets the particle rotational speed velocity\n   */\n  public particleRotationalVelocity: number = 0;\n\n  /**\n   * Indicates whether particles should start with a random rotation\n   */\n  public randomRotation: boolean = false;\n\n  /**\n   * @param x       The x position of the emitter\n   * @param y       The y position of the emitter\n   * @param width   The width of the emitter\n   * @param height  The height of the emitter\n   */\n  constructor(xOrConfig?: number | IParticleEmitterArgs, y?: number, width?: number, height?: number) {\n    super(typeof xOrConfig === 'number' ? { x: xOrConfig, y: y, width: width, height: height } : xOrConfig);\n    this._particlesToEmit = 0;\n    this.collisionType = CollisionType.PreventCollision;\n    this.particles = new Util.Collection<Particle>();\n    this.deadParticles = new Util.Collection<Particle>();\n    this.random = new Random();\n\n    // Remove offscreen culling from particle emitters\n    for (let i = 0; i < this.traits.length; i++) {\n      if (this.traits[i] instanceof Traits.OffscreenCulling) {\n        this.traits.splice(i, 1);\n      }\n    }\n  }\n\n  public removeParticle(particle: Particle) {\n    this.deadParticles.push(particle);\n  }\n\n  /**\n   * Causes the emitter to emit particles\n   * @param particleCount  Number of particles to emit right now\n   */\n  public emitParticles(particleCount: number) {\n    for (var i = 0; i < particleCount; i++) {\n      this.particles.push(this._createParticle());\n    }\n  }\n\n  public clearParticles() {\n    this.particles.clear();\n  }\n\n  // Creates a new particle given the constraints of the emitter\n  private _createParticle(): Particle {\n    // todo implement emitter constraints;\n    var ranX = 0;\n    var ranY = 0;\n\n    var angle = Util.randomInRange(this.minAngle, this.maxAngle, this.random);\n    var vel = Util.randomInRange(this.minVel, this.maxVel, this.random);\n    var size = this.startSize || Util.randomInRange(this.minSize, this.maxSize, this.random);\n    var dx = vel * Math.cos(angle);\n    var dy = vel * Math.sin(angle);\n\n    if (this.emitterType === EmitterType.Rectangle) {\n      ranX = Util.randomInRange(this.pos.x, this.pos.x + this.getWidth(), this.random);\n      ranY = Util.randomInRange(this.pos.y, this.pos.y + this.getHeight(), this.random);\n    } else if (this.emitterType === EmitterType.Circle) {\n      var radius = Util.randomInRange(0, this.radius, this.random);\n      ranX = radius * Math.cos(angle) + this.pos.x;\n      ranY = radius * Math.sin(angle) + this.pos.y;\n    }\n\n    var p = new Particle(\n      this,\n      this.particleLife,\n      this.opacity,\n      this.beginColor,\n      this.endColor,\n      new Vector(ranX, ranY),\n      new Vector(dx, dy),\n      this.acceleration,\n      this.startSize,\n      this.endSize\n    );\n    p.fadeFlag = this.fadeFlag;\n    p.particleSize = size;\n    if (this.particleSprite) {\n      p.particleSprite = this.particleSprite;\n    }\n    p.particleRotationalVelocity = this.particleRotationalVelocity;\n    if (this.randomRotation) {\n      p.currentRotation = Util.randomInRange(0, Math.PI * 2, this.random);\n    }\n    if (this.focus) {\n      p.focus = this.focus.add(new Vector(this.pos.x, this.pos.y));\n      p.focusAccel = this.focusAccel;\n    }\n    return p;\n  }\n\n  public update(engine: Engine, delta: number) {\n    super.update(engine, delta);\n\n    if (this.isEmitting) {\n      this._particlesToEmit += this.emitRate * (delta / 1000);\n      //var numParticles = Math.ceil(this.emitRate * delta / 1000);\n      if (this._particlesToEmit > 1.0) {\n        this.emitParticles(Math.floor(this._particlesToEmit));\n        this._particlesToEmit = this._particlesToEmit - Math.floor(this._particlesToEmit);\n      }\n    }\n\n    this.particles.forEach((p) => p.update(delta));\n    this.deadParticles.forEach((p) => this.particles.removeElement(p));\n    this.deadParticles.clear();\n  }\n\n  public draw(ctx: CanvasRenderingContext2D) {\n    // todo is there a more efficient to draw\n    // possibly use a webgl offscreen canvas and shaders to do particles?\n    this.particles.forEach((p) => p.draw(ctx));\n  }\n\n  public debugDraw(ctx: CanvasRenderingContext2D) {\n    super.debugDraw(ctx);\n    ctx.fillStyle = Color.Black.toString();\n    ctx.fillText('Particles: ' + this.particles.count(), this.pos.x, this.pos.y + 20);\n\n    if (this.focus) {\n      ctx.fillRect(this.focus.x + this.pos.x, this.focus.y + this.pos.y, 3, 3);\n      DrawUtil.line(ctx, Color.Yellow, this.focus.x + this.pos.x, this.focus.y + this.pos.y, super.getCenter().x, super.getCenter().y);\n      ctx.fillText('Focus', this.focus.x + this.pos.x, this.focus.y + this.pos.y);\n    }\n  }\n}\n\n/**\n * [[include:Constructors.md]]\n */\nexport interface IParticleEmitterArgs extends Partial<ParticleEmitterImpl> {\n  width?: number;\n  height?: number;\n  isEmitting?: boolean;\n  minVel?: number;\n  maxVel?: number;\n  acceleration?: Vector;\n  minAngle?: number;\n  maxAngle?: number;\n  emitRate?: number;\n  particleLife?: number;\n  opacity?: number;\n  fadeFlag?: boolean;\n  focus?: Vector;\n  focusAccel?: number;\n  startSize?: number;\n  endSize?: number;\n  minSize?: number;\n  maxSize?: number;\n  beginColor?: Color;\n  endColor?: Color;\n  particleSprite?: Sprite;\n  emitterType?: EmitterType;\n  radius?: number;\n  particleRotationalVelocity?: number;\n  randomRotation?: boolean;\n  random?: Random;\n}\n\n/**\n * Using a particle emitter is a great way to create interesting effects\n * in your game, like smoke, fire, water, explosions, etc. `ParticleEmitter`\n * extend [[Actor]] allowing you to use all of the features that come with.\n *\n * [[include:Particles.md]]\n */\nexport class ParticleEmitter extends Configurable(ParticleEmitterImpl) {\n  constructor(config?: IParticleEmitterArgs);\n  constructor(x?: number | IParticleEmitterArgs, y?: number, width?: number, height?: number);\n  constructor(xOrConfig?: number | IParticleEmitterArgs, y?: number, width?: number, height?: number) {\n    super(xOrConfig, y, width, height);\n  }\n}\n","import { Vector } from './Algebra';\n\n/**\n * Possible collision resolution strategies\n *\n * The default is [[CollisionResolutionStrategy.Box]] which performs simple axis aligned arcade style physics.\n *\n * More advanced rigid body physics are enabled by setting [[CollisionResolutionStrategy.RigidBody]] which allows for complicated\n * simulated physical interactions.\n */\nexport enum CollisionResolutionStrategy {\n  Box,\n  RigidBody\n}\n\n/**\n * Possible broadphase collision pair identification strategies\n *\n * The default strategy is [[BroadphaseStrategy.DynamicAABBTree]] which uses a binary tree of axis-aligned bounding boxes to identify\n * potential collision pairs which is O(nlog(n)) faster. The other possible strategy is the [[BroadphaseStrategy.Naive]] strategy\n * which loops over every object for every object in the scene to identify collision pairs which is O(n^2) slower.\n */\nexport enum BroadphaseStrategy {\n  Naive,\n  DynamicAABBTree\n}\n\n/**\n * Possible numerical integrators for position and velocity\n */\nexport enum Integrator {\n  Euler\n}\n\n/**\n * The [[Physics]] object is the global configuration object for all Excalibur physics.\n *\n * [[include:Physics.md]]\n */\n/* istanbul ignore next */\nexport class Physics {\n  /**\n   * Global acceleration that is applied to all vanilla actors that have a [[CollisionType.Active|active]] collision type.\n   * Global acceleration won't effect [[Label|labels]], [[UIActor|ui actors]], or [[Trigger|triggers]] in Excalibur.\n   *\n   * This is a great way to globally simulate effects like gravity.\n   */\n  public static acc = new Vector(0, 0);\n\n  /**\n   * Globally switches all Excalibur physics behavior on or off.\n   */\n  public static enabled = true;\n\n  /**\n   * Gets or sets the number of collision passes for Excalibur to perform on physics bodies.\n   *\n   * Reducing collision passes may cause things not to collide as expected in your game, but may increase performance.\n   *\n   * More passes can improve the visual quality of collisions when many objects are on the screen. This can reduce jitter, improve the\n   * collision resolution of fast move objects, or the stability of large numbers of objects stacked together.\n   *\n   * Fewer passes will improve the performance of the game at the cost of collision quality, more passes will improve quality at the\n   * cost of performance.\n   *\n   * The default is set to 5 passes which is a good start.\n   */\n  public static collisionPasses = 5;\n\n  /**\n   * Gets or sets the broadphase pair identification strategy.\n   *\n   * The default strategy is [[BroadphaseStrategy.DynamicAABBTree]] which uses a binary tree of axis-aligned bounding boxes to identify\n   * potential collision pairs which is O(nlog(n)) faster. The other possible strategy is the [[BroadphaseStrategy.Naive]] strategy\n   * which loops over every object for every object in the scene to identify collision pairs which is O(n^2) slower.\n   */\n  public static broadphaseStrategy: BroadphaseStrategy = BroadphaseStrategy.DynamicAABBTree;\n\n  /**\n   * Globally switches the debug information for the broadphase strategy\n   */\n  public static broadphaseDebug: boolean = false;\n  /**\n   * Show the normals as a result of collision on the screen.\n   */\n  public static showCollisionNormals: boolean = false;\n  /**\n   * Show the position, velocity, and acceleration as graphical vectors.\n   */\n  public static showMotionVectors: boolean = false;\n  /**\n   * Show the axis-aligned bounding boxes of the collision bodies on the screen.\n   */\n  public static showBounds: boolean = false;\n  /**\n   * Show the bounding collision area shapes\n   */\n  public static showArea: boolean = false;\n  /**\n   * Show points of collision interpreted by excalibur as a result of collision.\n   */\n  public static showContacts: boolean = false;\n  /**\n   * Show the surface normals of the collision areas.\n   */\n  public static showNormals: boolean = false;\n  /**\n   * Gets or sets the global collision resolution strategy (narrowphase).\n   *\n   * The default is [[CollisionResolutionStrategy.Box]] which performs simple axis aligned arcade style physics.\n   *\n   * More advanced rigid body physics are enabled by setting [[CollisionResolutionStrategy.RigidBody]] which allows for complicated\n   * simulated physical interactions.\n   */\n  public static collisionResolutionStrategy: CollisionResolutionStrategy = CollisionResolutionStrategy.Box;\n  /**\n   * The default mass to use if none is specified\n   */\n  public static defaultMass: number = 10;\n  /**\n   * Gets or sets the position and velocity positional integrator, currently only Euler is supported.\n   */\n  public static integrator: Integrator = Integrator.Euler;\n  /**\n   * Number of steps to use in integration. A higher number improves the positional accuracy over time. This can be useful to increase\n   * if you have fast moving objects in your simulation or you have a large number of objects and need to increase stability.\n   */\n  public static integrationSteps = 1;\n  /**\n   * Gets or sets whether rotation is allowed in a RigidBody collision resolution\n   */\n  public static allowRigidBodyRotation = true;\n\n  /**\n   * Configures Excalibur to use box physics. Box physics which performs simple axis aligned arcade style physics.\n   */\n  public static useBoxPhysics(): void {\n    Physics.collisionResolutionStrategy = CollisionResolutionStrategy.Box;\n  }\n\n  /**\n   * Configures Excalibur to use rigid body physics. Rigid body physics allows for complicated\n   * simulated physical interactions.\n   */\n  public static useRigidBodyPhysics(): void {\n    Physics.collisionResolutionStrategy = CollisionResolutionStrategy.RigidBody;\n  }\n\n  /**\n   * Small value to help collision passes settle themselves after the narrowphase.\n   */\n  public static collisionShift = 0.001;\n\n  /**\n   * Factor to add to the RigidBody BoundingBox, bounding box (dimensions += vel * dynamicTreeVelocityMultiplyer);\n   */\n  public static dynamicTreeVelocityMultiplyer = 2;\n\n  /**\n   * Pad RigidBody BoundingBox by a constant amount\n   */\n  public static boundsPadding = 5;\n\n  /**\n   * Surface epsilon is used to help deal with surface penatration\n   */\n  public static surfaceEpsilon = 0.1;\n\n  /**\n   * Enable fast moving body checking, this enables checking for collision pairs via raycast for fast moving objects to prevent\n   * bodies from tunneling through one another.\n   */\n  public static checkForFastBodies = true;\n\n  /**\n   * Disable minimum fast moving body raycast, by default if ex.Physics.checkForFastBodies = true Excalibur will only check if the\n   * body is moving at least half of its minimum diminension in an update. If ex.Physics.disableMinimumSpeedForFastBody is set to true,\n   * Excalibur will always perform the fast body raycast regardless of speed.\n   */\n  public static disableMinimumSpeedForFastBody = false;\n}\n","/* istanbul ignore next */\nif (typeof window === 'undefined') {\n  window = <any>{\n    audioContext: function() {\n      return;\n    }\n  };\n}\n/* istanbul ignore next */\nif (typeof window !== 'undefined' && !window.requestAnimationFrame) {\n  (<any>window).requestAnimationFrame =\n    (<any>window).webkitRequestAnimationFrame ||\n    (<any>window).mozRequestAnimationFrame ||\n    function(callback: Function) {\n      window.setInterval(callback, 1000 / 60);\n    };\n}\n/* istanbul ignore next */\nif (typeof window !== 'undefined' && !window.cancelAnimationFrame) {\n  (<any>window).cancelAnimationFrame =\n    (<any>window).webkitCancelAnimationFrame ||\n    (<any>window).mozCancelAnimationFrame ||\n    function() {\n      return;\n    };\n}\n/* istanbul ignore next */\nif (typeof window !== 'undefined' && !(<any>window).AudioContext) {\n  (<any>window).AudioContext =\n    (<any>window).AudioContext ||\n    (<any>window).webkitAudioContext ||\n    (<any>window).mozAudioContext ||\n    (<any>window).msAudioContext ||\n    (<any>window).oAudioContext;\n}\n\nif (typeof window !== 'undefined' && !(<any>window).devicePixelRatio) {\n  (<any>window).devicePixelRatio = window.devicePixelRatio || 1;\n}\n\n// Polyfill from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach\n// Production steps of ECMA-262, Edition 5, 15.4.4.18\n// Reference: http://es5.github.io/#x15.4.4.18\n/* istanbul ignore next */\nif (!Array.prototype.forEach) {\n  Array.prototype.forEach = function(this: Array<any>, callback, thisArg) {\n    var T, k;\n\n    if (this == null) {\n      throw new TypeError('this is null or not defined');\n    }\n\n    // 1. Let O be the result of calling ToObject passing the |this| value as the argument.\n    var O = Object(this);\n\n    // 2. Let lenValue be the result of calling the Get internal method of O with the argument \"length\".\n    // 3. Let len be ToUint32(lenValue).\n    var len = O.length >>> 0;\n\n    // 4. If IsCallable(callback) is false, throw a TypeError exception.\n    // See: http://es5.github.com/#x9.11\n    if (typeof callback !== 'function') {\n      throw new TypeError(callback + ' is not a function');\n    }\n\n    // 5. If thisArg was supplied, let T be thisArg; else let T be undefined.\n    if (arguments.length > 1) {\n      T = thisArg;\n    }\n\n    // 6. Let k be 0\n    k = 0;\n\n    // 7. Repeat, while k < len\n    while (k < len) {\n      var kValue;\n\n      // a. Let Pk be ToString(k).\n      //   This is implicit for LHS operands of the in operator\n      // b. Let kPresent be the result of calling the HasProperty internal method of O with argument Pk.\n      //   This step can be combined with c\n      // c. If kPresent is true, then\n      if (k in O) {\n        // i. Let kValue be the result of calling the Get internal method of O with argument Pk.\n        kValue = O[k];\n\n        // ii. Call the Call internal method of callback with T as the this value and\n        // argument list containing kValue, k, and O.\n        callback.call(T, kValue, k, O);\n      }\n      // d. Increase k by 1.\n      k++;\n    }\n    // 8. return undefined\n  };\n}\n\n// Polyfill from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/some\n/* istanbul ignore next */\nif (!Array.prototype.some) {\n  Array.prototype.some = function(this: Array<any>, fun /*, thisArg */) {\n    'use strict';\n\n    if (this === void 0 || this === null) {\n      throw new TypeError();\n    }\n\n    var t = Object(this);\n    var len = t.length >>> 0;\n    if (typeof fun !== 'function') {\n      throw new TypeError();\n    }\n\n    var thisArg = arguments.length >= 2 ? arguments[1] : void 0;\n    for (var i = 0; i < len; i++) {\n      if (i in t && fun.call(thisArg, t[i], i, t)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n}\n\n// Polyfill from  https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind#Polyfill\n/* istanbul ignore next */\nif (!Function.prototype.bind) {\n  Function.prototype.bind = function(oThis) {\n    if (typeof this !== 'function') {\n      // closest thing possible to the ECMAScript 5\n      // internal IsCallable function\n      throw new TypeError('Function.prototype.bind - what is trying to be bound is not callable');\n    }\n\n    var aArgs = Array.prototype.slice.call(arguments, 1),\n      fToBind = this,\n      fNOP: any = function() {\n        return;\n      },\n      fBound = function(this: Function) {\n        return fToBind.apply(this instanceof fNOP && oThis ? this : oThis, aArgs.concat(Array.prototype.slice.call(arguments)));\n      };\n\n    fNOP.prototype = this.prototype;\n    fBound.prototype = new fNOP();\n\n    return fBound;\n  };\n}\n","import { Logger } from './../Util/Log';\nimport { IPostProcessor } from './IPostProcessor';\nimport { Engine } from '../Engine';\n\nexport enum ColorBlindness {\n  Protanope,\n  Deuteranope,\n  Tritanope\n}\n\n/**\n * This post processor can correct colors and simulate color blindness.\n * It is possible to use this on every game, but the game's performance\n * will suffer measurably. It's better to use it as a helpful tool while developing your game.\n * Remember, the best practice is to design with color blindness in mind.\n *\n * [[include:ColorBlind.md]]\n */\nexport class ColorBlindCorrector implements IPostProcessor {\n  private _vertexShader =\n    'attribute vec2 a_position;' +\n    'attribute vec2 a_texCoord;' +\n    'uniform vec2 u_resolution;' +\n    'varying vec2 v_texCoord;' +\n    'void main() {' +\n    // convert the rectangle from pixels to 0.0 to 1.0\n    'vec2 zeroToOne = a_position / u_resolution;' +\n    // convert from 0->1 to 0->2\n    'vec2 zeroToTwo = zeroToOne * 2.0;' +\n    // convert from 0->2 to -1->+1 (clipspace)\n    'vec2 clipSpace = zeroToTwo - 1.0;' +\n    'gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);' +\n    // pass the texCoord to the fragment shader\n    // The GPU will interpolate this value between points.\n    'v_texCoord = a_texCoord;' +\n    '}';\n\n  private _fragmentShader =\n    'precision mediump float;' +\n    // our texture\n    'uniform sampler2D u_image;' +\n    // the texCoords passed in from the vertex shader.\n    'varying vec2 v_texCoord;' +\n    // Color blind conversions\n    /*'mat3 m[9] =' +\n   '{' +\n      'mat3(1.0, 0.0, 0.0,  0.0, 1.0, 0.0,  0.0, 0.0, 1.0  ),' + // normal\n      'mat3(0.567, 0.433, 0.0,  0.558, 0.442, 0.0,  0.0, 0.242, 0.758),' + // protanopia\n      'mat3(0.817, 0.183, 0.0,  0.333, 0.667, 0.0,  0.0, 0.125,0.875),' + // protanomaly\n      'mat3(0.625, 0.375, 0.0,  0.7, 0.3, 0.0,  0.0, 0.3,0.7  ),' + // deuteranopia\n      'mat3(0.8, 0.2, 0.0,  0.258, 0.742, 0.0,  0.0, 0.142,0.858),' + // deuteranomaly\n      'mat3(0.95, 0.05, 0.0,  0.0, 0.433, 0.567,  0.0, 0.475,0.525),' + // tritanopia\n      'mat3(0.967, 0.033, 0.0,  0.0, 0.733, 0.267,  0.0, 0.183,0.817),' + // tritanomaly\n      'mat3(0.299, 0.587, 0.114,  0.299, 0.587, 0.114,  0.299, 0.587,0.114),' + // achromatopsia\n      'mat3(0.618, 0.320, 0.062,  0.163, 0.775, 0.062,  0.163, 0.320,0.516)' +  // achromatomaly\n   '};' +*/\n\n    'void main() {' +\n    'vec4 o =  texture2D(u_image, v_texCoord);' +\n    // RGB to LMS matrix conversion\n    'float L = (17.8824 * o.r) + (43.5161 * o.g) + (4.11935 * o.b);' +\n    'float M = (3.45565 * o.r) + (27.1554 * o.g) + (3.86714 * o.b);' +\n    'float S = (0.0299566 * o.r) + (0.184309 * o.g) + (1.46709 * o.b);' +\n    // Simulate color blindness\n\n    '//MODE CODE//' +\n    /* Deuteranope for testing \n      'float l = 1.0 * L + 0.0 * M + 0.0 * S;' +\n            'float m = 0.494207 * L + 0.0 * M + 1.24827 * S;' +\n            'float s = 0.0 * L + 0.0 * M + 1.0 * S;' +*/\n\n    // LMS to RGB matrix conversion\n    'vec4 error;' +\n    'error.r = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s);' +\n    'error.g = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s);' +\n    'error.b = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);' +\n    'error.a = 1.0;' +\n    'vec4 diff = o - error;' +\n    'vec4 correction;' +\n    'correction.r = 0.0;' +\n    'correction.g =  (diff.r * 0.7) + (diff.g * 1.0);' +\n    'correction.b =  (diff.r * 0.7) + (diff.b * 1.0);' +\n    'correction = o + correction;' +\n    'correction.a = o.a;' +\n    '//SIMULATE//' +\n    '}';\n\n  private _internalCanvas: HTMLCanvasElement;\n  private _gl: WebGLRenderingContext;\n  private _program: WebGLProgram;\n\n  constructor(public engine: Engine, public simulate: boolean = false, public colorMode: ColorBlindness = ColorBlindness.Protanope) {\n    this._internalCanvas = document.createElement('canvas');\n    this._internalCanvas.width = engine.drawWidth;\n    this._internalCanvas.height = engine.drawHeight;\n\n    this._gl = <WebGLRenderingContext>this._internalCanvas.getContext('webgl', { preserveDrawingBuffer: true });\n\n    this._program = this._gl.createProgram();\n    var fragmentShader = this._getShader('Fragment', this._getFragmentShaderByMode(colorMode));\n    var vertextShader = this._getShader('Vertex', this._vertexShader);\n\n    this._gl.attachShader(this._program, vertextShader);\n    this._gl.attachShader(this._program, fragmentShader);\n    this._gl.linkProgram(this._program);\n\n    if (!this._gl.getProgramParameter(this._program, this._gl.LINK_STATUS)) {\n      Logger.getInstance().error('Unable to link shader program!');\n    }\n\n    this._gl.useProgram(this._program);\n  }\n\n  private _getFragmentShaderByMode(colorMode: ColorBlindness) {\n    var code = '';\n    if (colorMode === ColorBlindness.Protanope) {\n      code =\n        'float l = 0.0 * L + 2.02344 * M + -2.52581 * S;' +\n        'float m = 0.0 * L + 1.0 * M + 0.0 * S;' +\n        'float s = 0.0 * L + 0.0 * M + 1.0 * S;';\n    } else if (colorMode === ColorBlindness.Deuteranope) {\n      code =\n        'float l = 1.0 * L + 0.0 * M + 0.0 * S;' +\n        'float m = 0.494207 * L + 0.0 * M + 1.24827 * S;' +\n        'float s = 0.0 * L + 0.0 * M + 1.0 * S;';\n    } else if (colorMode === ColorBlindness.Tritanope) {\n      code =\n        'float l = 1.0 * L + 0.0 * M + 0.0 * S;' +\n        'float m = 0.0 * L + 1.0 * M + 0.0 * S;' +\n        'float s = -0.395913 * L + 0.801109 * M + 0.0 * S;';\n    }\n\n    if (this.simulate) {\n      this._fragmentShader = this._fragmentShader.replace('//SIMULATE//', 'gl_FragColor = error.rgba;');\n    } else {\n      this._fragmentShader = this._fragmentShader.replace('//SIMULATE//', 'gl_FragColor = correction.rgba;');\n    }\n\n    return this._fragmentShader.replace('//MODE CODE//', code);\n  }\n\n  private _setRectangle(x: number, y: number, width: number, height: number) {\n    var x1 = x;\n    var x2 = x + width;\n    var y1 = y;\n    var y2 = y + height;\n    this._gl.bufferData(this._gl.ARRAY_BUFFER, new Float32Array([x1, y1, x2, y1, x1, y2, x1, y2, x2, y1, x2, y2]), this._gl.STATIC_DRAW);\n  }\n\n  private _getShader(type: string, program: string): WebGLShader {\n    var shader: WebGLShader;\n    if (type === 'Fragment') {\n      shader = this._gl.createShader(this._gl.FRAGMENT_SHADER);\n    } else if (type === 'Vertex') {\n      shader = this._gl.createShader(this._gl.VERTEX_SHADER);\n    } else {\n      Logger.getInstance().error('Error unknown shader type', type);\n    }\n\n    this._gl.shaderSource(shader, program);\n    this._gl.compileShader(shader);\n\n    if (!this._gl.getShaderParameter(shader, this._gl.COMPILE_STATUS)) {\n      Logger.getInstance().error('Unable to compile shader!', this._gl.getShaderInfoLog(shader));\n      return null;\n    }\n\n    return shader;\n  }\n\n  public process(image: ImageData, out: CanvasRenderingContext2D) {\n    // look up where the vertex data needs to go.\n    var positionLocation = this._gl.getAttribLocation(this._program, 'a_position');\n    var texCoordLocation = this._gl.getAttribLocation(this._program, 'a_texCoord');\n\n    var texCoordBuffer = this._gl.createBuffer();\n    this._gl.bindBuffer(this._gl.ARRAY_BUFFER, texCoordBuffer);\n    this._gl.bufferData(\n      this._gl.ARRAY_BUFFER,\n      new Float32Array([0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0]),\n      this._gl.STATIC_DRAW\n    );\n    this._gl.enableVertexAttribArray(texCoordLocation);\n    this._gl.vertexAttribPointer(texCoordLocation, 2, this._gl.FLOAT, false, 0, 0);\n\n    // Create a texture.\n    var texture = this._gl.createTexture();\n    this._gl.bindTexture(this._gl.TEXTURE_2D, texture);\n\n    // Set the parameters so we can render any size image.\n    this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_WRAP_S, this._gl.CLAMP_TO_EDGE);\n    this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_WRAP_T, this._gl.CLAMP_TO_EDGE);\n    this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_MIN_FILTER, this._gl.NEAREST);\n    this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_MAG_FILTER, this._gl.NEAREST);\n    // Flip the texture when unpacking into the gl context, gl reads textures in the opposite order as everything else :/\n    this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL, 1);\n    // Upload the image into the texture.\n    this._gl.texImage2D(this._gl.TEXTURE_2D, 0, this._gl.RGBA, this._gl.RGBA, this._gl.UNSIGNED_BYTE, image);\n\n    // lookup uniforms\n    var resolutionLocation = this._gl.getUniformLocation(this._program, 'u_resolution');\n\n    // set the resolution\n    this._gl.uniform2f(resolutionLocation, this._internalCanvas.width, this._internalCanvas.height);\n\n    // Create a buffer for the position of the rectangle corners.\n    var positionBuffer = this._gl.createBuffer();\n    this._gl.bindBuffer(this._gl.ARRAY_BUFFER, positionBuffer);\n    this._gl.enableVertexAttribArray(positionLocation);\n    this._gl.vertexAttribPointer(positionLocation, 2, this._gl.FLOAT, false, 0, 0);\n\n    // Set a rectangle the same size as the image.\n    this._setRectangle(0, 0, image.width, image.height);\n\n    // Draw the rectangle.\n    this._gl.drawArrays(this._gl.TRIANGLES, 0, 6);\n\n    // Grab tranformed image from internal canvas\n    var pixelData = new Uint8Array(image.width * image.height * 4);\n    this._gl.readPixels(0, 0, image.width, image.height, this._gl.RGBA, this._gl.UNSIGNED_BYTE, pixelData);\n\n    (<any>image.data).set(pixelData);\n\n    out.putImageData(image, 0, 0);\n  }\n}\n","export * from './ColorBlindCorrector';\nexport * from './IPostProcessor';\n","// Promises/A+ Spec http://promises-aplus.github.io/promises-spec/\n\n/**\n * Valid states for a promise to be in\n */\nexport enum PromiseState {\n  Resolved,\n  Rejected,\n  Pending\n}\n\nexport interface IPromise<T> {\n  then(successCallback?: (value?: T) => any, rejectCallback?: (value?: T) => any): IPromise<T>;\n  error(rejectCallback?: (value?: any) => any): IPromise<T>;\n\n  //Cannot define static methods on interfaces\n  //wrap<T>(value?: T): IPromise<T>;\n\n  resolve(value?: T): IPromise<T>;\n  reject(value?: any): IPromise<T>;\n\n  state(): PromiseState;\n}\n\n/**\n * Promises are used to do asynchronous work and they are useful for\n * creating a chain of actions. In Excalibur they are used for loading,\n * sounds, animation, actions, and more.\n *\n * [[include:Promises.md]]\n */\nexport class Promise<T> implements IPromise<T> {\n  private _state: PromiseState = PromiseState.Pending;\n  private _value: T;\n  private _successCallbacks: { (value?: T): any }[] = [];\n  private _rejectCallback: (value?: any) => any = () => {\n    return;\n  };\n  private _errorCallback: (value?: any) => any;\n\n  /**\n   * Create and resolve a Promise with an optional value\n   * @param value  An optional value to wrap in a resolved promise\n   */\n  public static resolve<T>(value?: T): Promise<T> {\n    var promise = new Promise<T>().resolve(value);\n\n    return promise;\n  }\n\n  /**\n   * Create and reject a Promise with an optional value\n   * @param value  An optional value to wrap in a rejected promise\n   */\n  public static reject<T>(value?: T): Promise<T> {\n    var promise = new Promise<T>().reject(value);\n\n    return promise;\n  }\n\n  /**\n   * Returns a new promise that resolves when all the promises passed to it resolve, or rejects\n   * when at least 1 promise rejects.\n   */\n  public static join<T>(promises: Promise<T>[]): Promise<T>;\n\n  /**\n   * Returns a new promise that resolves when all the promises passed to it resolve, or rejects\n   * when at least 1 promise rejects.\n   */\n  public static join<T>(...promises: Promise<T>[]): Promise<T>;\n\n  public static join<T>() {\n    var promises: Promise<T>[] = [];\n\n    if (arguments.length > 0 && !Array.isArray(arguments[0])) {\n      for (var _i = 0; _i < arguments.length; _i++) {\n        promises[_i - 0] = arguments[_i];\n      }\n    } else if (arguments.length === 1 && Array.isArray(arguments[0])) {\n      promises = arguments[0];\n    }\n\n    var joinedPromise = new Promise<T>();\n    if (!promises || !promises.length) {\n      return joinedPromise.resolve();\n    }\n\n    var total = promises.length;\n    var successes = 0;\n    var rejects = 0;\n    var errors: any = [];\n\n    promises.forEach((p) => {\n      p.then(\n        () => {\n          successes += 1;\n          if (successes === total) {\n            joinedPromise.resolve();\n          } else if (successes + rejects + errors.length === total) {\n            joinedPromise.reject(errors);\n          }\n        },\n        () => {\n          rejects += 1;\n          if (successes + rejects + errors.length === total) {\n            joinedPromise.reject(errors);\n          }\n        }\n      ).error((e) => {\n        errors.push(e);\n        if (errors.length + successes + rejects === total) {\n          joinedPromise.reject(errors);\n        }\n      });\n    });\n\n    return joinedPromise;\n  }\n\n  /**\n   * Chain success and reject callbacks after the promise is resolved\n   * @param successCallback  Call on resolution of promise\n   * @param rejectCallback   Call on rejection of promise\n   */\n  public then(successCallback?: (value?: T) => any, rejectCallback?: (value?: any) => any) {\n    if (successCallback) {\n      this._successCallbacks.push(successCallback);\n\n      // If the promise is already resovled call immediately\n      if (this.state() === PromiseState.Resolved) {\n        try {\n          successCallback.call(this, this._value);\n        } catch (e) {\n          this._handleError(e);\n        }\n      }\n    }\n    if (rejectCallback) {\n      this._rejectCallback = rejectCallback;\n\n      // If the promise is already rejected call immediately\n      if (this.state() === PromiseState.Rejected) {\n        try {\n          rejectCallback.call(this, this._value);\n        } catch (e) {\n          this._handleError(e);\n        }\n      }\n    }\n\n    return this;\n  }\n\n  /**\n   * Add an error callback to the promise\n   * @param errorCallback  Call if there was an error in a callback\n   */\n  public error(errorCallback?: (value?: any) => any) {\n    if (errorCallback) {\n      this._errorCallback = errorCallback;\n    }\n    return this;\n  }\n\n  /**\n   * Resolve the promise and pass an option value to the success callbacks\n   * @param value  Value to pass to the success callbacks\n   */\n  public resolve(value?: T): Promise<T> {\n    if (this._state === PromiseState.Pending) {\n      this._value = value;\n      try {\n        this._state = PromiseState.Resolved;\n        this._successCallbacks.forEach((cb) => {\n          cb.call(this, this._value);\n        });\n      } catch (e) {\n        this._handleError(e);\n      }\n    } else {\n      throw new Error('Cannot resolve a promise that is not in a pending state!');\n    }\n    return this;\n  }\n\n  /**\n   * Reject the promise and pass an option value to the reject callbacks\n   * @param value  Value to pass to the reject callbacks\n   */\n  public reject(value?: any) {\n    if (this._state === PromiseState.Pending) {\n      this._value = value;\n      try {\n        this._state = PromiseState.Rejected;\n        this._rejectCallback.call(this, this._value);\n      } catch (e) {\n        this._handleError(e);\n      }\n    } else {\n      throw new Error('Cannot reject a promise that is not in a pending state!');\n    }\n    return this;\n  }\n\n  /**\n   * Inspect the current state of a promise\n   */\n  public state(): PromiseState {\n    return this._state;\n  }\n\n  private _handleError(e: any) {\n    if (this._errorCallback) {\n      this._errorCallback.call(this, e);\n    } else {\n      // rethrow error\n      throw e;\n    }\n  }\n}\n","export * from './Resource';\nexport * from './Sound/Index';\nexport * from './Texture';\n","import { ILoadable } from '../Interfaces/ILoadable';\nimport { Class } from '../Class';\nimport { Engine } from '../Engine';\nimport { Promise } from '../Promises';\nimport { Logger } from '../Util/Log';\n\n/**\n * The [[Resource]] type allows games built in Excalibur to load generic resources.\n * For any type of remote resource it is recommended to use [[Resource]] for preloading.\n *\n * [[include:Resources.md]]\n */\nexport class Resource<T> extends Class implements ILoadable {\n  public data: T = null;\n  public logger: Logger = Logger.getInstance();\n\n  /**\n   * @param path          Path to the remote resource\n   * @param responseType  The type to expect as a response: \"\" | \"arraybuffer\" | \"blob\" | \"document\" | \"json\" | \"text\";\n   * @param bustCache     Whether or not to cache-bust requests\n   */\n  constructor(\n    public path: string,\n    public responseType: '' | 'arraybuffer' | 'blob' | 'document' | 'json' | 'text',\n    public bustCache: boolean = true\n  ) {\n    super();\n  }\n\n  /**\n   * Returns true if the Resource is completely loaded and is ready\n   * to be drawn.\n   */\n  public isLoaded(): boolean {\n    return this.data !== null;\n  }\n\n  public wireEngine(_engine: Engine) {\n    // override me\n  }\n\n  private _cacheBust(uri: string): string {\n    var query: RegExp = /\\?\\w*=\\w*/;\n    if (query.test(uri)) {\n      uri += '&__=' + Date.now();\n    } else {\n      uri += '?__=' + Date.now();\n    }\n    return uri;\n  }\n\n  private _start() {\n    this.logger.debug('Started loading resource ' + this.path);\n  }\n\n  /**\n   * Begin loading the resource and returns a promise to be resolved on completion\n   */\n  public load(): Promise<T> {\n    var complete = new Promise<T>();\n\n    // Exit early if we already have data\n    if (this.data !== null) {\n      this.logger.debug('Already have data for resource', this.path);\n      complete.resolve(this.data);\n      this.oncomplete();\n      return complete;\n    }\n\n    var request = new XMLHttpRequest();\n    request.open('GET', this.bustCache ? this._cacheBust(this.path) : this.path, true);\n    request.responseType = this.responseType;\n    request.onloadstart = () => {\n      this._start();\n    };\n    request.onprogress = this.onprogress;\n    request.onerror = this.onerror;\n    request.onload = () => {\n      // XHR on file:// success status is 0, such as with PhantomJS\n      if (request.status !== 0 && request.status !== 200) {\n        this.logger.error('Failed to load resource ', this.path, ' server responded with error code', request.status);\n        this.onerror(request.response);\n        complete.resolve(request.response);\n        return;\n      }\n\n      this.data = this.processData(request.response);\n\n      this.oncomplete();\n      this.logger.debug('Completed loading resource', this.path);\n      complete.resolve(this.data);\n    };\n    request.send();\n\n    return complete;\n  }\n\n  /**\n   * Returns the loaded data once the resource is loaded\n   */\n  public getData(): any {\n    return this.data;\n  }\n\n  /**\n   * Sets the data for this resource directly\n   */\n  public setData(data: any) {\n    this.data = this.processData(data);\n  }\n\n  /**\n   * This method is meant to be overriden to handle any additional\n   * processing. Such as decoding downloaded audio bits.\n   */\n  public processData(data: T): any {\n    // https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseType\n    // Blob requires an object url\n    if (this.responseType === 'blob') {\n      return URL.createObjectURL(data);\n    }\n    return data;\n  }\n\n  public onprogress: (e: any) => void = () => {\n    return;\n  };\n\n  public oncomplete: () => void = () => {\n    return;\n  };\n\n  public onerror: (e: any) => void = () => {\n    return;\n  };\n}\n","/**\n * Internal class used to build instances of AudioContext\n */\n/* istanbul ignore next */\nexport class AudioContextFactory {\n  private static _INSTANCE: AudioContext = null;\n\n  public static create(): AudioContext {\n    if (!this._INSTANCE) {\n      if ((<any>window).AudioContext || (<any>window).webkitAudioContext) {\n        this._INSTANCE = new (<any>window).AudioContext();\n      }\n    }\n\n    return this._INSTANCE;\n  }\n}\n","import { IAudio } from '../../Interfaces/IAudio';\nimport { Promise } from '../../Promises';\nimport * as Util from '../../Util/Util';\nimport { AudioContextFactory } from './AudioContext';\n\n/**\n * Internal class for producing of AudioInstances\n */\n/* istanbul ignore next */\nexport class AudioInstanceFactory {\n  public static create(src: string | AudioBuffer): AudioInstance {\n    if (typeof src === 'string') {\n      return new AudioTagInstance(src);\n    }\n\n    if (src instanceof AudioBuffer) {\n      return new WebAudioInstance(src);\n    }\n\n    return new AudioInstance(src);\n  }\n}\n\n/**\n * Internal class representing base AudioInstance implementation\n */\n/* istanbul ignore next */\nexport class AudioInstance implements IAudio {\n  public set loop(value: boolean) {\n    this._loop = value;\n\n    if (this._instance) {\n      this._instance.loop = value;\n      this._wireUpOnEnded();\n    }\n  }\n  public get loop(): boolean {\n    return this._loop;\n  }\n  public set volume(value: number) {\n    this._volume = Util.clamp(value, 0, 1.0);\n  }\n  public get volume(): number {\n    return this._volume;\n  }\n\n  protected _volume = 1;\n  protected _loop = false;\n  protected _playingPromise: Promise<boolean>;\n  protected _isPlaying = false;\n  protected _isPaused = false;\n  protected _instance: HTMLAudioElement | AudioBufferSourceNode;\n\n  constructor(protected _src: string | AudioBuffer) {}\n\n  public isPlaying() {\n    return this._isPlaying;\n  }\n\n  public pause() {\n    if (!this._isPlaying) {\n      return;\n    }\n\n    this._isPaused = true;\n    this._isPlaying = false;\n  }\n\n  public stop() {\n    if (!this._isPlaying) {\n      return;\n    }\n\n    this._isPlaying = false;\n    this._isPaused = false;\n  }\n\n  public play() {\n    if (this._isPaused) {\n      this._resumePlayBack();\n    }\n\n    if (!this._isPlaying) {\n      this._startPlayBack();\n    }\n\n    return this._playingPromise;\n  }\n\n  protected _startPlayBack() {\n    this._isPlaying = true;\n    this._isPaused = false;\n    this._playingPromise = new Promise<boolean>();\n  }\n\n  protected _resumePlayBack() {\n    if (!this._isPaused) {\n      return;\n    }\n\n    this._isPaused = false;\n    this._isPlaying = true;\n  }\n\n  protected _wireUpOnEnded() {\n    if (!this.loop) {\n      this._instance.onended = () => this._handleOnEnded();\n    }\n  }\n\n  protected _handleOnEnded() {\n    /**\n     * Override me\n     */\n  }\n}\n\n/**\n * Internal class representing a HTML5 audio instance\n */\n/* istanbul ignore next */\nexport class AudioTagInstance extends AudioInstance {\n  public set volume(value: number) {\n    value = Util.clamp(value, 0, 1.0);\n\n    this._volume = value;\n    this._instance.volume = value;\n  }\n  public get volume(): number {\n    return this._volume;\n  }\n\n  protected _src: string;\n  protected _instance: HTMLAudioElement;\n\n  constructor(src: string) {\n    super(src);\n\n    this._instance = new Audio(src);\n  }\n\n  public pause() {\n    if (!this._isPlaying) {\n      return;\n    }\n\n    this._instance.pause();\n    this._isPaused = true;\n    this._isPlaying = false;\n  }\n\n  public stop() {\n    super.stop();\n\n    this._instance.pause();\n    this._instance.currentTime = 0;\n\n    this._handleOnEnded();\n  }\n\n  protected _startPlayBack() {\n    super._startPlayBack();\n\n    this._instance.load();\n    this._instance.loop = this.loop;\n    this._instance.play();\n\n    this._wireUpOnEnded();\n  }\n\n  protected _resumePlayBack() {\n    super._resumePlayBack();\n\n    this._instance.play();\n    this._wireUpOnEnded();\n  }\n\n  protected _handleOnEnded() {\n    this._isPlaying = false;\n    this._isPaused = false;\n    this._playingPromise.resolve(true);\n  }\n}\n\n/**\n * Internal class representing a Web Audio AudioBufferSourceNode instance\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API\n */\n/* istanbul ignore next */\nexport class WebAudioInstance extends AudioInstance {\n  public set volume(value: number) {\n    value = Util.clamp(value, 0, 1.0);\n\n    this._volume = value;\n\n    if (this._volumeNode.gain.setTargetAtTime) {\n      // https://developer.mozilla.org/en-US/docs/Web/API/AudioParam/setTargetAtTime\n      // After each .1 seconds timestep, the target value will ~63.2% closer to the target value.\n      // This exponential ramp provides a more pleasant trasition in gain\n      this._volumeNode.gain.setTargetAtTime(value, this._audioContext.currentTime, 0.1);\n    } else {\n      this._volumeNode.gain.value = value;\n    }\n  }\n  public get volume(): number {\n    return this._volume;\n  }\n\n  private get _playbackRate(): number {\n    return this._instance ? 1 / (this._instance.playbackRate.value || 1.0) : null;\n  }\n\n  protected _src: AudioBuffer;\n  protected _instance: AudioBufferSourceNode;\n  private _audioContext: AudioContext = AudioContextFactory.create();\n  private _volumeNode = this._audioContext.createGain();\n  private _startTime: number;\n\n  /**\n   * Current playback offset (in seconds)\n   */\n  private _currentOffset = 0;\n\n  constructor(_src: AudioBuffer) {\n    super(_src);\n\n    this._createNewBufferSource();\n  }\n\n  public pause() {\n    super.pause();\n\n    this._instance.stop(0);\n    // Playback rate will be a scale factor of how fast/slow the audio is being played\n    // default is 1.0\n    // we need to invert it to get the time scale\n\n    this._setPauseOffset();\n  }\n\n  public stop() {\n    super.stop();\n\n    this._currentOffset = 0;\n    this._instance.stop(0);\n\n    // handler will not be wired up if we were looping\n    if (!this._instance.onended) {\n      this._handleOnEnded();\n    }\n  }\n\n  protected _startPlayBack() {\n    super._startPlayBack();\n\n    if (!this._instance) {\n      this._createNewBufferSource();\n    }\n\n    this._rememberStartTime();\n\n    this._volumeNode.connect(this._audioContext.destination);\n    this._instance.start(0, 0);\n    this._currentOffset = 0;\n\n    this._playingPromise = new Promise<boolean>();\n    this._wireUpOnEnded();\n  }\n\n  protected _resumePlayBack() {\n    super._resumePlayBack();\n\n    // a buffer source can only be started once\n    // so we need to dispose of the previous instance before\n    // \"resuming\" the next one\n    this._instance.onended = null; // dispose of any previous event handler\n    this._createNewBufferSource();\n\n    const duration = this._playbackRate * this._src.duration;\n    const restartTime = this._currentOffset % duration;\n\n    this._rememberStartTime(restartTime * -1000);\n    this._instance.start(0, restartTime);\n    this._wireUpOnEnded();\n  }\n\n  protected _handleOnEnded() {\n    // pausing calls stop(0) which triggers onended event\n    // so we don't \"resolve\" yet (when we resume we'll try again)\n    if (!this._isPaused) {\n      this._isPlaying = false;\n      this._playingPromise.resolve(true);\n    }\n  }\n\n  private _rememberStartTime(amend?: number) {\n    this._startTime = new Date().getTime() + (amend | 0);\n  }\n\n  private _setPauseOffset() {\n    this._currentOffset = ((new Date().getTime() - this._startTime) * this._playbackRate) / 1000; // in seconds\n  }\n\n  private _createNewBufferSource() {\n    this._instance = this._audioContext.createBufferSource();\n    this._instance.buffer = this._src;\n    this._instance.loop = this.loop;\n    this._instance.playbackRate.setValueAtTime(1.0, 0);\n\n    this._instance.connect(this._volumeNode);\n  }\n}\n","export * from './Sound';\nexport * from './AudioContext';\nexport * from './AudioInstance';\n","import { ExResponse } from '../../Interfaces/IAudioImplementation';\nimport { IAudio } from '../../Interfaces/IAudio';\nimport { Engine } from '../../Engine';\nimport { Resource } from '../Resource';\nimport { AudioInstance, AudioInstanceFactory } from './AudioInstance';\nimport { AudioContextFactory } from './AudioContext';\nimport { NativeSoundEvent } from '../../Events/MediaEvents';\nimport { Promise } from '../../Promises';\nimport { canPlayFile } from '../../Util/Sound';\n\n/**\n * The [[Sound]] object allows games built in Excalibur to load audio\n * components, from soundtracks to sound effects. [[Sound]] is an [[ILoadable]]\n * which means it can be passed to a [[Loader]] to pre-load before a game or level.\n *\n * [[include:Sounds.md]]\n */\nexport class Sound extends Resource<Blob | ArrayBuffer> implements IAudio {\n  /**\n   * Indicates whether the clip should loop when complete\n   * @param value  Set the looping flag\n   */\n  public set loop(value: boolean) {\n    this._loop = value;\n\n    for (const track of this._tracks) {\n      track.loop = this._loop;\n    }\n\n    this.logger.debug('Set loop for all instances of sound', this.path, 'to', this._loop);\n  }\n  public get loop(): boolean {\n    return this._loop;\n  }\n\n  public set volume(value: number) {\n    this._volume = value;\n\n    for (const track of this._tracks) {\n      track.volume = this._volume;\n    }\n\n    this.emit('volumechange', new NativeSoundEvent(this));\n\n    this.logger.debug('Set loop for all instances of sound', this.path, 'to', this._volume);\n  }\n  public get volume(): number {\n    return this._volume;\n  }\n\n  /**\n   * Return array of Current AudioInstances playing or being paused\n   */\n  public get instances(): AudioInstance[] {\n    return this._tracks;\n  }\n\n  public path: string;\n\n  private _loop = false;\n  private _volume = 1;\n  private _isPaused = false;\n  private _tracks: AudioInstance[] = [];\n  private _engine: Engine;\n  private _wasPlayingOnHidden: boolean = false;\n  private _processedData = new Promise<string | AudioBuffer>();\n  private _audioContext = AudioContextFactory.create();\n\n  /**\n   * @param paths A list of audio sources (clip.wav, clip.mp3, clip.ogg) for this audio clip. This is done for browser compatibility.\n   */\n  constructor(...paths: string[]) {\n    super('', '');\n\n    this._detectResponseType();\n    /* Chrome : MP3, WAV, Ogg\n         * Firefox : WAV, Ogg,\n         * IE : MP3, WAV coming soon\n         * Safari MP3, WAV, Ogg\n         */\n    for (var path of paths) {\n      if (canPlayFile(path)) {\n        this.path = path;\n        break;\n      }\n    }\n\n    if (!this.path) {\n      this.logger.warn('This browser does not support any of the audio files specified:', paths.join(', '));\n      this.logger.warn('Attempting to use', paths[0]);\n      this.path = paths[0]; // select the first specified\n    }\n  }\n\n  public wireEngine(engine: Engine) {\n    if (engine) {\n      this._engine = engine;\n\n      this._engine.on('hidden', () => {\n        if (engine.pauseAudioWhenHidden && this.isPlaying()) {\n          this._wasPlayingOnHidden = true;\n          this.pause();\n        }\n      });\n\n      this._engine.on('visible', () => {\n        if (engine.pauseAudioWhenHidden && this._wasPlayingOnHidden) {\n          this.play();\n          this._wasPlayingOnHidden = false;\n        }\n      });\n    }\n  }\n\n  /**\n   * Returns how many instances of the sound are currently playing\n   */\n  public instanceCount(): number {\n    return this._tracks.length;\n  }\n\n  /**\n   * Whether or not the sound is playing right now\n   */\n  public isPlaying(): boolean {\n    return this._tracks.some((t) => t.isPlaying());\n  }\n\n  /**\n   * Play the sound, returns a promise that resolves when the sound is done playing\n   * An optional volume argument can be passed in to play the sound. Max volume is 1.0\n   */\n  public play(volume?: number): Promise<boolean> {\n    if (!this.isLoaded()) {\n      this.logger.warn('Cannot start playing. Resource', this.path, 'is not loaded yet');\n\n      return Promise.resolve(true);\n    }\n\n    this.volume = volume || this.volume;\n\n    if (this._isPaused) {\n      return this._resumePlayback();\n    } else {\n      return this._startPlayback();\n    }\n  }\n\n  /**\n   * Stop the sound, and do not rewind\n   */\n  public pause() {\n    if (!this.isPlaying()) {\n      return;\n    }\n\n    for (const track of this._tracks) {\n      track.pause();\n    }\n\n    this._isPaused = true;\n\n    this.emit('pause', new NativeSoundEvent(this));\n\n    this.logger.debug('Paused all instances of sound', this.path);\n  }\n\n  /**\n   * Stop the sound and rewind\n   */\n  public stop() {\n    if (!this.isPlaying()) {\n      return;\n    }\n\n    for (const track of this._tracks) {\n      track.stop();\n    }\n\n    this.emit('stop', new NativeSoundEvent(this));\n\n    this._isPaused = false;\n    this._tracks.length = 0;\n    this.logger.debug('Stopped all instances of sound', this.path);\n  }\n\n  public setData(data: any) {\n    this.emit('emptied', new NativeSoundEvent(this));\n\n    this.data = data;\n    this._processedData = new Promise<string | AudioBuffer>();\n  }\n\n  public processData(data: Blob | ArrayBuffer): Promise<string | AudioBuffer> {\n    /**\n     * Processes raw arraybuffer data and decodes into WebAudio buffer (async).\n     */\n    const processPromise: Promise<string | AudioBuffer> =\n      data instanceof ArrayBuffer ? this._processArrayBufferData(data) : this._processBlobData(data);\n\n    return processPromise.then((processedData) => this._setProcessedData(processedData));\n  }\n\n  /**\n   * Get Id of provided AudioInstance in current trackList\n   * @param track [[AudioInstance]] which Id is to be given\n   */\n  public getTrackId(track: AudioInstance): number {\n    return this._tracks.indexOf(track);\n  }\n\n  private _resumePlayback(): Promise<boolean> {\n    if (this._isPaused) {\n      const resumed = [];\n      // ensure we resume *current* tracks (if paused)\n      for (const track of this._tracks) {\n        resumed.push(track.play());\n      }\n\n      this._isPaused = false;\n\n      this.emit('resume', new NativeSoundEvent(this));\n\n      this.logger.debug('Resuming paused instances for sound', this.path, this._tracks);\n      // resolve when resumed tracks are done\n      return Promise.join(resumed);\n    } else {\n      return Promise.resolve(true);\n    }\n  }\n\n  private _startPlayback(): Promise<boolean> {\n    const newTrack = this._createNewTrack();\n    let playPromise = new Promise<boolean>();\n\n    newTrack.then((track) => {\n      track.play().then((resolved) => {\n        // when done, remove track\n        this.emit('playbackend', new NativeSoundEvent(this, track));\n        this._tracks.splice(this.getTrackId(track), 1);\n\n        playPromise.resolve(resolved);\n\n        return resolved;\n      });\n\n      this.emit('playbackstart', new NativeSoundEvent(this, track));\n      this.logger.debug('Playing new instance for sound', this.path);\n    });\n\n    return playPromise;\n  }\n\n  private _processArrayBufferData(data: ArrayBuffer): Promise<AudioBuffer> {\n    const complete = new Promise<AudioBuffer>();\n\n    this._audioContext.decodeAudioData(\n      data,\n      (buffer: AudioBuffer) => {\n        complete.resolve(buffer);\n      },\n      () => {\n        this.logger.error(\n          'Unable to decode ' +\n            ' this browser may not fully support this format, or the file may be corrupt, ' +\n            'if this is an mp3 try removing id3 tags and album art from the file.'\n        );\n        complete.resolve(undefined);\n      }\n    );\n\n    return complete;\n  }\n\n  private _processBlobData(data: Blob): Promise<string> {\n    return new Promise<string>().resolve(super.processData(data));\n  }\n\n  private _setProcessedData(processedData: string | AudioBuffer): void {\n    this._processedData.resolve(processedData);\n  }\n\n  private _createNewTrack(): Promise<AudioInstance> {\n    const aiPromise = new Promise<AudioInstance>();\n\n    if (this._processedData.state() !== 0) {\n      this.processData(this.data);\n    }\n\n    this._processedData.then(\n      (processedData) => {\n        aiPromise.resolve(this._getTrackInstance(processedData));\n\n        return processedData;\n      },\n      (error) => {\n        this.logger.error(error, 'Cannot create AudioInstance due to wrong processed data.');\n      }\n    );\n\n    return aiPromise;\n  }\n\n  private _getTrackInstance(data: string | AudioBuffer): AudioInstance {\n    const newTrack = AudioInstanceFactory.create(data);\n\n    newTrack.loop = this.loop;\n    newTrack.volume = this.volume;\n\n    this._tracks.push(newTrack);\n\n    return newTrack;\n  }\n\n  private _detectResponseType() {\n    if ((<any>window).AudioContext) {\n      this.responseType = ExResponse.type.arraybuffer;\n    } else {\n      this.responseType = ExResponse.type.blob;\n    }\n  }\n}\n","import { Resource } from './Resource';\nimport { Promise } from '../Promises';\nimport { Sprite } from '../Drawing/Sprite';\n\n/**\n * The [[Texture]] object allows games built in Excalibur to load image resources.\n * [[Texture]] is an [[ILoadable]] which means it can be passed to a [[Loader]]\n * to pre-load before starting a level or game.\n *\n * [[include:Textures.md]]\n */\nexport class Texture extends Resource<HTMLImageElement> {\n  /**\n   * The width of the texture in pixels\n   */\n  public width: number;\n\n  /**\n   * The height of the texture in pixels\n   */\n  public height: number;\n\n  /**\n   * A [[Promise]] that resolves when the Texture is loaded.\n   */\n  public loaded: Promise<any> = new Promise<any>();\n\n  private _isLoaded: boolean = false;\n  private _sprite: Sprite = null;\n\n  /**\n   * Populated once loading is complete\n   */\n  public image: HTMLImageElement;\n\n  /**\n   * @param path       Path to the image resource\n   * @param bustCache  Optionally load texture with cache busting\n   */\n  constructor(public path: string, public bustCache = true) {\n    super(path, 'blob', bustCache);\n    this._sprite = new Sprite(this, 0, 0, 0, 0);\n  }\n\n  /**\n   * Returns true if the Texture is completely loaded and is ready\n   * to be drawn.\n   */\n  public isLoaded(): boolean {\n    return this._isLoaded;\n  }\n\n  /**\n   * Begins loading the texture and returns a promise to be resolved on completion\n   */\n  public load(): Promise<HTMLImageElement> {\n    var complete = new Promise<HTMLImageElement>();\n\n    var loaded = super.load();\n    loaded.then(\n      () => {\n        this.image = new Image();\n        this.image.addEventListener('load', () => {\n          this._isLoaded = true;\n          this.width = this._sprite.width = this.image.naturalWidth;\n          this.height = this._sprite.height = this.image.naturalHeight;\n          this.loaded.resolve(this.image);\n          complete.resolve(this.image);\n        });\n        this.image.src = super.getData();\n      },\n      () => {\n        complete.reject('Error loading texture.');\n      }\n    );\n    return complete;\n  }\n\n  public asSprite(): Sprite {\n    return this._sprite;\n  }\n}\n","import { UIActor } from './UIActor';\nimport { Physics } from './Physics';\nimport {\n  InitializeEvent,\n  ActivateEvent,\n  DeactivateEvent,\n  PreUpdateEvent,\n  PostUpdateEvent,\n  PreDrawEvent,\n  PostDrawEvent,\n  PreDebugDrawEvent,\n  PostDebugDrawEvent,\n  GameEvent\n} from './Events';\nimport { Logger } from './Util/Log';\nimport { Timer } from './Timer';\nimport { DynamicTreeCollisionBroadphase } from './Collision/DynamicTreeCollisionBroadphase';\nimport { ICollisionBroadphase } from './Collision/ICollisionResolver';\nimport { SortedList } from './Util/SortedList';\nimport { Engine } from './Engine';\nimport { Group } from './Group';\nimport { TileMap } from './TileMap';\nimport { BaseCamera } from './Camera';\nimport { Actor } from './Actor';\nimport { Class } from './Class';\nimport { ICanInitialize, ICanActivate, ICanDeactivate, ICanUpdate, ICanDraw } from './Interfaces/LifecycleEvents';\nimport * as Util from './Util/Util';\nimport * as Events from './Events';\nimport * as ActorUtils from './Util/Actors';\nimport { Trigger } from './Trigger';\n/**\n * [[Actor|Actors]] are composed together into groupings called Scenes in\n * Excalibur. The metaphor models the same idea behind real world\n * actors in a scene. Only actors in scenes will be updated and drawn.\n *\n * Typical usages of a scene include: levels, menus, loading screens, etc.\n *\n * [[include:Scenes.md]]\n */\nexport class Scene extends Class implements ICanInitialize, ICanActivate, ICanDeactivate, ICanUpdate, ICanDraw {\n  /**\n   * Gets or sets the current camera for the scene\n   */\n  public camera: BaseCamera;\n\n  /**\n   * The actors in the current scene\n   */\n  public actors: Actor[] = [];\n\n  /**\n   * The triggers in the current scene\n   */\n  public triggers: Trigger[] = [];\n\n  /**\n   * The [[TileMap]]s in the scene, if any\n   */\n  public tileMaps: TileMap[] = [];\n\n  /**\n   * The [[Group]]s in the scene, if any\n   */\n  public groups: { [key: string]: Group } = {};\n\n  /**\n   * Access to the Excalibur engine\n   */\n  public engine: Engine;\n\n  /**\n   * The [[UIActor]]s in a scene, if any; these are drawn last\n   */\n  public uiActors: Actor[] = [];\n\n  private _isInitialized: boolean = false;\n\n  private _sortedDrawingTree: SortedList<Actor> = new SortedList<Actor>(Actor.prototype.getZIndex);\n\n  private _broadphase: ICollisionBroadphase = new DynamicTreeCollisionBroadphase();\n\n  private _killQueue: Actor[] = [];\n  private _triggerKillQueue: Trigger[] = [];\n  private _timers: Timer[] = [];\n  private _cancelQueue: Timer[] = [];\n  private _logger: Logger = Logger.getInstance();\n\n  constructor(engine?: Engine) {\n    super();\n    this.camera = new BaseCamera();\n    if (engine) {\n      this.camera.x = engine.halfDrawWidth;\n      this.camera.y = engine.halfDrawHeight;\n    }\n  }\n\n  public on(eventName: Events.initialize, handler: (event?: InitializeEvent) => void): void;\n  public on(eventName: Events.activate, handler: (event?: ActivateEvent) => void): void;\n  public on(eventName: Events.deactivate, handler: (event?: DeactivateEvent) => void): void;\n  public on(eventName: Events.preupdate, handler: (event?: PreUpdateEvent) => void): void;\n  public on(eventName: Events.postupdate, handler: (event?: PostUpdateEvent) => void): void;\n  public on(eventName: Events.predraw, handler: (event?: PreDrawEvent) => void): void;\n  public on(eventName: Events.postdraw, handler: (event?: PostDrawEvent) => void): void;\n  public on(eventName: Events.predebugdraw, handler: (event?: PreDebugDrawEvent) => void): void;\n  public on(eventName: Events.postdebugdraw, handler: (event?: PostDebugDrawEvent) => void): void;\n  public on(eventName: string, handler: (event?: GameEvent<any>) => void): void;\n  public on(eventName: string, handler: (event?: any) => void): void {\n    super.on(eventName, handler);\n  }\n\n  public once(eventName: Events.initialize, handler: (event?: InitializeEvent) => void): void;\n  public once(eventName: Events.activate, handler: (event?: ActivateEvent) => void): void;\n  public once(eventName: Events.deactivate, handler: (event?: DeactivateEvent) => void): void;\n  public once(eventName: Events.preupdate, handler: (event?: PreUpdateEvent) => void): void;\n  public once(eventName: Events.postupdate, handler: (event?: PostUpdateEvent) => void): void;\n  public once(eventName: Events.predraw, handler: (event?: PreDrawEvent) => void): void;\n  public once(eventName: Events.postdraw, handler: (event?: PostDrawEvent) => void): void;\n  public once(eventName: Events.predebugdraw, handler: (event?: PreDebugDrawEvent) => void): void;\n  public once(eventName: Events.postdebugdraw, handler: (event?: PostDebugDrawEvent) => void): void;\n  public once(eventName: string, handler: (event?: GameEvent<any>) => void): void;\n  public once(eventName: string, handler: (event?: any) => void): void {\n    super.once(eventName, handler);\n  }\n\n  public off(eventName: Events.initialize, handler?: (event?: InitializeEvent) => void): void;\n  public off(eventName: Events.activate, handler?: (event?: ActivateEvent) => void): void;\n  public off(eventName: Events.deactivate, handler?: (event?: DeactivateEvent) => void): void;\n  public off(eventName: Events.preupdate, handler?: (event?: PreUpdateEvent) => void): void;\n  public off(eventName: Events.postupdate, handler?: (event?: PostUpdateEvent) => void): void;\n  public off(eventName: Events.predraw, handler?: (event?: PreDrawEvent) => void): void;\n  public off(eventName: Events.postdraw, handler?: (event?: PostDrawEvent) => void): void;\n  public off(eventName: Events.predebugdraw, handler?: (event?: PreDebugDrawEvent) => void): void;\n  public off(eventName: Events.postdebugdraw, handler?: (event?: PostDebugDrawEvent) => void): void;\n  public off(eventName: string, handler?: (event?: GameEvent<any>) => void): void;\n  public off(eventName: string, handler?: (event?: any) => void): void {\n    super.off(eventName, handler);\n  }\n\n  /**\n   * This is called before the first update of the [[Scene]]. Initializes scene members like the camera. This method is meant to be\n   * overridden. This is where initialization of child actors should take place.\n   */\n  public onInitialize(_engine: Engine): void {\n    // will be overridden\n  }\n\n  /**\n   * This is called when the scene is made active and started. It is meant to be overriden,\n   * this is where you should setup any DOM UI or event handlers needed for the scene.\n   */\n  public onActivate(_oldScene: Scene, _newScene: Scene): void {\n    // will be overridden\n  }\n\n  /**\n   * This is called when the scene is made transitioned away from and stopped. It is meant to be overriden,\n   * this is where you should cleanup any DOM UI or event handlers needed for the scene.\n   */\n  public onDeactivate(_oldScene: Scene, _newScene: Scene): void {\n    // will be overridden\n  }\n\n  /**\n   * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n   *\n   * `onPreUpdate` is called directly before a scene is updated.\n   */\n  public onPreUpdate(_engine: Engine, _delta: number): void {\n    // will be overridden\n  }\n\n  /**\n   * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n   *\n   * `onPostUpdate` is called directly after a scene is updated.\n   */\n  public onPostUpdate(_engine: Engine, _delta: number): void {\n    // will be overridden\n  }\n\n  /**\n   * Safe to override onPreDraw lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n   *\n   * `onPreDraw` is called directly before a scene is drawn.\n   */\n  public onPreDraw(_ctx: CanvasRenderingContext2D, _delta: number): void {\n    // will be overridden\n  }\n\n  /**\n   * Safe to override onPostDraw lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\n   *\n   * `onPostDraw` is called directly after a scene is drawn.\n   */\n  public onPostDraw(_ctx: CanvasRenderingContext2D, _delta: number): void {\n    // will be overridden\n  }\n\n  /**\n   * Initializes actors in the scene\n   */\n  private _initializeChildren(): void {\n    for (var child of this.actors) {\n      child._initialize(this.engine);\n    }\n  }\n\n  /**\n   * Gets whether or not the [[Scene]] has been initialized\n   */\n  public get isInitialized(): boolean {\n    return this._isInitialized;\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overriden, do so at your own risk.\n   *\n   * Initializes the scene before the first update, meant to be called by engine not by users of\n   * Excalibur\n   * @internal\n   */\n  public _initialize(engine: Engine) {\n    if (!this.isInitialized) {\n      if (this.camera) {\n        this.camera.x = engine.halfDrawWidth;\n        this.camera.y = engine.halfDrawHeight;\n      }\n\n      this._initializeChildren();\n\n      this._logger.debug('Scene.onInitialize', this, engine);\n\n      this.eventDispatcher.emit('initialize', new InitializeEvent(engine, this));\n      this.onInitialize.call(this, engine);\n      this._isInitialized = true;\n    }\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overriden, do so at your own risk.\n   *\n   * Activates the scene with the base behavior, then calls the overridable `onActivate` implementation.\n   * @internal\n   */\n  public _activate(oldScene: Scene, newScene: Scene): void {\n    this._logger.debug('Scene.onActivate', this);\n    this.onActivate(oldScene, newScene);\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overriden, do so at your own risk.\n   *\n   * Deactivates the scene with the base behavior, then calls the overridable `onDeactivate` implementation.\n   * @internal\n   */\n  public _deactivate(oldScene: Scene, newScene: Scene): void {\n    this._logger.debug('Scene.onDectivate', this);\n    this.onDeactivate(oldScene, newScene);\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overriden, do so at your own risk.\n   *\n   * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\n   * @internal\n   */\n  public _preupdate(_engine: Engine, delta: number): void {\n    this.emit('preupdate', new PreUpdateEvent(_engine, delta, this));\n    this.onPreUpdate(_engine, delta);\n  }\n\n  /**\n   *  It is not recommended that internal excalibur methods be overriden, do so at your own risk.\n   *\n   * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\n   * @internal\n   */\n  public _postupdate(_engine: Engine, delta: number): void {\n    this.emit('postupdate', new PostUpdateEvent(_engine, delta, this));\n    this.onPostUpdate(_engine, delta);\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overriden, do so at your own risk.\n   *\n   * Internal _predraw handler for [[onPreDraw]] lifecycle event\n   *\n   * @internal\n   */\n  public _predraw(_ctx: CanvasRenderingContext2D, _delta: number): void {\n    this.emit('predraw', new PreDrawEvent(_ctx, _delta, this));\n    this.onPreDraw(_ctx, _delta);\n  }\n\n  /**\n   * It is not recommended that internal excalibur methods be overriden, do so at your own risk.\n   *\n   * Internal _postdraw handler for [[onPostDraw]] lifecycle event\n   *\n   * @internal\n   */\n  public _postdraw(_ctx: CanvasRenderingContext2D, _delta: number): void {\n    this.emit('postdraw', new PostDrawEvent(_ctx, _delta, this));\n    this.onPostDraw(_ctx, _delta);\n  }\n\n  /**\n   * Updates all the actors and timers in the scene. Called by the [[Engine]].\n   * @param engine  Reference to the current Engine\n   * @param delta   The number of milliseconds since the last update\n   */\n  public update(engine: Engine, delta: number) {\n    this._preupdate(engine, delta);\n    var i: number, len: number;\n    // Remove timers in the cancel queue before updating them\n    for (i = 0, len = this._cancelQueue.length; i < len; i++) {\n      this.removeTimer(this._cancelQueue[i]);\n    }\n    this._cancelQueue.length = 0;\n\n    // Cycle through timers updating timers\n    for (var timer of this._timers) {\n      timer.update(delta);\n    }\n\n    // Cycle through actors updating UI actors\n    for (i = 0, len = this.uiActors.length; i < len; i++) {\n      this.uiActors[i].update(engine, delta);\n    }\n\n    // Cycle through actors updating tile maps\n    for (i = 0, len = this.tileMaps.length; i < len; i++) {\n      this.tileMaps[i].update(engine, delta);\n    }\n\n    // Cycle through actors updating actors\n    for (i = 0, len = this.actors.length; i < len; i++) {\n      this.actors[i].update(engine, delta);\n    }\n\n    // Cycle through triggers updating\n    for (i = 0, len = this.triggers.length; i < len; i++) {\n      this.triggers[i].update(engine, delta);\n    }\n\n    this._collectActorStats(engine);\n\n    // propagates all events through their paths assigned\n    engine.input.pointers.propagate();\n\n    // Run the broadphase and narrowphase\n    if (this._broadphase && Physics.enabled) {\n      var beforeBroadphase = Date.now();\n      this._broadphase.update(this.actors, delta);\n      var pairs = this._broadphase.broadphase(this.actors, delta, engine.stats.currFrame);\n      var afterBroadphase = Date.now();\n\n      var beforeNarrowphase = Date.now();\n      var iter: number = Physics.collisionPasses;\n      var collisionDelta = delta / iter;\n      while (iter > 0) {\n        // Run the narrowphase\n        pairs = this._broadphase.narrowphase(pairs, engine.stats.currFrame);\n        // Run collision resolution strategy\n        pairs = this._broadphase.resolve(pairs, collisionDelta, Physics.collisionResolutionStrategy);\n\n        this._broadphase.runCollisionStartEnd(pairs);\n\n        iter--;\n      }\n\n      var afterNarrowphase = Date.now();\n      engine.stats.currFrame.physics.broadphase = afterBroadphase - beforeBroadphase;\n      engine.stats.currFrame.physics.narrowphase = afterNarrowphase - beforeNarrowphase;\n    }\n\n    engine.stats.currFrame.actors.killed = this._killQueue.length + this._triggerKillQueue.length;\n\n    this._processKillQueue(this._killQueue, this.actors);\n    this._processKillQueue(this._triggerKillQueue, this.triggers);\n\n    if (this.camera) {\n      this.camera.update(engine, delta);\n    }\n\n    this._postupdate(engine, delta);\n  }\n\n  private _processKillQueue(killQueue: Actor[], collection: Actor[]) {\n    // Remove actors from scene graph after being killed\n    var actorIndex: number;\n    for (let killed of killQueue) {\n      //don't remove actors that were readded during the same frame they were killed\n      if (killed.isKilled()) {\n        actorIndex = collection.indexOf(killed);\n        if (actorIndex > -1) {\n          this._sortedDrawingTree.removeByComparable(killed);\n          collection.splice(actorIndex, 1);\n        }\n      }\n    }\n    killQueue.length = 0;\n  }\n\n  /**\n   * Draws all the actors in the Scene. Called by the [[Engine]].\n   * @param ctx    The current rendering context\n   * @param delta  The number of milliseconds since the last draw\n   */\n  public draw(ctx: CanvasRenderingContext2D, delta: number) {\n    this._predraw(ctx, delta);\n    ctx.save();\n\n    if (this.camera) {\n      this.camera.draw(ctx);\n    }\n\n    var i: number, len: number;\n\n    for (i = 0, len = this.tileMaps.length; i < len; i++) {\n      this.tileMaps[i].draw(ctx, delta);\n    }\n\n    var sortedChildren = this._sortedDrawingTree.list();\n    for (i = 0, len = sortedChildren.length; i < len; i++) {\n      // only draw actors that are visible and on screen\n      if (sortedChildren[i].visible && !sortedChildren[i].isOffScreen) {\n        sortedChildren[i].draw(ctx, delta);\n      }\n    }\n\n    if (this.engine && this.engine.isDebug) {\n      ctx.strokeStyle = 'yellow';\n      this.debugDraw(ctx);\n    }\n\n    ctx.restore();\n\n    for (i = 0, len = this.uiActors.length; i < len; i++) {\n      // only draw ui actors that are visible and on screen\n      if (this.uiActors[i].visible) {\n        this.uiActors[i].draw(ctx, delta);\n      }\n    }\n\n    if (this.engine && this.engine.isDebug) {\n      for (i = 0, len = this.uiActors.length; i < len; i++) {\n        this.uiActors[i].debugDraw(ctx);\n      }\n    }\n    this._postdraw(ctx, delta);\n  }\n\n  /**\n   * Draws all the actors' debug information in the Scene. Called by the [[Engine]].\n   * @param ctx  The current rendering context\n   */\n  /* istanbul ignore next */\n  public debugDraw(ctx: CanvasRenderingContext2D) {\n    this.emit('predebugdraw', new PreDebugDrawEvent(ctx, this));\n\n    var i: number, len: number;\n\n    for (i = 0, len = this.tileMaps.length; i < len; i++) {\n      this.tileMaps[i].debugDraw(ctx);\n    }\n\n    for (i = 0, len = this.actors.length; i < len; i++) {\n      this.actors[i].debugDraw(ctx);\n    }\n\n    for (i = 0, len = this.triggers.length; i < len; i++) {\n      this.triggers[i].debugDraw(ctx);\n    }\n\n    this._broadphase.debugDraw(ctx, 20);\n\n    this.camera.debugDraw(ctx);\n    this.emit('postdebugdraw', new PostDebugDrawEvent(ctx, this));\n  }\n\n  /**\n   * Checks whether an actor is contained in this scene or not\n   */\n  public contains(actor: Actor): boolean {\n    return this.actors.indexOf(actor) > -1;\n  }\n\n  /**\n   * Adds a [[Timer]] to the current [[Scene]].\n   * @param timer  The timer to add to the current [[Scene]].\n   */\n  public add(timer: Timer): void;\n\n  /**\n   * Adds a [[TileMap]] to the [[Scene]], once this is done the [[TileMap]] will be drawn and updated.\n   */\n  public add(tileMap: TileMap): void;\n\n  /**\n   * Adds a [[Trigger]] to the [[Scene]], once this is done the [[Trigger]] will listen for interactions with other actors.\n   * @param trigger\n   */\n  public add(trigger: Trigger): void;\n\n  /**\n   * Adds an actor to the scene, once this is done the [[Actor]] will be drawn and updated.\n   * @param actor  The actor to add to the current scene\n   */\n  public add(actor: Actor): void;\n\n  /**\n   * Adds a [[UIActor]] to the scene.\n   * @param uiActor  The UIActor to add to the current scene\n   */\n  public add(uiActor: UIActor): void;\n  public add(entity: any): void {\n    if (entity instanceof Actor) {\n      (<Actor>entity).unkill();\n    }\n    if (entity instanceof UIActor) {\n      if (!Util.contains(this.uiActors, entity)) {\n        this.addUIActor(entity);\n      }\n      return;\n    }\n\n    if (entity instanceof Actor) {\n      if (!Util.contains(this.actors, entity)) {\n        this._addChild(entity);\n      }\n      return;\n    }\n    if (entity instanceof Timer) {\n      if (!Util.contains(this._timers, entity)) {\n        this.addTimer(entity);\n      }\n      return;\n    }\n    if (entity instanceof TileMap) {\n      if (!Util.contains(this.tileMaps, entity)) {\n        this.addTileMap(entity);\n      }\n    }\n  }\n\n  /**\n   * Removes a [[Timer]] from the current scene, it will no longer be updated.\n   * @param timer  The timer to remove to the current scene.\n   */\n  public remove(timer: Timer): void;\n\n  /**\n   * Removes a [[TileMap]] from the scene, it will no longer be drawn or updated.\n   * @param tileMap {TileMap}\n   */\n  public remove(tileMap: TileMap): void;\n\n  /**\n   * Removes an actor from the scene, it will no longer be drawn or updated.\n   * @param actor  The actor to remove from the current scene.\n   */\n  public remove(actor: Actor): void;\n\n  /**\n   * Removes a [[UIActor]] to the scene, it will no longer be drawn or updated\n   * @param uiActor  The UIActor to remove from the current scene\n   */\n  public remove(uiActor: UIActor): void;\n  public remove(entity: any): void {\n    if (entity instanceof UIActor) {\n      this.removeUIActor(entity);\n      return;\n    }\n\n    if (entity instanceof Actor) {\n      this._removeChild(entity);\n    }\n    if (entity instanceof Timer) {\n      this.removeTimer(entity);\n    }\n\n    if (entity instanceof TileMap) {\n      this.removeTileMap(entity);\n    }\n  }\n\n  /**\n   * Adds (any) actor to act as a piece of UI, meaning it is always positioned\n   * in screen coordinates. UI actors do not participate in collisions.\n   * @todo Should this be `UIActor` only?\n   */\n  public addUIActor(actor: Actor) {\n    this.uiActors.push(actor);\n    actor.scene = this;\n  }\n\n  /**\n   * Removes an actor as a piece of UI\n   */\n  public removeUIActor(actor: Actor) {\n    var index = this.uiActors.indexOf(actor);\n    if (index > -1) {\n      this.uiActors.splice(index, 1);\n    }\n  }\n\n  /**\n   * Adds an actor to the scene, once this is done the actor will be drawn and updated.\n   */\n  protected _addChild(actor: Actor) {\n    this._broadphase.track(actor.body);\n    actor.scene = this;\n    if (actor instanceof Trigger) {\n      this.triggers.push(actor);\n    } else {\n      this.actors.push(actor);\n    }\n\n    this._sortedDrawingTree.add(actor);\n  }\n\n  /**\n   * Adds a [[TileMap]] to the scene, once this is done the TileMap will be drawn and updated.\n   */\n  public addTileMap(tileMap: TileMap) {\n    this.tileMaps.push(tileMap);\n  }\n\n  /**\n   * Removes a [[TileMap]] from the scene, it will no longer be drawn or updated.\n   */\n  public removeTileMap(tileMap: TileMap) {\n    var index = this.tileMaps.indexOf(tileMap);\n    if (index > -1) {\n      this.tileMaps.splice(index, 1);\n    }\n  }\n\n  /**\n   * Removes an actor from the scene, it will no longer be drawn or updated.\n   */\n  protected _removeChild(actor: Actor) {\n    if (!Util.contains(this.actors, actor)) {\n      return;\n    }\n    this._broadphase.untrack(actor.body);\n    if (actor instanceof Trigger) {\n      this._triggerKillQueue.push(actor);\n    } else {\n      if (!actor.isKilled()) {\n        actor.kill();\n      }\n      this._killQueue.push(actor);\n    }\n\n    actor.parent = null;\n  }\n\n  /**\n   * Adds a [[Timer]] to the scene\n   * @param timer  The timer to add\n   */\n  public addTimer(timer: Timer): Timer {\n    this._timers.push(timer);\n    timer.scene = this;\n    return timer;\n  }\n\n  /**\n   * Removes a [[Timer]] from the scene.\n   * @warning Can be dangerous, use [[cancelTimer]] instead\n   * @param timer  The timer to remove\n   */\n  public removeTimer(timer: Timer): Timer {\n    var i = this._timers.indexOf(timer);\n    if (i !== -1) {\n      this._timers.splice(i, 1);\n    }\n    return timer;\n  }\n\n  /**\n   * Cancels a [[Timer]], removing it from the scene nicely\n   * @param timer  The timer to cancel\n   */\n  public cancelTimer(timer: Timer): Timer {\n    this._cancelQueue.push(timer);\n    return timer;\n  }\n\n  /**\n   * Tests whether a [[Timer]] is active in the scene\n   */\n  public isTimerActive(timer: Timer): boolean {\n    return this._timers.indexOf(timer) > -1 && !timer.complete;\n  }\n\n  /**\n   * Creates and adds a [[Group]] to the scene with a name\n   */\n  public createGroup(name: string): Group {\n    return new Group(name, this);\n  }\n\n  /**\n   * Returns a [[Group]] by name\n   */\n  public getGroup(name: string): Group {\n    return this.groups[name];\n  }\n\n  /**\n   * Removes a [[Group]] by name\n   */\n  public removeGroup(name: string): void;\n\n  /**\n   * Removes a [[Group]] by reference\n   */\n  public removeGroup(group: Group): void;\n  public removeGroup(group: any): void {\n    if (typeof group === 'string') {\n      delete this.groups[group];\n    } else if (group instanceof Group) {\n      delete this.groups[group.name];\n    } else {\n      this._logger.error('Invalid arguments to removeGroup', group);\n    }\n  }\n\n  /**\n   * Removes the given actor from the sorted drawing tree\n   */\n  public cleanupDrawTree(actor: Actor) {\n    this._sortedDrawingTree.removeByComparable(actor);\n  }\n\n  /**\n   * Updates the given actor's position in the sorted drawing tree\n   */\n  public updateDrawTree(actor: Actor) {\n    this._sortedDrawingTree.add(actor);\n  }\n\n  /**\n   * Checks if an actor is in this scene's sorted draw tree\n   */\n  public isActorInDrawTree(actor: Actor): boolean {\n    return this._sortedDrawingTree.find(actor);\n  }\n\n  public isCurrentScene(): boolean {\n    if (this.engine) {\n      return this.engine.currentScene === this;\n    }\n    return false;\n  }\n\n  private _collectActorStats(engine: Engine) {\n    for (var _ui of this.uiActors) {\n      engine.stats.currFrame.actors.ui++;\n    }\n\n    for (var actor of this.actors) {\n      engine.stats.currFrame.actors.alive++;\n      for (var child of actor.children) {\n        if (ActorUtils.isUIActor(child)) {\n          engine.stats.currFrame.actors.ui++;\n        } else {\n          engine.stats.currFrame.actors.alive++;\n        }\n      }\n    }\n  }\n}\n","import { BoundingBox } from './Collision/BoundingBox';\nimport { Color } from './Drawing/Color';\nimport { Class } from './Class';\nimport { Engine } from './Engine';\nimport { Vector } from './Algebra';\nimport { Actor } from './Actor';\nimport { Logger } from './Util/Log';\nimport { SpriteSheet } from './Drawing/SpriteSheet';\nimport * as Events from './Events';\nimport { Configurable } from './Configurable';\n\n/**\n * @hidden\n */\nexport class TileMapImpl extends Class {\n  private _collidingX: number = -1;\n  private _collidingY: number = -1;\n  private _onScreenXStart: number = 0;\n  private _onScreenXEnd: number = 9999;\n  private _onScreenYStart: number = 0;\n  private _onScreenYEnd: number = 9999;\n  private _spriteSheets: { [key: string]: SpriteSheet } = {};\n  public logger: Logger = Logger.getInstance();\n  public data: Cell[] = [];\n  public x: number;\n  public y: number;\n  public cellWidth: number;\n  public cellHeight: number;\n  public rows: number;\n  public cols: number;\n\n  public on(eventName: Events.preupdate, handler: (event?: Events.PreUpdateEvent) => void): void;\n  public on(eventName: Events.postupdate, handler: (event?: Events.PostUpdateEvent) => void): void;\n  public on(eventName: Events.predraw, handler: (event?: Events.PreDrawEvent) => void): void;\n  public on(eventName: Events.postdraw, handler: (event?: Events.PostDrawEvent) => void): void;\n  public on(eventName: string, handler: (event?: Events.GameEvent<any>) => void): void;\n  public on(eventName: string, handler: (event?: any) => void): void {\n    super.on(eventName, handler);\n  }\n\n  /**\n   * @param x             The x coordinate to anchor the TileMap's upper left corner (should not be changed once set)\n   * @param y             The y coordinate to anchor the TileMap's upper left corner (should not be changed once set)\n   * @param cellWidth     The individual width of each cell (in pixels) (should not be changed once set)\n   * @param cellHeight    The individual height of each cell (in pixels) (should not be changed once set)\n   * @param rows          The number of rows in the TileMap (should not be changed once set)\n   * @param cols          The number of cols in the TileMap (should not be changed once set)\n   */\n  constructor(xOrConfig: number | ITileMapArgs, y: number, cellWidth: number, cellHeight: number, rows: number, cols: number) {\n    super();\n    if (xOrConfig && typeof xOrConfig === 'object') {\n      var config = xOrConfig;\n      xOrConfig = config.x;\n      y = config.y;\n      cellWidth = config.cellWidth;\n      cellHeight = config.cellHeight;\n      rows = config.rows;\n      cols = config.cols;\n    }\n    this.x = <number>xOrConfig;\n    this.y = y;\n    this.cellWidth = cellWidth;\n    this.cellHeight = cellHeight;\n    this.rows = rows;\n    this.cols = cols;\n    this.data = new Array<Cell>(rows * cols);\n    for (var i = 0; i < cols; i++) {\n      for (var j = 0; j < rows; j++) {\n        (() => {\n          var cd = new Cell(i * cellWidth + <number>xOrConfig, j * cellHeight + y, cellWidth, cellHeight, i + j * cols);\n          this.data[i + j * cols] = cd;\n        })();\n      }\n    }\n  }\n\n  public registerSpriteSheet(key: string, spriteSheet: SpriteSheet) {\n    this._spriteSheets[key] = spriteSheet;\n  }\n  /**\n   * Returns the intersection vector that can be used to resolve collisions with actors. If there\n   * is no collision null is returned.\n   */\n  public collides(actor: Actor): Vector {\n    var width = actor.pos.x + actor.getWidth();\n    var height = actor.pos.y + actor.getHeight();\n    var actorBounds = actor.getBounds();\n    var overlaps: Vector[] = [];\n    // trace points for overlap\n    for (var x = actorBounds.left; x <= width; x += Math.min(actor.getWidth() / 2, this.cellWidth / 2)) {\n      for (var y = actorBounds.top; y <= height; y += Math.min(actor.getHeight() / 2, this.cellHeight / 2)) {\n        var cell = this.getCellByPoint(x, y);\n        if (cell && cell.solid) {\n          var overlap = actorBounds.collides(cell.getBounds());\n          var dir = actor.getCenter().sub(cell.getCenter());\n          if (overlap && overlap.dot(dir) > 0) {\n            overlaps.push(overlap);\n          }\n        }\n      }\n    }\n    if (overlaps.length === 0) {\n      return null;\n    }\n    // Return the smallest change other than zero\n    var result = overlaps.reduce((accum, next) => {\n      var x = accum.x;\n      var y = accum.y;\n      if (Math.abs(accum.x) < Math.abs(next.x)) {\n        x = next.x;\n      }\n      if (Math.abs(accum.y) < Math.abs(next.y)) {\n        y = next.y;\n      }\n      return new Vector(x, y);\n    });\n    return result;\n  }\n\n  /**\n   * Returns the [[Cell]] by index (row major order)\n   */\n  public getCellByIndex(index: number): Cell {\n    return this.data[index];\n  }\n  /**\n   * Returns the [[Cell]] by its x and y coordinates\n   */\n  public getCell(x: number, y: number): Cell {\n    if (x < 0 || y < 0 || x >= this.cols || y >= this.rows) {\n      return null;\n    }\n    return this.data[x + y * this.cols];\n  }\n  /**\n   * Returns the [[Cell]] by testing a point in global coordinates,\n   * returns `null` if no cell was found.\n   */\n  public getCellByPoint(x: number, y: number): Cell {\n    x = Math.floor((x - this.x) / this.cellWidth);\n    y = Math.floor((y - this.y) / this.cellHeight);\n    var cell = this.getCell(x, y);\n    if (x >= 0 && y >= 0 && x < this.cols && y < this.rows && cell) {\n      return cell;\n    }\n    return null;\n  }\n\n  public update(engine: Engine, delta: number) {\n    this.emit('preupdate', new Events.PreUpdateEvent(engine, delta, this));\n\n    var worldCoordsUpperLeft = engine.screenToWorldCoordinates(new Vector(0, 0));\n    var worldCoordsLowerRight = engine.screenToWorldCoordinates(new Vector(engine.canvas.clientWidth, engine.canvas.clientHeight));\n\n    this._onScreenXStart = Math.max(Math.floor((worldCoordsUpperLeft.x - this.x) / this.cellWidth) - 2, 0);\n    this._onScreenYStart = Math.max(Math.floor((worldCoordsUpperLeft.y - this.y) / this.cellHeight) - 2, 0);\n    this._onScreenXEnd = Math.max(Math.floor((worldCoordsLowerRight.x - this.x) / this.cellWidth) + 2, 0);\n    this._onScreenYEnd = Math.max(Math.floor((worldCoordsLowerRight.y - this.y) / this.cellHeight) + 2, 0);\n\n    this.emit('postupdate', new Events.PostUpdateEvent(engine, delta, this));\n  }\n\n  /**\n   * Draws the tile map to the screen. Called by the [[Scene]].\n   * @param ctx    The current rendering context\n   * @param delta  The number of milliseconds since the last draw\n   */\n  public draw(ctx: CanvasRenderingContext2D, delta: number) {\n    this.emit('predraw', new Events.PreDrawEvent(ctx, delta, this));\n\n    ctx.save();\n    ctx.translate(this.x, this.y);\n\n    let x = this._onScreenXStart;\n    let xEnd = Math.min(this._onScreenXEnd, this.cols);\n    let y = this._onScreenYStart;\n    let yEnd = Math.min(this._onScreenYEnd, this.rows);\n\n    var cs: TileSprite[], csi: number, cslen: number;\n\n    for (x; x < xEnd; x++) {\n      for (y; y < yEnd; y++) {\n        // get non-negative tile sprites\n        cs = this.getCell(x, y).sprites.filter((s) => {\n          return s.spriteId > -1;\n        });\n\n        for (csi = 0, cslen = cs.length; csi < cslen; csi++) {\n          var ss = this._spriteSheets[cs[csi].spriteSheetKey];\n\n          // draw sprite, warning if sprite doesn't exist\n          if (ss) {\n            var sprite = ss.getSprite(cs[csi].spriteId);\n            if (sprite) {\n              sprite.draw(ctx, x * this.cellWidth, y * this.cellHeight);\n            } else {\n              this.logger.warn('Sprite does not exist for id', cs[csi].spriteId, 'in sprite sheet', cs[csi].spriteSheetKey, sprite, ss);\n            }\n          } else {\n            this.logger.warn('Sprite sheet', cs[csi].spriteSheetKey, 'does not exist', ss);\n          }\n        }\n      }\n      y = this._onScreenYStart;\n    }\n    ctx.restore();\n\n    this.emit('postdraw', new Events.PostDrawEvent(ctx, delta, this));\n  }\n\n  /**\n   * Draws all the tile map's debug info. Called by the [[Scene]].\n   * @param ctx  The current rendering context\n   */\n  public debugDraw(ctx: CanvasRenderingContext2D) {\n    var width = this.cols * this.cellWidth;\n    var height = this.rows * this.cellHeight;\n    ctx.save();\n    ctx.strokeStyle = Color.Red.toString();\n    for (var x = 0; x < this.cols + 1; x++) {\n      ctx.beginPath();\n      ctx.moveTo(this.x + x * this.cellWidth, this.y);\n      ctx.lineTo(this.x + x * this.cellWidth, this.y + height);\n      ctx.stroke();\n    }\n    for (var y = 0; y < this.rows + 1; y++) {\n      ctx.beginPath();\n      ctx.moveTo(this.x, this.y + y * this.cellHeight);\n      ctx.lineTo(this.x + width, this.y + y * this.cellHeight);\n      ctx.stroke();\n    }\n    var solid = Color.Red.clone();\n    solid.a = 0.3;\n    this.data\n      .filter(function(cell) {\n        return cell.solid;\n      })\n      .forEach(function(cell) {\n        ctx.fillStyle = solid.toString();\n        ctx.fillRect(cell.x, cell.y, cell.width, cell.height);\n      });\n    if (this._collidingY > -1 && this._collidingX > -1) {\n      ctx.fillStyle = Color.Cyan.toString();\n      ctx.fillRect(\n        this.x + this._collidingX * this.cellWidth,\n        this.y + this._collidingY * this.cellHeight,\n        this.cellWidth,\n        this.cellHeight\n      );\n    }\n    ctx.restore();\n  }\n}\n\n/**\n * [[include:Constructors.md]]\n */\nexport interface ITileMapArgs extends Partial<TileMapImpl> {\n  x: number;\n  y: number;\n  cellWidth: number;\n  cellHeight: number;\n  rows: number;\n  cols: number;\n}\n\n/**\n * The [[TileMap]] class provides a lightweight way to do large complex scenes with collision\n * without the overhead of actors.\n *\n * [[include:TileMaps.md]]\n */\nexport class TileMap extends Configurable(TileMapImpl) {\n  constructor(config: ITileMapArgs);\n  constructor(x: number, y: number, cellWidth: number, cellHeight: number, rows: number, cols: number);\n  constructor(xOrConfig: number | ITileMapArgs, y?: number, cellWidth?: number, cellHeight?: number, rows?: number, cols?: number) {\n    super(xOrConfig, y, cellWidth, cellHeight, rows, cols);\n  }\n}\n\n/**\n * Tile sprites are used to render a specific sprite from a [[TileMap]]'s spritesheet(s)\n */\nexport class TileSprite {\n  /**\n   * @param spriteSheetKey  The key of the spritesheet to use\n   * @param spriteId        The index of the sprite in the [[SpriteSheet]]\n   */\n  constructor(public spriteSheetKey: string, public spriteId: number) {}\n}\n\n/**\n * @hidden\n */\nexport class CellImpl {\n  private _bounds: BoundingBox;\n  public x: number;\n  public y: number;\n  public width: number;\n  public height: number;\n  public index: number;\n  public solid: boolean = false;\n  public sprites: TileSprite[] = [];\n\n  /**\n   * @param x       Gets or sets x coordinate of the cell in world coordinates\n   * @param y       Gets or sets y coordinate of the cell in world coordinates\n   * @param width   Gets or sets the width of the cell\n   * @param height  Gets or sets the height of the cell\n   * @param index   The index of the cell in row major order\n   * @param solid   Gets or sets whether this cell is solid\n   * @param sprites The list of tile sprites to use to draw in this cell (in order)\n   */\n  constructor(\n    xOrConfig: number | ICellArgs,\n    y: number,\n    width: number,\n    height: number,\n    index: number,\n    solid: boolean = false,\n    sprites: TileSprite[] = []\n  ) {\n    if (xOrConfig && typeof xOrConfig === 'object') {\n      var config = xOrConfig;\n      xOrConfig = config.x;\n      y = config.y;\n      width = config.width;\n      height = config.height;\n      index = config.index;\n      solid = config.solid;\n      sprites = config.sprites;\n    }\n    this.x = <number>xOrConfig;\n    this.y = y;\n    this.width = width;\n    this.height = height;\n    this.index = index;\n    this.solid = solid;\n    this.sprites = sprites;\n    this._bounds = new BoundingBox(this.x, this.y, this.x + this.width, this.y + this.height);\n  }\n\n  /**\n   * Returns the bounding box for this cell\n   */\n  public getBounds() {\n    return this._bounds;\n  }\n  /**\n   * Gets the center coordinate of this cell\n   */\n  public getCenter(): Vector {\n    return new Vector(this.x + this.width / 2, this.y + this.height / 2);\n  }\n  /**\n   * Add another [[TileSprite]] to this cell\n   */\n  public pushSprite(tileSprite: TileSprite) {\n    this.sprites.push(tileSprite);\n  }\n  /**\n   * Remove an instance of [[TileSprite]] from this cell\n   */\n  public removeSprite(tileSprite: TileSprite) {\n    var index = -1;\n    if ((index = this.sprites.indexOf(tileSprite)) > -1) {\n      this.sprites.splice(index, 1);\n    }\n  }\n  /**\n   * Clear all sprites from this cell\n   */\n  public clearSprites() {\n    this.sprites.length = 0;\n  }\n}\n\n/**\n * [[include:Constructors.md]]\n */\nexport interface ICellArgs extends Partial<CellImpl> {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  index: number;\n  solid?: boolean;\n  sprites?: TileSprite[];\n}\n\n/**\n * TileMap Cell\n *\n * A light-weight object that occupies a space in a collision map. Generally\n * created by a [[TileMap]].\n *\n * Cells can draw multiple sprites. Note that the order of drawing is the order\n * of the sprites in the array so the last one will be drawn on top. You can\n * use transparency to create layers this way.\n */\nexport class Cell extends Configurable(CellImpl) {\n  constructor(config: ICellArgs);\n  constructor(x: number, y: number, width: number, height: number, index: number, solid?: boolean, sprites?: TileSprite[]);\n  constructor(\n    xOrConfig: number | ICellArgs,\n    y?: number,\n    width?: number,\n    height?: number,\n    index?: number,\n    solid?: boolean,\n    sprites?: TileSprite[]\n  ) {\n    super(xOrConfig, y, width, height, index, solid, sprites);\n  }\n}\n","import { Scene } from './Scene';\n\n/**\n * The Excalibur timer hooks into the internal timer and fires callbacks,\n * after a certain interval, optionally repeating.\n */\nexport class Timer {\n  public static id: number = 0;\n  public id: number = 0;\n  public interval: number = 10;\n  public fcn: () => void = () => {\n    return;\n  };\n  public repeats: boolean = false;\n  public maxNumberOfRepeats: number = -1;\n  private _elapsedTime: number = 0;\n  private _totalTimeAlive: number = 0;\n  private _paused: boolean = false;\n  private _numberOfTicks: number = 0;\n  public complete: boolean = false;\n  public scene: Scene = null;\n\n  /**\n   * @param fcn        The callback to be fired after the interval is complete.\n   * @param interval   Interval length\n   * @param repeats    Indicates whether this call back should be fired only once, or repeat after every interval as completed.\n   * @param numberOfRepeats Specifies a maximum number of times that this timer will execute.\n   */\n  constructor(fcn: () => void, interval: number, repeats?: boolean, numberOfRepeats?: number) {\n    if (!!numberOfRepeats && numberOfRepeats >= 0) {\n      this.maxNumberOfRepeats = numberOfRepeats;\n      if (!repeats) {\n        throw new Error('repeats must be set to true if numberOfRepeats is set');\n      }\n    }\n    this.id = Timer.id++;\n    this.interval = interval || this.interval;\n    this.fcn = fcn || this.fcn;\n    this.repeats = repeats || this.repeats;\n  }\n\n  /**\n   * Updates the timer after a certain number of milliseconds have elapsed. This is used internally by the engine.\n   * @param delta  Number of elapsed milliseconds since the last update.\n   */\n  public update(delta: number) {\n    if (!this._paused) {\n      this._totalTimeAlive += delta;\n      this._elapsedTime += delta;\n\n      if (this.maxNumberOfRepeats > -1 && this._numberOfTicks >= this.maxNumberOfRepeats) {\n        this.complete = true;\n      }\n\n      if (!this.complete && this._elapsedTime >= this.interval) {\n        this.fcn.call(this);\n        this._numberOfTicks++;\n        if (this.repeats) {\n          this._elapsedTime = 0;\n        } else {\n          this.complete = true;\n        }\n      }\n    }\n  }\n\n  /**\n   * Resets the timer so that it can be reused, and optionally reconfigure the timers interval.\n   * @param newInterval If specified, sets a new non-negative interval in milliseconds to refire the callback\n   * @param newNumberOfRepeats If specified, sets a new non-negative upper limit to the number of time this timer executes\n   */\n  public reset(newInterval?: number, newNumberOfRepeats?: number) {\n    if (!!newInterval && newInterval >= 0) {\n      this.interval = newInterval;\n    }\n\n    if (!!this.maxNumberOfRepeats && this.maxNumberOfRepeats >= 0) {\n      this.maxNumberOfRepeats = newNumberOfRepeats;\n      if (!this.repeats) {\n        throw new Error('repeats must be set to true if numberOfRepeats is set');\n      }\n    }\n\n    this.complete = false;\n    this._elapsedTime = 0;\n    this._numberOfTicks = 0;\n  }\n\n  public get timesRepeated(): number {\n    return this._numberOfTicks;\n  }\n\n  public getTimeRunning(): number {\n    return this._totalTimeAlive;\n  }\n\n  /**\n   * Pauses the timer so that no more time will be incremented towards the next call\n   */\n  public pause() {\n    this._paused = true;\n  }\n\n  /**\n   * Unpauses the timer. Time will now increment towards the next call\n   */\n  public unpause() {\n    this._paused = false;\n  }\n\n  /**\n   * Cancels the timer, preventing any further executions.\n   */\n  public cancel() {\n    if (this.scene) {\n      this.scene.cancelTimer(this);\n    }\n  }\n}\n","import { IActorTrait } from '../Interfaces/IActorTrait';\nimport { Actor } from '../Actor';\nimport { Engine } from '../Engine';\n\nexport interface ICapturePointerConfig {\n  /**\n   * Capture PointerMove events (may be expensive!)\n   */\n  captureMoveEvents: boolean;\n\n  /**\n   * Capture PointerDrag events (may be expensive!)\n   */\n  captureDragEvents: boolean;\n}\n\n/**\n * Revises pointer events path accordingly to the actor\n */\nexport class CapturePointer implements IActorTrait {\n  public update(actor: Actor, engine: Engine) {\n    if (!actor.enableCapturePointer) {\n      return;\n    }\n    if (actor.isKilled()) {\n      return;\n    }\n\n    engine.input.pointers.revisePointerEventsPaths(actor);\n  }\n}\n","import { Physics } from './../Physics';\nimport { IActorTrait } from '../Interfaces/IActorTrait';\nimport { Actor, CollisionType } from '../Actor';\nimport { Engine } from '../Engine';\n\nexport class EulerMovement implements IActorTrait {\n  public update(actor: Actor, _engine: Engine, delta: number) {\n    // Update placements based on linear algebra\n    var seconds = delta / 1000;\n\n    var totalAcc = actor.acc.clone();\n    // Only active vanilla actors are affected by global acceleration\n    if (actor.collisionType === CollisionType.Active) {\n      totalAcc.addEqual(Physics.acc);\n    }\n\n    actor.oldVel = actor.vel;\n    actor.vel.addEqual(totalAcc.scale(seconds));\n\n    actor.pos.addEqual(actor.vel.scale(seconds)).addEqual(totalAcc.scale(0.5 * seconds * seconds));\n\n    actor.rx += actor.torque * (1.0 / actor.moi) * seconds;\n    actor.rotation += actor.rx * seconds;\n\n    actor.scale.x += (actor.sx * delta) / 1000;\n    actor.scale.y += (actor.sy * delta) / 1000;\n  }\n}\n","export * from './CapturePointer';\nexport * from './EulerMovement';\nexport * from './OffscreenCulling';\nexport * from './TileMapCollisionDetection';\n","import { CullingBox } from './../Util/CullingBox';\nimport { IActorTrait } from '../Interfaces/IActorTrait';\nimport { Actor } from '../Actor';\nimport { Engine } from '../Engine';\nimport { Vector } from '../Algebra';\nimport { ExitViewPortEvent, EnterViewPortEvent } from '../Events';\n\nexport class OffscreenCulling implements IActorTrait {\n  public cullingBox: CullingBox = new CullingBox();\n\n  public update(actor: Actor, engine: Engine) {\n    var eventDispatcher = actor.eventDispatcher;\n    var anchor = actor.anchor;\n    var globalScale = actor.getGlobalScale();\n    var width = (globalScale.x * actor.getWidth()) / actor.scale.x;\n    var height = (globalScale.y * actor.getHeight()) / actor.scale.y;\n    var cameraPos = engine.currentScene.camera.pos;\n    var worldPos = actor.getWorldPos();\n    var actorScreenCoords = engine.worldToScreenCoordinates(new Vector(worldPos.x - anchor.x * width, worldPos.y - anchor.y * height));\n    var cameraScreenCoords = engine.worldToScreenCoordinates(cameraPos);\n\n    var zoom = 1.0;\n    if (actor.scene && actor.scene.camera) {\n      zoom = Math.abs(actor.scene.camera.getZoom());\n    }\n\n    var isSpriteOffScreen = true;\n    if (actor.currentDrawing != null) {\n      isSpriteOffScreen = this.cullingBox.isSpriteOffScreen(actor, engine);\n    }\n\n    if (!actor.isOffScreen) {\n      if (\n        (actorScreenCoords.x + width * zoom < 0 ||\n          actorScreenCoords.y + height * zoom < 0 ||\n          actorScreenCoords.x > engine.halfDrawWidth + cameraScreenCoords.x ||\n          actorScreenCoords.y > engine.halfDrawHeight + cameraScreenCoords.y) &&\n        isSpriteOffScreen\n      ) {\n        eventDispatcher.emit('exitviewport', new ExitViewPortEvent(actor));\n        actor.isOffScreen = true;\n      }\n    } else {\n      if (\n        (actorScreenCoords.x + width * zoom > 0 &&\n          actorScreenCoords.y + height * zoom > 0 &&\n          actorScreenCoords.x < engine.halfDrawWidth + cameraScreenCoords.x &&\n          actorScreenCoords.y < engine.halfDrawHeight + cameraScreenCoords.y) ||\n        !isSpriteOffScreen\n      ) {\n        eventDispatcher.emit('enterviewport', new EnterViewPortEvent(actor));\n        actor.isOffScreen = false;\n      }\n    }\n  }\n}\n","import { IActorTrait } from '../Interfaces/IActorTrait';\nimport { Actor, CollisionType } from '../Actor';\nimport { Engine } from '../Engine';\nimport { Vector } from '../Algebra';\nimport { Side } from '../Collision/Side';\nimport { PreCollisionEvent, PostCollisionEvent } from '../Events';\n\nexport class TileMapCollisionDetection implements IActorTrait {\n  public update(actor: Actor, engine: Engine) {\n    var eventDispatcher = actor.eventDispatcher;\n    if (actor.collisionType !== CollisionType.PreventCollision && engine.currentScene && engine.currentScene.tileMaps) {\n      for (var j = 0; j < engine.currentScene.tileMaps.length; j++) {\n        var map = engine.currentScene.tileMaps[j];\n        var intersectMap: Vector;\n        var side = Side.None;\n        var max = 2;\n        while ((intersectMap = map.collides(actor))) {\n          if (max-- < 0) {\n            break;\n          }\n          side = actor.getSideFromIntersect(intersectMap);\n          eventDispatcher.emit('precollision', new PreCollisionEvent(actor, null, side, intersectMap));\n          if (actor.collisionType === CollisionType.Active) {\n            actor.pos.y += intersectMap.y;\n            actor.pos.x += intersectMap.x;\n            eventDispatcher.emit('postcollision', new PostCollisionEvent(actor, null, side, intersectMap));\n          }\n        }\n      }\n    }\n  }\n}\n","import { Color } from './Drawing/Color';\nimport { Engine } from './Engine';\nimport { ActionQueue } from './Actions/Action';\nimport { EventDispatcher } from './EventDispatcher';\nimport { Actor, CollisionType } from './Actor';\nimport { Vector } from './Algebra';\nimport { ExitTriggerEvent, EnterTriggerEvent, CollisionEndEvent, CollisionStartEvent } from './Events';\nimport * as Util from './Util/Util';\n\n/**\n * ITriggerOptions\n */\nexport interface ITriggerOptions {\n  // position of the trigger\n  pos: Vector;\n  // width of the trigger\n  width: number;\n  // height of the trigger\n  height: number;\n  // whether the trigger is visible or not\n  visible: boolean;\n  // action to take when triggered\n  action: () => void;\n  // if specified the trigger will only fire on a specific actor and overrides any filter\n  target: Actor;\n  // Returns true if the triggers should fire on the collided actor\n  filter: (actor: Actor) => boolean;\n  // -1 if it should repeat forever\n  repeat: number;\n}\n\nlet triggerDefaults: Partial<ITriggerOptions> = {\n  pos: Vector.Zero.clone(),\n  width: 10,\n  height: 10,\n  visible: false,\n  action: () => {\n    return;\n  },\n  filter: () => true,\n  repeat: -1\n};\n\n/**\n * Triggers are a method of firing arbitrary code on collision. These are useful\n * as 'buttons', 'switches', or to trigger effects in a game. By default triggers\n * are invisible, and can only be seen when [[Trigger.visible]] is set to `true`.\n *\n * [[include:Triggers.md]]\n */\nexport class Trigger extends Actor {\n  private _target: Actor;\n  /**\n   * Action to fire when triggered by collision\n   */\n  public action: () => void = () => {\n    return;\n  };\n  /**\n   * Filter to add additional granularity to action dispatch, if a filter is specified the action will only fire when\n   * filter return true for the collided actor.\n   */\n  public filter: (actor: Actor) => boolean = () => true;\n  /**\n   * Number of times to repeat before killing the trigger,\n   */\n  public repeat: number = -1;\n\n  /**\n   *\n   * @param opts Trigger options\n   */\n  constructor(opts: Partial<ITriggerOptions>) {\n    super(opts.pos.x, opts.pos.y, opts.width, opts.height);\n    opts = Util.extend({}, triggerDefaults, opts);\n\n    this.filter = opts.filter || this.filter;\n    this.repeat = opts.repeat || this.repeat;\n    this.action = opts.action || this.action;\n    if (opts.target) {\n      this.target = opts.target;\n    }\n\n    this.visible = opts.visible;\n    this.collisionType = CollisionType.Passive;\n    this.eventDispatcher = new EventDispatcher(this);\n    this.actionQueue = new ActionQueue(this);\n\n    this.on('collisionstart', (evt: CollisionStartEvent) => {\n      if (this.filter(evt.other)) {\n        this.emit('enter', new EnterTriggerEvent(this, evt.other));\n        this._dispatchAction();\n        // remove trigger if its done, -1 repeat forever\n        if (this.repeat === 0) {\n          this.kill();\n        }\n      }\n    });\n\n    this.on('collisionend', (evt: CollisionEndEvent) => {\n      if (this.filter(evt.other)) {\n        this.emit('exit', new ExitTriggerEvent(this, evt.other));\n      }\n    });\n  }\n\n  public set target(target: Actor) {\n    this._target = target;\n    this.filter = (actor: Actor) => actor === target;\n  }\n\n  public get target() {\n    return this._target;\n  }\n\n  public _initialize(engine: Engine) {\n    super._initialize(engine);\n  }\n\n  private _dispatchAction() {\n    this.action.call(this);\n    this.repeat--;\n  }\n\n  /* istanbul ignore next */\n  public debugDraw(ctx: CanvasRenderingContext2D) {\n    super.debugDraw(ctx);\n    // Meant to draw debug information about actors\n    ctx.save();\n    ctx.translate(this.pos.x, this.pos.y);\n\n    var bb = this.getBounds();\n    var wp = this.getWorldPos();\n    bb.left = bb.left - wp.x;\n    bb.right = bb.right - wp.x;\n    bb.top = bb.top - wp.y;\n    bb.bottom = bb.bottom - wp.y;\n\n    // Currently collision primitives cannot rotate\n    // ctx.rotate(this.rotation);\n    ctx.fillStyle = Color.Violet.toString();\n    ctx.strokeStyle = Color.Violet.toString();\n    ctx.fillText('Trigger', 10, 10);\n    bb.debugDraw(ctx);\n\n    ctx.restore();\n  }\n}\n","import { Vector } from './Algebra';\nimport { Engine } from './Engine';\nimport { Actor, IActorArgs, CollisionType } from './Actor';\nimport * as Traits from './Traits/Index';\n\n/**\n * Helper [[Actor]] primitive for drawing UI's, optimized for UI drawing. Does\n * not participate in collisions. Drawn on top of all other actors.\n */\nexport class UIActor extends Actor {\n  protected _engine: Engine;\n\n  constructor();\n  constructor(xOrConfig?: number, y?: number, width?: number, height?: number);\n  constructor(config?: IActorArgs);\n  /**\n   * @param x       The starting x coordinate of the actor\n   * @param y       The starting y coordinate of the actor\n   * @param width   The starting width of the actor\n   * @param height  The starting height of the actor\n   */\n  constructor(xOrConfig?: number | IActorArgs, y?: number, width?: number, height?: number) {\n    if (typeof xOrConfig !== 'object') {\n      super(<number>xOrConfig, y, width, height);\n    } else {\n      super(<IActorArgs>xOrConfig);\n    }\n    this.traits = [];\n    this.traits.push(new Traits.CapturePointer());\n    this.anchor.setTo(0, 0);\n    this.collisionType = CollisionType.PreventCollision;\n    this.enableCapturePointer = true;\n  }\n\n  public _initialize(engine: Engine) {\n    this._engine = engine;\n    super._initialize(engine);\n  }\n\n  public contains(x: number, y: number, useWorld: boolean = true) {\n    if (useWorld) {\n      return super.contains(x, y);\n    }\n\n    var coords = this._engine.worldToScreenCoordinates(new Vector(x, y));\n    return super.contains(coords.x, coords.y);\n  }\n}\n","import { Actor } from '../Actor';\nimport { UIActor } from '../UIActor';\nimport { Label } from '../Label';\nimport { Trigger } from '../Trigger';\n\nexport function isVanillaActor(actor: Actor) {\n  return !(actor instanceof UIActor) && !(actor instanceof Trigger) && !(actor instanceof Label);\n}\n\nexport function isUIActor(actor: Actor) {\n  return actor instanceof UIActor;\n}\n","import { Vector } from '../Algebra';\nimport { Actor } from '../Actor';\nimport { Engine } from '../Engine';\nimport { Color } from '../Drawing/Color';\n\nexport class CullingBox {\n  private _topLeft: Vector = new Vector(0, 0);\n  private _topRight: Vector = new Vector(0, 0);\n  private _bottomLeft: Vector = new Vector(0, 0);\n  private _bottomRight: Vector = new Vector(0, 0);\n\n  private _xCoords: Array<number>;\n  private _yCoords: Array<number>;\n  private _xMin: number;\n  private _yMin: number;\n  private _xMax: number;\n  private _yMax: number;\n\n  private _xMinWorld: number;\n  private _yMinWorld: number;\n  private _xMaxWorld: number;\n  private _yMaxWorld: number;\n\n  public isSpriteOffScreen(actor: Actor, engine: Engine): boolean {\n    var drawingWidth = actor.currentDrawing.drawWidth;\n    var drawingHeight = actor.currentDrawing.drawHeight;\n    var rotation = actor.rotation;\n    var anchor = actor.getCenter();\n    var worldPos = actor.getWorldPos();\n\n    this._topLeft.x = worldPos.x - drawingWidth / 2;\n    this._topLeft.y = worldPos.y - drawingHeight / 2;\n    this._topLeft = this._topLeft.rotate(rotation, anchor);\n\n    this._topRight.x = worldPos.x + drawingWidth / 2;\n    this._topRight.y = worldPos.y - drawingHeight / 2;\n    this._topRight = this._topRight.rotate(rotation, anchor);\n\n    this._bottomLeft.x = worldPos.x - drawingWidth / 2;\n    this._bottomLeft.y = worldPos.y + drawingHeight / 2;\n    this._bottomLeft = this._bottomLeft.rotate(rotation, anchor);\n\n    this._bottomRight.x = worldPos.x + drawingWidth / 2;\n    this._bottomRight.y = worldPos.y + drawingHeight / 2;\n    this._bottomRight = this._bottomRight.rotate(rotation, anchor);\n\n    ///\n\n    var topLeftScreen = engine.worldToScreenCoordinates(this._topLeft);\n    var topRightScreen = engine.worldToScreenCoordinates(this._topRight);\n    var bottomLeftScreen = engine.worldToScreenCoordinates(this._bottomLeft);\n    var bottomRightScreen = engine.worldToScreenCoordinates(this._bottomRight);\n    this._xCoords = [];\n    this._yCoords = [];\n\n    this._xCoords.push(topLeftScreen.x, topRightScreen.x, bottomLeftScreen.x, bottomRightScreen.x);\n    this._yCoords.push(topLeftScreen.y, topRightScreen.y, bottomLeftScreen.y, bottomRightScreen.y);\n\n    this._xMin = Math.min.apply(null, this._xCoords);\n    this._yMin = Math.min.apply(null, this._yCoords);\n    this._xMax = Math.max.apply(null, this._xCoords);\n    this._yMax = Math.max.apply(null, this._yCoords);\n\n    var minWorld = engine.screenToWorldCoordinates(new Vector(this._xMin, this._yMin));\n    var maxWorld = engine.screenToWorldCoordinates(new Vector(this._xMax, this._yMax));\n    this._xMinWorld = minWorld.x;\n    this._yMinWorld = minWorld.y;\n    this._xMaxWorld = maxWorld.x;\n    this._yMaxWorld = maxWorld.y;\n\n    var boundingPoints = [\n      new Vector(this._xMin, this._yMin), // topleft\n      new Vector(this._xMax, this._yMin), // topright\n      new Vector(this._xMin, this._yMax), // bottomleft\n      new Vector(this._xMax, this._yMax)\n    ]; // bottomright\n\n    // sprite can be wider than canvas screen (and still visible within canvas)\n    // top or bottom of sprite must be within canvas\n    if (\n      boundingPoints[0].x < 0 &&\n      boundingPoints[1].x > engine.canvas.clientWidth &&\n      (boundingPoints[0].y > 0 || boundingPoints[2].y < engine.canvas.clientHeight)\n    ) {\n      return false;\n    }\n\n    // sprite can be taller than canvas screen (and still visible within canvas)\n    // left or right of sprite must be within canvas\n    if (\n      boundingPoints[0].y < 0 &&\n      boundingPoints[2].y > engine.canvas.clientHeight &&\n      (boundingPoints[1].x > 0 || boundingPoints[0].x < engine.canvas.clientWidth)\n    ) {\n      return false;\n    }\n\n    // otherwise if any corner is visible, we're not offscreen\n    for (var i = 0; i < boundingPoints.length; i++) {\n      if (\n        boundingPoints[i].x > 0 &&\n        boundingPoints[i].y > 0 &&\n        boundingPoints[i].x < engine.canvas.clientWidth &&\n        boundingPoints[i].y < engine.canvas.clientHeight\n      ) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  public debugDraw(ctx: CanvasRenderingContext2D) {\n    // bounding rectangle\n    ctx.beginPath();\n    ctx.strokeStyle = Color.White.toString();\n    ctx.rect(this._xMinWorld, this._yMinWorld, this._xMaxWorld - this._xMinWorld, this._yMaxWorld - this._yMinWorld);\n    ctx.stroke();\n\n    ctx.fillStyle = Color.Red.toString();\n    ctx.beginPath();\n    ctx.arc(this._topLeft.x, this._topLeft.y, 5, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.fill();\n\n    ctx.fillStyle = Color.Green.toString();\n    ctx.beginPath();\n    ctx.arc(this._topRight.x, this._topRight.y, 5, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.fill();\n\n    ctx.fillStyle = Color.Blue.toString();\n    ctx.beginPath();\n    ctx.arc(this._bottomLeft.x, this._bottomLeft.y, 5, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.fill();\n\n    ctx.fillStyle = Color.Magenta.toString();\n    ctx.beginPath();\n    ctx.arc(this._bottomRight.x, this._bottomRight.y, 5, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.fill();\n  }\n}\n","import { Logger } from './Log';\nimport * as Util from './Util';\n\n/**\n * Obsolete decorator options\n */\nexport interface IObsoleteOptions {\n  // Optionally specify a custom message\n  message?: string;\n  // Optionally indicate that an alternate method to the obsolete one exists\n  alternateMethod?: string;\n}\n\n/**\n * Obsolete decorator for marking Excalibur methods obsolete, you can optionally specify a custom message and/or alternate replacement\n * method do the deprecated one. Inspired by https://github.com/jayphelps/core-decorators.js\n */\nexport function obsolete(options?: IObsoleteOptions) {\n  options = Util.extend({}, { message: 'This method will be removed in future versions of Excalibur.', alternateMethod: null }, options);\n\n  return function(target: any, property: string, descriptor: PropertyDescriptor): any {\n    if (!(typeof descriptor.value === 'function' || typeof descriptor.get === 'function' || typeof descriptor.set === 'function')) {\n      throw new SyntaxError('Only functions/getters/setters can be marked as obsolete');\n    }\n    const methodSignature = `${target.name || ''}${target.name ? '.' : ''}${property}`;\n\n    var message =\n      `${methodSignature} is marked obsolete: ${options.message}` +\n      (options.alternateMethod ? ` Use ${options.alternateMethod} instead` : '');\n\n    let method = Util.extend({}, descriptor);\n\n    if (descriptor.value) {\n      method.value = function(this: any) {\n        Logger.getInstance().warn(message);\n        return descriptor.value.apply(this, arguments);\n      };\n      return method;\n    }\n\n    if (descriptor.get) {\n      method.get = function(this: any) {\n        Logger.getInstance().warn(message);\n        return descriptor.get.apply(this, arguments);\n      };\n    }\n\n    if (descriptor.set) {\n      method.set = function(this: any) {\n        Logger.getInstance().warn(message);\n        return descriptor.set.apply(this, arguments);\n      };\n    }\n    return method;\n  };\n}\n","import { Logger } from './Log';\n/**\n * This is the list of features that will be used to log the supported\n * features to the console when Detector.logBrowserFeatures() is called.\n */\n\nconst REPORTED_FEATURES: { [key: string]: string } = {\n  webgl: 'WebGL',\n  webaudio: 'WebAudio',\n  gamepadapi: 'Gamepad API'\n};\n\n/**\n * Interface for detected browser features matrix\n */\nexport interface IDetectedFeatures {\n  readonly canvas: boolean;\n  readonly arraybuffer: boolean;\n  readonly dataurl: boolean;\n  readonly objecturl: boolean;\n  readonly rgba: boolean;\n  readonly webaudio: boolean;\n  readonly webgl: boolean;\n  readonly gamepadapi: boolean;\n}\n\ninterface ICriticalTests {\n  canvasSupport(): boolean;\n  arrayBufferSupport(): boolean;\n  dataUrlSupport(): boolean;\n  objectUrlSupport(): boolean;\n  rgbaSupport(): boolean;\n}\n\ninterface IWarningTests {\n  webAudioSupport(): boolean;\n  webglSupport(): boolean;\n}\n\n/**\n * Excalibur internal feature detection helper class\n */\nexport class Detector {\n  private _features: IDetectedFeatures = null;\n\n  public failedTests: string[] = [];\n\n  public constructor() {\n    this._features = this._loadBrowserFeatures();\n  }\n\n  /**\n   * Returns a map of currently supported browser features. This method\n   * treats the features as a singleton and will only calculate feature\n   * support if it has not previously been done.\n   */\n  public getBrowserFeatures(): IDetectedFeatures {\n    if (this._features === null) {\n      this._features = this._loadBrowserFeatures();\n    }\n    return this._features;\n  }\n\n  /**\n   * Report on non-critical browser support for debugging purposes.\n   * Use native browser console colors for visibility.\n   */\n  public logBrowserFeatures(): void {\n    let msg = '%cSUPPORTED BROWSER FEATURES\\n==========================%c\\n';\n    let args = ['font-weight: bold; color: navy', 'font-weight: normal; color: inherit'];\n\n    let supported: any = this.getBrowserFeatures();\n    for (let feature of Object.keys(REPORTED_FEATURES)) {\n      if (supported[feature]) {\n        msg += '(%c\\u2713%c)'; // ()\n        args.push('font-weight: bold; color: green');\n        args.push('font-weight: normal; color: inherit');\n      } else {\n        msg += '(%c\\u2717%c)'; // ()\n        args.push('font-weight: bold; color: red');\n        args.push('font-weight: normal; color: inherit');\n      }\n\n      msg += ' ' + REPORTED_FEATURES[feature] + '\\n';\n    }\n\n    args.unshift(msg);\n    console.log.apply(console, args);\n  }\n\n  /**\n   * Executes several IIFE's to get a constant reference to supported\n   * features within the current execution context.\n   */\n  private _loadBrowserFeatures(): IDetectedFeatures {\n    return {\n      // IIFE to check canvas support\n      canvas: (() => {\n        return this._criticalTests.canvasSupport();\n      })(),\n\n      // IIFE to check arraybuffer support\n      arraybuffer: (() => {\n        return this._criticalTests.arrayBufferSupport();\n      })(),\n\n      // IIFE to check dataurl support\n      dataurl: (() => {\n        return this._criticalTests.dataUrlSupport();\n      })(),\n\n      // IIFE to check objecturl support\n      objecturl: (() => {\n        return this._criticalTests.objectUrlSupport();\n      })(),\n\n      // IIFE to check rgba support\n      rgba: (() => {\n        return this._criticalTests.rgbaSupport();\n      })(),\n\n      // IIFE to check webaudio support\n      webaudio: (() => {\n        return this._warningTest.webAudioSupport();\n      })(),\n\n      // IIFE to check webgl support\n      webgl: (() => {\n        return this._warningTest.webglSupport();\n      })(),\n\n      // IIFE to check gamepadapi support\n      gamepadapi: (() => {\n        return !!(<any>navigator).getGamepads;\n      })()\n    };\n  }\n\n  // critical browser features required for ex to run\n  private _criticalTests: ICriticalTests = {\n    // Test canvas/2d context support\n    canvasSupport: function() {\n      var elem = document.createElement('canvas');\n      return !!(elem.getContext && elem.getContext('2d'));\n    },\n\n    // Test array buffer support ex uses for downloading binary data\n    arrayBufferSupport: function() {\n      var xhr = new XMLHttpRequest();\n      xhr.open('GET', '/');\n      try {\n        xhr.responseType = 'arraybuffer';\n      } catch (e) {\n        return false;\n      }\n      return xhr.responseType === 'arraybuffer';\n    },\n\n    // Test data urls ex uses for sprites\n    dataUrlSupport: function() {\n      var canvas = document.createElement('canvas');\n      return canvas.toDataURL('image/png').indexOf('data:image/png') === 0;\n    },\n\n    // Test object url support for loading\n    objectUrlSupport: function() {\n      return 'URL' in window && 'revokeObjectURL' in URL && 'createObjectURL' in URL;\n    },\n\n    // RGBA support for colors\n    rgbaSupport: function() {\n      var style = document.createElement('a').style;\n      style.cssText = 'background-color:rgba(150,255,150,.5)';\n      return ('' + style.backgroundColor).indexOf('rgba') > -1;\n    }\n  };\n\n  // warnings excalibur performance will be degraded\n  private _warningTest: IWarningTests = {\n    webAudioSupport: function() {\n      return !!(\n        (<any>window).AudioContext ||\n        (<any>window).webkitAudioContext ||\n        (<any>window).mozAudioContext ||\n        (<any>window).msAudioContext ||\n        (<any>window).oAudioContext\n      );\n    },\n    webglSupport: function() {\n      var elem = document.createElement('canvas');\n      return !!(elem.getContext && elem.getContext('webgl'));\n    }\n  };\n\n  public test(): boolean {\n    // Critical test will for ex not to run\n    var failedCritical = false;\n    for (var test in this._criticalTests) {\n      if (!this._criticalTests[<keyof ICriticalTests>test].call(this)) {\n        this.failedTests.push(test);\n        Logger.getInstance().error('Critical browser feature missing, Excalibur requires:', test);\n        failedCritical = true;\n      }\n    }\n    if (failedCritical) {\n      return false;\n    }\n\n    // Warning tests do not for ex to return false to compatibility\n    for (var warning in this._warningTest) {\n      if (!this._warningTest[<keyof IWarningTests>warning]()) {\n        Logger.getInstance().warn('Warning browser feature missing, Excalibur will have reduced performance:', warning);\n      }\n    }\n\n    return true;\n  }\n}\n","import { Color } from '../Drawing/Color';\nimport { Vector } from '../Algebra';\n\n/**\n * A canvas linecap style. \"butt\" is the default flush style, \"round\" is a semi-circle cap with a radius half the width of\n * the line, and \"square\" is a rectangle that is an equal width and half height cap.\n */\nexport type LineCapStyle = 'butt' | 'round' | 'square';\n\n/**\n * Draw a line on canvas context\n *\n * @param ctx The canvas context\n * @param color The color of the line\n * @param x1 The start x coordinate\n * @param y1 The start y coordinate\n * @param x2 The ending x coordinate\n * @param y2 The ending y coordinate\n * @param thickness The line thickness\n * @param cap The [[LineCapStyle]] (butt, round, or square)\n */\n/* istanbul ignore next */\nexport function line(\n  ctx: CanvasRenderingContext2D,\n  color: Color = Color.Red.clone(),\n  x1: number,\n  y1: number,\n  x2: number,\n  y2: number,\n  thickness: number = 1,\n  cap: LineCapStyle = 'butt'\n) {\n  ctx.beginPath();\n  ctx.lineWidth = thickness;\n  ctx.lineCap = cap;\n  ctx.strokeStyle = color.toString();\n  ctx.moveTo(x1, y1);\n  ctx.lineTo(x2, y2);\n  ctx.closePath();\n  ctx.stroke();\n}\n\n/**\n * Draw the vector as a point onto the canvas.\n */\n/* istanbul ignore next */\nexport function point(ctx: CanvasRenderingContext2D, color: Color = Color.Red.clone(), point: Vector): void {\n  ctx.beginPath();\n  ctx.strokeStyle = color.toString();\n  ctx.arc(point.x, point.y, 5, 0, Math.PI * 2);\n  ctx.closePath();\n  ctx.stroke();\n}\n\n/**\n * Draw the vector as a line onto the canvas starting a origin point.\n */\n/* istanbul ignore next */\nexport function vector(ctx: CanvasRenderingContext2D, color: Color, origin: Vector, vector: Vector, scale: number = 1.0): void {\n  var c = color ? color.toString() : 'blue';\n  var v = vector.scale(scale);\n  ctx.beginPath();\n  ctx.strokeStyle = c;\n  ctx.moveTo(origin.x, origin.y);\n  ctx.lineTo(origin.x + v.x, origin.y + v.y);\n  ctx.closePath();\n  ctx.stroke();\n}\n\n/**\n * Represents border radius values\n */\nexport interface IBorderRadius {\n  /**\n   * Top-left\n   */\n  tl: number;\n  /**\n   * Top-right\n   */\n  tr: number;\n  /**\n   * Bottom-right\n   */\n  br: number;\n  /**\n   * Bottom-left\n   */\n  bl: number;\n}\n\n/**\n * Draw a round rectangle on a canvas context\n *\n * @param ctx The canvas context\n * @param x The top-left x coordinate\n * @param y The top-left y coordinate\n * @param width The width of the rectangle\n * @param height The height of the rectangle\n * @param radius The border radius of the rectangle\n * @param fill The [[Color]] to fill rectangle with\n * @param stroke The [[Color]] to stroke rectangle with\n */\nexport function roundRect(\n  ctx: CanvasRenderingContext2D,\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n  radius: number | IBorderRadius = 5,\n  stroke: Color = Color.White,\n  fill: Color = null\n) {\n  var br: IBorderRadius;\n\n  if (typeof radius === 'number') {\n    br = { tl: radius, tr: radius, br: radius, bl: radius };\n  } else {\n    var defaultRadius: IBorderRadius = { tl: 0, tr: 0, br: 0, bl: 0 };\n\n    for (var prop in defaultRadius) {\n      if (defaultRadius.hasOwnProperty(prop)) {\n        let side = <keyof IBorderRadius>prop;\n        br[side] = radius[side] || defaultRadius[side];\n      }\n    }\n  }\n\n  ctx.beginPath();\n  ctx.moveTo(x + br.tl, y);\n  ctx.lineTo(x + width - br.tr, y);\n  ctx.quadraticCurveTo(x + width, y, x + width, y + br.tr);\n  ctx.lineTo(x + width, y + height - br.br);\n  ctx.quadraticCurveTo(x + width, y + height, x + width - br.br, y + height);\n  ctx.lineTo(x + br.bl, y + height);\n  ctx.quadraticCurveTo(x, y + height, x, y + height - br.bl);\n  ctx.lineTo(x, y + br.tl);\n  ctx.quadraticCurveTo(x, y, x + br.tl, y);\n  ctx.closePath();\n\n  if (fill) {\n    ctx.fillStyle = fill.toString();\n    ctx.fill();\n  }\n\n  if (stroke) {\n    ctx.strokeStyle = stroke.toString();\n    ctx.stroke();\n  }\n}\n\nexport function circle(\n  ctx: CanvasRenderingContext2D,\n  x: number,\n  y: number,\n  radius: number,\n  stroke: Color = Color.White,\n  fill: Color = null\n) {\n  ctx.beginPath();\n  ctx.arc(x, y, radius, 0, Math.PI * 2);\n  ctx.closePath();\n\n  if (fill) {\n    ctx.fillStyle = fill.toString();\n    ctx.fill();\n  }\n\n  if (stroke) {\n    ctx.strokeStyle = stroke.toString();\n    ctx.stroke();\n  }\n}\n","import { Vector } from '../Algebra';\n\n/**\n * A definition of an EasingFunction. See [[EasingFunctions]].\n */\n// tslint:disable-next-line\nexport interface EasingFunction {\n  (currentTime: number, startValue: number, endValue: number, duration: number): number;\n}\n\n/**\n * Standard easing functions for motion in Excalibur, defined on a domain of [0, duration] and a range from [+startValue,+endValue]\n * Given a time, the function will return a value from positive startValue to positive endValue.\n *\n * ```js\n * function Linear (t) {\n *    return t * t;\n * }\n *\n * // accelerating from zero velocity\n * function EaseInQuad (t) {\n *    return t * t;\n * }\n *\n * // decelerating to zero velocity\n * function EaseOutQuad (t) {\n *    return t * (2 - t);\n * }\n *\n * // acceleration until halfway, then deceleration\n * function EaseInOutQuad (t) {\n *    return t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n * }\n *\n * // accelerating from zero velocity\n * function EaseInCubic (t) {\n *    return t * t * t;\n * }\n *\n * // decelerating to zero velocity\n * function EaseOutCubic (t) {\n *    return (--t) * t * t + 1;\n * }\n *\n * // acceleration until halfway, then deceleration\n * function EaseInOutCubic (t) {\n *    return t < .5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\n * }\n * ```\n */\nexport class EasingFunctions {\n  public static CreateReversableEasingFunction(easing: EasingFunction) {\n    return (time: number, start: number, end: number, duration: number) => {\n      if (end < start) {\n        return start - (easing(time, end, start, duration) - end);\n      } else {\n        return easing(time, start, end, duration);\n      }\n    };\n  }\n\n  public static CreateVectorEasingFunction(easing: EasingFunction) {\n    return (time: number, start: Vector, end: Vector, duration: number) => {\n      return new Vector(easing(time, start.x, end.x, duration), easing(time, start.y, end.y, duration));\n    };\n  }\n\n  public static Linear: EasingFunction = EasingFunctions.CreateReversableEasingFunction(\n    (currentTime: number, startValue: number, endValue: number, duration: number) => {\n      endValue = endValue - startValue;\n      return (endValue * currentTime) / duration + startValue;\n    }\n  );\n\n  public static EaseInQuad = EasingFunctions.CreateReversableEasingFunction(\n    (currentTime: number, startValue: number, endValue: number, duration: number) => {\n      endValue = endValue - startValue;\n      currentTime /= duration;\n\n      return endValue * currentTime * currentTime + startValue;\n    }\n  );\n\n  public static EaseOutQuad: EasingFunction = EasingFunctions.CreateReversableEasingFunction(\n    (currentTime: number, startValue: number, endValue: number, duration: number) => {\n      endValue = endValue - startValue;\n      currentTime /= duration;\n      return -endValue * currentTime * (currentTime - 2) + startValue;\n    }\n  );\n\n  public static EaseInOutQuad: EasingFunction = EasingFunctions.CreateReversableEasingFunction(\n    (currentTime: number, startValue: number, endValue: number, duration: number) => {\n      endValue = endValue - startValue;\n      currentTime /= duration / 2;\n\n      if (currentTime < 1) {\n        return (endValue / 2) * currentTime * currentTime + startValue;\n      }\n      currentTime--;\n\n      return (-endValue / 2) * (currentTime * (currentTime - 2) - 1) + startValue;\n    }\n  );\n\n  public static EaseInCubic: EasingFunction = EasingFunctions.CreateReversableEasingFunction(\n    (currentTime: number, startValue: number, endValue: number, duration: number) => {\n      endValue = endValue - startValue;\n      currentTime /= duration;\n      return endValue * currentTime * currentTime * currentTime + startValue;\n    }\n  );\n\n  public static EaseOutCubic: EasingFunction = EasingFunctions.CreateReversableEasingFunction(\n    (currentTime: number, startValue: number, endValue: number, duration: number) => {\n      endValue = endValue - startValue;\n      currentTime /= duration;\n      currentTime--;\n      return endValue * (currentTime * currentTime * currentTime + 1) + startValue;\n    }\n  );\n\n  public static EaseInOutCubic: EasingFunction = EasingFunctions.CreateReversableEasingFunction(\n    (currentTime: number, startValue: number, endValue: number, duration: number) => {\n      endValue = endValue - startValue;\n      currentTime /= duration / 2;\n      if (currentTime < 1) {\n        return (endValue / 2) * currentTime * currentTime * currentTime + startValue;\n      }\n      currentTime -= 2;\n      return (endValue / 2) * (currentTime * currentTime * currentTime + 2) + startValue;\n    }\n  );\n}\n","export * from './Util';\nimport * as drawUtil from './DrawUtil';\n\nexport { drawUtil as DrawUtil };\n","/**\n * Logging level that Excalibur will tag\n */\nexport enum LogLevel {\n  Debug,\n  Info,\n  Warn,\n  Error,\n  Fatal\n}\n\n/**\n * Static singleton that represents the logging facility for Excalibur.\n * Excalibur comes built-in with a [[ConsoleAppender]] and [[ScreenAppender]].\n * Derive from [[IAppender]] to create your own logging appenders.\n *\n * [[include:Logger.md]]\n */\nexport class Logger {\n  private static _instance: Logger = null;\n  private _appenders: IAppender[] = [];\n\n  constructor() {\n    if (Logger._instance) {\n      throw new Error('Logger is a singleton');\n    }\n    Logger._instance = this;\n    // Default console appender\n    Logger._instance.addAppender(new ConsoleAppender());\n    return Logger._instance;\n  }\n\n  /**\n   * Gets or sets the default logging level. Excalibur will only log\n   * messages if equal to or above this level. Default: [[LogLevel.Info]]\n   */\n  public defaultLevel: LogLevel = LogLevel.Info;\n\n  /**\n   * Gets the current static instance of Logger\n   */\n  public static getInstance(): Logger {\n    if (Logger._instance == null) {\n      Logger._instance = new Logger();\n    }\n    return Logger._instance;\n  }\n\n  /**\n   * Adds a new [[IAppender]] to the list of appenders to write to\n   */\n  public addAppender(appender: IAppender): void {\n    this._appenders.push(appender);\n  }\n\n  /**\n   * Clears all appenders from the logger\n   */\n  public clearAppenders(): void {\n    this._appenders.length = 0;\n  }\n\n  /**\n   * Logs a message at a given LogLevel\n   * @param level  The LogLevel`to log the message at\n   * @param args   An array of arguments to write to an appender\n   */\n  private _log(level: LogLevel, args: any[]): void {\n    if (level == null) {\n      level = this.defaultLevel;\n    }\n\n    var i = 0,\n      len = this._appenders.length;\n\n    for (i; i < len; i++) {\n      if (level >= this.defaultLevel) {\n        this._appenders[i].log(level, args);\n      }\n    }\n  }\n\n  /**\n   * Writes a log message at the [[LogLevel.Debug]] level\n   * @param args  Accepts any number of arguments\n   */\n  public debug(...args: any[]): void {\n    this._log(LogLevel.Debug, args);\n  }\n\n  /**\n   * Writes a log message at the [[LogLevel.Info]] level\n   * @param args  Accepts any number of arguments\n   */\n  public info(...args: any[]): void {\n    this._log(LogLevel.Info, args);\n  }\n\n  /**\n   * Writes a log message at the [[LogLevel.Warn]] level\n   * @param args  Accepts any number of arguments\n   */\n  public warn(...args: any[]): void {\n    this._log(LogLevel.Warn, args);\n  }\n\n  /**\n   * Writes a log message at the [[LogLevel.Error]] level\n   * @param args  Accepts any number of arguments\n   */\n  public error(...args: any[]): void {\n    this._log(LogLevel.Error, args);\n  }\n\n  /**\n   * Writes a log message at the [[LogLevel.Fatal]] level\n   * @param args  Accepts any number of arguments\n   */\n  public fatal(...args: any[]): void {\n    this._log(LogLevel.Fatal, args);\n  }\n}\n\n/**\n * Contract for any log appender (such as console/screen)\n */\nexport interface IAppender {\n  /**\n   * Logs a message at the given [[LogLevel]]\n   * @param level  Level to log at\n   * @param args   Arguments to log\n   */\n  log(level: LogLevel, args: any[]): void;\n}\n\n/**\n * Console appender for browsers (i.e. `console.log`)\n */\nexport class ConsoleAppender implements IAppender {\n  /**\n   * Logs a message at the given [[LogLevel]]\n   * @param level  Level to log at\n   * @param args   Arguments to log\n   */\n  public log(level: LogLevel, args: any[]): void {\n    // Check for console support\n    if (!console && !console.log && console.warn && console.error) {\n      // todo maybe do something better than nothing\n      return;\n    }\n\n    // Create a new console args array\n    var consoleArgs: any[] = [];\n    consoleArgs.unshift.apply(consoleArgs, args);\n    consoleArgs.unshift('[' + LogLevel[level] + '] : ');\n\n    if (level < LogLevel.Warn) {\n      // Call .log for Debug/Info\n      if (console.log.apply) {\n        // this is required on some older browsers that don't support apply on console.log :(\n        console.log.apply(console, consoleArgs);\n      } else {\n        console.log(consoleArgs.join(' '));\n      }\n    } else if (level < LogLevel.Error) {\n      // Call .warn for Warn\n      if (console.warn.apply) {\n        console.warn.apply(console, consoleArgs);\n      } else {\n        console.warn(consoleArgs.join(' '));\n      }\n    } else {\n      // Call .error for Error/Fatal\n      if (console.error.apply) {\n        console.error.apply(console, consoleArgs);\n      } else {\n        console.error(consoleArgs.join(' '));\n      }\n    }\n  }\n}\n\n/**\n * On-screen (canvas) appender\n */\nexport class ScreenAppender implements IAppender {\n  // @todo Clean this up\n\n  private _messages: string[] = [];\n  private _canvas: HTMLCanvasElement;\n  private _ctx: CanvasRenderingContext2D;\n\n  /**\n   * @param width   Width of the screen appender in pixels\n   * @param height  Height of the screen appender in pixels\n   */\n  constructor(width?: number, height?: number) {\n    this._canvas = <HTMLCanvasElement>document.createElement('canvas');\n    this._canvas.width = width || window.innerWidth;\n    this._canvas.height = height || window.innerHeight;\n    this._canvas.style.position = 'absolute';\n    this._ctx = <CanvasRenderingContext2D>this._canvas.getContext('2d');\n    document.body.appendChild(this._canvas);\n  }\n\n  /**\n   * Logs a message at the given [[LogLevel]]\n   * @param level  Level to log at\n   * @param args   Arguments to log\n   */\n  public log(level: LogLevel, args: any[]): void {\n    var message = args.join(',');\n\n    this._ctx.clearRect(0, 0, this._canvas.width, this._canvas.height);\n\n    this._messages.unshift('[' + LogLevel[level] + '] : ' + message);\n\n    var pos = 10;\n    var opacity = 1.0;\n    for (var i = 0; i < this._messages.length; i++) {\n      this._ctx.fillStyle = 'rgba(255,255,255,' + opacity.toFixed(2) + ')';\n      this._ctx.fillText(this._messages[i], 200, pos);\n      pos += 10;\n      opacity = opacity > 0 ? opacity - 0.05 : 0;\n    }\n  }\n}\n","/**\n * A sorted list implementation. NOTE: this implementation is not self-balancing\n */\nexport class SortedList<T> {\n  private _getComparable: Function;\n  private _root: BinaryTreeNode;\n\n  constructor(getComparable: () => any) {\n    this._getComparable = getComparable;\n  }\n\n  public find(element: any): boolean {\n    return this._find(this._root, element);\n  }\n\n  private _find(node: BinaryTreeNode, element: any): boolean {\n    if (node == null) {\n      return false;\n    } else if (this._getComparable.call(element) === node.getKey()) {\n      if (node.getData().indexOf(element) > -1) {\n        return true;\n      } else {\n        return false;\n      }\n    } else if (this._getComparable.call(element) < node.getKey()) {\n      return this._find(node.getLeft(), element);\n    } else {\n      return this._find(node.getRight(), element);\n    }\n  }\n\n  // returns the array of elements at a specific key value\n  public get(key: number): any[] {\n    return this._get(this._root, key);\n  }\n\n  private _get(node: BinaryTreeNode, key: number): any[] {\n    if (node == null) {\n      return [];\n    } else if (key === node.getKey()) {\n      return node.getData();\n    } else if (key < node.getKey()) {\n      return this._get(node.getLeft(), key);\n    } else {\n      return this._get(node.getRight(), key);\n    }\n  }\n\n  public add(element: any): boolean {\n    if (this._root == null) {\n      this._root = new BinaryTreeNode(this._getComparable.call(element), [element], null, null);\n      return true;\n    } else {\n      return this._insert(this._root, element);\n    }\n  }\n\n  private _insert(node: BinaryTreeNode, element: any): boolean {\n    if (node != null) {\n      if (this._getComparable.call(element) === node.getKey()) {\n        if (node.getData().indexOf(element) > -1) {\n          return false; // the element we're trying to insert already exists\n        } else {\n          node.getData().push(element);\n          return true;\n        }\n      } else if (this._getComparable.call(element) < node.getKey()) {\n        if (node.getLeft() == null) {\n          node.setLeft(new BinaryTreeNode(this._getComparable.call(element), [element], null, null));\n          return true;\n        } else {\n          return this._insert(node.getLeft(), element);\n        }\n      } else {\n        if (node.getRight() == null) {\n          node.setRight(new BinaryTreeNode(this._getComparable.call(element), [element], null, null));\n          return true;\n        } else {\n          return this._insert(node.getRight(), element);\n        }\n      }\n    }\n    return false;\n  }\n\n  public removeByComparable(element: any): void {\n    this._root = this._remove(this._root, element);\n  }\n\n  private _remove(node: BinaryTreeNode, element: any): BinaryTreeNode {\n    if (node == null) {\n      return null;\n    } else if (this._getComparable.call(element) === node.getKey()) {\n      var elementIndex = node.getData().indexOf(element);\n      // if the node contains the element, remove the element\n      if (elementIndex > -1) {\n        node.getData().splice(elementIndex, 1);\n        // if we have removed the last element at this node, remove the node\n        if (node.getData().length === 0) {\n          // if the node is a leaf\n          if (node.getLeft() == null && node.getRight() == null) {\n            return null;\n          } else if (node.getLeft() == null) {\n            return node.getRight();\n          } else if (node.getRight() == null) {\n            return node.getLeft();\n          }\n          // if node has 2 children\n          var temp = this._findMinNode(node.getRight());\n          node.setKey(temp.getKey());\n          node.setData(temp.getData());\n          node.setRight(this._cleanup(node.getRight(), temp)); //\"cleanup nodes\" (move them up recursively)\n          return node;\n        } else {\n          // this prevents the node from being removed since it still contains elements\n          return node;\n        }\n      }\n    } else if (this._getComparable.call(element) < node.getKey()) {\n      node.setLeft(this._remove(node.getLeft(), element));\n      return node;\n    } else {\n      node.setRight(this._remove(node.getRight(), element));\n      return node;\n    }\n    return null;\n  }\n\n  // called once we have successfully removed the element we wanted, recursively corrects the part of the tree below the removed node\n  private _cleanup(node: BinaryTreeNode, element: BinaryTreeNode): BinaryTreeNode {\n    var comparable = element.getKey();\n    if (node == null) {\n      return null;\n    } else if (comparable === node.getKey()) {\n      // if the node is a leaf\n      if (node.getLeft() == null && node.getRight() == null) {\n        return null;\n      } else if (node.getLeft() == null) {\n        return node.getRight();\n      } else if (node.getRight() == null) {\n        return node.getLeft();\n      }\n      // if node has 2 children\n      var temp = this._findMinNode(node.getRight());\n      node.setKey(temp.getKey());\n      node.setData(temp.getData());\n\n      node.setRight(this._cleanup(node.getRight(), temp));\n      return node;\n    } else if (this._getComparable.call(element) < node.getKey()) {\n      node.setLeft(this._cleanup(node.getLeft(), element));\n      return node;\n    } else {\n      node.setRight(this._cleanup(node.getRight(), element));\n      return node;\n    }\n  }\n\n  private _findMinNode(node: BinaryTreeNode): BinaryTreeNode {\n    var current = node;\n    while (current.getLeft() != null) {\n      current = current.getLeft();\n    }\n    return current;\n  }\n\n  public list(): Array<T> {\n    var results = new Array<any>();\n    this._list(this._root, results);\n    return results;\n  }\n\n  private _list(treeNode: BinaryTreeNode, results: Array<T>): void {\n    if (treeNode != null) {\n      this._list(treeNode.getLeft(), results);\n      treeNode.getData().forEach(function(element) {\n        results.push(element);\n      });\n      this._list(treeNode.getRight(), results);\n    }\n  }\n}\n\n/**\n * A tree node part of [[SortedList]]\n */\nexport class BinaryTreeNode {\n  private _key: number;\n  private _data: Array<any>;\n  private _left: BinaryTreeNode;\n  private _right: BinaryTreeNode;\n\n  constructor(key: number, data: Array<any>, left: BinaryTreeNode, right: BinaryTreeNode) {\n    this._key = key;\n    this._data = data;\n    this._left = left;\n    this._right = right;\n  }\n\n  public getKey(): number {\n    return this._key;\n  }\n\n  public setKey(key: number) {\n    this._key = key;\n  }\n\n  public getData(): Array<any> {\n    return this._data;\n  }\n\n  public setData(data: any) {\n    this._data = data;\n  }\n\n  public getLeft(): BinaryTreeNode {\n    return this._left;\n  }\n\n  public setLeft(left: BinaryTreeNode) {\n    this._left = left;\n  }\n\n  public getRight(): BinaryTreeNode {\n    return this._right;\n  }\n\n  public setRight(right: BinaryTreeNode) {\n    this._right = right;\n  }\n}\n\n/**\n * Mock element for testing\n *\n * @internal\n */\nexport class MockedElement {\n  private _key: number = 0;\n\n  constructor(key: number) {\n    this._key = key;\n  }\n\n  public getTheKey() {\n    return this._key;\n  }\n\n  public setKey(key: number) {\n    this._key = key;\n  }\n}\n","import { Logger } from './Log';\n\n/**\n * Whether or not the browser can play this file as HTML5 Audio\n */\nexport function canPlayFile(file: string): boolean {\n  try {\n    var a = new Audio();\n    var filetype = /.*\\.([A-Za-z0-9]+)$/;\n    var type = file.match(filetype)[1];\n    if (a.canPlayType('audio/' + type)) {\n      return true;\n    } else {\n      return false;\n    }\n  } catch (e) {\n    Logger.getInstance().warn('Cannot determine audio support, assuming no support for the Audio Tag', e);\n    return false;\n  }\n}\n","import { Vector } from '../Algebra';\nimport { Random } from '../Math/Random';\nimport { Side } from '../Collision/Side';\n\n/**\n * Two PI constant\n */\nexport const TwoPI: number = Math.PI * 2;\n\n/**\n * Merges one or more objects into a single target object\n *\n * @param deep Whether or not to do a deep clone\n * @param target The target object to attach properties on\n * @param objects The objects whose properties to merge\n * @returns Merged object with properties from other objects\n */\nexport function extend(deep: boolean, target: any, ...objects: any[]): any;\n\n/**\n * Merges one or more objects into a single target object\n *\n * @param target The target object to attach properties on\n * @param object2 The second object whose properties to merge\n * @returns Merged object with properties from other objects\n */\nexport function extend<T1, T2>(target: T1, object2: T2): T1 & T2;\n\n/**\n * Merges one or more objects into a single target object\n *\n * @param target The target object to attach properties on\n * @param object2 The second object whose properties to merge\n * @param object3 The third object whose properties to merge\n * @returns Merged object with properties from other objects\n */\nexport function extend<T1, T2, T3>(target: T1, object2: T2, object3: T3): T1 & T2 & T3;\n\n/**\n * Merges one or more objects into a single target object\n *\n * @param target The target object to attach properties on\n * @param objects The objects whose properties to merge\n * @returns Merged object with properties from other objects\n */\nexport function extend(target: any, ...objects: any[]): any;\n\n/**\n * Merges one or more objects into a single target object\n *\n * @returns Merged object with properties from other objects\n * @credit https://gomakethings.com/vanilla-javascript-version-of-jquery-extend/\n */\nexport function extend() {\n  var extended: { [key: string]: any } = {};\n  var deep = false;\n  var i = 0;\n  var length = arguments.length;\n\n  // Check if a deep merge\n  if (Object.prototype.toString.call(arguments[0]) === '[object Boolean]') {\n    deep = arguments[0];\n    i++;\n  }\n\n  // Merge the object into the extended object\n  var assignExists = typeof (<any>Object).assign === 'function';\n  var merge = null;\n  if (!assignExists) {\n    merge = function(obj: any) {\n      for (var prop in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, prop)) {\n          // If deep merge and property is an object, merge properties\n          if (deep && Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n            extended[prop] = extend(true, extended[prop], obj[prop]);\n          } else {\n            extended[prop] = obj[prop];\n          }\n        }\n      }\n    };\n  } else {\n    merge = (<any>Object).assign;\n  }\n\n  // Loop through each object and conduct a merge\n  for (; i < length; i++) {\n    var obj = arguments[i];\n    if (!assignExists) {\n      merge(obj);\n    } else {\n      merge(extended, obj);\n    }\n  }\n\n  return extended;\n}\n\nexport function base64Encode(inputStr: string) {\n  var b64 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n  var outputStr = '';\n  var i = 0;\n\n  while (i < inputStr.length) {\n    //all three \"& 0xff\" added below are there to fix a known bug\n    //with bytes returned by xhr.responseText\n    var byte1 = inputStr.charCodeAt(i++) & 0xff;\n    var byte2 = inputStr.charCodeAt(i++) & 0xff;\n    var byte3 = inputStr.charCodeAt(i++) & 0xff;\n\n    var enc1 = byte1 >> 2;\n    var enc2 = ((byte1 & 3) << 4) | (byte2 >> 4);\n\n    var enc3, enc4;\n    if (isNaN(byte2)) {\n      enc3 = enc4 = 64;\n    } else {\n      enc3 = ((byte2 & 15) << 2) | (byte3 >> 6);\n      if (isNaN(byte3)) {\n        enc4 = 64;\n      } else {\n        enc4 = byte3 & 63;\n      }\n    }\n\n    outputStr += b64.charAt(enc1) + b64.charAt(enc2) + b64.charAt(enc3) + b64.charAt(enc4);\n  }\n\n  return outputStr;\n}\n\n/**\n * Clamps a value between a min and max inclusive\n */\nexport function clamp(val: number, min: number, max: number) {\n  return Math.min(Math.max(min, val), max);\n}\n\nexport function randomInRange(min: number, max: number, random: Random = new Random()): number {\n  return random ? random.floating(min, max) : min + Math.random() * (max - min);\n}\n\nexport function randomIntInRange(min: number, max: number, random: Random = new Random()): number {\n  return random ? random.integer(min, max) : Math.round(randomInRange(min, max));\n}\n\nexport function canonicalizeAngle(angle: number): number {\n  var tmpAngle = angle;\n  if (angle > TwoPI) {\n    while (tmpAngle > TwoPI) {\n      tmpAngle -= TwoPI;\n    }\n  }\n\n  if (angle < 0) {\n    while (tmpAngle < 0) {\n      tmpAngle += TwoPI;\n    }\n  }\n  return tmpAngle;\n}\n\nexport function toDegrees(radians: number): number {\n  return (180 / Math.PI) * radians;\n}\n\nexport function toRadians(degrees: number): number {\n  return (degrees / 180) * Math.PI;\n}\n\nexport function getPosition(el: HTMLElement): Vector {\n  var oLeft: number = 0,\n    oTop: number = 0;\n\n  var calcOffsetLeft = (parent: HTMLElement) => {\n    oLeft += parent.offsetLeft;\n\n    if (parent.offsetParent) {\n      calcOffsetLeft(<HTMLElement>parent.offsetParent);\n    }\n  };\n  var calcOffsetTop = (parent: HTMLElement) => {\n    oTop += parent.offsetTop;\n    if (parent.offsetParent) {\n      calcOffsetTop(<HTMLElement>parent.offsetParent);\n    }\n  };\n\n  calcOffsetLeft(el);\n  calcOffsetTop(el);\n\n  return new Vector(oLeft, oTop);\n}\n\nexport function addItemToArray<T>(item: T, array: T[]): boolean {\n  if (array.indexOf(item) === -1) {\n    array.push(item);\n    return true;\n  }\n  return false;\n}\n\nexport function removeItemFromArray<T>(item: T, array: T[]): boolean {\n  var index = -1;\n  if ((index = array.indexOf(item)) > -1) {\n    array.splice(index, 1);\n    return true;\n  }\n\n  return false;\n}\n\nexport function contains(array: Array<any>, obj: any): boolean {\n  for (var i = 0; i < array.length; i++) {\n    if (array[i] === obj) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport function getOppositeSide(side: Side) {\n  if (side === Side.Top) {\n    return Side.Bottom;\n  }\n  if (side === Side.Bottom) {\n    return Side.Top;\n  }\n  if (side === Side.Left) {\n    return Side.Right;\n  }\n  if (side === Side.Right) {\n    return Side.Left;\n  }\n\n  return Side.None;\n}\n\nexport function getSideFromVector(direction: Vector) {\n  var directions = [Vector.Left, Vector.Right, Vector.Up, Vector.Down];\n  var directionEnum = [Side.Left, Side.Right, Side.Top, Side.Bottom];\n\n  var max = -Number.MAX_VALUE;\n  var maxIndex = -1;\n  for (var i = 0; i < directions.length; i++) {\n    if (directions[i].dot(direction) > max) {\n      max = directions[i].dot(direction);\n      maxIndex = i;\n    }\n  }\n  return directionEnum[maxIndex];\n}\n\n/**\n * Excalibur's dynamically resizing collection\n */\nexport class Collection<T> {\n  /**\n   * Default collection size\n   */\n  public static DefaultSize = 200;\n  private _internalArray: T[] = null;\n  private _endPointer: number = 0;\n\n  /**\n   * @param initialSize  Initial size of the internal backing array\n   */\n  constructor(initialSize: number = Collection.DefaultSize) {\n    this._internalArray = new Array<T>(initialSize);\n  }\n\n  private _resize() {\n    var newSize = this._internalArray.length * 2;\n    var newArray = new Array<T>(newSize);\n    var count = this.count();\n    for (var i = 0; i < count; i++) {\n      newArray[i] = this._internalArray[i];\n    }\n\n    delete this._internalArray;\n    this._internalArray = newArray;\n  }\n\n  /**\n   * Push elements to the end of the collection\n   */\n  public push(element: T): T {\n    if (this._endPointer === this._internalArray.length) {\n      this._resize();\n    }\n    return (this._internalArray[this._endPointer++] = element);\n  }\n\n  /**\n   * Removes elements from the end of the collection\n   */\n  public pop(): T {\n    this._endPointer = this._endPointer - 1 < 0 ? 0 : this._endPointer - 1;\n    return this._internalArray[this._endPointer];\n  }\n\n  /**\n   * Returns the count of the collection\n   */\n  public count(): number {\n    return this._endPointer;\n  }\n\n  /**\n   * Empties the collection\n   */\n  public clear() {\n    this._endPointer = 0;\n  }\n\n  /**\n   * Returns the size of the internal backing array\n   */\n  public internalSize(): number {\n    return this._internalArray.length;\n  }\n\n  /**\n   * Returns an element at a specific index\n   * @param index  Index of element to retrieve\n   */\n  public elementAt(index: number): T {\n    if (index >= this.count()) {\n      //Logger.getInstance().error('Invalid parameter: ' + index);\n      throw new Error('Invalid index ' + index);\n    }\n    return this._internalArray[index];\n  }\n\n  /**\n   * Inserts an element at a specific index\n   * @param index  Index to insert the element\n   * @param value  Element to insert\n   */\n  public insert(index: number, value: T): T {\n    if (index >= this.count()) {\n      this._resize();\n    }\n    return (this._internalArray[index] = value);\n  }\n\n  /**\n   * Removes an element at a specific index\n   * @param index  Index of element to remove\n   */\n  public remove(index: number): T {\n    var count = this.count();\n    if (count === 0) {\n      //Logger.getInstance().error('Invalid parameter: ' + index);\n      throw new Error('Invalid parameter ' + index);\n    }\n    // O(n) Shift\n    var removed = this._internalArray[index];\n    for (var i = index; i < count; i++) {\n      this._internalArray[i] = this._internalArray[i + 1];\n    }\n    this._endPointer--;\n    return removed;\n  }\n\n  /**\n   * Removes an element by reference\n   * @param element  Element to retrieve\n   */\n  public removeElement(element: T) {\n    var index = this._internalArray.indexOf(element);\n    this.remove(index);\n  }\n\n  /**\n   * Returns a array representing the collection\n   */\n  public toArray(): T[] {\n    return this._internalArray.slice(0, this._endPointer);\n  }\n\n  /**\n   * Iterate over every element in the collection\n   * @param func  Callback to call for each element passing a reference to the element and its index, returned values are ignored\n   */\n  public forEach(func: (element: T, index: number) => any) {\n    var i = 0,\n      count = this.count();\n    for (i; i < count; i++) {\n      func.call(this, this._internalArray[i], i);\n    }\n  }\n\n  /**\n   * Mutate every element in the collection\n   * @param func  Callback to call for each element passing a reference to the element and its index, any values returned mutate\n   * the collection\n   */\n  public map(func: (element: T, index: number) => any) {\n    var count = this.count();\n    for (var i = 0; i < count; i++) {\n      this._internalArray[i] = func.call(this, this._internalArray[i], i);\n    }\n  }\n}\n","import { AudioContextFactory } from '../Resources/Sound/AudioContext';\nimport { Promise } from '../Promises';\n\nexport interface LegacyWebAudioSource {\n  playbackState: string;\n  PLAYING_STATE: 'playing';\n  FINISHED_STATE: 'finished';\n}\n\nfunction isLegacyWebAudioSource(source: any): source is LegacyWebAudioSource {\n  return !!source.playbackState;\n}\n\nexport class WebAudio {\n  private static _unlocked: boolean = false;\n\n  /**\n   * Play an empty sound to unlock Safari WebAudio context. Call this function\n   * right after a user interaction event. Typically used by [[PauseAfterLoader]]\n   * @source https://paulbakaus.com/tutorials/html5/web-audio-on-ios/\n   */\n  static unlock(): Promise<boolean> {\n    let promise = new Promise<boolean>();\n    if (WebAudio._unlocked || !AudioContextFactory.create()) {\n      return promise.resolve(true);\n    }\n\n    const audioContext = AudioContextFactory.create();\n    audioContext.resume().then(\n      () => {\n        // create empty buffer and play it\n        const buffer = audioContext.createBuffer(1, 1, 22050);\n        const source = audioContext.createBufferSource();\n        let ended = false;\n\n        source.buffer = buffer;\n        source.connect(audioContext.destination);\n        source.onended = () => (ended = true);\n\n        if ((<any>source).noteOn) {\n          // deprecated\n          (<any>source).noteOn(0);\n        } else {\n          source.start(0);\n        }\n\n        // by checking the play state after some time, we know if we're really unlocked\n        setTimeout(() => {\n          if (isLegacyWebAudioSource(source)) {\n            if (source.playbackState === source.PLAYING_STATE || source.playbackState === source.FINISHED_STATE) {\n              WebAudio._unlocked = true;\n            }\n          } else {\n            if (audioContext.currentTime > 0 || ended) {\n              WebAudio._unlocked = true;\n            }\n          }\n        }, 0);\n\n        promise.resolve();\n      },\n      () => {\n        promise.reject(false);\n      }\n    );\n\n    return promise;\n  }\n\n  static isUnlocked() {\n    return this._unlocked;\n  }\n}\n","/**\n * The current Excalibur version string\n * @description `process.env.__EX_VERSION` gets replaced by Webpack on build\n */\nexport var EX_VERSION = process.env.__EX_VERSION;\n\n// This file is used as the bundle entrypoint and exports everything\n// that will be exposed as the `ex` global variable.\n\nexport * from './Engine';\nexport { Actor, IActorArgs, CollisionType } from './Actor';\nexport * from './Algebra';\nexport * from './Camera';\nexport * from './Class';\nexport * from './Configurable';\nexport * from './Debug';\nexport * from './EventDispatcher';\nexport * from './Events/MediaEvents';\nexport * from './Events';\nexport * from './Group';\nexport { Label, FontStyle, FontUnit, TextAlign, BaseAlign } from './Label';\nexport * from './Loader';\nexport { Particle, ParticleEmitter, IParticleArgs, IParticleEmitterArgs, EmitterType } from './Particles';\nexport * from './Physics';\nexport * from './Promises';\nexport * from './Scene';\nexport { TileMap, Cell, ITileMapArgs, ICellArgs, TileSprite } from './TileMap';\nexport * from './Timer';\nexport * from './Trigger';\nexport * from './UIActor';\n\nexport * from './Actions/Index';\nexport * from './Collision/Index';\nexport * from './Drawing/Index';\nexport * from './Interfaces/Index';\nexport * from './Math/Index';\nexport * from './PostProcessing/Index';\nexport * from './Resources/Index';\n\n// ex.Events namespace\nimport * as events from './Events';\nexport { events as Events };\n\n// ex.Input namespace\nimport * as input from './Input/Index';\nexport { input as Input };\n\n// ex.Traits namespace\nimport * as traits from './Traits/Index';\nexport { traits as Traits };\n\n// ex.Util namespaces\nimport * as util from './Util/Index';\nexport { util as Util };\n\nexport * from './Util/Decorators';\nexport * from './Util/Detector';\nexport * from './Util/CullingBox';\nexport * from './Util/EasingFunctions';\nexport * from './Util/Log';\nexport * from './Util/SortedList';\n"],"sourceRoot":""}